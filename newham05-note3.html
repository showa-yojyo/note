<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>入門 bash 読書ノート 3/3 &mdash; 読書ノート v1.2.0</title>
    
    <link rel="stylesheet" href="_static/prefab.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/twitter-button.js"></script>
    <link rel="top" title="読書ノート v1.2.0" href="index.html" />
    <link rel="up" title="入門 bash 読書ノート" href="newham05.html" />
    <link rel="next" title="アジャイルプラクティス 読書ノート" href="subramaniam06.html" />
    <link rel="prev" title="入門 bash 読書ノート 2/3" href="newham05-note2.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html">読書ノート v1.2.0</a> &raquo;</li>
          <li><a href="newham05.html" accesskey="U">入門 bash 読書ノート</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="bash-3-3">
<h1><a class="toc-backref" href="#id30">入門 bash 読書ノート 3/3</a><a class="headerlink" href="#bash-3-3" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="newham05-note2.html"><em>入門 bash 読書ノート 2/3</em></a> からの続き。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">著者:</th><td class="field-body">Cameron Newham, Bill Rosenblatt</td>
</tr>
<tr class="field-even field"><th class="field-name">訳者:</th><td class="field-body">株式会社クイープ</td>
</tr>
<tr class="field-odd field"><th class="field-name">出版社:</th><td class="field-body">オライリー・ジャパン</td>
</tr>
<tr class="field-even field"><th class="field-name">ISBN:</th><td class="field-body">4-87311-254-0</td>
</tr>
</tbody>
</table>
<div class="contents topic" id="id1">
<p class="topic-title first">ノートの目次</p>
<ul class="simple">
<li><a class="reference internal" href="#bash-3-3" id="id30">入門 bash 読書ノート 3/3</a><ul>
<li><a class="reference internal" href="#id2" id="id31">8 章 プロセスの操作</a><ul>
<li><a class="reference internal" href="#id" id="id32">8.1 プロセス ID とジョブ番号</a></li>
<li><a class="reference internal" href="#id3" id="id33">8.2 ジョブ制御</a><ul>
<li><a class="reference internal" href="#id4" id="id34">8.2.1 フォアグラウントとバックグラウンド</a></li>
<li><a class="reference internal" href="#id5" id="id35">8.2.2 ジョブの一時停止</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id6" id="id36">8.3 シグナル</a><ul>
<li><a class="reference internal" href="#id7" id="id37">8.3.1 コントロールキーのシグナル</a></li>
<li><a class="reference internal" href="#kill" id="id38">8.3.2 kill</a></li>
<li><a class="reference internal" href="#ps" id="id39">8.3.3 ps</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id8" id="id40">8.4 トラップ</a><ul>
<li><a class="reference internal" href="#id9" id="id41">8.4.2 プロセス ID と一時ファイル</a></li>
<li><a class="reference internal" href="#id10" id="id42">8.4.5 トラップのリセット</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id11" id="id43">8.5 コルーチン</a><ul>
<li><a class="reference internal" href="#wait" id="id44">8.5.1 wait</a></li>
<li><a class="reference internal" href="#id12" id="id45">8.5.2 コルーチンの利点と欠点</a></li>
<li><a class="reference internal" href="#id13" id="id46">8.5.3 並列化</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id14" id="id47">8.6 サブシェル</a><ul>
<li><a class="reference internal" href="#id15" id="id48">8.6.2 入れ子のサブシェル</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id16" id="id49">8.7 プロセス置換</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id17" id="id50">9 章 シェルプログラミングのデバッグ</a><ul>
<li><a class="reference internal" href="#id18" id="id51">9.1 基本的なデバッグ補助</a><ul>
<li><a class="reference internal" href="#set" id="id52">9.1.1 set のオプション</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bash" id="id53">9.2 bash デバッガ</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id19" id="id54">10 章 bash の管理</a><ul>
<li><a class="reference internal" href="#id20" id="id55">10.1 標準シェルとしての bash のインストール</a><ul>
<li><a class="reference internal" href="#posix" id="id56">10.1.1 POSIX モード</a></li>
<li><a class="reference internal" href="#id21" id="id57">10.1.2 コマンドラインオプション</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id22" id="id58">10.2 環境のカスタマイズ</a><ul>
<li><a class="reference internal" href="#umask" id="id59">10.2.1 umask</a></li>
<li><a class="reference internal" href="#ulimit" id="id60">10.2.2 ulimit</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id23" id="id61">11 章 シェルスクリプティング</a><ul>
<li><a class="reference internal" href="#id24" id="id62">11.1 スクリプトは何をするのか</a><ul>
<li><a class="reference internal" href="#id25" id="id63">11.1.2 変数と定数</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id26" id="id64">11.2 スクリプトの起動</a></li>
<li><a class="reference internal" href="#id27" id="id65">11.3 その他の問題点</a></li>
<li><a class="reference internal" href="#id28" id="id66">11.4 bash を使用しない</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id29" id="id67">12 章 bash の導入</a></li>
<li><a class="reference internal" href="#a" id="id68">付録 A 関連シェル</a><ul>
<li><a class="reference internal" href="#a-3-korn" id="id69">A.3 Korn シェル</a></li>
<li><a class="reference internal" href="#a-5-zsh" id="id70">A.5 zsh</a></li>
</ul>
</li>
<li><a class="reference internal" href="#b" id="id71">付録 B リファレンス</a><ul>
<li><a class="reference internal" href="#b-8" id="id72">B.8 入出力リダイレクト</a></li>
</ul>
</li>
<li><a class="reference internal" href="#d" id="id73">付録 D プログラム可能な補完</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id31">8 章 プロセスの操作</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Cygwin ユーザーが読んでも役に立つと信じて本章を読む。</p>
<ul class="simple">
<li>&lt;UNIX は、ユーザーごとに複数のプロセスの制御を可能にした最初の小型コンピュータオペレーティングシステムとしてもよく知られている&gt; (p. 209)</li>
<li>&lt;プロセスを識別し、ログインセッションやシェルスクリプトでそれらを制御するための最も基本的な要素から見ていく&gt; (p. 209)</li>
<li>&lt;プロセスどうしを通信させる仕組みについて調べる&gt; (p. 209)</li>
</ul>
<div class="section" id="id">
<h3><a class="toc-backref" href="#id32">8.1 プロセス ID とジョブ番号</a><a class="headerlink" href="#id" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>&lt;プロセスが生成されると、必ず <strong>プロセス ID</strong> という番号が振られる&gt; (p. 210)
コマンドを <tt class="docutils literal"><span class="pre">&amp;</span></tt> 付きで実行すると、コンソールに <tt class="docutils literal"><span class="pre">[1]</span> <span class="pre">4000</span></tt> のような表示が出る。
最初の括弧つきの番号が <strong>ジョブ番号</strong> を示す。</li>
<li>&lt;ジョブという言葉は、基本的に、シェルから呼び出されたコマンドラインを指す&gt; (p. 210)</li>
</ul>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id33">8.2 ジョブ制御</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>&lt;ただし、ジョブ番号のほうは重要だ。
<strong>ジョブ制御</strong> を行うシェルコマンドで使用するからである&gt; (p. 211)</li>
<li>&lt;ジョブをバックグラウンドで起動した後は、そのまま完了させるか、
<strong>フォアグラウンド</strong> へ移すか、または
<strong>シグナル</strong> というメッセージを送りつけることができる&gt; (p. 211)</li>
</ul>
<div class="section" id="id4">
<h4><a class="toc-backref" href="#id34">8.2.1 フォアグラウントとバックグラウンド</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">jobs</span></tt> コマンドでジョブの一覧表示。オプションが色々ある。</li>
<li>引数なしで <tt class="docutils literal"><span class="pre">fg</span></tt> と入力すると、バックグランドで最後に実行されたジョブがフォアグラウンドに移る。</li>
</ul>
</div>
<div class="section" id="id5">
<h4><a class="toc-backref" href="#id35">8.2.2 ジョブの一時停止</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;一時停止するには、ジョブの実行中に CTRL+Z キーを押す&gt; (p. 213)
ここで CTRL+Z は <tt class="docutils literal"><span class="pre">susp</span></tt> に設定されていることを仮定している。</li>
<li>&lt;停止したジョブを再開し、フォアグラウンドで続行したい場合には、
ここで <tt class="docutils literal"><span class="pre">fg</span></tt> と入力すればよい&gt; (p. 213)</li>
<li>&lt;（いつものように）コマンドをフォアグラウンドに実行したところ、
思ったよりも処理に時間がかかっていることに気付く。
コマンドはきちんと終了させたいが、端末の制御を取り戻して他の作業も行いたい。
このような場合には、CTRL+Z キーを押してから <tt class="docutils literal"><span class="pre">bg</span></tt> と入力すれば、
ジョブをバックグラウンドに移すことができる&gt; (p. 214)
脚注のネットワーク経由での実行に関する注意も読む。</li>
</ul>
</div>
</div>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id36">8.3 シグナル</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>CTRL+Z と CTRL+C は、&lt;どちらもプロセスに <strong>シグナル</strong> を送信するという特殊な行動をとる&gt; (p. 214)</li>
<li>シグナルとは、あるプロセスから別のプロセスに送信されるメッセージととらえればよいようだ。</li>
<li>シグナルを使用するスクリプトを書くときは、可搬性を高めるために番号ではなく名前を使用する。
<tt class="docutils literal"><span class="pre">kill</span> <span class="pre">-l</span></tt> で一覧できる。</li>
</ul>
<div class="section" id="id7">
<h4><a class="toc-backref" href="#id37">8.3.1 コントロールキーのシグナル</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;説明しておいて何だが、この方法はお勧めできないことを付け加えておかなければならない&gt; (p. 216)</li>
</ul>
</div>
<div class="section" id="kill">
<h4><a class="toc-backref" href="#id38">8.3.2 kill</a><a class="headerlink" href="#kill" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>デフォルトでは <tt class="docutils literal"><span class="pre">kill</span></tt> は TERM シグナルを送信する。
ただ、効果としては INT シグナルと同じとのこと。</li>
<li>&lt;すべてを説明すると込み入った話になるので、次の説明で勘弁して欲しい&gt; (p. 216)</li>
<li><tt class="docutils literal"><span class="pre">kill</span> <span class="pre">%1</span></tt> は「ジョブ番号 1 のプロセスを（TERM シグナルで）停止する」。</li>
<li><tt class="docutils literal"><span class="pre">kill</span> <span class="pre">-QUIT</span> <span class="pre">%1</span></tt> は「ジョブ番号 1 のプロセスを（QUIT シグナルで）終了する」。</li>
<li><tt class="docutils literal"><span class="pre">kill</span> <span class="pre">-KILL</span> <span class="pre">%1</span></tt> は「ジョブ番号 1 のプロセスを（KILL シグナルで）終了する」。</li>
<li>&lt;TERM シグナルと QUIT シグナルは、プロセスを終了する前に「後始末」をする機会を設けるが、
KILL シグナルは、たとえ計算中であったとしても、プロセスを強制終了する。
<strong>KILL シグナルは最後の手段として使用すること。</strong>&gt; (pp. 217-218)</li>
</ul>
</div>
<div class="section" id="ps">
<h4><a class="toc-backref" href="#id39">8.3.3 ps</a><a class="headerlink" href="#ps" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;プロセス ID は <tt class="docutils literal"><span class="pre">ps</span></tt> コマンドで取得することができる&gt; (p. 218)</li>
<li>&lt;<tt class="docutils literal"><span class="pre">ps</span></tt> にはオプションが複数あるが、UNIX のバージョンによって異なる&gt; (p. 218)
Cygwin 環境では <tt class="docutils literal"><span class="pre">ps</span> <span class="pre">-ax</span></tt> が怒られるから、BSD ではなく System V 系統なのだろうか。</li>
</ul>
</div>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id40">8.4 トラップ</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id9">
<h4><a class="toc-backref" href="#id41">8.4.2 プロセス ID と一時ファイル</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;<tt class="docutils literal"><span class="pre">$$</span></tt> は、現在のシェルのプロセス ID を保持する特別なシェル変数である&gt; (p. 224)</li>
<li>&lt;<tt class="docutils literal"><span class="pre">$!</span></tt> には、最後に実行したバックグラウンドジョブのプロセス ID が含まれている&gt; (p. 224)</li>
<li>&lt;<tt class="docutils literal"><span class="pre">trap</span></tt> コマンドに指定されたコマンド文字列が、実行されるまで <strong>評価されない</strong> ことに注意しよう。
したがって、コマンド文字列の <tt class="docutils literal"><span class="pre">$msgfile</span></tt> には、必ず正しい値が含まれる。
コマンド文字列を単一引用符で囲んだのは、そのためである&gt; (p. 225)</li>
</ul>
</div>
<div class="section" id="id10">
<h4><a class="toc-backref" href="#id42">8.4.5 トラップのリセット</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">trap</span></tt> コマンドに引数としてハイフンだけを指定すると、
シグナル受信時の動作がデフォルト（プロセスの中止）に戻る。</li>
</ul>
</div>
</div>
<div class="section" id="id11">
<h3><a class="toc-backref" href="#id43">8.5 コルーチン</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>&lt;2 つ（以上）のプロセスが同時に実行されるようにプログラムされていて、
プロセスどうしが互いにやり取りすることが可能である場合、それらを <strong>コルーチン</strong>
(coroutine) という&gt; (p. 227)</li>
<li>&lt;パイプラインはコルーチンの一例だ&gt; (p. 227)</li>
</ul>
<div class="section" id="wait">
<h4><a class="toc-backref" href="#id44">8.5.1 wait</a><a class="headerlink" href="#wait" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;引数を指定しないと、
<tt class="docutils literal"><span class="pre">wait</span></tt> はバックグラウンドジョブがすべて終了するまで待機する&gt; (p. 228)</li>
</ul>
</div>
<div class="section" id="id12">
<h4><a class="toc-backref" href="#id45">8.5.2 コルーチンの利点と欠点</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>以下の用語がだいたい人に説明できる程度まで、複数プロセス同時実行のメリットに関する理解を深めたい。</p>
<ul class="simple">
<li>CPU 集約型</li>
<li>入出力集約型</li>
<li>対話型</li>
<li>スラッシンング</li>
</ul>
</div>
<div class="section" id="id13">
<h4><a class="toc-backref" href="#id46">8.5.3 並列化</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;プロセスをコルーチンに分割することを、ジョブを <strong>並列化</strong> するとも言う&gt; (p. 229)</li>
<li>&lt;この場合、コルーチンの実行時間は、すべてのプロセスの実行時間を合計したものではなく、
基本的には、実行時間が最も長いものに若干のオーバーヘッドを足したものとなる
（ただし、すべての CPU が 1 つのディスクドライブを共有していた場合、
I/O 関連のスラッシングの可能性はまだ消えない）&gt; (p. 230)</li>
<li>&lt;せっかく並列化を施して処理時間を短縮したのに、
追加したコードの実行時間で相殺されてしまったのでは意味がない&gt; (p. 231)</li>
<li>&lt;複雑な並列プログラムになると、本体の目的を達成するコードよりも、
特殊な状況に対応するコードのほうが圧倒的に多いほどである&gt; (p. 231)</li>
</ul>
</div>
</div>
<div class="section" id="id14">
<h3><a class="toc-backref" href="#id47">8.6 サブシェル</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id15">
<h4><a class="toc-backref" href="#id48">8.6.2 入れ子のサブシェル</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;シェルコードの一部を（中かっこではなく）かっこで囲むと、そのコードはサブシェルで実行される。
これを <strong>入れ子</strong> の（またはネストした）サブシェルと言う&gt; (p. 232)<ul>
<li>通常は、コマンドブロック（中括弧）の場合よりも効率が悪い。</li>
<li>サブシェルとコマンドブロックの違いは、そのほとんどが「スコープ」に関係するもの。
シェル変数やシグナルトラップの有効範囲が違う。</li>
</ul>
</li>
<li>&lt;コードの入れ子をサポートしている言語では、入れ子のコード内で定義されるものには、
そこだけに限定されたスコープが割り当てられることが望ましい、とされている。
このため、変数やシグナルトラップのスコープに関しては、
入れ子のサブシェルのほうがコマンドブロックよりも厳密な制御が可能である。
したがって、変数の定義やシグナルトラップが必要で、
効率を度外視できるのであれば、コマンドブロックよりもサブシェルを使用したほうがよいだろう&gt; (p. 233)</li>
</ul>
</div>
</div>
<div class="section" id="id16">
<h3><a class="toc-backref" href="#id49">8.7 プロセス置換</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre>cmp &lt;<span class="o">(</span>program1<span class="o">)</span> &lt;<span class="o">(</span>program2<span class="o">)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">program1</span></tt> と <tt class="docutils literal"><span class="pre">program2</span></tt> を同時に実行して、</li>
<li>それらの出力を <strong>名前付きパイプ</strong> につなぎ、</li>
<li><tt class="docutils literal"><span class="pre">cmp</span></tt> がそれぞれのパイプからデータを読み取り、比較する。</li>
</ol>
</div>
</div>
<div class="section" id="id17">
<h2><a class="toc-backref" href="#id50">9 章 シェルプログラミングのデバッグ</a><a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id18">
<h3><a class="toc-backref" href="#id51">9.1 基本的なデバッグ補助</a><a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<div class="section" id="set">
<h4><a class="toc-backref" href="#id52">9.1.1 set のオプション</a><a class="headerlink" href="#set" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>組み込み変数 <tt class="docutils literal"><span class="pre">PS4</span></tt> は <tt class="docutils literal"><span class="pre">set</span> <span class="pre">-o</span> <span class="pre">xtrace</span></tt> の出力行の先頭の文字列。
展開レベル次第で、出力行の先頭の文字列の先頭に <tt class="docutils literal"><span class="pre">PS4</span></tt> の 1 文字目が付加される。</li>
</ul>
</div>
</div>
<div class="section" id="bash">
<h3><a class="toc-backref" href="#id53">9.2 bash デバッガ</a><a class="headerlink" href="#bash" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">&lt;プログラムにおいて実行を停止する場所を指定する。
これを <strong>ブレークポイント</strong> という&gt; (p. 245)</p>
</li>
<li><p class="first">&lt;プログラムにおいて指定された数の文を実行する。
これを <strong>ステップ実行</strong> という&gt; (p. 245)</p>
</li>
<li><p class="first">&lt;<tt class="docutils literal"><span class="pre">exec</span></tt> に引数としてコマンドラインを渡すと、
それらは現在のプログラム（同じプロセス）で実行される。
したがって、 <tt class="docutils literal"><span class="pre">exec</span></tt> を実行するとシェルが <strong>直ちに停止し、</strong>
<tt class="docutils literal"><span class="pre">exec</span></tt> の引数と置換される&gt; (p. 247)</p>
<p><tt class="docutils literal"><span class="pre">exec</span></tt> が危険な存在であることを指摘している。</p>
</li>
</ul>
</div>
</div>
<div class="section" id="id19">
<h2><a class="toc-backref" href="#id54">10 章 bash の管理</a><a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id20">
<h3><a class="toc-backref" href="#id55">10.1 標準シェルとしての bash のインストール</a><a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">&lt;1 行目では、 <tt class="docutils literal"><span class="pre">$PATH</span></tt> 環境変数を
<tt class="docutils literal"><span class="pre">for</span></tt> ループの項目リストとして使用できるようにしている&gt; (p. 268)</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">IFS</span><span class="o">=</span>:
<span class="k">for </span>d in <span class="nv">$PATH</span>; <span class="k">do</span>
    <span class="c"># 何か処理</span>
</pre></div>
</div>
</li>
</ul>
<div class="section" id="posix">
<h4><a class="toc-backref" href="#id56">10.1.1 POSIX モード</a><a class="headerlink" href="#posix" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>POSIX は Portable Operating System Interface の略らしい。X はどこから？</li>
<li>&lt;<tt class="docutils literal"><span class="pre">bash</span></tt> はデフォルトのモードでも POSIX にほぼ 100% 準拠している。
POSIX へのこだわりがあるならば、 <tt class="docutils literal"><span class="pre">bash</span></tt> を POSIX モードで実行することができる。
そのためには、 <tt class="docutils literal"><span class="pre">--posix</span></tt> オプションを指定するか、
シェルで <tt class="docutils literal"><span class="pre">set</span> <span class="pre">-o</span> <span class="pre">posix</span></tt> を設定する&gt; (p. 269)</li>
</ul>
</div>
<div class="section" id="id21">
<h4><a class="toc-backref" href="#id57">10.1.2 コマンドラインオプション</a><a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">表 10-1 より、使えそうなものをノート：</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-c <var>string</var></span></kbd></td>
<td><p class="first last"><em>string</em> からコマンドを読み取る。</p>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-i</span></kbd></td>
<td><p class="first last">対話型シェル。</p>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-l</span>, <span class="option">--login</span></kbd></td>
<td><p class="first last">ログインシェル。</p>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--help</span></kbd></td>
<td><p class="first last">使用法を示すメッセージを表示する。</p>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--noprofile</span></kbd></td>
<td><p class="first last"><tt class="docutils literal"><span class="pre">/etc/profile</span></tt> やユーザーの初期設定ファイルをロードしない。</p>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--norc</span></kbd></td>
<td><p class="first last">対話型シェルの場合、 <tt class="docutils literal"><span class="pre">~/.bashrc</span></tt> をロードしない。</p>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--rcfile <var>file</var></span></kbd></td>
<td><p class="first last">対話型シェルの場合、 <tt class="docutils literal"><span class="pre">~/.bashrc</span></tt> の代わりに <em>file</em> をロードする。</p>
</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--init-file <var>file</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td><p class="first last">同上。</p>
</td></tr>
</tbody>
</table>
</li>
<li><p class="first">&lt;コマンドラインで複数文字のオプションを指定する場合には、
1 文字のオプションよりも前に指定しなければならない&gt; (p. 270)</p>
</li>
</ul>
</div>
</div>
<div class="section" id="id22">
<h3><a class="toc-backref" href="#id58">10.2 環境のカスタマイズ</a><a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">bash</span></tt> は <tt class="docutils literal"><span class="pre">/etc/profile</span></tt> を読み込んでから <tt class="docutils literal"><span class="pre">~/.bash_profile</span></tt> を読み込む。
<tt class="docutils literal"><span class="pre">umask</span></tt> や <tt class="docutils literal"><span class="pre">ulimit</span></tt> コマンドを使用するのは前者。</li>
</ul>
<div class="section" id="umask">
<h4><a class="toc-backref" href="#id59">10.2.1 umask</a><a class="headerlink" href="#umask" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;ここでは 8 進表記を使用して <tt class="docutils literal"><span class="pre">umask</span></tt> の説明をする。
おそらく知っていると思うが、パーミッションの数字は、（左から右に）
所有者、所有者が属するグループ、その他のユーザーへのパーミッションを表す。
数字はそれぞれ 3 ビットで構成され、左から右に、
読み取り、書き込み、実行のパーミッションを指定する。
（ファイルがディレクトリの場合、「実行」パーミッションは「検索」パーミッションとなる。
検索パーミッションとは、ディレクトリを移動したりファイルの一覧を取得したりするためのパーミッションである&gt; (p. 271)</li>
</ul>
</div>
<div class="section" id="ulimit">
<h4><a class="toc-backref" href="#id60">10.2.2 ulimit</a><a class="headerlink" href="#ulimit" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ulimit</span></tt> コマンドで、ユーザーが利用できるシステムリソースに制限を設けることができる。</li>
</ul>
</div>
</div>
</div>
<div class="section" id="id23">
<h2><a class="toc-backref" href="#id61">11 章 シェルスクリプティング</a><a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<p>本章では、&lt;保守可能なシェルスクリプトを作成する方法を紹介&gt; (p. 279) するようだ。</p>
<div class="section" id="id24">
<h3><a class="toc-backref" href="#id62">11.1 スクリプトは何をするのか</a><a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id25">
<h4><a class="toc-backref" href="#id63">11.1.2 変数と定数</a><a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>&lt;ヘッダーとコメントは、コードを文書化するための方法の 1 つにすぎない&gt; (p. 281)</li>
<li>&lt;よい名前とは、短くてわかりやすいものである。（略）長い名前にしてはならない。
（略）わかりやすい名前のメリットを帳消しにするほど、
スクリプトを煩雑にするだけである&gt; (p. 281)</li>
</ul>
</div>
</div>
<div class="section" id="id26">
<h3><a class="toc-backref" href="#id64">11.2 スクリプトの起動</a><a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>&lt;プログラマはユーザーの操作ができるだけ楽になるように努力しなければならない&gt; (p. 281)</li>
<li>&lt;Free Software Foundation では、GNU ソフトウェアを作成するためのガイドラインを公開し、
UNIX ユーティリティの標準的な使用法を提案している&gt; (p. 282) URL が脚注にある。</li>
<li>&lt;注意しなければならない点が 1 つある。
それは、ユーザーの環境において特定の環境変数が設定されていることを前提とする場合である。
環境変数が設定されていることをあてにするくらいなら、
スクリプトの設計を見直して、その値を引数として指定できるようにしたほうがよいだろう&gt; (p. 283)</li>
</ul>
</div>
<div class="section" id="id27">
<h3><a class="toc-backref" href="#id65">11.3 その他の問題点</a><a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">bash</span></tt> スクリプトに関するものだけノート。</p>
<ul class="simple">
<li>必ず <tt class="docutils literal"><span class="pre">#!/bin/bash</span></tt> とすること。</li>
<li>ホワイトスペースに注意する。等号の前後、開き括弧の後ろ、閉じ括弧の前が危ない。</li>
<li>評価演算子 <tt class="docutils literal"><span class="pre">[...]</span></tt> の使用に注意。 <tt class="docutils literal"><span class="pre">=</span></tt> なのか <tt class="docutils literal"><span class="pre">-eq</span></tt> なのか等。</li>
</ul>
</div>
<div class="section" id="id28">
<h3><a class="toc-backref" href="#id66">11.4 bash を使用しない</a><a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>大量の処理をすばやく実行する場合や、
数学的な計算を要する場合は C/C++ の使用を検討したり、
システム間の可搬性を重視する場合は、
Python や Perl のほうが適しているといった判断をすること。
適材適所。</li>
</ul>
</div>
</div>
<div class="section" id="id29">
<h2><a class="toc-backref" href="#id67">12 章 bash の導入</a><a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h2>
<p>Cygwin ユーザーである記者は特に読まなくてよい？</p>
</div>
<div class="section" id="a">
<h2><a class="toc-backref" href="#id68">付録 A 関連シェル</a><a class="headerlink" href="#a" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-3-korn">
<h3><a class="toc-backref" href="#id69">A.3 Korn シェル</a><a class="headerlink" href="#a-3-korn" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>&lt;唯一の欠点は、数年起きにしかアップグレードされないことだ&gt; (p. 302)
とある。今でもそうなのだろうか。</li>
</ul>
</div>
<div class="section" id="a-5-zsh">
<h3><a class="toc-backref" href="#id70">A.5 zsh</a><a class="headerlink" href="#a-5-zsh" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>&lt;特に「パワーユーザー」にお勧めである&gt; (p. 303)</li>
</ul>
</div>
</div>
<div class="section" id="b">
<h2><a class="toc-backref" href="#id71">付録 B リファレンス</a><a class="headerlink" href="#b" title="Permalink to this headline">¶</a></h2>
<div class="section" id="b-8">
<h3><a class="toc-backref" href="#id72">B.8 入出力リダイレクト</a><a class="headerlink" href="#b-8" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>出力・エラーリダイレクトには <tt class="docutils literal"><span class="pre">&amp;&gt;file</span></tt> と <tt class="docutils literal"><span class="pre">&gt;&amp;file</span></tt> の 2 つの形式がある。
後者のほうが望ましい。</li>
</ul>
</div>
</div>
<div class="section" id="d">
<h2><a class="toc-backref" href="#id73">付録 D プログラム可能な補完</a><a class="headerlink" href="#d" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">&lt;補完メカニズムにフックを仕掛けて、
2 章で説明した組み込みのテキスト補完機能を拡張するものである&gt; (p. 333)</p>
</li>
<li><p class="first">TAB キーが押されたときのシェルの対応を <tt class="docutils literal"><span class="pre">complete</span></tt> コマンドで指定する。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># -A file が「補完するのはファイルリストだ」ということを指示する</span>
<span class="c">#</span>
<span class="c"># -X &#39;!*.@(Z|gz|tgz)&#39; がファイル名パターンのフィルターを指示する</span>
<span class="nb">complete</span> -A file -X <span class="s1">&#39;!*.@(Z|gz|tgz)&#39;</span> gunzip
</pre></div>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">compgen</span></tt> は補完文字列を確認するのに利用できる。</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nb">complete</span> -A file -X <span class="s1">&#39;!*.@(Z|gz|tgz)&#39;</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html">読書ノート v1.2.0</a> &raquo;</li>
          <li><a href="newham05.html" >入門 bash 読書ノート</a> &raquo;</li> 
      </ul>
    </div>
    <div id="footer">
      <div id="footer_logo">
        <a class="imga" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="_static/logos.png" width="88" height="31" /></a>
      </div>
      <div id="footer_share">
        <a href="https://twitter.com/share" class="twitter-share-button" data-size="large">Tweet</a>
        <script type="text/javascript">render_twitter_button(document, 'script', 'twitter-wjs')</script>
      </div>
      <div id="footer_copyright">
        Since 1999<br />
        Copyright &copy; 1999-2014, プレハブ小屋 All rights reserved.
      </div>
      <div id="footer_spacer">
        <p>
          Last updated at 2014/11/06 (Thu) 23:22:09.
        </p>
      </div>
    </div>
  </body>
</html>