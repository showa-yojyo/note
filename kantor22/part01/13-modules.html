
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modules &#8212; 読書ノート 1.5dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/mermaid.js"></script>
    <link rel="next" title="Miscellaneous" href="14-js-misc.html" />
    <link rel="prev" title="Generators, advanced iteration" href="12-generators-iterators.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="12-generators-iterators.html" title="Previous document">Generators, advanced iteration</a>
        </li>
        <li>
          <a href="14-js-misc.html" title="Next document">Miscellaneous</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <div class="section" id="modules">
<h1><a class="toc-backref" href="#id1">Modules</a><a class="headerlink" href="#modules" title="Permalink to this heading">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#modules" id="id1">Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#modules-introduction" id="id2">Modules, introduction</a></p></li>
<li><p><a class="reference internal" href="#export-and-import" id="id3">Export and Import</a></p></li>
<li><p><a class="reference internal" href="#dynamic-imports" id="id4">Dynamic imports</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="modules-introduction">
<h2><a class="toc-backref" href="#id2">Modules, introduction</a><a class="headerlink" href="#modules-introduction" title="Permalink to this heading">¶</a></h2>
<p>&lt;<a class="reference external" href="https://javascript.info/modules-intro">https://javascript.info/modules-intro</a>&gt; のノート。</p>
<p>JavaScript は長い間モジュールのサポートがなかったが、2015 年に標準仕様に現れる。今ではすべての主要なブラウザーと Node.js でサポートされている。</p>
<div class="section" id="what-is-a-module">
<h3>What is a module?<a class="headerlink" href="#what-is-a-module" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>モジュールは単なるファイルだ。</p></li>
<li><p>モジュールは互いにロードすることができ、 <code class="docutils literal notranslate"><span class="pre">export</span></code> と <code class="docutils literal notranslate"><span class="pre">import</span></code> を使ってモジュール構成要素を交換する。例えば、あるモジュールの関数を別のモジュールから呼び出すことができる。</p></li>
</ul>
<p>モジュールファイルで <code class="docutils literal notranslate"><span class="pre">export</span></code> をオブジェクト宣言の前に置くと、外側からそれをロードできる。</p>
<p><code class="docutils literal notranslate"><span class="pre">import</span></code> でロードすることができる。ロードしたいオブジェクトとモジュールファイルパスを指定する：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="p">{</span><span class="nx">sayHi</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./sayHi.js&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>モジュールは特別なキーワードや機能をサポートしているので、スクリプトの
<code class="docutils literal notranslate"><span class="pre">type=&quot;module&quot;</span></code> という属性を使って、モジュールとして扱われることを宣言する必要がある。</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
    <span class="kr">import</span> <span class="p">{</span><span class="nx">sayHi</span><span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;./say.js&#39;</span><span class="p">;</span>

    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">sayHi</span><span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">file://</span></code> プロトコルでは <code class="docutils literal notranslate"><span class="pre">import</span></code>/<code class="docutils literal notranslate"><span class="pre">export</span></code> は機能しない。</p>
</div>
<div class="section" id="core-module-features">
<h3>Core module features<a class="headerlink" href="#core-module-features" title="Permalink to this heading">¶</a></h3>
<p>モジュールのコードと今までのスクリプトのコードとの違いを見ていく。</p>
<div class="section" id="always-use-strict">
<h4>Always “use strict”<a class="headerlink" href="#always-use-strict" title="Permalink to this heading">¶</a></h4>
<p>モジュールは自動的に “use strict” モードになる。この文言を明示的に書かなくて済む。</p>
</div>
<div class="section" id="module-level-scope">
<h4>Module-level scope<a class="headerlink" href="#module-level-scope" title="Permalink to this heading">¶</a></h4>
<p>各モジュールは固有のスコープを有する。</p>
</div>
<div class="section" id="a-module-code-is-evaluated-only-the-first-time-when-imported">
<h4>A module code is evaluated only the first time when imported<a class="headerlink" href="#a-module-code-is-evaluated-only-the-first-time-when-imported" title="Permalink to this heading">¶</a></h4>
<p>同じモジュールが他の複数のモジュールにロードされる場合、そのコードは最初のロード時にしか実行されない。</p>
<p>トップレベルのモジュールコードは、初期化、モジュール固有の内部データ構造の作成に用いるべきだ。何度でも呼び出すような用途のものは、関数として <code class="docutils literal notranslate"><span class="pre">export</span></code> する必要がある。</p>
<p>この一度きりの評価という性質を利用して、モジュールを構成することができる。</p>
</div>
<div class="section" id="import-meta">
<h4>import.meta<a class="headerlink" href="#import-meta" title="Permalink to this heading">¶</a></h4>
<p>オブジェクト <code class="docutils literal notranslate"><span class="pre">import.meta</span></code> は現在のモジュールの情報を含む。</p>
</div>
<div class="section" id="in-a-module-this-is-undefined">
<h4>In a module, “this” is undefined<a class="headerlink" href="#in-a-module-this-is-undefined" title="Permalink to this heading">¶</a></h4>
<p>モジュールスコープでは <code class="docutils literal notranslate"><span class="pre">this</span></code> が存在しない。</p>
</div>
</div>
<div class="section" id="browser-specific-features">
<h3>Browser-specific features<a class="headerlink" href="#browser-specific-features" title="Permalink to this heading">¶</a></h3>
<div class="admonition- admonition">
<p class="admonition-title">学習者ノート</p>
<p>ブラウザーが HTML を解析するときに SCRIPT タグを見つけると、DOM の構築をそこで中断する。そのタグを実行してから構築を再開する。これが DOM 生成の基本だ。</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">defer</span></code></dt><dd><p>そこで中断する代わりにスクリプトのロードをバックグランドで行い、かつ
DOM の構築を続行する。DOM の準備ができたらスクリプトが実行する。複数の <code class="docutils literal notranslate"><span class="pre">defer</span></code> スクリプトがある場合、それらの順序は考慮される。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">async</span></code></dt><dd><p>他のスクリプトのロードを待たないし、他のスクリプトも <code class="docutils literal notranslate"><span class="pre">async</span></code> スクリプトを待たない。イベント <code class="docutils literal notranslate"><span class="pre">DOMContentLoaded</span></code> さえ <code class="docutils literal notranslate"><span class="pre">async</span></code> スクリプトの完了を待たない。つまり、ページのロード完了前に実行される。</p>
</dd>
</dl>
<p>どちらの属性も、<code class="docutils literal notranslate"><span class="pre">src</span></code> のない（つまり外部ファイルではない）スクリプトには効かない。</p>
<p>以上を踏まえて、モジュールスクリプトは <code class="docutils literal notranslate"><span class="pre">defer</span></code> が与えられていないものでも
<code class="docutils literal notranslate"><span class="pre">defer</span></code> が適用される。HTML ファイルに直接書かれているスクリプトでもだ。ユーザーはモジュールスクリプトが実行される前のページを一瞬見ることになる可能性が高い。</p>
<p><code class="docutils literal notranslate"><span class="pre">async</span></code> モジュールの場合はやはり独立性があり、他を待たない。</p>
</div>
<div class="section" id="module-scripts-are-deferred">
<h4>Module scripts are deferred<a class="headerlink" href="#module-scripts-are-deferred" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">type=&quot;module&quot;</span> <span class="pre">src=&quot;...&quot;&gt;</span></code> は HTML 処理を妨げない。</p></li>
<li><p>モジュールスクリプトは HTML 文書の準備が完全に整うまで待機し、それから実行される。</p></li>
<li><p>スクリプトの相対的な順序は維持される。ドキュメント内で最初に現れるスクリプトが最初に実行される。</p></li>
</ul>
<p>言い換えると、モジュールスクリプトは完全にロードされた HTML ページを常に扱うということだ。</p>
<p>モジュールを使うときに注意しなければならないのは、HTML ページは読み込まれると同時に表示され、JavaScript モジュールはその後に実行されるので、閲覧者が
JavaScript アプリケーションの準備ができる前にページを見るかもしれないことだ。まだ動作しない機能がある可能性がある。</p>
</div>
<div class="section" id="async-works-on-inline-scripts">
<h4>Async works on inline scripts<a class="headerlink" href="#async-works-on-inline-scripts" title="Permalink to this heading">¶</a></h4>
<p>モジュール以外のスクリプトでは <code class="docutils literal notranslate"><span class="pre">async</span></code> 属性は外部スクリプトにのみ作用する。非同期スクリプトは、他のスクリプトや HTML ページとは無関係に、準備ができると直ちに実行される。</p>
<p>モジュールスクリプトの場合は、インラインスクリプトでも機能する。</p>
<p>カウンターや広告、ドキュメントレベルのイベントリスナーなど、ページ固有の要素に依存しない機能に向いている。</p>
</div>
<div class="section" id="external-scripts">
<h4>External scripts<a class="headerlink" href="#external-scripts" title="Permalink to this heading">¶</a></h4>
<p>今のところ、よそのウェブサイトのモジュールを
<code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">type=&quot;module&quot;</span> <span class="pre">src=&quot;xxxx&quot;&gt;</span></code> でロードするには、許可する設定が先方側でなされている必要があると覚えておく。</p>
</div>
<div class="section" id="no-bare-modules-allowed">
<h4>No “bare” modules allowed<a class="headerlink" href="#no-bare-modules-allowed" title="Permalink to this heading">¶</a></h4>
<p>ブラウザー環境では <code class="docutils literal notranslate"><span class="pre">import</span></code> 文の <code class="docutils literal notranslate"><span class="pre">from</span></code> モジュールスクリプトは相対パスか
URL でなければならない。</p>
</div>
<div class="section" id="compatibility-nomodule">
<h4>Compatibility, “nomodule”<a class="headerlink" href="#compatibility-nomodule" title="Permalink to this heading">¶</a></h4>
<p>古いブラウザーに対応したい場合にはこうする：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
    <span class="c1">// ...</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">nomodule</span><span class="p">&gt;</span>
    <span class="c1">// code for old browsers</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="build-tools">
<h3>Build tools<a class="headerlink" href="#build-tools" title="Permalink to this heading">¶</a></h3>
<p>ブラウザーモジュールを生で使用することはほとんどない。
Webpack などの特別な道具でまとめて、本番サーバーに配備する。</p>
<p>ビルドツールは次のようなことをする：</p>
<ol class="arabic simple">
<li><p>HTML の <code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">type=&quot;module&quot;&gt;</span></code> に置かれることを意図したメインモジュールを取る。</p></li>
<li><p>その依存関係を分析する。インポート、そしてインポートのインポート、等々。</p></li>
<li><p>すべてのモジュールから単一のファイルを構築し、元あった <code class="docutils literal notranslate"><span class="pre">import</span></code> 文をバンドラー関数で置き換え、それが動作するようにする。</p></li>
<li><p>その他、変換処理や最適化処理。</p></li>
</ol>
<p>バンドルツールを使うと、スクリプトが一つのファイルにまとめられるとき、それらのスクリプト内の <code class="docutils literal notranslate"><span class="pre">import</span></code>/<code class="docutils literal notranslate"><span class="pre">export</span></code> 文は、特別なバンドル関数に置き換えられる。その結果、まとめられたスクリプトは <code class="docutils literal notranslate"><span class="pre">import</span></code>/<code class="docutils literal notranslate"><span class="pre">export</span></code> を含まず、
<code class="docutils literal notranslate"><span class="pre">type=&quot;module&quot;</span></code> を必要としない通常のスクリプトに入れることができる。</p>
</div>
</div>
<div class="section" id="export-and-import">
<h2><a class="toc-backref" href="#id3">Export and Import</a><a class="headerlink" href="#export-and-import" title="Permalink to this heading">¶</a></h2>
<p>&lt;<a class="reference external" href="https://javascript.info/import-export">https://javascript.info/import-export</a>&gt; のノート。</p>
<div class="section" id="export-before-declarations">
<h3>Export before declarations<a class="headerlink" href="#export-before-declarations" title="Permalink to this heading">¶</a></h3>
<p>オブジェクト宣言の直前にキーワード <code class="docutils literal notranslate"><span class="pre">export</span></code> を置くのが基本的だろう。</p>
</div>
<div class="section" id="export-apart-from-declarations">
<h3>Export apart from declarations<a class="headerlink" href="#export-apart-from-declarations" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">export</span></code> はオブジェクトの宣言と個別に書いてもいい。個別に書く場合には、
<code class="docutils literal notranslate"><span class="pre">export</span></code> のあとに中括弧を書いて、その中にオブジェクトをカンマ区切りで列挙する。</p>
</div>
<div class="section" id="import">
<h3>Import <code class="docutils literal notranslate"><span class="pre">*</span></code><a class="headerlink" href="#import" title="Permalink to this heading">¶</a></h3>
<p>モジュールロードには <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span> <span class="pre">as</span> <span class="pre">XXX</span> <span class="pre">from</span> <span class="pre">YYY</span></code> という構文もある。
Python と違ってモジュール名がファイル名を同じでないので <code class="docutils literal notranslate"><span class="pre">as</span> <span class="pre">XXX</span></code> が必須となるのだろう。</p>
<p>利用するモジュール要素だけを明示的に指定して <code class="docutils literal notranslate"><span class="pre">import</span></code> するほうが望ましい。</p>
</div>
<div class="section" id="import-as">
<h3>Import “as”<a class="headerlink" href="#import-as" title="Permalink to this heading">¶</a></h3>
<p>ロードするモジュール要素に別の名前を付けるために <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">{XXX</span> <span class="pre">as</span> <span class="pre">YYY}</span> <span class="pre">from</span> <span class="pre">ZZZ</span></code>
という構文もある。</p>
</div>
<div class="section" id="export-as">
<h3>Export “as”<a class="headerlink" href="#export-as" title="Permalink to this heading">¶</a></h3>
<p>反対に、ロードさせるモジュール要素に別の名前を付けることもできる。
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">{XXX</span> <span class="pre">as</span> <span class="pre">YYY}</span></code> という構文もある。別の名前というより、公式名という扱いだ。</p>
</div>
<div class="section" id="export-default">
<h3>Export default<a class="headerlink" href="#export-default" title="Permalink to this heading">¶</a></h3>
<p>あるモジュールが単一のオブジェクトしか外部に見せないような造りだとする。こういう状況では特別な構文 <code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> を使うのがいい。</p>
<p>本文の例では、モジュール user.js が次のクラス宣言だけであるとする：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">User</span> <span class="p">{</span>
    <span class="c1">// class body</span>
<span class="p">}</span>
</pre></div>
</div>
<p>それを利用するモジュール main.js では、クラス <code class="docutils literal notranslate"><span class="pre">User</span></code> を利用するのに、次のように中括弧なしで単純に書けるようになる：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">User</span> <span class="nx">from</span> <span class="s1">&#39;./user.js&#39;</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>一つのモジュールに <code class="docutils literal notranslate"><span class="pre">default</span></code> と名前付きの <code class="docutils literal notranslate"><span class="pre">export</span></code> の両方を持つことができるが、それらを混在させないのが実践的だ。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> はファイルにつき一つまでなので、そのモジュール要素には名前がないかもしれない。</p></li>
</ul>
<div class="section" id="the-default-name">
<h4>The “default” name<a class="headerlink" href="#the-default-name" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">{XXX</span> <span class="pre">as</span> <span class="pre">default};</span></code> で、宣言と <code class="docutils literal notranslate"><span class="pre">export</span></code> を個別にする場合の
<code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> オブジェクトを指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">{default</span> <span class="pre">as</span> <span class="pre">XXX}</span> <span class="pre">from</span> <span class="pre">YYY;</span></code> はモジュールスクリプト <code class="docutils literal notranslate"><span class="pre">YYY</span></code> の
<code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> オブジェクトに別名 <code class="docutils literal notranslate"><span class="pre">XXX</span></code> で参照する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span> <span class="pre">as</span> <span class="pre">XXX</span> <span class="pre">from</span> <span class="pre">YYY;</span></code> 形式でロードするときの <code class="docutils literal notranslate"><span class="pre">YYY</span></code> の
<code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> オブジェクトを <code class="docutils literal notranslate"><span class="pre">XXX.default</span></code> で参照できる。</p></li>
</ul>
</div>
<div class="section" id="a-word-against-default-exports">
<h4>A word against default exports<a class="headerlink" href="#a-word-against-default-exports" title="Permalink to this heading">¶</a></h4>
<p>好きに名前を付けられると混乱するので、モジュールスクリプトの名前に対応したものにするのが普通だ。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">import</span> <span class="nx">User</span> <span class="nx">from</span> <span class="s1">&#39;./user.js&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">LoginForm</span> <span class="nx">from</span> <span class="s1">&#39;./loginForm.js&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">func</span> <span class="nx">from</span> <span class="s1">&#39;/path/to/func.js&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="re-export">
<h3>Re-export<a class="headerlink" href="#re-export" title="Permalink to this heading">¶</a></h3>
<p>あるモジュールから <code class="docutils literal notranslate"><span class="pre">import</span></code> したものを、別の名前に付け替えて <code class="docutils literal notranslate"><span class="pre">export</span></code> する構文がある。名前付き <code class="docutils literal notranslate"><span class="pre">export</span></code> と <code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> のどちらの形式も選べる：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">export</span> <span class="p">{</span><span class="nx">XXX</span><span class="p">}</span> <span class="nx">from</span> <span class="nx">YYY</span><span class="p">;</span>

<span class="kr">export</span> <span class="p">{</span><span class="k">default</span> <span class="nx">as</span> <span class="nx">XXX</span><span class="p">}</span> <span class="nx">from</span> <span class="nx">YYY</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>この構文はパッケージを編成するときに応用されるものらしい。</p></li>
<li><p>この特殊な <code class="docutils literal notranslate"><span class="pre">export</span></code> をしたモジュール自身は、この <code class="docutils literal notranslate"><span class="pre">XXX</span></code> をこの名前で参照できない。</p></li>
</ul>
<div class="section" id="re-exporting-the-default-export">
<h4>Re-exporting the default export<a class="headerlink" href="#re-exporting-the-default-export" title="Permalink to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> 要素を <code class="docutils literal notranslate"><span class="pre">export</span></code> し直すのには、変な手続きが要る。今、モジュールスクリプト <code class="docutils literal notranslate"><span class="pre">YYY</span></code> で <code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> されたオブジェクト <code class="docutils literal notranslate"><span class="pre">XXX</span></code>
があるとする。
<code class="docutils literal notranslate"><span class="pre">XXX</span></code> を <code class="docutils literal notranslate"><span class="pre">export</span></code> し直すには、次の二行を書く：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">export</span> <span class="o">*</span> <span class="nx">from</span> <span class="nx">YYY</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="k">default</span><span class="p">}</span> <span class="nx">from</span> <span class="nx">YYY</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dynamic-imports">
<h2><a class="toc-backref" href="#id4">Dynamic imports</a><a class="headerlink" href="#dynamic-imports" title="Permalink to this heading">¶</a></h2>
<p>&lt;<a class="reference external" href="https://javascript.info/modules-dynamic-imports">https://javascript.info/modules-dynamic-imports</a>&gt; のノート。</p>
<p>これまでの <code class="docutils literal notranslate"><span class="pre">import</span></code> は静的であると言う。モジュールパスは実行時評価されるような文字列であってはならない。</p>
<p>さらに、 <code class="docutils literal notranslate"><span class="pre">import</span></code> 文を <code class="docutils literal notranslate"><span class="pre">if</span></code> ブロックで囲んで、条件付きでロードするというようなことも許されない。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">import</span></code> を非同期関数呼び出しのように使うと動的インポート。</p></li>
<li><p>この方法はモジュールではないスクリプトに対しても適用できる。</p></li>
</ul>
<div class="section" id="the-import-expression">
<h3>The import() expression<a class="headerlink" href="#the-import-expression" title="Permalink to this heading">¶</a></h3>
<p>式 <code class="docutils literal notranslate"><span class="pre">import(module)</span></code> はモジュールをロードし、そのすべての <code class="docutils literal notranslate"><span class="pre">export</span></code> を含むモジュールオブジェクトに resolve される <code class="docutils literal notranslate"><span class="pre">Promise</span></code> を返す。この方式の
<code class="docutils literal notranslate"><span class="pre">import</span></code> はコード内の任意の場所から、動的に呼び出すことができる。</p>
<ul class="simple">
<li><p>モジュールでないスクリプトでも、この呼び出しができる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import()</span></code> は <code class="docutils literal notranslate"><span class="pre">super()</span></code> と似ていて、関数呼び出しではない。
<code class="docutils literal notranslate"><span class="pre">import</span></code> を変数にコピーしたり、 <code class="docutils literal notranslate"><span class="pre">call</span></code>/<code class="docutils literal notranslate"><span class="pre">apply</span></code> を使ったりすることはできない。</p></li>
</ul>
</div>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="12-generators-iterators.html" title="Previous document">Generators, advanced iteration</a>
        </li>
        <li>
          <a href="14-js-misc.html" title="Next document">Miscellaneous</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">読書ノート</a></h1>



<p class="blurb">個人的な読書、学習、研究ノート。</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../mathseminar72.html">数学 100 の発見 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gamma95/index.html">オブジェクト指向における再利用のためのデザインパターン改訂版 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hunt00/index.html">達人プログラマー 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sutter00.html">Exceptional C++ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../alexandrescu01/index.html">Modern C++ Design 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../meyers01.html">Effective STL 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sutter02.html">More Exceptional C++ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../joel04/index.html">Joel on Software 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../graham04.html">ハッカーと画家 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../angel05/index.html">OpenGL: A Primer Second Edition 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../yamamoto05/index.html">入門 xyzzy 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../newham05/index.html">入門 bash 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tsuboi05/index.html">幾何学 I 多様体入門 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../subramaniam06.html">アジャイルプラクティス 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../asaoka06.html">SE・製造技術者・理工系学生のための技術文書の作り方・書き方 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../levin06/index.html">Shaping Functions 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tsuboi08/index.html">幾何学 III 微分形式 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../loeliger09.html">実用 Git 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../griffiths10.html">プログラミング C# 第 6 版 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../onodera10.html">ORACLE MASTER Bronze 11g SQL 基礎 I 必修教本 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hosoda10/index.html">Python 入門［２＆３対応］読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nishiyama12/index.html">幾何学と不変量 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../omg15/index.html">Unified Modeling Language 2.5 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gorelick14.html">ハイパフォーマンス Python 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stroustrup14.html">C++ のエッセンス 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../stepanov15.html">その数式、プログラムできますか？ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../khronos15/index.html">WebGL Specification 1.0 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vivo15/index.html">The Book of Shaders 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../saha16.html">Python からはじめる数学入門 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../slatkin16.html">Effective Python 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guntheroth16.html">Optimized C++ 下読みノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../speinellis17.html">Effective Debugging 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bancila18.html">Modern C++ チャレンジ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../haverbeke18/index.html">Eloquent JavaScript 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../khronos18/index.html">OpenGL Shading Language 4.60 Specification 読書ノート</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">The Modern JavaScript Tutorial 読書ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../preliminary2014.html">ノート準備中書籍群 2014 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preliminary2015.html">ノート準備中書籍群 2015 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preliminary2016.html">ノート準備中書籍群 2016 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preliminary2017.html">ノート準備中書籍群 2017 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../preliminary2018.html">ノート準備中書籍群 2018 年編</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../bash-v2.html">What’s New In Bash 2 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bash-v3.html">What’s New In Bash 3 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bash-v4.html">What’s New In Bash 4 ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cpp11/index.html">What’s New In C++11 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp14/index.html">What’s New In C++14 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp17/index.html">What’s New In C++17 ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.0.html">What’s New In Python 3.0 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.1.html">What’s New In Python 3.1 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.2.html">What’s New In Python 3.2 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.3.html">What’s New In Python 3.3 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.4.html">What’s New In Python 3.4 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.5.html">What’s New In Python 3.5 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.6.html">What’s New In Python 3.6 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.7.html">What’s New In Python 3.7 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.8.html">What’s New In Python 3.8 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.9.html">What’s New In Python 3.9 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-3.10.html">What’s New In Python 3.10 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pip.html">pip 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pylint.html">Pylint 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-docutils/index.html">Docutils 解読ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-restview.html">Restview 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-nose.html">Nose 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-ipython.html">IPython 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-jupyter.html">Jupyter 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-numpy/index.html">NumPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-scipy/index.html">SciPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-sympy/index.html">SymPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-apgl.html">Another Python Graph Library (APGL) 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pil.html">PIL 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pillow.html">Pillow 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-matplotlib/index.html">Matplotlib 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-networkx/index.html">NetworkX 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-quaternion.html">Quaternion 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-jinja2.html">Jinja2 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pygments.html">Pygments 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-bs4.html">BeautifulSoup4 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-selenium.html">Selenium 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-scrapy.html">Scrapy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-twitter/index.html">Python Twitter Tools 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-isbn-hyphenate.html">isbn-hyphenate 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pyopengl/index.html">PyOpenGL 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pyqt4.html">PyQt4 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pyqt5.html">PyQt5 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pandas/index.html">Pandas 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pygame.html">Pygame 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-pytube.html">Pytube 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-py2exe.html">Py2exe 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-upgrade.html">Python 移行ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-miniconda.html">Miniconda 利用ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../freeware.html">Windows 用フリーウェア 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../winget.html">Windows Package Manager CLI 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../power-toys.html">Microsoft PowerToys 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cygwin.html">Cygwin 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../chrome.html">Chrome DevTools 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/index.html">Git 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../twitter.html">Twitter 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../inkscape/index.html">Inkscape 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mathjax.html">MathJax 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../javascript-mermaid/index.html">Mermaid 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../css-selector.html">CSS セレクター学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../xpath.html">XPath 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hxutils.html">HTML-XML-utils 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../webgl.html">WebGL 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pandoc.html">Pandoc 利用ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../milestone09/index.html">ラジルギノア プレイノート</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">The Modern JavaScript Tutorial 読書ノート</a><ul>
  <li><a href="index.html">Part 1 The JavaScript language</a><ul>
      <li>Previous: <a href="12-generators-iterators.html" title="previous chapter">Generators, advanced iteration</a></li>
      <li>Next: <a href="14-js-misc.html" title="next chapter">Miscellaneous</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../../_static/logos.png"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2022, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>