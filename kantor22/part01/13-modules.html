<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modules &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=c9b0a06a" />
    <script src="../../_static/documentation_options.js?v=4354bf25"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Miscellaneous" href="14-js-misc.html" />
    <link rel="prev" title="Generators, advanced iteration" href="12-generators-iterators.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="12-generators-iterators.html" title="Previous">Generators, advanced iteration</a>
        </li>
      
        <li>
          &uarr;
          <a href="../index.html" title="Parent">The Modern JavaScript Tutorial 読書ノート</a>
        </li>
        <li>
          &uarr;
          <a href="index.html" title="Parent">Part 1 The JavaScript language</a>
        </li>
        <li>
          <a href="14-js-misc.html" title="Next">Miscellaneous</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="modules">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">Modules</a><a class="headerlink" href="#modules" title="Link to this heading">¶</a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#modules" id="id1">Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#modules-introduction" id="id2">Modules, introduction</a></p></li>
<li><p><a class="reference internal" href="#export-and-import" id="id3">Export and Import</a></p></li>
<li><p><a class="reference internal" href="#dynamic-imports" id="id4">Dynamic imports</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="modules-introduction">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Modules, introduction</a><a class="headerlink" href="#modules-introduction" title="Link to this heading">¶</a></h2>
<p>&lt;<a class="reference external" href="https://javascript.info/modules-intro">https://javascript.info/modules-intro</a>&gt; のノート。</p>
<p>JavaScript は長い間モジュールのサポートがなかったが、2015 年に標準仕様に現れる。今ではすべての主要なブラウザーと Node.js でサポートされている。</p>
<section id="what-is-a-module">
<h3>What is a module?<a class="headerlink" href="#what-is-a-module" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>モジュールは単なるファイルだ。</p></li>
<li><p>モジュールは互いにロードすることができ、<code class="docutils literal notranslate"><span class="pre">export</span></code> と <code class="docutils literal notranslate"><span class="pre">import</span></code> を使ってモジュール構成要素を交換する。例えば、あるモジュールの関数を別のモジュールから呼び出すことができる。</p></li>
</ul>
<p>モジュールファイルで <code class="docutils literal notranslate"><span class="pre">export</span></code> をオブジェクト宣言の前に置くと、外側からそれをロードできる。</p>
<p><code class="docutils literal notranslate"><span class="pre">import</span></code> でロードすることができる。ロードしたいオブジェクトとモジュールファイルパスを指定する：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="nx">sayHi</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./sayHi.js&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>モジュールは特別なキーワードや機能をサポートしているので、スクリプトの
<code class="docutils literal notranslate"><span class="pre">type=&quot;module&quot;</span></code> という属性を使って、モジュールとして扱われることを宣言する必要がある。</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
<span class="w">    </span><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="nx">sayHi</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./say.js&#39;</span><span class="p">;</span>

<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">sayHi</span><span class="p">(</span><span class="s1">&#39;John&#39;</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">file://</span></code> プロトコルでは <code class="docutils literal notranslate"><span class="pre">import</span></code>/<code class="docutils literal notranslate"><span class="pre">export</span></code> は機能しない。</p>
</section>
<section id="core-module-features">
<h3>Core module features<a class="headerlink" href="#core-module-features" title="Link to this heading">¶</a></h3>
<p>モジュールのコードと今までのスクリプトのコードとの違いを見ていく。</p>
<section id="always-use-strict">
<h4>Always “use strict”<a class="headerlink" href="#always-use-strict" title="Link to this heading">¶</a></h4>
<p>モジュールは自動的に “use strict” モードになる。この文言を明示的に書かなくて済む。</p>
</section>
<section id="module-level-scope">
<h4>Module-level scope<a class="headerlink" href="#module-level-scope" title="Link to this heading">¶</a></h4>
<p>各モジュールは固有のスコープを有する。</p>
</section>
<section id="a-module-code-is-evaluated-only-the-first-time-when-imported">
<h4>A module code is evaluated only the first time when imported<a class="headerlink" href="#a-module-code-is-evaluated-only-the-first-time-when-imported" title="Link to this heading">¶</a></h4>
<p>同じモジュールが他の複数のモジュールにロードされる場合、そのコードは最初のロード時にしか実行されない。</p>
<p>トップレベルのモジュールコードは、初期化、モジュール固有の内部データ構造の作成に用いるべきだ。何度でも呼び出すような用途のものは、関数として <code class="docutils literal notranslate"><span class="pre">export</span></code> する必要がある。</p>
<p>この一度きりの評価という性質を利用して、モジュールを構成することができる。</p>
</section>
<section id="import-meta">
<h4><code class="docutils literal notranslate"><span class="pre">import.meta</span></code><a class="headerlink" href="#import-meta" title="Link to this heading">¶</a></h4>
<p>オブジェクト <code class="docutils literal notranslate"><span class="pre">import.meta</span></code> は現在のモジュールの情報を含む。</p>
</section>
<section id="in-a-module-this-is-undefined">
<h4>In a module, <code class="docutils literal notranslate"><span class="pre">this</span></code> is undefined<a class="headerlink" href="#in-a-module-this-is-undefined" title="Link to this heading">¶</a></h4>
<p>モジュールスコープでは <code class="docutils literal notranslate"><span class="pre">this</span></code> が存在しない。</p>
</section>
</section>
<section id="browser-specific-features">
<h3>Browser-specific features<a class="headerlink" href="#browser-specific-features" title="Link to this heading">¶</a></h3>
<div class="admonition- admonition">
<p class="admonition-title">学習者ノート</p>
<p>ブラウザーが HTML を解析するときに <code class="docutils literal notranslate"><span class="pre">SCRIPT</span></code> タグを見つけると、DOM の構築をそこで中断する。そのタグを実行してから構築を再開する。これが DOM 生成の基本だ。</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">defer</span></code></dt><dd><p>そこで中断する代わりにスクリプトのロードをバックグランドで行い、かつDOM
の構築を続行する。DOM の準備ができたらスクリプトが実行する。複数の
<code class="docutils literal notranslate"><span class="pre">defer</span></code> スクリプトがある場合、それらの順序は考慮される。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">async</span></code></dt><dd><p>他のスクリプトのロードを待たないし、他のスクリプトも <code class="docutils literal notranslate"><span class="pre">async</span></code> スクリプトを待たない。イベント <code class="docutils literal notranslate"><span class="pre">DOMContentLoaded</span></code> さえ <code class="docutils literal notranslate"><span class="pre">async</span></code> スクリプトの完了を待たない。つまり、ページのロード完了前に実行される。</p>
</dd>
</dl>
<p>どちらの属性も、<code class="docutils literal notranslate"><span class="pre">src</span></code> のない（つまり外部ファイルではない）スクリプトには効かない。</p>
<p>以上を踏まえて、モジュールスクリプトは <code class="docutils literal notranslate"><span class="pre">defer</span></code> が与えられていないものでも
<code class="docutils literal notranslate"><span class="pre">defer</span></code> が適用される。HTML ファイルに直接書かれているスクリプトでもだ。ユーザーはモジュールスクリプトが実行される前のページを一瞬見ることになる可能性が高い。</p>
<p><code class="docutils literal notranslate"><span class="pre">async</span></code> モジュールの場合はやはり独立性があり、他を待たない。</p>
</div>
<section id="module-scripts-are-deferred">
<h4>Module scripts are deferred<a class="headerlink" href="#module-scripts-are-deferred" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">type=&quot;module&quot;</span> <span class="pre">src=&quot;...&quot;&gt;</span></code> は HTML 処理を妨げない。</p></li>
<li><p>モジュールスクリプトは HTML 文書の準備が完全に整うまで待機し、それから実行される。</p></li>
<li><p>スクリプトの相対的な順序は維持される。ドキュメント内で最初に現れるスクリプトが最初に実行される。</p></li>
</ul>
<p>言い換えると、モジュールスクリプトは完全にロードされた HTML ページを常に扱うということだ。</p>
<p>モジュールを使うときに注意しなければならないのは、HTML ページは読み込まれると同時に表示され、JavaScript モジュールはその後に実行されるので、閲覧者がJavaScript
アプリケーションの準備ができる前にページを見るかもしれないことだ。まだ動作しない機能がある可能性がある。</p>
</section>
<section id="async-works-on-inline-scripts">
<h4>Async works on inline scripts<a class="headerlink" href="#async-works-on-inline-scripts" title="Link to this heading">¶</a></h4>
<p>モジュール以外のスクリプトでは <code class="docutils literal notranslate"><span class="pre">async</span></code> 属性は外部スクリプトにのみ作用する。非同期スクリプトは、他のスクリプトや HTML ページとは無関係に、準備ができると直ちに実行される。</p>
<p>モジュールスクリプトの場合は、インラインスクリプトでも機能する。</p>
<p>カウンターや広告、ドキュメントレベルのイベントリスナーなど、ページ固有の要素に依存しない機能に向いている。</p>
</section>
<section id="external-scripts">
<h4>External scripts<a class="headerlink" href="#external-scripts" title="Link to this heading">¶</a></h4>
<p>今のところ、よそのウェブサイトのモジュールを <code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">type=&quot;module&quot;</span> <span class="pre">src=&quot;xxxx&quot;&gt;</span></code>
でロードするには、許可する設定が先方側でなされている必要があると覚えておく。</p>
</section>
<section id="no-bare-modules-allowed">
<h4>No “bare” modules allowed<a class="headerlink" href="#no-bare-modules-allowed" title="Link to this heading">¶</a></h4>
<p>ブラウザー環境では <code class="docutils literal notranslate"><span class="pre">import</span></code> 文の <code class="docutils literal notranslate"><span class="pre">from</span></code> モジュールスクリプトは相対パスか URL
でなければならない。</p>
</section>
<section id="compatibility-nomodule">
<h4>Compatibility, <code class="docutils literal notranslate"><span class="pre">nomodule</span></code><a class="headerlink" href="#compatibility-nomodule" title="Link to this heading">¶</a></h4>
<p>古いブラウザーに対応したい場合にはこうする：</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;module&quot;</span><span class="p">&gt;</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">nomodule</span><span class="p">&gt;</span>
<span class="w">    </span><span class="c1">// code for old browsers</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="build-tools">
<h3>Build tools<a class="headerlink" href="#build-tools" title="Link to this heading">¶</a></h3>
<p>ブラウザーモジュールを生で使用することはほとんどない。Webpack などの特別な道具でまとめて、本番サーバーに配備する。</p>
<p>ビルドツールは次のようなことをする：</p>
<ol class="arabic simple">
<li><p>HTML の <code class="docutils literal notranslate"><span class="pre">&lt;script</span> <span class="pre">type=&quot;module&quot;&gt;</span></code> に置かれることを意図したメインモジュールを取る。</p></li>
<li><p>その依存関係を分析する。インポート、そしてインポートのインポート、等々。</p></li>
<li><p>すべてのモジュールから単一のファイルを構築し、元あった <code class="docutils literal notranslate"><span class="pre">import</span></code> 文をバンドラー関数で置き換え、それが動作するようにする。</p></li>
<li><p>その他、変換処理や最適化処理。</p></li>
</ol>
<p>バンドルツールを使うと、スクリプトが一つのファイルにまとめられるとき、それらのスクリプト内の <code class="docutils literal notranslate"><span class="pre">import</span></code>/<code class="docutils literal notranslate"><span class="pre">export</span></code> 文は、特別なバンドル関数に置き換えられる。その結果、まとめられたスクリプトは <code class="docutils literal notranslate"><span class="pre">import</span></code>/<code class="docutils literal notranslate"><span class="pre">export</span></code> を含まず、
<code class="docutils literal notranslate"><span class="pre">type=&quot;module&quot;</span></code> を必要としない通常のスクリプトに入れることができる。</p>
</section>
</section>
<section id="export-and-import">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Export and Import</a><a class="headerlink" href="#export-and-import" title="Link to this heading">¶</a></h2>
<p>&lt;<a class="reference external" href="https://javascript.info/import-export">https://javascript.info/import-export</a>&gt; のノート。</p>
<section id="export-before-declarations">
<h3>Export before declarations<a class="headerlink" href="#export-before-declarations" title="Link to this heading">¶</a></h3>
<p>オブジェクト宣言の直前にキーワード <code class="docutils literal notranslate"><span class="pre">export</span></code> を置くのが基本的だろう。</p>
</section>
<section id="export-apart-from-declarations">
<h3>Export apart from declarations<a class="headerlink" href="#export-apart-from-declarations" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">export</span></code> はオブジェクトの宣言と個別に書いてもいい。個別に書く場合には、
<code class="docutils literal notranslate"><span class="pre">export</span></code> のあとに中括弧を書いて、その中にオブジェクトをカンマ区切りで列挙する。</p>
</section>
<section id="import">
<h3><code class="docutils literal notranslate"><span class="pre">Import</span> <span class="pre">*</span></code><a class="headerlink" href="#import" title="Link to this heading">¶</a></h3>
<p>モジュールロードには <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span> <span class="pre">as</span> <span class="pre">XXX</span> <span class="pre">from</span> <span class="pre">YYY</span></code> という構文もある。
Python と違ってモジュール名がファイル名を同じでないので <code class="docutils literal notranslate"><span class="pre">as</span> <span class="pre">XXX</span></code> が必須となるのだろう。</p>
<p>利用するモジュール要素だけを明示的に指定して <code class="docutils literal notranslate"><span class="pre">import</span></code> するほうが望ましい。</p>
</section>
<section id="import-as">
<h3><code class="docutils literal notranslate"><span class="pre">Import</span> <span class="pre">as</span></code><a class="headerlink" href="#import-as" title="Link to this heading">¶</a></h3>
<p>ロードするモジュール要素に別の名前を付けるために <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">{XXX</span> <span class="pre">as</span> <span class="pre">YYY}</span> <span class="pre">from</span> <span class="pre">ZZZ</span></code>
という構文もある。</p>
</section>
<section id="export-as">
<h3><code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">as</span></code><a class="headerlink" href="#export-as" title="Link to this heading">¶</a></h3>
<p>反対に、ロードさせるモジュール要素に別の名前を付けることもできる。
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">{XXX</span> <span class="pre">as</span> <span class="pre">YYY}</span></code> という構文もある。別の名前というより、公式名という扱いだ。</p>
</section>
<section id="export-default">
<h3>Export default<a class="headerlink" href="#export-default" title="Link to this heading">¶</a></h3>
<p>あるモジュールが単一のオブジェクトしか外部に見せないような造りだとする。こういう状況では特別な構文 <code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> を使うのがいい。</p>
<p>本文の例では、モジュール <code class="file docutils literal notranslate"><span class="pre">user.js</span></code> が次のクラス宣言だけであるとする：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nx">User</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// class body</span>
<span class="p">}</span>
</pre></div>
</div>
<p>それを利用するモジュール <code class="file docutils literal notranslate"><span class="pre">main.js</span></code> では、クラス <code class="docutils literal notranslate"><span class="pre">User</span></code> を利用するのに、次のように中括弧なしで単純に書けるようになる：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">User</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./user.js&#39;</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>一つのモジュールに <code class="docutils literal notranslate"><span class="pre">default</span></code> と名前付きの <code class="docutils literal notranslate"><span class="pre">export</span></code> の両方を持つことができるが、それらを混在させないのが実践的だ。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> はファイルにつき一つまでなので、そのモジュール要素には名前がないかもしれない。</p></li>
</ul>
<section id="the-default-name">
<h4>The <code class="docutils literal notranslate"><span class="pre">default</span></code> name<a class="headerlink" href="#the-default-name" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">{XXX</span> <span class="pre">as</span> <span class="pre">default};</span></code> で、宣言と <code class="docutils literal notranslate"><span class="pre">export</span></code> を個別にする場合の
<code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> オブジェクトを指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">{default</span> <span class="pre">as</span> <span class="pre">XXX}</span> <span class="pre">from</span> <span class="pre">YYY;</span></code> はモジュールスクリプト <code class="docutils literal notranslate"><span class="pre">YYY</span></code> の
<code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> オブジェクトに別名 <code class="docutils literal notranslate"><span class="pre">XXX</span></code> で参照する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span> <span class="pre">as</span> <span class="pre">XXX</span> <span class="pre">from</span> <span class="pre">YYY;</span></code> 形式でロードするときの <code class="docutils literal notranslate"><span class="pre">YYY</span></code> の
<code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> オブジェクトを <code class="docutils literal notranslate"><span class="pre">XXX.default</span></code> で参照できる。</p></li>
</ul>
</section>
<section id="a-word-against-default-exports">
<h4>A word against default exports<a class="headerlink" href="#a-word-against-default-exports" title="Link to this heading">¶</a></h4>
<p>好きに名前を付けられると混乱するので、モジュールスクリプトの名前に対応したものにするのが普通だ。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">import</span><span class="w"> </span><span class="nx">User</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./user.js&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">LoginForm</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;./loginForm.js&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="nx">func</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;/path/to/func.js&#39;</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>
<section id="re-export">
<h3>Re-export<a class="headerlink" href="#re-export" title="Link to this heading">¶</a></h3>
<p>あるモジュールから <code class="docutils literal notranslate"><span class="pre">import</span></code> したものを、別の名前に付け替えて <code class="docutils literal notranslate"><span class="pre">export</span></code> する構文がある。名前付き <code class="docutils literal notranslate"><span class="pre">export</span></code> と <code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> のどちらの形式も選べる：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="nx">XXX</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="nx">YYY</span><span class="p">;</span>

<span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="k">default</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">XXX</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="nx">YYY</span><span class="p">;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>この構文はパッケージを編成するときに応用されるものらしい。</p></li>
<li><p>この特殊な <code class="docutils literal notranslate"><span class="pre">export</span></code> をしたモジュール自身は、この <code class="docutils literal notranslate"><span class="pre">XXX</span></code> をこの名前で参照できない。</p></li>
</ul>
<section id="re-exporting-the-default-export">
<h4>Re-exporting the default export<a class="headerlink" href="#re-exporting-the-default-export" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> 要素を <code class="docutils literal notranslate"><span class="pre">export</span></code> し直すのには、変な手続きが要る。今、モジュールスクリプト <code class="docutils literal notranslate"><span class="pre">YYY</span></code> で <code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">export</span></code> されたオブジェクト <code class="docutils literal notranslate"><span class="pre">XXX``があ</span>
<span class="pre">るとする。``XXX</span></code> を <code class="docutils literal notranslate"><span class="pre">export</span></code> し直すには、次の二行を書く：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">export</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="nx">YYY</span><span class="p">;</span>
<span class="k">export</span><span class="w"> </span><span class="p">{</span><span class="k">default</span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="nx">YYY</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="dynamic-imports">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Dynamic imports</a><a class="headerlink" href="#dynamic-imports" title="Link to this heading">¶</a></h2>
<p>&lt;<a class="reference external" href="https://javascript.info/modules-dynamic-imports">https://javascript.info/modules-dynamic-imports</a>&gt; のノート。</p>
<p>これまでの <code class="docutils literal notranslate"><span class="pre">import</span></code> は静的であると言う。モジュールパスは実行時評価されるような文字列であってはならない。</p>
<p>さらに、<code class="docutils literal notranslate"><span class="pre">import</span></code> 文を <code class="docutils literal notranslate"><span class="pre">if</span></code> ブロックで囲んで、条件付きでロードするというようなことも許されない。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">import</span></code> を非同期関数呼び出しのように使うと動的インポート。</p></li>
<li><p>この方法はモジュールではないスクリプトに対しても適用できる。</p></li>
</ul>
<section id="the-import-expression">
<h3>The <code class="docutils literal notranslate"><span class="pre">import()</span></code> expression<a class="headerlink" href="#the-import-expression" title="Link to this heading">¶</a></h3>
<p>式 <code class="docutils literal notranslate"><span class="pre">import(module)</span></code> はモジュールをロードし、そのすべての <code class="docutils literal notranslate"><span class="pre">export</span></code> を含むモジュールオブジェクトに resolve される <code class="docutils literal notranslate"><span class="pre">Promise</span></code> を返す。この方式の <code class="docutils literal notranslate"><span class="pre">import</span></code>
はコード内の任意の場所から、動的に呼び出すことができる。</p>
<ul class="simple">
<li><p>モジュールでないスクリプトでも、この呼び出しができる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">import()</span></code> は <code class="docutils literal notranslate"><span class="pre">super()</span></code> と似ていて、関数呼び出しではない。<code class="docutils literal notranslate"><span class="pre">import</span></code> を変数にコピーしたり、<code class="docutils literal notranslate"><span class="pre">call</span></code>/<code class="docutils literal notranslate"><span class="pre">apply</span></code> を使ったりすることはできない。</p></li>
</ul>
</section>
</section>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="12-generators-iterators.html" title="Previous">Generators, advanced iteration</a>
        </li>
      
        <li>
          &uarr;
          <a href="../index.html" title="Parent">The Modern JavaScript Tutorial 読書ノート</a>
        </li>
        <li>
          &uarr;
          <a href="index.html" title="Parent">Part 1 The JavaScript language</a>
        </li>
        <li>
          <a href="14-js-misc.html" title="Next">Miscellaneous</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="../../index.html" title="読書ノート Home"><img src="../../_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>