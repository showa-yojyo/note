
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>OpenGL: A Primer Second Edition 読書ノート 3/4 &#8212; 読書ノート v1.5dev</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/prefab.css" />
    
    <script src="../_static/mathjax-v3.js"></script>
    
    <link rel="next" title="OpenGL: A Primer Second Edition 読書ノート 4/4" href="note4.html" />
    <link rel="prev" title="OpenGL: A Primer Second Edition 読書ノート 2/4" href="note2.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="note4.html" title="OpenGL: A Primer Second Edition 読書ノート 4/4"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="note2.html" title="OpenGL: A Primer Second Edition 読書ノート 2/4"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">OpenGL: A Primer Second Edition 読書ノート</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">OpenGL: A Primer Second Edition 読書ノート 3/4</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="opengl-a-primer-second-edition-3-4">
<h1><a class="toc-backref" href="#id2">OpenGL: A Primer Second Edition 読書ノート 3/4</a><a class="headerlink" href="#opengl-a-primer-second-edition-3-4" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">著者</dt>
<dd class="field-odd"><p>Edward Angel</p>
</dd>
<dt class="field-even">出版社</dt>
<dd class="field-even"><p>Addison Wesley</p>
</dd>
<dt class="field-odd">発行年</dt>
<dd class="field-odd"><p>2004 年</p>
</dd>
<dt class="field-even">ISBN</dt>
<dd class="field-even"><p>978-0-321-23762-0</p>
</dd>
</dl>
<div class="contents topic" id="id1">
<p class="topic-title">ノート目次</p>
<ul class="simple">
<li><p><a class="reference internal" href="#opengl-a-primer-second-edition-3-4" id="id2">OpenGL: A Primer Second Edition 読書ノート 3/4</a></p>
<ul>
<li><p><a class="reference internal" href="#lights-and-matrials" id="id3">Lights and Matrials</a></p>
<ul>
<li><p><a class="reference internal" href="#light-material-interatctions" id="id4">Light-Material Interatctions</a></p></li>
<li><p><a class="reference internal" href="#the-phong-model" id="id5">The Phong Model</a></p>
<ul>
<li><p><a class="reference internal" href="#diffuse-reflection" id="id6">Diffuse Reflection</a></p></li>
<li><p><a class="reference internal" href="#specular-reflection" id="id7">Specular Reflection</a></p></li>
<li><p><a class="reference internal" href="#ambient-reflection" id="id8">Ambient Reflection</a></p></li>
<li><p><a class="reference internal" href="#emission" id="id9">Emission</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#opengl-lighting" id="id10">OpenGL Lighting</a></p></li>
<li><p><a class="reference internal" href="#specifying-light-sources" id="id11">Specifying Light Sources</a></p>
<ul>
<li><p><a class="reference internal" href="#light-sources-and-transformations" id="id12">Light Sources and Transformations</a></p></li>
<li><p><a class="reference internal" href="#specifying-a-material" id="id13">Specifying a Material</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#shading-the-rotating-cube" id="id14">Shading the Rotating Cube</a></p></li>
<li><p><a class="reference internal" href="#controlling-the-shading-calculation" id="id15">Controlling the Shading Calculation</a></p></li>
<li><p><a class="reference internal" href="#smooth-shading" id="id16">Smooth Shading</a></p></li>
<li><p><a class="reference internal" href="#working-with-normals" id="id17">Working with Normals</a></p></li>
<li><p><a class="reference internal" href="#transparancy" id="id18">Transparancy</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#images" id="id19">Images</a></p>
<ul>
<li><p><a class="reference internal" href="#pixels-and-bitmaps" id="id20">Pixels and Bitmaps</a></p></li>
<li><p><a class="reference internal" href="#bitmaps" id="id21">Bitmaps</a></p>
<ul>
<li><p><a class="reference internal" href="#displaying-a-bitmap" id="id22">Displaying a Bitmap</a></p></li>
<li><p><a class="reference internal" href="#mixing-bitmaps-and-geometry" id="id23">Mixing Bitmaps and Geometry</a></p></li>
<li><p><a class="reference internal" href="#colors-and-masks" id="id24">Colors and Masks</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#drawing-modes" id="id25">Drawing Modes</a></p></li>
<li><p><a class="reference internal" href="#reading-and-writing-pixels" id="id26">Reading and Writing Pixels</a></p>
<ul>
<li><p><a class="reference internal" href="#writing-pixels" id="id27">Writing Pixels</a></p></li>
<li><p><a class="reference internal" href="#reading-pixels" id="id28">Reading Pixels</a></p></li>
<li><p><a class="reference internal" href="#copying-pixels" id="id29">Copying Pixels</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#selecting-buffers" id="id30">Selecting Buffers</a></p></li>
<li><p><a class="reference internal" href="#pixel-store-modes" id="id31">Pixel Store Modes</a></p></li>
<li><p><a class="reference internal" href="#displaying-a-ppm-image" id="id32">Displaying a PPM Image</a></p></li>
<li><p><a class="reference internal" href="#using-luminace" id="id33">Using Luminace</a></p></li>
<li><p><a class="reference internal" href="#pixel-mapping" id="id34">Pixel Mapping</a></p></li>
<li><p><a class="reference internal" href="#pixel-zoom" id="id35">Pixel Zoom</a></p></li>
<li><p><a class="reference internal" href="#image-processing-in-opengl" id="id36">Image Processing in OpenGL</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="lights-and-matrials">
<h2><a class="toc-backref" href="#id3">Lights and Matrials</a><a class="headerlink" href="#lights-and-matrials" title="Permalink to this headline">¶</a></h2>
<section id="light-material-interatctions">
<h3><a class="toc-backref" href="#id4">Light-Material Interatctions</a><a class="headerlink" href="#light-material-interatctions" title="Permalink to this headline">¶</a></h3>
<dl>
<dt>色の説明</dt><dd><p>&lt;The colors that we see in the real world are based on the
interaction between light coming from light sources and
the materials of which the objects are made&gt; (p. 123)</p>
</dd>
<dt>影の説明</dt><dd><p>&lt;These shadows are determined by light-material interactions&gt;
(p. 123)</p>
<p>&lt;Such a calculation is beyond the capabilities of real-time
rendering&gt; (p. 123)</p>
<p>&lt;Thus in OpenGL, shading must be done locally on a vertex-by-vertex
basis&gt; (p. 123)</p>
<p>&lt;we can do a fairly good job of shading on a vertex-by-vertex
basis&gt; (p. 123)</p>
</dd>
</dl>
</section>
<section id="the-phong-model">
<h3><a class="toc-backref" href="#id5">The Phong Model</a><a class="headerlink" href="#the-phong-model" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>OpenGL では modifed Phong モデルをシェーディング計算に採用している。</p></li>
<li><p>ある曲面をシェーディングしたいとする。このとき、曲面上の点 P に対して、次の四つのベクトルを導入する。</p>
<dl class="field-list">
<dt class="field-odd">L</dt>
<dd class="field-odd"><p>The direction to the light source from P.</p>
</dd>
<dt class="field-even">V</dt>
<dd class="field-even"><p>The viewer is located in the direction V from P.</p>
</dd>
<dt class="field-odd">N</dt>
<dd class="field-odd"><p>The normal vector at P.
局所的な曲面の向きという捉え方。</p>
</dd>
<dt class="field-even">R</dt>
<dd class="field-even"><p>perfect reflector;
&lt;If the surface is highly refective, it will act like a
mirror and most of the light will go off in the direction of
a perfect reflector R&gt; (p. 125)</p>
<p>&lt;The vector R can be computed from N and L&gt; (p. 125)</p>
</dd>
</dl>
</li>
<li><p>Phong モデルは P のシェーディングには、以下の四種類のものが寄与 (contributions) していると考える：</p>
<ul class="simple">
<li><p><strong>diffuse reflections</strong></p></li>
<li><p><strong>specular reflections</strong></p></li>
<li><p><strong>ambient reflections</strong></p></li>
<li><p><strong>emissive light</strong></p></li>
</ul>
</li>
</ul>
<section id="diffuse-reflection">
<h4><a class="toc-backref" href="#id6">Diffuse Reflection</a><a class="headerlink" href="#diffuse-reflection" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>曲面に照りつける光は、一部は材質により吸収され、一部は散乱する。この散乱は等方向に発生するので、diffuse の計算は V に依存しない。</p></li>
<li><p>&lt;Diffuse surfaces tend to look dull like plastic&gt; (p. 125)</p></li>
</ul>
</section>
<section id="specular-reflection">
<h4><a class="toc-backref" href="#id7">Specular Reflection</a><a class="headerlink" href="#specular-reflection" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>specular = 鏡のように反射する。</p></li>
<li><p>&lt;a specular surface is smooth and the reflected light is
concentrated along the direction R&gt; (p. 126)</p></li>
<li><p>&lt;The Phong model characterizes this concentration with
a <strong>shininess coefficient</strong>&gt; (p. 126)</p></li>
<li><p>光沢のある材質が specular な曲面なのだ。
&lt;Specular surfaces include polished materials, such as metals&gt;
(p. 126)</p></li>
<li><p>OpenGL では R を L + V で代用して計算に用いる。</p></li>
</ul>
</section>
<section id="ambient-reflection">
<h4><a class="toc-backref" href="#id8">Ambient Reflection</a><a class="headerlink" href="#ambient-reflection" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>環境反射に関しては、これだけ憶えておけばいいか。
&lt;the light that we see does not depend on any of the four vectors,
only on the incoming light and the fraction that is reflected&gt;
(p. 126)</p></li>
</ul>
</section>
<section id="emission">
<h4><a class="toc-backref" href="#id9">Emission</a><a class="headerlink" href="#emission" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>物体が発光するケースもサポート。
&lt;we can add on an emissive term that is not affected by
incoming light and can help model visible light sources
or glowing objects&gt; (p.126)</p></li>
</ul>
</section>
</section>
<section id="opengl-lighting">
<h3><a class="toc-backref" href="#id10">OpenGL Lighting</a><a class="headerlink" href="#opengl-lighting" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>OpenGL は三種類の光源があることをおさえる。
&lt;In OpenGL, we can have point sources, spotlights, and ambient sources&gt;
(p. 127)</p></li>
<li><p>光源は材質と共通するある性質を有している。
&lt;For each source there are separate diffuse, specular, and ambient
RGB parameters&gt; (p. 127)</p></li>
<li><p>光源をオンにすることを忘れないこと。
&lt;Enabling lighting asks OpenGL to do the shading calculations&gt; (p 127)</p></li>
<li><p>一旦カラーのことを忘れよう。
&lt;Once lighting is enabled, colors assigned by <code class="docutils literal notranslate"><span class="pre">glColor*()</span></code> are no longer used&gt;
(p. 127)</p></li>
<li><p>照光処理では、法線ベクトルの質が死活的に重要となる。
&lt;the user generally must supply the normal vectors through <code class="docutils literal notranslate"><span class="pre">glNormal*()</span></code>&gt;
(p. 127)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glNormal3(dx,</span> <span class="pre">dy,</span> <span class="pre">dz)</span></code></p>
<p><span class="math notranslate nohighlight">\((dx, dy, dz)\)</span>: 法線ベクトルの各成分。</p>
</li>
</ul>
</section>
<section id="specifying-light-sources">
<h3><a class="toc-backref" href="#id11">Specifying Light Sources</a><a class="headerlink" href="#specifying-light-sources" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">glLight</span></code> に関する説明に紙幅を割いているが、ポイントは前半部に集中。</p></li>
<li><p>&lt;The defaults are slightly different for light 0 and all the other sources&gt;
(p. 128)</p></li>
<li><p>ライト 0 は白色なのだが、その他は黒となっている。
&lt;The default value of the position is <span class="math notranslate nohighlight">\((0.0, 0.0, 1.0, 0.0)\)</span>.  This value is
in eye coordinates, so it is  behind the default camera&gt; (p. 128)</p></li>
<li><p>z 軸の正の方向に無限の距離だけ離れたところが初期値。
&lt;w component indicates that the source is at infinity because :math`w = 0`
indicates it is the representation of direction rather than of a point&gt;
(p. 128)</p></li>
<li><p>スポットライトのカットオフ角の初期値は 180 度だ。</p></li>
<li><p>光の減衰を指定するパラメータ (<code class="docutils literal notranslate"><span class="pre">GL_xxx_ATTENUATION</span></code>) があるが、デフォルトが減衰なしであることを憶えておけば、今はいい。</p></li>
</ul>
<section id="light-sources-and-transformations">
<h4><a class="toc-backref" href="#id12">Light Sources and Transformations</a><a class="headerlink" href="#light-sources-and-transformations" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">glLight</span></code> で指定する光源の位置と向きは、モデルビュー変換の影響を受ける。</p></li>
</ul>
</section>
<section id="specifying-a-material">
<h4><a class="toc-backref" href="#id13">Specifying a Material</a><a class="headerlink" href="#specifying-a-material" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p>&lt;Material properties match the lighting properties.  A material has
reflectively properties for each type of light&gt; (p. 131)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glMaterial(face,</span> <span class="pre">name,</span> <span class="pre">value)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">face</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">GL_FRONT</span></code>, <code class="docutils literal notranslate"><span class="pre">GL_BACK</span></code>, <code class="docutils literal notranslate"><span class="pre">GL_FRONT_AND_BACK</span></code></p>
</dd>
<dt class="field-even">name</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">GL_AMBIENT</span></code> 等</p>
</dd>
</dl>
<p>&lt;Often the ambient and diffuce properties are the same and can be
set together using <code class="docutils literal notranslate"><span class="pre">GL_AMBIENT_AND_DIFFUSE</span></code>&gt; (p. 132)</p>
</li>
<li><p>材質のアルファ値は、その材質の透明感をシミュレートする用途で使うことができる。</p></li>
<li><p>余力があれば、材質のデフォルト値を憶えておく。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GL_SHININESS</span></code> については、
&lt;The higher the value of this parameter, the shinier the material appears
as the specular highlights are concentrated in a small area near the
angle of a perfect reflection&gt; (p. 132)
とのこと。</p></li>
</ul>
</section>
</section>
<section id="shading-the-rotating-cube">
<h3><a class="toc-backref" href="#id14">Shading the Rotating Cube</a><a class="headerlink" href="#shading-the-rotating-cube" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>ここのコードのポイントは以下の通り。</p>
<ul>
<li><p>照光処理を有効にして、利用する光源を有効にする。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL_LIGHTING</span><span class="p">);</span>
<span class="n">glEnable</span><span class="p">(</span><span class="n">GL_LIGHT0</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>現在の材質を設定する。この例では前面だけに指定している。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">glMaterialfv</span><span class="p">(</span><span class="n">GL_FRONT</span><span class="p">,</span> <span class="n">GL_AMBIENT</span><span class="p">,</span> <span class="n">currentMaterials</span><span class="o">-&gt;</span><span class="n">ambient</span><span class="p">);</span>
<span class="n">glMaterialfv</span><span class="p">(</span><span class="n">GL_FRONT</span><span class="p">,</span> <span class="n">GL_DIFFUSE</span><span class="p">,</span> <span class="n">currentMaterials</span><span class="o">-&gt;</span><span class="n">diffuse</span><span class="p">);</span>
<span class="n">glMaterialfv</span><span class="p">(</span><span class="n">GL_FRONT</span><span class="p">,</span> <span class="n">GL_SPECULAR</span><span class="p">,</span> <span class="n">currentMaterials</span><span class="o">-&gt;</span><span class="n">specular</span><span class="p">);</span>
<span class="n">glMaterialf</span><span class="p">(</span><span class="n">GL_FRONT</span><span class="p">,</span> <span class="n">GL_SHININESS</span><span class="p">,</span> <span class="n">currentMaterials</span><span class="o">-&gt;</span><span class="n">shininess</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>光源の特徴を設定する。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">glLightfv</span><span class="p">(</span><span class="n">GL_LIGHT0</span><span class="p">,</span> <span class="n">GL_AMBIENT</span><span class="p">,</span> <span class="n">currentLighting</span><span class="o">-&gt;</span><span class="n">ambient</span><span class="p">);</span>
<span class="n">glLightfv</span><span class="p">(</span><span class="n">GL_LIGHT0</span><span class="p">,</span> <span class="n">GL_DIFFUSE</span><span class="p">,</span> <span class="n">currentLighting</span><span class="o">-&gt;</span><span class="n">diffuse</span><span class="p">);</span>
<span class="n">glLightfv</span><span class="p">(</span><span class="n">GL_LIGHT0</span><span class="p">,</span> <span class="n">GL_SPECULAR</span><span class="p">,</span> <span class="n">currentLighting</span><span class="o">-&gt;</span><span class="n">specular</span><span class="p">);</span>
<span class="n">glLightfv</span><span class="p">(</span><span class="n">GL_LIGHT0</span><span class="p">,</span> <span class="n">GL_POSITION</span><span class="p">,</span> <span class="n">light0_pos</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</section>
<section id="controlling-the-shading-calculation">
<h3><a class="toc-backref" href="#id15">Controlling the Shading Calculation</a><a class="headerlink" href="#controlling-the-shading-calculation" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>照光処理は大量のリソースを必要とする。ゆえに、通常は前面だけを処理させるように
<code class="docutils literal notranslate"><span class="pre">glLightModel</span></code> を介して設定する。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">glLightModel(param,</span> <span class="pre">value)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">param</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">GL_LIGHT_MODEL_(AMBIENT|LOCAL_VIEWER|TWO_SIDE)</span></code></p>
</dd>
</dl>
<p>どうしても両面でシェーディングをしたければ <code class="docutils literal notranslate"><span class="pre">TWO_SIDE</span></code> を <code class="docutils literal notranslate"><span class="pre">GL_TRUE</span></code> にセット。</p>
</li>
<li><p>オブジェクトが視点から相当距離離れている場合、照光計算を簡略化するべく
<code class="docutils literal notranslate"><span class="pre">LOCAL_VIEWER</span></code> を <code class="docutils literal notranslate"><span class="pre">GL_TRUE</span></code> にセットすることができる。</p></li>
<li><p>すべての光源がオフであっても、少量の環境光が存在するように指示できる。
<code class="docutils literal notranslate"><span class="pre">AMBIENT</span></code> にグローバルな環境光の RGBA 値を指示すればよい。</p></li>
</ul>
</li>
</ul>
</section>
<section id="smooth-shading">
<h3><a class="toc-backref" href="#id16">Smooth Shading</a><a class="headerlink" href="#smooth-shading" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GL_SMOOTH</span></code> がデフォルトの照光処理。</p></li>
<li><p>巨大なポリゴンをシェーディングすると、中央部が妙に暗くなる。これを回避するには、ポリゴンを細分化する。</p></li>
</ul>
</section>
<section id="working-with-normals">
<h3><a class="toc-backref" href="#id17">Working with Normals</a><a class="headerlink" href="#working-with-normals" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>&lt;the quality of our shading depends on the normals&gt; (p. 138)</p></li>
<li><p>&lt;Smooth shading is sometimes called Gouraud shading&gt; (p. 138) グーローシェーディング。</p></li>
<li><p>&lt;The lighting calculations require that the normal vector have unit length&gt; (p. 138)</p></li>
<li><p>効率が落ちるのを覚悟で、OpenGL に法線の長さを 1 になるようにお願いすることができる。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL_NORMALIZE</span><span class="p">);</span>
</pre></div>
</div>
<p>しかし、何と言っても最大の注意点は、
&lt;Scaling changes the lengths of normals&gt; (p. 139)
ということだ。</p>
</li>
</ul>
</section>
<section id="transparancy">
<h3><a class="toc-backref" href="#id18">Transparancy</a><a class="headerlink" href="#transparancy" title="Permalink to this headline">¶</a></h3>
<p>シェーディングのことをいったん忘れて、ブレンディングの話題になる。</p>
<ul>
<li><p>OpenGL は RGBA 値の A の値の指定は通常無視するが、ブレンディングを明示的に有効にすれば意味を持つようになる。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL_BLEND</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>アルファ値は、通常 opacity を表現する。透明度の逆の概念。
&lt;the usual use is to use this value to determine the degree of opacity
of a color or material&gt; (p. 139)</p></li>
<li><p>半透明オブジェクトの描画に関しては、忘れてはならない重大なポイントがある。オブジェクトの描画順によって、結果が違ってくるということだ。</p></li>
<li><p>&lt;OpenGL provides a variety of constants that determine how to
blend colors and alpha values&gt; (p. 140)</p></li>
<li><p>source 色と destination 色という考え方。塗り絵みたいなもんだ。
&lt;When blending is disabled, the source color simply replaces
the destination color&gt; (p. 140)</p>
<p>結果色 := X * source + Y * destination</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">glBlendFunc(source,</span> <span class="pre">destination)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">source</dt>
<dd class="field-odd"><p>source 側のブレンディング係数。e.g. <code class="docutils literal notranslate"><span class="pre">GL_SRC_ALPHA</span></code></p>
</dd>
<dt class="field-even">destination</dt>
<dd class="field-even"><p>destination 側のブレンディング係数。e.g. <code class="docutils literal notranslate"><span class="pre">GL_ONE_MINUS_SRC_ALPHA</span></code></p>
</dd>
</dl>
<p>よく使う係数はこれ：
&lt;When we draw polygonal surfaces, the most common choices for the
source factor and destination factors are <code class="docutils literal notranslate"><span class="pre">GL_SRC_ALPHA</span></code> and
<code class="docutils literal notranslate"><span class="pre">ONE_MINUS_SRC_ALPHA</span></code>, respectively&gt; (p. 140)</p>
<p>つまり、ソースのアルファ値のみをブレンド率としている。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL_BLEND</span><span class="p">);</span>
<span class="n">glBlendFunc</span><span class="p">(</span><span class="n">GL_SRC_ALPHA</span><span class="p">,</span> <span class="n">GL_ONE_MINUS_SRC_ALPHA</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>ブレンド率をいいかげんに指定すると、最終的な値が [0, 1] の外にいってしまうことがある。デプスバッファがここでも活躍する。
&lt;We can use the depth buffer to keep track of whether or not a
polygon is in front of all polygons that have been rendered so far&gt;
(p. 141)</p>
<p>&lt;OpenGL provides a function <code class="docutils literal notranslate"><span class="pre">glDepthMask()</span></code>, which can make the depth
buffer read-only (<code class="docutils literal notranslate"><span class="pre">GL_FALSE</span></code>) or writeable (<code class="docutils literal notranslate"><span class="pre">GL_TRUE</span></code>)&gt; (p. 141)</p>
</li>
<li><p>アルファ値 (opacity) が 1.0 であるオブジェクトを描く前にデプスマスクを有効にし、半透明なオブジェクトを描く前には read-only にすればよい。</p></li>
</ul>
</section>
</section>
<section id="images">
<h2><a class="toc-backref" href="#id19">Images</a><a class="headerlink" href="#images" title="Permalink to this headline">¶</a></h2>
<p>この章ではフレームバッファとピクセルの概念を頭に叩き込む。</p>
<section id="pixels-and-bitmaps">
<h3><a class="toc-backref" href="#id20">Pixels and Bitmaps</a><a class="headerlink" href="#pixels-and-bitmaps" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>&lt;The frame buffer is really a collection of buffers.  For each x, y value
in screen space, there is a corresponding group of bits that can be thought
of as a generalized picture element or <strong>pixel</strong>&gt; (p. 143)</p></li>
<li><p>明らかに註が重要。用語の意味の汲み方を間違えぬこと。ピクセルという用語に与える意味は、OpenGL のほうが一般の CG の教科書より優れている気がする。
&lt;OpenGL uses <em>color buffer</em> to refer to these bits and the <em>frame buffer</em>
(or framebuffer) is the collection of all the buffers, including the
color buffer(s) and the depth buffer&gt; (p. 143)</p></li>
<li><p>&lt;we need the ability to read and write rectangular arrays of pixels&gt; (p. 143)</p></li>
<li><p>Figure 7.1 の &lt;n x m frame buffer shown with k parallel bit planes&gt; を憶える。</p></li>
<li><p>&lt;we shall use the term pixel to denote a group of bits&gt; (p.144)</p></li>
<li><p>ピクセルを直にいじる操作のことを <strong>bit block transfer</strong> という。これを縮めて <strong>bitblt</strong> というのだ。</p></li>
<li><p>Figure 7.2. Vertices パイプラインと Pixels パイプラインがラスタライズステージで合流する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Vertices</span> <span class="o">--&gt;</span> <span class="n">Geometric</span> <span class="n">Processing</span> <span class="o">--&gt;</span> <span class="n">Rasterization</span> <span class="o">--&gt;</span> <span class="n">Display</span>
                                        <span class="o">|</span>
  <span class="n">Pixels</span> <span class="o">--&gt;</span> <span class="n">Pixel</span> <span class="n">Operations</span> <span class="o">----------|</span>
</pre></div>
</div>
</li>
<li><p>&lt;We have to warry about the differences in how pixels are formatted in
the application program&gt; (p. 145)</p></li>
<li><p>&lt;a pixel might represent an RGB color, an RGBA color, a luminance value,
or a depth value&gt; (p. 145)</p></li>
</ul>
</section>
<section id="bitmaps">
<h3><a class="toc-backref" href="#id21">Bitmaps</a><a class="headerlink" href="#bitmaps" title="Permalink to this headline">¶</a></h3>
<section id="displaying-a-bitmap">
<h4><a class="toc-backref" href="#id22">Displaying a Bitmap</a><a class="headerlink" href="#displaying-a-bitmap" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">glBitmap</span></code> 関数の説明。ラスタポジションの状態を変更することに言及している。</p></li>
</ul>
</section>
<section id="mixing-bitmaps-and-geometry">
<h4><a class="toc-backref" href="#id23">Mixing Bitmaps and Geometry</a><a class="headerlink" href="#mixing-bitmaps-and-geometry" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gluOrtho2D</span></code> と <code class="docutils literal notranslate"><span class="pre">glRasterPos2i</span></code> のコンビ技について説明している。二次元的に描画するときの基本的な考え方。</p></li>
<li><p>&lt;One solution to this problem is to use two sets of viewing conditions,
one for the geometry and the other for the bitmaps&gt; (p. 148)</p></li>
</ul>
</section>
<section id="colors-and-masks">
<h4><a class="toc-backref" href="#id24">Colors and Masks</a><a class="headerlink" href="#colors-and-masks" title="Permalink to this headline">¶</a></h4>
<p>ビットマップをマスクという観点で説明する。
<code class="docutils literal notranslate"><span class="pre">glColor</span></code> と <code class="docutils literal notranslate"><span class="pre">glClearColor</span></code> のチェッカーボードの例を挙げている。</p>
<ul>
<li><p>ここは理解しにくい：
&lt;OpenGL stores both a present drawing color and a present raster color&gt;
(p. 149)</p>
<p>&lt;The checkerboard is drawn in red because the raster color is the color
that was in effect the last time that the function <code class="docutils literal notranslate"><span class="pre">glRasterPos2i()</span></code> was
executed&gt; (p. 149)</p>
</li>
</ul>
</section>
</section>
<section id="drawing-modes">
<h3><a class="toc-backref" href="#id25">Drawing Modes</a><a class="headerlink" href="#drawing-modes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Figure 7.6 の模式を憶えること。Logic Op の回路。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glLogicOp(op)</span></code> を利用するには、
<code class="docutils literal notranslate"><span class="pre">glEnable</span></code> で有効にする必要がある。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">glEnable</span><span class="p">(</span><span class="n">GL_COLOR_LOGIC_OP</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>&lt;If we use XOR, wesimply draw the same object a second time at the same
place that we drew it the first time.  The second draw undoes the first&gt;
(p. 151)</p></li>
<li><p>&lt;Applications of this simple idea include moving a cursor around the
screen, rubberbanding lines and rectangles&gt; (p.152)</p></li>
</ul>
</section>
<section id="reading-and-writing-pixels">
<h3><a class="toc-backref" href="#id26">Reading and Writing Pixels</a><a class="headerlink" href="#reading-and-writing-pixels" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Figure 7.7 Pixel pipeline を意識する。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Processor</span>                   <span class="n">Pixel</span>        <span class="n">Pixel</span>       <span class="n">Pixel</span>       <span class="n">Frame</span>
<span class="n">Memory</span>    <span class="o">--&gt;</span> <span class="n">Unpacking</span> <span class="o">--&gt;</span> <span class="n">Transfer</span> <span class="o">--&gt;</span> <span class="n">Mapping</span> <span class="o">--&gt;</span> <span class="n">Testing</span> <span class="o">--&gt;</span> <span class="n">Buffer</span>
   <span class="o">|</span>                                                                <span class="o">|</span>
   <span class="o">|&lt;---------------------------</span> <span class="n">Packing</span> <span class="o">&lt;--------------------------|</span>
</pre></div>
</div>
</li>
</ul>
<section id="writing-pixels">
<h4><a class="toc-backref" href="#id27">Writing Pixels</a><a class="headerlink" href="#writing-pixels" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">glDrawPixels(w,</span> <span class="pre">h,</span> <span class="pre">format,</span> <span class="pre">type,</span> <span class="pre">array)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">w, h</dt>
<dd class="field-odd"><p>ピクセル矩形のサイズ</p>
</dd>
<dt class="field-even">format</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">GL_UNSIGNED_BYTE</span></code> とか</p>
</dd>
<dt class="field-odd">type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">GL_UNSIGNED_BYTE_3_3_2</span></code> とか</p>
</dd>
<dt class="field-even">array</dt>
<dd class="field-even"><p>描画したいデータ</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="reading-pixels">
<h4><a class="toc-backref" href="#id28">Reading Pixels</a><a class="headerlink" href="#reading-pixels" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">glReadPixels(x,</span> <span class="pre">y,</span> <span class="pre">w,</span> <span class="pre">h,</span> <span class="pre">format,</span> <span class="pre">type,</span> <span class="pre">array)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">x, y</dt>
<dd class="field-odd"><p>フレームバッファのどの位置からデータを読み込むのかを指示</p>
</dd>
</dl>
</li>
<li><p>dithering について言及しているが、よくわからなかった。</p></li>
</ul>
</section>
<section id="copying-pixels">
<h4><a class="toc-backref" href="#id29">Copying Pixels</a><a class="headerlink" href="#copying-pixels" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">glCopyPixels</span></code> はフレームバッファ内でピクセルをコピーするというのがポイント。
<code class="docutils literal notranslate"><span class="pre">glCopyPixels</span></code> はデータをシステムメモリに運ばないので、
<code class="docutils literal notranslate"><span class="pre">glReadPixels</span></code> と <code class="docutils literal notranslate"><span class="pre">glDrawPixels</span></code> を組み合わせてコピーをするよりも、パフォーマンスが優れている。</p></li>
</ul>
</section>
</section>
<section id="selecting-buffers">
<h3><a class="toc-backref" href="#id30">Selecting Buffers</a><a class="headerlink" href="#selecting-buffers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>シングルバッファモードで読み書きが起こるのは front color buffer で、ダブルバッファモードでは back color buffer で起こる。</p></li>
<li><p>OpenGL は実装によってはさらなる color buffer をサポートしている。どのバッファを用いるのかを選択するのには、
<code class="docutils literal notranslate"><span class="pre">glReadBuffer</span></code> と <code class="docutils literal notranslate"><span class="pre">glDrawBuffer</span></code> 関数を利用する。</p></li>
</ul>
</section>
<section id="pixel-store-modes">
<h3><a class="toc-backref" href="#id31">Pixel Store Modes</a><a class="headerlink" href="#pixel-store-modes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>どのようにしてプロセッサーメモリにバイトが配列されているのかを
OpenGL に教えてやる必要があるとする。この場合、
<code class="docutils literal notranslate"><span class="pre">glPixelStore</span></code> を利用する。</p></li>
<li><p>バイトオーダーの話題か。</p></li>
</ul>
</section>
<section id="displaying-a-ppm-image">
<h3><a class="toc-backref" href="#id32">Displaying a PPM Image</a><a class="headerlink" href="#displaying-a-ppm-image" title="Permalink to this headline">¶</a></h3>
<p>いまさら PPM を扱うことはあるまい。</p>
</section>
<section id="using-luminace">
<h3><a class="toc-backref" href="#id33">Using Luminace</a><a class="headerlink" href="#using-luminace" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p><strong>Luminance</strong> とは &lt;images that consist only of shades of gray&gt; (p. 163) のこと。モノクロ画像だ。</p></li>
<li><p>RGB 値から luminance の値を計算する式は次で与えられるらしい。</p>
<div class="math notranslate nohighlight">
\begin{align*}
L = .30R + .59G + .11B
\end{align*}</div><p>明らかに G 成分が支配的。</p>
</li>
</ul>
</section>
<section id="pixel-mapping">
<h3><a class="toc-backref" href="#id34">Pixel Mapping</a><a class="headerlink" href="#pixel-mapping" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>カラーバッファの RGB ピクセルの値を補正することができる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glPixelTransfer(name,</span> <span class="pre">value)</span></code> - pixel transfer mode を指定する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glPixelMap(map,</span> <span class="pre">size,</span> <span class="pre">array)</span></code> - 補正テーブルをセットする。</p>
<dl class="field-list simple">
<dt class="field-odd">map</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">GL_PIXEL_MAP_I_TO_R</span></code> など。</p>
</dd>
<dt class="field-even">size</dt>
<dd class="field-even"><p>2 のベキ乗でなければならない。</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="pixel-zoom">
<h3><a class="toc-backref" href="#id35">Pixel Zoom</a><a class="headerlink" href="#pixel-zoom" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>ピクセルブロックのスケーリングには <code class="docutils literal notranslate"><span class="pre">glPixelZoom</span></code> を用いる。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">glPixelZoom(sx,</span> <span class="pre">sy)</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">sx, sy</dt>
<dd class="field-odd"><p>スケール係数。負数も許す。負数の場合はピクセルの並び順が逆転する。</p>
</dd>
</dl>
</li>
</ul>
</li>
<li><p>そしていまいち使い方がわからない <code class="docutils literal notranslate"><span class="pre">gluScaleImage</span></code> 関数。イメージをトリムするのかストレッチするのかがわからない。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">gluScaleImage(format,</span> <span class="pre">win,</span> <span class="pre">hin,</span> <span class="pre">typein,</span> <span class="pre">imagein,</span> <span class="pre">wout,</span> <span class="pre">hout,</span> <span class="pre">typeout,</span> <span class="pre">imageout)</span></code></p></li>
</ul>
</li>
</ul>
</section>
<section id="image-processing-in-opengl">
<h3><a class="toc-backref" href="#id36">Image Processing in OpenGL</a><a class="headerlink" href="#image-processing-in-opengl" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>ヒストグラムやフィルタリング。高度な内容らしい。</p></li>
<li><p>Convolution という単語がフィルタに関連する理由が、次の文のおかげでわかった。
&lt;Convolution or filtering that replaces a pixel value by a linear function
of the surrounding pixel values&gt; (p. 167)</p></li>
<li><p>Imaging Pipeline</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pixels</span>   <span class="n">Color</span>                      <span class="n">Color</span>      <span class="n">Color</span>      <span class="n">Color</span>                 <span class="n">Pixels</span>
    <span class="o">--&gt;</span>  <span class="n">Lookup</span> <span class="o">--&gt;</span> <span class="n">Convolution</span> <span class="o">--&gt;</span> <span class="n">Lookup</span> <span class="o">--&gt;</span> <span class="n">Matrix</span> <span class="o">--&gt;</span> <span class="n">Lookup</span> <span class="o">--&gt;</span> <span class="n">Histogram</span> <span class="o">--&gt;</span>
         <span class="n">Table</span>                      <span class="n">Table</span>                 <span class="n">Table</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="note4.html" title="OpenGL: A Primer Second Edition 読書ノート 4/4"
             >next</a></li>
        <li class="right" >
          <a href="note2.html" title="OpenGL: A Primer Second Edition 読書ノート 2/4"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >OpenGL: A Primer Second Edition 読書ノート</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">OpenGL: A Primer Second Edition 読書ノート 3/4</a></li> 
      </ul>
    </div>
    <div id="footer">
      <div id="footer_logo">
        <a class="imga" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png" width="88" height="31" /></a>
      </div>
      <div id="footer_copyright">
        Since 1999<br />
        Copyright &copy; 1999-2021, プレハブ小屋 All rights reserved.
      </div>
    </div>
  </body>
</html>