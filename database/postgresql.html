<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PostgreSQL 利用ノート &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=c9b0a06a" />
    <script src="../_static/documentation_options.js?v=4354bf25"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Firebird 利用ノート" href="firebird.html" />
    <link rel="prev" title="MySQL 利用ノート" href="mysql.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="mysql.html" title="Previous">MySQL 利用ノート</a>
        </li>
      
        <li>
          <a href="firebird.html" title="Next">Firebird 利用ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="postgresql">
<h1>PostgreSQL 利用ノート<a class="headerlink" href="#postgresql" title="Link to this heading">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Since<span class="colon">:</span></dt>
<dd class="field-odd"><p>1996</p>
</dd>
<dt class="field-even">Official site<span class="colon">:</span></dt>
<dd class="field-even"><p>&lt;<a class="reference external" href="https://www.postgresql.org/">https://www.postgresql.org/</a>&gt;</p>
</dd>
<dt class="field-odd">Version<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong class="program">psql</strong> 16.3 (Debian 16.3-1.pgdg120+1)</p>
</dd>
</dl>
<p>PostgreSQL をとりあえず利用するまでの手順を記す。SQL 学習環境が得られれば十分だ。本稿では <a class="reference internal" href="../docker/index.html"><span class="doc">Docker</span></a> を利用するものとする。</p>
<p class="rubric">以前の PostgreSQL 環境の残滓を一掃する</p>
<p>環境が完全にクリーンである場合にはここを飛ばしてイメージ入手工程を読め。以前、何かの PostgreSQL チュートリアルをやって上手くいかなかった場合にはこの工程が外せない。</p>
<p>おそらく <strong class="program">apt</strong> を利用して環境構築したはずなので、次の手順に従えばひじょうに上手くいく：</p>
<p><a class="reference external" href="https://www.postgresqltutorial.com/postgresql-administration/uninstall-postgresql-ubuntu/">How to Uninstall PostgreSQL from Ubuntu</a></p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">アンインストール手順例</span><a class="headerlink" href="#id1" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>apt<span class="w"> </span>remove<span class="w"> </span>--purge<span class="w"> </span>postgresql
<span class="gp">$ </span>dpkg<span class="w"> </span>-l<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>postgres
<span class="gp">$ </span>sudo<span class="w"> </span>apt<span class="w"> </span>remove<span class="w"> </span>--purge<span class="w"> </span>postgresql-<span class="o">{{</span>,client-<span class="o">}{</span><span class="m">14</span>,common<span class="o">}</span>,contrib<span class="o">}</span>
<span class="gp">$ </span>sudo<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="o">{</span>/var/lib/,/var/log/,/etc/<span class="o">}</span>postgresql/
<span class="gp">$ </span>sudo<span class="w"> </span>deluser<span class="w"> </span>postgres
</pre></div>
</div>
</div>
<p>さらにユーザー設定ファイルも削除するべきだと考えられる。後ほど XDG Base
Directory 対応と同時に設定ファイルを作り直す想定だ。</p>
<p class="rubric">イメージを入手してコンテナーを稼働する</p>
<p>最初に Docker Hub から公式イメージを検索して、それをローカルに持ってくる：</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">PostgreSQL イメージ取得例</span><a class="headerlink" href="#id2" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>search<span class="w"> </span>postgresql<span class="w"> </span>--filter<span class="o">=</span>is-official<span class="o">=</span><span class="nb">true</span>
<span class="gp">$ </span>docker<span class="w"> </span>pull<span class="w"> </span>postgres
<span class="gp">$ </span>docker<span class="w"> </span>images<span class="w"> </span>--filter<span class="w"> </span><span class="nv">reference</span><span class="o">=</span>postgres
</pre></div>
</div>
</div>
<p>コンテナーに例えば <code class="docutils literal notranslate"><span class="pre">some-postgres</span></code> などの名前を付けて稼働する。このときに
PostgreSQL に対して必要な情報、環境変数を指定する：</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">PostgreSQL コンテナー稼働コマンド例</span><a class="headerlink" href="#id3" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>run<span class="w"> </span>--name<span class="w"> </span>some-postgres<span class="w"> </span>-e<span class="w"> </span><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>secret<span class="w"> </span>-d<span class="w"> </span>postgres
</pre></div>
</div>
</div>
<p>これで PostgreSQL サーバーが稼働する。あくまでも練習用の手順なので、パスワードの扱いはここではぞんざいだ。</p>
<p class="rubric">データベースクライアントを実行する</p>
<p>PostgreSQL が稼働しているコンテナーに「入って」クライアント <strong class="program">psql</strong> を実行したい。</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">稼働中の PostgreSQL コンテナーで CLI を対話的に起動する例</span><a class="headerlink" href="#id4" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>some-postgres<span class="w"> </span>createdb<span class="w"> </span>mydb
<span class="gp">$ </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>some-postgres<span class="w"> </span>psql<span class="w"> </span>-s<span class="w"> </span>mydb
<span class="go">psql (16.3 (Debian 16.3-1.pgdg120+1))</span>
<span class="go">Type &quot;help&quot; for help.</span>

<span class="go">mydb=#</span>
</pre></div>
</div>
</div>
<p class="rubric">コンテナーを一時停止する</p>
<p>PostgreSQL コンテナーを一時停止、再開するには次のどちらかの組み合わせを実行する：</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">コンテナー一時停止＆再開例</span><a class="headerlink" href="#id5" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>stop<span class="w"> </span>some-postgres
<span class="gp">$ </span>docker<span class="w"> </span>start<span class="w"> </span>some-postgres

<span class="gp">$ </span>docker<span class="w"> </span>pause<span class="w"> </span>some-postgres
<span class="gp">$ </span>docker<span class="w"> </span>unpause<span class="w"> </span>some-postgres
</pre></div>
</div>
</div>
<p>システム資源を一時的に解放する必要がある場合に停止するといい。</p>
<p class="rubric">SQL などの練習をする</p>
<p>PostgreSQL 公式文書のチュートリアルも有用であるし、キーワード “PostgreSQL
Tutorial” などで Google 検索するとそれらしい教材がたくさん見つかる。</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.postgresql.org/docs/current/tutorial.html">公式チュートリアル</a></p></li>
<li><p><a class="reference external" href="https://www.postgresqltutorial.com/">PostgreSQL Tutorial</a></p></li>
</ul>
<p class="rubric">ドットファイル</p>
<p>ここで言うドットファイルとは <code class="file docutils literal notranslate"><span class="pre">.psqlrc</span></code> とする。PostgreSQL 環境を Docker コンテナーではなくホストに構築したとするならば、次のようにこのファイルを管理したい。まず、Bash ドットファイル <code class="file docutils literal notranslate"><span class="pre">.bashrc</span></code> で <span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PSQLRC</span></code> と
<span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PSQL_HISTORY</span></code> を設定する：</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">PSQLRC と PSQL_HISTORY の設定例</span><a class="headerlink" href="#id6" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">PSQLRC</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$XDG_CONFIG_HOME</span><span class="s2">/postgresql/psqlrc&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PSQL_HISTORY</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$XDG_STATE_HOME</span><span class="s2">/postgresql/psql_history&quot;</span>
</pre></div>
</div>
</div>
<p>上記パスのディレクトリー部分に当たるものは <strong class="command">mkdir</strong> しておく必要がある。ここまで述べた方式はクライアントプログラム <strong class="program">psql</strong> をホスト環境にインストールしている場合にはそのまま使える。</p>
<p>コンテナー環境の <strong class="program">psql</strong> を利用する場合。ユーザーは postgres であるとすると、その <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal notranslate"><span class="pre">HOME</span></code> は <code class="file docutils literal notranslate"><span class="pre">/var/lib/postgresql</span></code> だ。この直下にドットファイルが置かれる。コンテナー稼働開始時にホストファイルを bind-mount すれば行ける。履歴はコンテナーに置いてかまわないと考えるので指定しない。</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>some-postgres<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>secret<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mount<span class="w"> </span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span><span class="nv">$PSQLRC</span>,target<span class="o">=</span>/var/lib/postgresql/.psqlrc,readonly<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>postgres
</pre></div>
</div>
<p>サーバードットファイルに関しても同様に、ホストにカスタム版を置いて bind-mount することが可能だ。ログが欲しい場合などに設定項目を編集することになる。</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>some-postgres<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>secret<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mount<span class="w"> </span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span>/path/to/my-postgres.conf,target<span class="o">=</span>/etc/postgresql/postgresql.conf,readonly<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>postgres<span class="w"> </span>-c<span class="w"> </span><span class="nv">config_file</span><span class="o">=</span>/etc/postgresql/postgresql.conf
</pre></div>
</div>
<p class="rubric">データ格納場所</p>
<p>コンテナー内 <code class="file docutils literal notranslate"><span class="pre">/var/lib/postgresql</span></code> が既定のデータベース格納場所であり、これをホスト側で管理したい場合には bind-mount を適宜指定する。ホスト側のディレクトリーは前もって手動で作成しておく。</p>
<p>Docker Hub 公式イメージ README によると <code class="file docutils literal notranslate"><span class="pre">/var/lib/postgresql</span></code> にマウントする場合、<code class="file docutils literal notranslate"><span class="pre">/var/lib/postgresql/data</span></code> はコンテナーランタイムからのローカルボリュームであるため、マウントされたボリューム上にデータは永続化されないと文書にある。</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><code class="file docutils literal notranslate"><span class="pre">/path/to</span></code> は差し当たり <code class="docutils literal notranslate"><span class="pre">$(pwd)</span></code> にしておけ</span><a class="headerlink" href="#id7" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>some-postgres<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>secret<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">PGDATA</span><span class="o">=</span>/var/lib/postgresql/data/pgdata<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mount<span class="w"> </span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span>/path/to/datadir,target<span class="o">=</span>/var/lib/postgresql/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>postgres
</pre></div>
</div>
</div>
<p>この結果、ホスト側ファイルシステム部分である <code class="file docutils literal notranslate"><span class="pre">./data/pgdata</span></code> にデータベース実体が保存される。コンテナーをいったん廃棄して再度この <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> コマンドを実行すると、データベースが維持できていることが確認できる。</p>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p><code class="file docutils literal notranslate"><span class="pre">./data/pgdata</span></code> の所有権表記が <code class="docutils literal notranslate"><span class="pre">999</span> <span class="pre">root</span></code> になる。コンテナーの
<code class="file docutils literal notranslate"><span class="pre">/etc/passwd</span></code> を確認するとユーザー <code class="docutils literal notranslate"><span class="pre">postgres</span></code> に相当する。</p>
</div>
<p class="rubric">まとめ</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">ここまでの諸々をまとめたコンテナー稼働コマンド</span><a class="headerlink" href="#id8" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>some-postgres<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span>secret<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">PGDATA</span><span class="o">=</span>/var/lib/postgresql/data/pgdata<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mount<span class="w"> </span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span><span class="nv">$PWD</span>/datadir,target<span class="o">=</span>/var/lib/postgresql/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--mount<span class="w"> </span><span class="nv">type</span><span class="o">=</span>bind,source<span class="o">=</span><span class="nv">$PSQLRC</span>,target<span class="o">=</span>/var/lib/postgresql/.psqlrc,readonly<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>postgres
</pre></div>
</div>
</div>
<p>こんなコマンドを毎回書いていられないので Docker Compose を利用する。ファイル
<code class="file docutils literal notranslate"><span class="pre">compose.yaml</span></code> を次のような内容で用意：</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Example of <code class="file docutils literal notranslate"><span class="pre">compose.yaml</span></code></span><a class="headerlink" href="#id9" title="Link to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">postgres</span><span class="p">:</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some-postgres</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">PGDATA</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/lib/postgresql/data/pgdata</span>
<span class="w">      </span><span class="nt">POSTGRES_USER</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<span class="w">      </span><span class="nt">POSTGRES_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">secret</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bind</span>
<span class="w">        </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PWD}/datadir</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/lib/postgresql/data</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bind</span>
<span class="w">        </span><span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${PSQLRC}</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/lib/postgresql/.psqlrc</span>
<span class="w">        </span><span class="nt">read_only</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</div>
<p>これで <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">compose</span> <span class="pre">up</span> <span class="pre">-d</span></code> や <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">compose</span> <span class="pre">down</span></code> が利用可能になる。</p>
<p class="rubric">サンプルデータベースを構築する</p>
<p><a class="reference external" href="https://www.postgresqltutorial.com/postgresql-getting-started/load-postgresql-sample-database/">Load PostgreSQL Sample Database</a>
で配布されている SQL 練習用データベースを拝借する。まずホスト側ファイルシステムにアーカイブをダウンロードし、それからそのファイルをコンテナーに転送する。おしまいにコンテナー側で <strong class="program">pg_restore</strong> コマンドを実行するという流れだ：</p>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">ホスト側手順</span><a class="headerlink" href="#id10" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>curl<span class="w"> </span>-O<span class="w"> </span>https://www.postgresqltutorial.com/wp-content/uploads/2019/05/dvdrental.zip
<span class="gp">$ </span>unzip<span class="w"> </span>dvdrental.zip
<span class="gp">$ </span>docker<span class="w"> </span>cp<span class="w"> </span>dvdrental.tar<span class="w"> </span>some-postgres:/tmp/dvdrental.tar
</pre></div>
</div>
</div>
<p>チュートリアルに従い、データベース <code class="docutils literal notranslate"><span class="pre">dvdrental</span></code> を作成しておく。<strong class="program">psql</strong>
セッションで <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">DATABASE</span> <span class="pre">dvdrental;</span></code> しておけ。その後ならばデータベースをロードして良い：</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">コンテナー側手順</span><a class="headerlink" href="#id11" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-u<span class="w"> </span>postgres<span class="w"> </span>some-postgres<span class="w"> </span>pg_restore<span class="w"> </span>-d<span class="w"> </span>dvdrental<span class="w"> </span>/tmp/dvdrental.tar
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">データベース dvdrental を確認する例</span><a class="headerlink" href="#id12" title="Link to this code">¶</a></div>
<div class="highlight-psql notranslate"><div class="highlight"><pre><span></span><span class="gp">postgres=#</span><span class="w"> </span><span class="kp">\c</span><span class="w"> </span><span class="ss">dvdrental</span>
<span class="go">You are now connected to database &quot;dvdrental&quot; as user &quot;postgres&quot;.</span>
<span class="gp">dvdrental=#</span><span class="w"> </span><span class="kp">\dt</span>
<span class="go">             List of relations</span>
<span class="go"> Schema |     Name      | Type  |  Owner</span>
<span class="go">--------+---------------+-------+----------</span>
<span class="go"> public | actor         | table | postgres</span>
<span class="go"> public | address       | table | postgres</span>
<span class="go"> public | category      | table | postgres</span>
<span class="go"> public | city          | table | postgres</span>
<span class="go"> public | country       | table | postgres</span>
<span class="go"> public | customer      | table | postgres</span>
<span class="go"> public | film          | table | postgres</span>
<span class="go"> public | film_actor    | table | postgres</span>
<span class="go"> public | film_category | table | postgres</span>
<span class="go"> public | inventory     | table | postgres</span>
<span class="go"> public | language      | table | postgres</span>
<span class="go"> public | payment       | table | postgres</span>
<span class="go"> public | rental        | table | postgres</span>
<span class="go"> public | staff         | table | postgres</span>
<span class="go"> public | store         | table | postgres</span>
<span class="go">(15 rows)</span>
</pre></div>
</div>
</div>
<p class="rubric">コンテナーを廃棄する</p>
<p>PostgreSQL コンテナーが用済みになったらそれを削除することでデータベースも消去される。失いたくない場合には <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> の段階でマウントなどを指定するか、コンテナーにあるデータベースをホスト側に退避させるのだろう。</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">コンテナーを処分するコマンド例</span><a class="headerlink" href="#id13" title="Link to this code">¶</a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>docker<span class="w"> </span>stop<span class="w"> </span>some-postgres
<span class="gp">$ </span>docker<span class="w"> </span>rm<span class="w"> </span>some-postgres
</pre></div>
</div>
</div>
<p>ディスクに余裕がなければイメージも削除する。</p>
<hr class="docutils" />
<p>ネットワークやログ管理など、未実施の項目が残っているが、納得したのでひとまず終わる。</p>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="mysql.html" title="Previous">MySQL 利用ノート</a>
        </li>
      
        <li>
          <a href="firebird.html" title="Next">Firebird 利用ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="../index.html" title="読書ノート Home"><img src="../_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>