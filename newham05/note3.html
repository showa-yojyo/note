
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>入門 bash 読書ノート 3/3 &#8212; 読書ノート v1.5dev</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/prefab.css" />
    
    <script src="../_static/mathjax-v3.js"></script>
    
    <link rel="next" title="幾何学 I 多様体入門 読書ノート" href="../tsuboi05/index.html" />
    <link rel="prev" title="入門 bash 読書ノート 2/3" href="note2.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../tsuboi05/index.html" title="幾何学 I 多様体入門 読書ノート"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="note2.html" title="入門 bash 読書ノート 2/3"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">入門 bash 読書ノート</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">入門 bash 読書ノート 3/3</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <section id="bash-3-3">
<h1><a class="toc-backref" href="#id30">入門 bash 読書ノート 3/3</a><a class="headerlink" href="#bash-3-3" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">著者</dt>
<dd class="field-odd"><p>Cameron Newham, Bill Rosenblatt</p>
</dd>
<dt class="field-even">訳者</dt>
<dd class="field-even"><p>株式会社クイープ</p>
</dd>
<dt class="field-odd">出版社</dt>
<dd class="field-odd"><p>オライリー・ジャパン</p>
</dd>
<dt class="field-even">発行年</dt>
<dd class="field-even"><p>2005 年</p>
</dd>
<dt class="field-odd">ISBN</dt>
<dd class="field-odd"><p>978-4-87311-254-1</p>
</dd>
</dl>
<div class="contents topic" id="id1">
<p class="topic-title">ノートの目次</p>
<ul class="simple">
<li><p><a class="reference internal" href="#bash-3-3" id="id30">入門 bash 読書ノート 3/3</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id31">8 章 プロセスの操作</a></p>
<ul>
<li><p><a class="reference internal" href="#id" id="id32">8.1 プロセス ID とジョブ番号</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id33">8.2 ジョブ制御</a></p>
<ul>
<li><p><a class="reference internal" href="#id4" id="id34">8.2.1 フォアグラウントとバックグラウンド</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id35">8.2.2 ジョブの一時停止</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id6" id="id36">8.3 シグナル</a></p>
<ul>
<li><p><a class="reference internal" href="#id7" id="id37">8.3.1 コントロールキーのシグナル</a></p></li>
<li><p><a class="reference internal" href="#kill" id="id38">8.3.2 kill</a></p></li>
<li><p><a class="reference internal" href="#ps" id="id39">8.3.3 ps</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id8" id="id40">8.4 トラップ</a></p>
<ul>
<li><p><a class="reference internal" href="#id9" id="id41">8.4.2 プロセス ID と一時ファイル</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id42">8.4.5 トラップのリセット</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id11" id="id43">8.5 コルーチン</a></p>
<ul>
<li><p><a class="reference internal" href="#wait" id="id44">8.5.1 wait</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id45">8.5.2 コルーチンの利点と欠点</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id46">8.5.3 並列化</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id14" id="id47">8.6 サブシェル</a></p>
<ul>
<li><p><a class="reference internal" href="#id15" id="id48">8.6.2 入れ子のサブシェル</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id16" id="id49">8.7 プロセス置換</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id17" id="id50">9 章 シェルプログラミングのデバッグ</a></p>
<ul>
<li><p><a class="reference internal" href="#id18" id="id51">9.1 基本的なデバッグ補助</a></p>
<ul>
<li><p><a class="reference internal" href="#set" id="id52">9.1.1 set のオプション</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#bash" id="id53">9.2 bash デバッガ</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id19" id="id54">10 章 bash の管理</a></p>
<ul>
<li><p><a class="reference internal" href="#id20" id="id55">10.1 標準シェルとしての bash のインストール</a></p>
<ul>
<li><p><a class="reference internal" href="#posix" id="id56">10.1.1 POSIX モード</a></p></li>
<li><p><a class="reference internal" href="#id21" id="id57">10.1.2 コマンドラインオプション</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id22" id="id58">10.2 環境のカスタマイズ</a></p>
<ul>
<li><p><a class="reference internal" href="#umask" id="id59">10.2.1 umask</a></p></li>
<li><p><a class="reference internal" href="#ulimit" id="id60">10.2.2 ulimit</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#id23" id="id61">11 章 シェルスクリプティング</a></p>
<ul>
<li><p><a class="reference internal" href="#id24" id="id62">11.1 スクリプトは何をするのか</a></p>
<ul>
<li><p><a class="reference internal" href="#id25" id="id63">11.1.2 変数と定数</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id26" id="id64">11.2 スクリプトの起動</a></p></li>
<li><p><a class="reference internal" href="#id27" id="id65">11.3 その他の問題点</a></p></li>
<li><p><a class="reference internal" href="#id28" id="id66">11.4 bash を使用しない</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id29" id="id67">12 章 bash の導入</a></p></li>
<li><p><a class="reference internal" href="#a" id="id68">付録 A 関連シェル</a></p>
<ul>
<li><p><a class="reference internal" href="#a-3-korn" id="id69">A.3 Korn シェル</a></p></li>
<li><p><a class="reference internal" href="#a-5-zsh" id="id70">A.5 zsh</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#b" id="id71">付録 B リファレンス</a></p>
<ul>
<li><p><a class="reference internal" href="#b-8" id="id72">B.8 入出力リダイレクト</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#d" id="id73">付録 D プログラム可能な補完</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="id2">
<h2><a class="toc-backref" href="#id31">8 章 プロセスの操作</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Cygwin ユーザーが読んでも役に立つと信じて本章を読む。</p>
<ul class="simple">
<li><p>&lt;UNIX は、ユーザーごとに複数のプロセスの制御を可能にした最初の小型コンピュータオペレーティングシステムとしてもよく知られている&gt; (p. 209)</p></li>
<li><p>&lt;プロセスを識別し、ログインセッションやシェルスクリプトでそれらを制御するための最も基本的な要素から見ていく&gt; (p. 209)</p></li>
<li><p>&lt;プロセスどうしを通信させる仕組みについて調べる&gt; (p. 209)</p></li>
</ul>
<section id="id">
<h3><a class="toc-backref" href="#id32">8.1 プロセス ID とジョブ番号</a><a class="headerlink" href="#id" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>&lt;プロセスが生成されると、必ず <strong>プロセス ID</strong> という番号が振られる&gt; (p. 210)
コマンドを <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> 付きで実行すると、コンソールに <code class="docutils literal notranslate"><span class="pre">[1]</span> <span class="pre">4000</span></code> のような表示が出る。最初の括弧つきの番号が <strong>ジョブ番号</strong> を示す。</p></li>
<li><p>&lt;ジョブという言葉は、基本的に、シェルから呼び出されたコマンドラインを指す&gt; (p. 210)</p></li>
</ul>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id33">8.2 ジョブ制御</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>&lt;ただし、ジョブ番号のほうは重要だ。
<strong>ジョブ制御</strong> を行うシェルコマンドで使用するからである&gt; (p. 211)</p></li>
<li><p>&lt;ジョブをバックグラウンドで起動した後は、そのまま完了させるか、
<strong>フォアグラウンド</strong> へ移すか、または
<strong>シグナル</strong> というメッセージを送りつけることができる&gt; (p. 211)</p></li>
</ul>
<section id="id4">
<h4><a class="toc-backref" href="#id34">8.2.1 フォアグラウントとバックグラウンド</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">jobs</span></code> コマンドでジョブの一覧表示。オプションが色々ある。</p></li>
<li><p>引数なしで <code class="docutils literal notranslate"><span class="pre">fg</span></code> と入力すると、バックグランドで最後に実行されたジョブがフォアグラウンドに移る。</p></li>
</ul>
</section>
<section id="id5">
<h4><a class="toc-backref" href="#id35">8.2.2 ジョブの一時停止</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;一時停止するには、ジョブの実行中に CTRL+Z キーを押す&gt; (p. 213)
ここで CTRL+Z は <code class="docutils literal notranslate"><span class="pre">susp</span></code> に設定されていることを仮定している。</p></li>
<li><p>&lt;停止したジョブを再開し、フォアグラウンドで続行したい場合には、ここで <code class="docutils literal notranslate"><span class="pre">fg</span></code> と入力すればよい&gt; (p. 213)</p></li>
<li><p>&lt;（いつものように）コマンドをフォアグラウンドに実行したところ、思ったよりも処理に時間がかかっていることに気付く。コマンドはきちんと終了させたいが、端末の制御を取り戻して他の作業も行いたい。このような場合には、CTRL+Z キーを押してから <code class="docutils literal notranslate"><span class="pre">bg</span></code> と入力すれば、ジョブをバックグラウンドに移すことができる&gt; (p. 214)
脚注のネットワーク経由での実行に関する注意も読む。</p></li>
</ul>
</section>
</section>
<section id="id6">
<h3><a class="toc-backref" href="#id36">8.3 シグナル</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>CTRL+Z と CTRL+C は、&lt;どちらもプロセスに <strong>シグナル</strong> を送信するという特殊な行動をとる&gt; (p. 214)</p></li>
<li><p>シグナルとは、あるプロセスから別のプロセスに送信されるメッセージととらえればよいようだ。</p></li>
<li><p>シグナルを使用するスクリプトを書くときは、可搬性を高めるために番号ではなく名前を使用する。
<code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">-l</span></code> で一覧できる。</p></li>
</ul>
<section id="id7">
<h4><a class="toc-backref" href="#id37">8.3.1 コントロールキーのシグナル</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;説明しておいて何だが、この方法はお勧めできないことを付け加えておかなければならない&gt; (p. 216)</p></li>
</ul>
</section>
<section id="kill">
<h4><a class="toc-backref" href="#id38">8.3.2 kill</a><a class="headerlink" href="#kill" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>デフォルトでは <code class="docutils literal notranslate"><span class="pre">kill</span></code> は TERM シグナルを送信する。ただ、効果としては INT シグナルと同じとのこと。</p></li>
<li><p>&lt;すべてを説明すると込み入った話になるので、次の説明で勘弁して欲しい&gt; (p. 216)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">%1</span></code> は「ジョブ番号 1 のプロセスを（TERM シグナルで）停止する」。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">-QUIT</span> <span class="pre">%1</span></code> は「ジョブ番号 1 のプロセスを（QUIT シグナルで）終了する」。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kill</span> <span class="pre">-KILL</span> <span class="pre">%1</span></code> は「ジョブ番号 1 のプロセスを（KILL シグナルで）終了する」。</p></li>
<li><p>&lt;TERM シグナルと QUIT シグナルは、プロセスを終了する前に「後始末」をする機会を設けるが、
KILL シグナルは、たとえ計算中であったとしても、プロセスを強制終了する。
<strong>KILL シグナルは最後の手段として使用すること。</strong>&gt; (pp. 217-218)</p></li>
</ul>
</section>
<section id="ps">
<h4><a class="toc-backref" href="#id39">8.3.3 ps</a><a class="headerlink" href="#ps" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;プロセス ID は <code class="docutils literal notranslate"><span class="pre">ps</span></code> コマンドで取得することができる&gt; (p. 218)</p></li>
<li><p>&lt;<code class="docutils literal notranslate"><span class="pre">ps</span></code> にはオプションが複数あるが、UNIX のバージョンによって異なる&gt; (p. 218)
Cygwin 環境では <code class="docutils literal notranslate"><span class="pre">ps</span> <span class="pre">-ax</span></code> が怒られるから、BSD ではなく System V 系統なのだろうか。</p></li>
</ul>
</section>
</section>
<section id="id8">
<h3><a class="toc-backref" href="#id40">8.4 トラップ</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<section id="id9">
<h4><a class="toc-backref" href="#id41">8.4.2 プロセス ID と一時ファイル</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;<code class="docutils literal notranslate"><span class="pre">$$</span></code> は、現在のシェルのプロセス ID を保持する特別なシェル変数である&gt; (p. 224)</p></li>
<li><p>&lt;<code class="docutils literal notranslate"><span class="pre">$!</span></code> には、最後に実行したバックグラウンドジョブのプロセス ID が含まれている&gt; (p. 224)</p></li>
<li><p>&lt;<code class="docutils literal notranslate"><span class="pre">trap</span></code> コマンドに指定されたコマンド文字列が、実行されるまで <strong>評価されない</strong> ことに注意しよう。したがって、コマンド文字列の <code class="docutils literal notranslate"><span class="pre">$msgfile</span></code> には、必ず正しい値が含まれる。コマンド文字列を単一引用符で囲んだのは、そのためである&gt; (p. 225)</p></li>
</ul>
</section>
<section id="id10">
<h4><a class="toc-backref" href="#id42">8.4.5 トラップのリセット</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trap</span></code> コマンドに引数としてハイフンだけを指定すると、シグナル受信時の動作がデフォルト（プロセスの中止）に戻る。</p></li>
</ul>
</section>
</section>
<section id="id11">
<h3><a class="toc-backref" href="#id43">8.5 コルーチン</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>&lt;2 つ（以上）のプロセスが同時に実行されるようにプログラムされていて、プロセスどうしが互いにやり取りすることが可能である場合、それらを <strong>コルーチン</strong>
(coroutine) という&gt; (p. 227)</p></li>
<li><p>&lt;パイプラインはコルーチンの一例だ&gt; (p. 227)</p></li>
</ul>
<section id="wait">
<h4><a class="toc-backref" href="#id44">8.5.1 wait</a><a class="headerlink" href="#wait" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;引数を指定しないと、
<code class="docutils literal notranslate"><span class="pre">wait</span></code> はバックグラウンドジョブがすべて終了するまで待機する&gt; (p. 228)</p></li>
</ul>
</section>
<section id="id12">
<h4><a class="toc-backref" href="#id45">8.5.2 コルーチンの利点と欠点</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>以下の用語がだいたい人に説明できる程度まで、複数プロセス同時実行のメリットに関する理解を深めたい。</p>
<ul class="simple">
<li><p>CPU 集約型</p></li>
<li><p>入出力集約型</p></li>
<li><p>対話型</p></li>
<li><p>スラッシンング</p></li>
</ul>
</section>
<section id="id13">
<h4><a class="toc-backref" href="#id46">8.5.3 並列化</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;プロセスをコルーチンに分割することを、ジョブを <strong>並列化</strong> するとも言う&gt; (p. 229)</p></li>
<li><p>&lt;この場合、コルーチンの実行時間は、すべてのプロセスの実行時間を合計したものではなく、基本的には、実行時間が最も長いものに若干のオーバーヘッドを足したものとなる（ただし、すべての CPU が 1 つのディスクドライブを共有していた場合、
I/O 関連のスラッシングの可能性はまだ消えない）&gt; (p. 230)</p></li>
<li><p>&lt;せっかく並列化を施して処理時間を短縮したのに、追加したコードの実行時間で相殺されてしまったのでは意味がない&gt; (p. 231)</p></li>
<li><p>&lt;複雑な並列プログラムになると、本体の目的を達成するコードよりも、特殊な状況に対応するコードのほうが圧倒的に多いほどである&gt; (p. 231)</p></li>
</ul>
</section>
</section>
<section id="id14">
<h3><a class="toc-backref" href="#id47">8.6 サブシェル</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<section id="id15">
<h4><a class="toc-backref" href="#id48">8.6.2 入れ子のサブシェル</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;シェルコードの一部を（中かっこではなく）かっこで囲むと、そのコードはサブシェルで実行される。これを <strong>入れ子</strong> の（またはネストした）サブシェルと言う&gt; (p. 232)</p>
<ul>
<li><p>通常は、コマンドブロック（中括弧）の場合よりも効率が悪い。</p></li>
<li><p>サブシェルとコマンドブロックの違いは、そのほとんどが「スコープ」に関係するもの。シェル変数やシグナルトラップの有効範囲が違う。</p></li>
</ul>
</li>
<li><p>&lt;コードの入れ子をサポートしている言語では、入れ子のコード内で定義されるものには、そこだけに限定されたスコープが割り当てられることが望ましい、とされている。このため、変数やシグナルトラップのスコープに関しては、入れ子のサブシェルのほうがコマンドブロックよりも厳密な制御が可能である。したがって、変数の定義やシグナルトラップが必要で、効率を度外視できるのであれば、コマンドブロックよりもサブシェルを使用したほうがよいだろう&gt; (p. 233)</p></li>
</ul>
</section>
</section>
<section id="id16">
<h3><a class="toc-backref" href="#id49">8.7 プロセス置換</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cmp &lt;<span class="o">(</span>program1<span class="o">)</span> &lt;<span class="o">(</span>program2<span class="o">)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">program1</span></code> と <code class="docutils literal notranslate"><span class="pre">program2</span></code> を同時に実行して、</p></li>
<li><p>それらの出力を <strong>名前付きパイプ</strong> につなぎ、</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cmp</span></code> がそれぞれのパイプからデータを読み取り、比較する。</p></li>
</ol>
</section>
</section>
<section id="id17">
<h2><a class="toc-backref" href="#id50">9 章 シェルプログラミングのデバッグ</a><a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h2>
<section id="id18">
<h3><a class="toc-backref" href="#id51">9.1 基本的なデバッグ補助</a><a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<section id="set">
<h4><a class="toc-backref" href="#id52">9.1.1 set のオプション</a><a class="headerlink" href="#set" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>組み込み変数 <code class="docutils literal notranslate"><span class="pre">PS4</span></code> は <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">-o</span> <span class="pre">xtrace</span></code> の出力行の先頭の文字列。展開レベル次第で、出力行の先頭の文字列の先頭に <code class="docutils literal notranslate"><span class="pre">PS4</span></code> の 1 文字目が付加される。</p></li>
</ul>
</section>
</section>
<section id="bash">
<h3><a class="toc-backref" href="#id53">9.2 bash デバッガ</a><a class="headerlink" href="#bash" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>&lt;プログラムにおいて実行を停止する場所を指定する。これを <strong>ブレークポイント</strong> という&gt; (p. 245)</p></li>
<li><p>&lt;プログラムにおいて指定された数の文を実行する。これを <strong>ステップ実行</strong> という&gt; (p. 245)</p></li>
<li><p>&lt;<code class="docutils literal notranslate"><span class="pre">exec</span></code> に引数としてコマンドラインを渡すと、それらは現在のプログラム（同じプロセス）で実行される。したがって、<code class="docutils literal notranslate"><span class="pre">exec</span></code> を実行するとシェルが <strong>直ちに停止し、</strong>
<code class="docutils literal notranslate"><span class="pre">exec</span></code> の引数と置換される&gt; (p. 247)</p>
<p><code class="docutils literal notranslate"><span class="pre">exec</span></code> が危険な存在であることを指摘している。</p>
</li>
</ul>
</section>
</section>
<section id="id19">
<h2><a class="toc-backref" href="#id54">10 章 bash の管理</a><a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h2>
<section id="id20">
<h3><a class="toc-backref" href="#id55">10.1 標準シェルとしての bash のインストール</a><a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>&lt;1 行目では、<code class="docutils literal notranslate"><span class="pre">$PATH</span></code> 環境変数を
<code class="docutils literal notranslate"><span class="pre">for</span></code> ループの項目リストとして使用できるようにしている&gt; (p. 268)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">IFS</span><span class="o">=</span>:
<span class="k">for</span> d <span class="k">in</span> <span class="nv">$PATH</span><span class="p">;</span> <span class="k">do</span>
    <span class="c1"># 何か処理</span>
</pre></div>
</div>
</li>
</ul>
<section id="posix">
<h4><a class="toc-backref" href="#id56">10.1.1 POSIX モード</a><a class="headerlink" href="#posix" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>POSIX は Portable Operating System Interface の略らしい。X はどこから？</p></li>
<li><p>&lt;<code class="docutils literal notranslate"><span class="pre">bash</span></code> はデフォルトのモードでも POSIX にほぼ 100% 準拠している。
POSIX へのこだわりがあるならば、<code class="docutils literal notranslate"><span class="pre">bash</span></code> を POSIX モードで実行することができる。そのためには、<code class="docutils literal notranslate"><span class="pre">--posix</span></code> オプションを指定するか、シェルで <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">-o</span> <span class="pre">posix</span></code> を設定する&gt; (p. 269)</p></li>
</ul>
</section>
<section id="id21">
<h4><a class="toc-backref" href="#id57">10.1.2 コマンドラインオプション</a><a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p>表 10-1 より、使えそうなものをノート：</p>
<dl class="option-list">
<dt><kbd><span class="option">-c <var>string</var></span></kbd></dt>
<dd><p><em>string</em> からコマンドを読み取る。</p>
</dd>
<dt><kbd><span class="option">-i</span></kbd></dt>
<dd><p>対話型シェル。</p>
</dd>
<dt><kbd><span class="option">-l</span>, <span class="option">--login</span></kbd></dt>
<dd><p>ログインシェル。</p>
</dd>
<dt><kbd><span class="option">--help</span></kbd></dt>
<dd><p>使用法を示すメッセージを表示する。</p>
</dd>
<dt><kbd><span class="option">--noprofile</span></kbd></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">/etc/profile</span></code> やユーザーの初期設定ファイルをロードしない。</p>
</dd>
<dt><kbd><span class="option">--norc</span></kbd></dt>
<dd><p>対話型シェルの場合、<code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> をロードしない。</p>
</dd>
<dt><kbd><span class="option">--rcfile <var>file</var></span></kbd></dt>
<dd><p>対話型シェルの場合、<code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code> の代わりに <em>file</em> をロードする。</p>
</dd>
<dt><kbd><span class="option">--init-file <var>file</var></span></kbd></dt>
<dd><p>同上。</p>
</dd>
</dl>
</li>
<li><p>&lt;コマンドラインで複数文字のオプションを指定する場合には、
1 文字のオプションよりも前に指定しなければならない&gt; (p. 270)</p></li>
</ul>
</section>
</section>
<section id="id22">
<h3><a class="toc-backref" href="#id58">10.2 環境のカスタマイズ</a><a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bash</span></code> は <code class="docutils literal notranslate"><span class="pre">/etc/profile</span></code> を読み込んでから <code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code> を読み込む。
<code class="docutils literal notranslate"><span class="pre">umask</span></code> や <code class="docutils literal notranslate"><span class="pre">ulimit</span></code> コマンドを使用するのは前者。</p></li>
</ul>
<section id="umask">
<h4><a class="toc-backref" href="#id59">10.2.1 umask</a><a class="headerlink" href="#umask" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;ここでは 8 進表記を使用して <code class="docutils literal notranslate"><span class="pre">umask</span></code> の説明をする。おそらく知っていると思うが、パーミッションの数字は、（左から右に）所有者、所有者が属するグループ、その他のユーザーへのパーミッションを表す。数字はそれぞれ 3 ビットで構成され、左から右に、読み取り、書き込み、実行のパーミッションを指定する。（ファイルがディレクトリの場合、「実行」パーミッションは「検索」パーミッションとなる。検索パーミッションとは、ディレクトリを移動したりファイルの一覧を取得したりするためのパーミッションである&gt; (p. 271)</p></li>
</ul>
</section>
<section id="ulimit">
<h4><a class="toc-backref" href="#id60">10.2.2 ulimit</a><a class="headerlink" href="#ulimit" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ulimit</span></code> コマンドで、ユーザーが利用できるシステムリソースに制限を設けることができる。</p></li>
</ul>
</section>
</section>
</section>
<section id="id23">
<h2><a class="toc-backref" href="#id61">11 章 シェルスクリプティング</a><a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<p>本章では、&lt;保守可能なシェルスクリプトを作成する方法を紹介&gt; (p. 279) するようだ。</p>
<section id="id24">
<h3><a class="toc-backref" href="#id62">11.1 スクリプトは何をするのか</a><a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<section id="id25">
<h4><a class="toc-backref" href="#id63">11.1.2 変数と定数</a><a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>&lt;ヘッダーとコメントは、コードを文書化するための方法の 1 つにすぎない&gt; (p. 281)</p></li>
<li><p>&lt;よい名前とは、短くてわかりやすいものである。（略）長い名前にしてはならない。（略）わかりやすい名前のメリットを帳消しにするほど、スクリプトを煩雑にするだけである&gt; (p. 281)</p></li>
</ul>
</section>
</section>
<section id="id26">
<h3><a class="toc-backref" href="#id64">11.2 スクリプトの起動</a><a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>&lt;プログラマはユーザーの操作ができるだけ楽になるように努力しなければならない&gt; (p. 281)</p></li>
<li><p>&lt;Free Software Foundation では、GNU ソフトウェアを作成するためのガイドラインを公開し、
UNIX ユーティリティの標準的な使用法を提案している&gt; (p. 282) URL が脚注にある。</p></li>
<li><p>&lt;注意しなければならない点が 1 つある。それは、ユーザーの環境において特定の環境変数が設定されていることを前提とする場合である。環境変数が設定されていることをあてにするくらいなら、スクリプトの設計を見直して、その値を引数として指定できるようにしたほうがよいだろう&gt; (p. 283)</p></li>
</ul>
</section>
<section id="id27">
<h3><a class="toc-backref" href="#id65">11.3 その他の問題点</a><a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">bash</span></code> スクリプトに関するものだけノート。</p>
<ul class="simple">
<li><p>必ず <code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code> とすること。</p></li>
<li><p>ホワイトスペースに注意する。等号の前後、開き括弧の後ろ、閉じ括弧の前が危ない。</p></li>
<li><p>評価演算子 <code class="docutils literal notranslate"><span class="pre">[...]</span></code> の使用に注意。<code class="docutils literal notranslate"><span class="pre">=</span></code> なのか <code class="docutils literal notranslate"><span class="pre">-eq</span></code> なのか等。</p></li>
</ul>
</section>
<section id="id28">
<h3><a class="toc-backref" href="#id66">11.4 bash を使用しない</a><a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>大量の処理をすばやく実行する場合や、数学的な計算を要する場合は C/C++ の使用を検討したり、システム間の可搬性を重視する場合は、
Python や Perl のほうが適しているといった判断をすること。適材適所。</p></li>
</ul>
</section>
</section>
<section id="id29">
<h2><a class="toc-backref" href="#id67">12 章 bash の導入</a><a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h2>
<p>Cygwin ユーザーである記者は特に読まなくてよい？</p>
</section>
<section id="a">
<h2><a class="toc-backref" href="#id68">付録 A 関連シェル</a><a class="headerlink" href="#a" title="Permalink to this headline">¶</a></h2>
<section id="a-3-korn">
<h3><a class="toc-backref" href="#id69">A.3 Korn シェル</a><a class="headerlink" href="#a-3-korn" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>&lt;唯一の欠点は、数年おきにしかアップグレードされないことだ&gt; (p. 302)
とある。今でもそうなのだろうか。</p></li>
</ul>
</section>
<section id="a-5-zsh">
<h3><a class="toc-backref" href="#id70">A.5 zsh</a><a class="headerlink" href="#a-5-zsh" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>&lt;特に「パワーユーザー」にお勧めである&gt; (p. 303)</p></li>
</ul>
</section>
</section>
<section id="b">
<h2><a class="toc-backref" href="#id71">付録 B リファレンス</a><a class="headerlink" href="#b" title="Permalink to this headline">¶</a></h2>
<section id="b-8">
<h3><a class="toc-backref" href="#id72">B.8 入出力リダイレクト</a><a class="headerlink" href="#b-8" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>出力・エラーリダイレクトには <code class="docutils literal notranslate"><span class="pre">&amp;&gt;file</span></code> と <code class="docutils literal notranslate"><span class="pre">&gt;&amp;file</span></code> の 2 つの形式がある。後者のほうが望ましい。</p></li>
</ul>
</section>
</section>
<section id="d">
<h2><a class="toc-backref" href="#id73">付録 D プログラム可能な補完</a><a class="headerlink" href="#d" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>&lt;補完メカニズムにフックを仕掛けて、
2 章で説明した組み込みのテキスト補完機能を拡張するものである&gt; (p. 333)</p></li>
<li><p>TAB キーが押されたときのシェルの対応を <code class="docutils literal notranslate"><span class="pre">complete</span></code> コマンドで指定する。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># -A file が「補完するのはファイルリストだ」ということを指示する</span>
<span class="c1">#</span>
<span class="c1"># -X &#39;!*.@(Z|gz|tgz)&#39; がファイル名パターンのフィルターを指示する</span>
<span class="nb">complete</span> -A file -X <span class="s1">&#39;!*.@(Z|gz|tgz)&#39;</span> gunzip
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">compgen</span></code> は補完文字列を確認するのに利用できる。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">complete</span> -A file -X <span class="s1">&#39;!*.@(Z|gz|tgz)&#39;</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../tsuboi05/index.html" title="幾何学 I 多様体入門 読書ノート"
             >next</a></li>
        <li class="right" >
          <a href="note2.html" title="入門 bash 読書ノート 2/3"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >入門 bash 読書ノート</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">入門 bash 読書ノート 3/3</a></li> 
      </ul>
    </div>
    <div id="footer">
      <div id="footer_logo">
        <a class="imga" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png" width="88" height="31" /></a>
      </div>
      <div id="footer_copyright">
        Since 1999<br />
        Copyright &copy; 1999-2021, プレハブ小屋 All rights reserved.
      </div>
    </div>
  </body>
</html>