
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>常微分方程式 &#8212; 読書ノート 1.5dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="../_static/mathjax-v3.js"></script>
    <script src="../_static/mermaid.js"></script>
    <link rel="next" title="偏微分方程式" href="pde.html" />
    <link rel="prev" title="積分" href="integrals.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="integrals.html" title="Previous document">積分</a>
        </li>
        <li>
          <a href="pde.html" title="Next document">偏微分方程式</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id24">常微分方程式</a><a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h1>
<p>モジュール <code class="docutils literal notranslate"><span class="pre">sympy.solvers.ode</span></code> が提供する、常微分方程式を解くための機能に関する覚え書きを記す。</p>
<div class="contents topic" id="id2">
<p class="topic-title">ノート目次</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id24">常微分方程式</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id25">基本機能</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id26">下回りの機能</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id27">特化型ソルバー</a></p></li>
<li><p><a class="reference internal" href="#id6" id="id28">連立常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id29">演習</a></p>
<ul>
<li><p><a class="reference internal" href="#id8" id="id30">常微分方程式</a></p>
<ul>
<li><p><a class="reference internal" href="#id9" id="id31">使い方</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id32">求積法だけで解が求まる常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id11" id="id33">変数分離形常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id34">一階同次常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id35">一階線形常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#bernoulli" id="id36">Bernoulli 常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#riccati" id="id37">Riccati 常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id14" id="id38">定数係数二階線形常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#euler" id="id39">Euler 常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id40">特殊な二階常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id16" id="id41">二階線形非同次常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id17" id="id42">二階非線形常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id18" id="id43">定数係数高階線形常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id19" id="id44">高階 Euler 常微分方程式</a></p></li>
<li><p><a class="reference internal" href="#id20" id="id45">特殊な高階常微分方程式</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id21" id="id46">連立常微分方程式</a></p>
<ul>
<li><p><a class="reference internal" href="#id22" id="id47">線形</a></p></li>
<li><p><a class="reference internal" href="#id23" id="id48">非線形</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>紙幅の都合上、出力を一部手で改行した。</p>
<p>本文中のすべての IPython セッション中のサンプルコードで、以下のインポートおよび出力書式設定が済んでいるものとする。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_printing</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id25">基本機能</a><a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<p>ここに記す関数は isympy シェルがデフォルトで実行するインポート <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">sympy</span> <span class="pre">import</span> <span class="pre">*</span></code> だけで利用可能だ。</p>
<p>SymPy で常微分方程式を解くには、関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> を用いる。簡単なケースではこれ一本で事足りる。何か凝ったことをする場合に、その他の関数やデータを併用するという方針でよさそうだ。</p>
<dl>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">dsolve(eq,</span> <span class="pre">...)</span></code></dt><dd><p>常微分方程式系を解く。</p>
<p>方程式を一個解くときには、引数 <code class="code docutils literal notranslate"><span class="pre">eq</span></code> には何か導関数を含むような数式オブジェクトを指定する。方程式を複数個解くときには、同様に数式オブジェクトの list オブジェクトを指定する。ソルバーは各方程式が 0 と等しい条件を求める。</p>
<ul>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">func=None</span></code> は <code class="code docutils literal notranslate"><span class="pre">eq</span></code> がどの一変数関数に関する微分方程式なのかを指示する。方程式を複数個解くときには、やはり list の形式をとる。普通はソルバーが自動検出するため、指定しない。</p></li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">hint='default'</span></code> ではソルバーに微分方程式のタイプについてヒントを教える。このヒントによって方程式の解法を調整することになる。</p>
<p>方程式を一個解くときには、与え得るパラメーターは次のとおり（すべて文字列だが、引用符を省略する）。</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">default</span></code>: 後述の関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode(eq,</span> <span class="pre">...)</span></code> にて記す。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">all</span></code>: 全部の解法候補を適用する。この場合はソルバーの戻り値がキーと値をタイプ名と解からなる dict オブジェクトになる。タイプ名は文字列で、解は Equality オブジェクトだと思われる。それに加えて、ベスト解や階数等の副次的な情報も併せて含む。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">all_Integral</span></code>: <code class="code docutils literal notranslate"><span class="pre">all</span></code> と同様に振る舞うが、もしタイプ xxx とタイプ xxx_Integral が候補にある場合、前者を省略するという点が異なる。後者の解法は結果オブジェクト内に Integral オブジェクトが未評価のまま残るが、計算処理が速いという特徴がある。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">best</span></code>: 全部の候補を試して、もっとも解が単純なものを返す。</p></li>
<li><p>あるいはユーザーが別途関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode(eq,</span> <span class="pre">...)</span></code> を呼び出して得たタイプのうちの一つ。</p></li>
</ul>
</li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">simplify=True</span></code> はソルバー内部が関数 <code class="code docutils literal notranslate"><span class="pre">odesimp</span></code> を呼び出すかどうかを指定する。</p></li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">ics=None</span></code> は境界条件を dict オブジェクトで指定できる。</p>
<ul class="simple">
<li><p>キーの例 <code class="code docutils literal notranslate"><span class="pre">func(x0)</span></code>, <code class="code docutils literal notranslate"><span class="pre">func(x).diff(x).subs(x,</span> <span class="pre">x2)</span></code></p></li>
<li><p>利用可能になる条件は一階常微分方程式のべき級数？</p></li>
</ul>
</li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">xi=None</span></code> および <code class="code docutils literal notranslate"><span class="pre">eta=None</span></code> は無限小関数。後述する関数 <code class="code docutils literal notranslate"><span class="pre">infinitesimals</span></code> の項で解説する。</p></li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">x0=0</span></code> は微分方程式のべき級数解をどの点周りに評価するかを指定する。</p></li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">n=6</span></code> はべき級数の指数をどこまで上げてよいかを指定する。</p></li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode(eq,</span> <span class="pre">...)</span></code></dt><dd><p>常微分方程式 <code class="code docutils literal notranslate"><span class="pre">eq</span> <span class="pre">==</span> <span class="pre">0</span></code> のタイプを返す。微分方程式の教科書と考え方は同じで、ソルバーは微分方程式を解く手法を何種類かに名前をつけて分類している。この関数は与えられた微分方程式を解くのに相応しいであろう手法の名前を列挙するものだ。</p>
<ul class="simple">
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">func=None</span></code> および <code class="code docutils literal notranslate"><span class="pre">ics=None</span></code> はソルバー関数と同じ。</p></li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">dict=False</span></code> はソルバー関数が内々に利用するもの。</p></li>
<li><p>戻り値は文字列からなる tuple オブジェクトである。</p>
<ul>
<li><p>ソルバーが方程式を解くのにデフォルトで採用するのは、この最初のタイプである。特定の方法で解かせたいならば、関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> の <code class="code docutils literal notranslate"><span class="pre">hint</span></code> として、この候補のいずれかのタイプを指定する。</p></li>
<li><p>タイプは基本的には「このタイプとみなせば、方程式を解きやすいだろう」という順序で列挙されている。</p></li>
</ul>
</li>
<li><p>サポートするタイプは <code class="code docutils literal notranslate"><span class="pre">allhints</span></code> という tuple オブジェクトが知っている。手許の環境では 34 個ある。</p></li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">checkodesol(ode,</span> <span class="pre">sol,</span> <span class="pre">...)</span></code></dt><dd><p>これは微分方程式の解を求めた後に、それを検算するのに用いる。オブジェクト <code class="code docutils literal notranslate"><span class="pre">sol</span></code> をソルバーに渡したものと同じ <code class="code docutils literal notranslate"><span class="pre">ode</span></code> に代入して、ゼロになることを見たい。</p>
<ul class="simple">
<li><p>戻り値は 2 要素の tuple である。</p>
<ul>
<li><p>[0]: 代入結果がゼロならば True であり、そうでなければ False である。</p></li>
<li><p>[1]: [0] が True ならば <code class="docutils literal notranslate"><span class="pre">0</span></code> である（逆は必ずしも成り立たない）。それ以外は代入結果が何になったのかを表現する値が入る。</p></li>
</ul>
</li>
<li><p>この関数の呼び出しがなかなか返って来ないときは、間違いなく <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> がキツイためだろう。</p></li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">homogeneous_order(eq,</span> <span class="pre">*symbols)</span></code></dt><dd><p>同次方程式 <code class="code docutils literal notranslate"><span class="pre">eq</span> <span class="pre">==</span> <span class="pre">0</span></code> の次数を返す。</p>
<ul class="simple">
<li><p>非同次であれば None を返す。</p></li>
<li><p>シンボル関数も <code class="code docutils literal notranslate"><span class="pre">eq</span></code> になれるが、関数のすべての変数がシンボルである必要がある。なおかつ、数式中のその関数の変数が <code class="code docutils literal notranslate"><span class="pre">*symbols</span></code> にマッチしている必要がある。</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id26">下回りの機能</a><a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<p>ここからはモジュール <code class="docutils literal notranslate"><span class="pre">sympy.solvers.ode</span></code> からの明示的なインポートを必要とする機能を記す。</p>
<dl>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">infinitesimals(eq,</span> <span class="pre">...)</span></code></dt><dd><p>一階常微分方程式 <span class="math notranslate nohighlight">\(y^\prime = f(x, y)\)</span> に対して、次の条件をみたすような点変換 <span class="math notranslate nohighlight">\(\xi(x, y)\)</span> と <span class="math notranslate nohighlight">\(\eta(x, y)\)</span> を返す：</p>
<p>これらの点変換が次のリー群について、元の <span class="math notranslate nohighlight">\(f\)</span> を用いて変換先の各変数に関する微分方程式 <span class="math notranslate nohighlight">\((y^*)^\prime=f(x^*, y^*)\)</span> が成り立つ。</p>
<div class="math notranslate nohighlight">
\begin{aligned}
x^* &amp;= X(x, y;\eps) = x + \eps \xi(x, y),\\
y^* &amp;= Y(x, y;\eps) = y + \eps \eta(x, y)
\end{aligned}</div><ul class="simple">
<li><p>戻り値は dict の list の型をとる。内側の dict は、キーが点変換関数オブジェクトで、値が Function 系オブジェクトまたは定数である。</p></li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">hint</span></code> を用いて、点変換関数の計算方法のヒューリスティックを調整できるもよう。</p></li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">checkinfsol(eq,</span> <span class="pre">infinitesimals,</span> <span class="pre">...)</span></code></dt><dd><p>この関数は上述の関数 <code class="code docutils literal notranslate"><span class="pre">infinitesimals</span></code> の結果を検証するのに用いられる。</p>
<ul>
<li><p>引数 <code class="code docutils literal notranslate"><span class="pre">infinitesimals</span></code> の型は（というか値は）先ほどの関数の戻り値と同じようにする。</p></li>
<li><p>戻り値は list オブジェクトである。この要素は各点変換のペアに対応するブーリアン値と検算結果の値とのペアである。検算結果とは、次の偏微分に点変換関数を代入して評価した値である。</p>
<div class="math notranslate nohighlight">
\begin{align*}
\frac{\partial \eta}{\partial x} + \left(\frac{\partial \eta}{\partial y}
 - \frac{\partial \xi}{\partial x}\right)\diff{y}{x}
 - \frac{\partial \xi}{\partial y} \left(\diff{y}{x}\right)^{2}
 - \xi\frac{\partial h}{\partial x} - \eta\frac{\partial h}{\partial y}
\end{align*}</div><p>すなわち、妥当な関数を与えればリストが含む要素はすべて <code class="code docutils literal notranslate"><span class="pre">(True,</span> <span class="pre">0)</span></code> となる。</p>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">odesimp(eq,</span> <span class="pre">func,</span> <span class="pre">order,</span> <span class="pre">constants,</span> <span class="pre">hint)</span></code></dt><dd><p>常微分方程式の単純化処理のための関数。</p>
<ul class="simple">
<li><p>関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> が本関数を呼び出すので、これを単体で利用するケースというのは一般ユーザーにはまれだということだ。</p></li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">constant_renumber(expr,</span> <span class="pre">symbolname,</span> <span class="pre">startnumber,</span> <span class="pre">endnumber)</span></code></dt><dd><p>式に含まれる任意定数の番号付けを変更する関数。</p>
<p>式 <code class="code docutils literal notranslate"><span class="pre">expr</span></code> 中にはいくつかの Symbol オブジェクトがあるという前提。そのオブジェクト名が <code class="code docutils literal notranslate"><span class="pre">symbolname</span></code> に末尾から数字のくっついたもので、さらにその数字が範囲 <cite>[startnumber, endnumber)</cite> にあれば、リネームの対象になる。新たに 1 から範囲の長さまでの連番が振られる。</p>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">constantsimp(expr,</span> <span class="pre">constants)</span></code></dt><dd><p>式に含まれる任意定数に対する単純化処理のための関数。</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">C1</span> <span class="pre">+</span> <span class="pre">C2</span></code> → <code class="code docutils literal notranslate"><span class="pre">C1</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">C1</span> <span class="pre">*</span> <span class="pre">C2</span></code> → <code class="code docutils literal notranslate"><span class="pre">C1</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">exp(C1)</span></code> → <code class="code docutils literal notranslate"><span class="pre">C1</span></code></p></li>
<li><p>etc.</p></li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">ode_sol_simplicity(sol,</span> <span class="pre">func,</span> <span class="pre">trysolving=True)</span></code></dt><dd><p>解の簡単さを示す数値を返す関数。例えば <code class="code docutils literal notranslate"><span class="pre">ode_sol_simplicity(A,</span> <span class="pre">f)</span> <span class="pre">&lt;</span> <span class="pre">ode_sol_simplicity(B,</span> <span class="pre">f)</span></code> なる <code class="code docutils literal notranslate"><span class="pre">A</span></code> と <code class="code docutils literal notranslate"><span class="pre">B</span></code> については、
<code class="code docutils literal notranslate"><span class="pre">A</span></code> のほうが <code class="code docutils literal notranslate"><span class="pre">B</span></code> よりも解が簡単であると解釈する。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-2</span></code> や <code class="docutils literal notranslate"><span class="pre">-1</span></code> が戻ってくる場合は「解けている」または「解けていないが、解ける」を意味する。</p></li>
<li><p>何か正の整数が戻ってくる場合は「解けない」か「与えられた <code class="code docutils literal notranslate"><span class="pre">func</span></code> について解けない」を意味する。この値は解の文字列的な長さである。長い方程式のほうが難しそうだからこうしたのか。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">oo</span></code> が戻ってくる場合、解が未評価の Integral オブジェクトを含むことを意味する。</p></li>
<li><p>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">trysolving</span></code> は、ユーザーが既に解が解けないことを知っているときに利用できる。値 False を指示することで、計算を省略する。</p>
<ul>
<li><p><code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> の <code class="code docutils literal notranslate"><span class="pre">simplify=False</span></code> と連動している。</p></li>
</ul>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id27">特化型ソルバー</a><a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<p>SymPy のドキュメントが関数名と微分方程式の数式 (LaTeX) を併記していて素晴らしいので、カタログのように参照すると目当てのタイプのソルバーが提供されているかどうかはすぐにわかるだろう。</p>
<p>ここでは関数名だけを列挙するに留める。対応するヒント名を併記するとメモ代わりになるか。</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_1st_exact</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_1st_homogeneous_coeff_subs_dep_div_indep</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_1st_homogeneous_coeff_subs_indep_div_dep</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_1st_linear</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_almost_linear</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_Bernoulli</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_linear_coefficients</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_Liouville</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_nth_linear_constant_coeff_homogeneous</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_nth_linear_constant_coeff_undetermined_coefficients</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_nth_linear_constant_coeff_variation_of_parameters</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_Riccati_special_minus2</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_separable</span></code></p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">ode_separable_reduced</span></code></p></li>
</ul>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id28">連立常微分方程式</a><a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<p>連立常微分方程式を <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> に評価させると、最初に関数 <code class="code docutils literal notranslate"><span class="pre">classify_sysode</span></code> を呼ぶ。これで方程式のタイプを判定して、特化型のソルバーに処理を委ねる。</p>
<p>このタイプ判定が下の図のように入れ子になっていて、末端のソルバーでは結局 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> を単一の方程式に対して適用することを繰り返す。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>sysode_linear_neq_order&lt;M&gt;
    sysode_linear_neq_order1
        _linear_neq_order1_type1
sysode_linear_&lt;N&gt;eq_order&lt;M&gt;
    sysode_linear_2eq_order1
        _linear_2eq_order1_type&lt;i&gt; i: 1-7
    sysode_linear_2eq_order2
        _linear_2eq_order2_type&lt;i&gt; i: 1-11
    sysode_linear_3eq_order1
        _linear_3eq_order1_type&lt;i&gt; i: 1-4
        _linear_neq_order1_type1 も流用。
sysode_nonlinear_&lt;N&gt;seq_order&lt;M&gt;
    sysode_nonlinear_2eq_order1
        _nonlinear_2eq_order1_type&lt;i&gt; i: 1-4
    sysode_nonlinear_3eq_order1
        _nonlinear_3eq_order1_type&lt;i&gt; i: 1-5
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2><a class="toc-backref" href="#id29">演習</a><a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h2>
<p>ここに出てくる微分方程式は次の文書から拝借した。</p>
<ul class="simple">
<li><p><a class="reference external" href="http://reference.wolfram.com/language/tutorial/DSolveOverview.html">DSolveで解く微分方程式</a></p></li>
<li><p><a class="reference external" href="http://math.stackexchange.com/questions/650774/non-homogeneous-2nd-order-euler-cauchy-differential-equation">Non-homogeneous 2nd order Euler-Cauchy differential equation</a></p></li>
</ul>
<p>演習で得た自分なりのコツを次にまとめる。</p>
<ul class="simple">
<li><p>長い数式で表現される常微分方程式は SymPy のオブジェクトとしても長い表現になる。何度もタイプするハメにならぬように、素直にローカル変数を宣言してバインドしておく。</p></li>
<li><p>ソルバーに渡す前に関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode</span></code> で常微分方程式のタイプを判定しておく。その結果が次の <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> 呼び出しの <code class="code docutils literal notranslate"><span class="pre">hint</span></code> パラメーターを
<code class="code docutils literal notranslate"><span class="pre">all</span></code> にするか <code class="code docutils literal notranslate"><span class="pre">all_Integral</span></code> にするかの判断材料になる。</p>
<ul>
<li><p>空の tuple オブジェクトが戻ってくるようならば、残念だがその常微分方程式を SymPy で解くのを諦める。</p></li>
</ul>
</li>
<li><p>関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> を呼び出すときは許される限り <code class="code docutils literal notranslate"><span class="pre">all_Integral</span></code> を指定する。この戻り値をザッと見ると、未評価の積分オブジェクトが一般解に含まれているだろう。必要ならばこれを <code class="code docutils literal notranslate"><span class="pre">doit()</span></code> にて手動で遅延評価する。</p></li>
</ul>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id30">常微分方程式</a><a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<p>連立しないほうのパターン。</p>
<div class="section" id="id9">
<h4><a class="toc-backref" href="#id31">使い方</a><a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h4>
<p>例えば微分方程式 <span class="math notranslate nohighlight">\(y^\prime = y\)</span> を解くには次のようにするのがいちばん早い：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsolve</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">Eq(f(x), C1*exp(x))</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h4><a class="toc-backref" href="#id32">求積法だけで解が求まる常微分方程式</a><a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h4>
<p>次のデモは単に <code class="code docutils literal notranslate"><span class="pre">integrate</span></code> するだけで解が得られる常微分方程式を与えるものだ。
SymPy のソルバーは一階線形常微分方程式の特別に単純な場合として処理する。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="go">{&#39;nth_linear_constant_coeff_variation_of_parameters_Integral&#39;: Eq(f(x), C1 - Integral(-x**2*sin(x) + sqrt(x**2 + 1), x)),</span>
<span class="go"> &#39;Bernoulli_Integral&#39;: Eq(f(x), C1 - Integral(-x**2*sin(x) + sqrt(x**2 + 1), x)),</span>
<span class="go"> &#39;1st_linear_Integral&#39;: Eq(f(x), C1 + Integral(x**2*sin(x) - sqrt(x**2 + 1), x)),</span>
<span class="go"> &#39;nth_algebraic_Integral&#39;: Eq(f(x), C1 + Integral(x**2*sin(x) - sqrt(x**2 + 1), x)),</span>
<span class="go"> &#39;1st_exact_Integral&#39;: Eq(Subs(Integral(1, _y) + Integral(-x**2*sin(x) + sqrt(x**2 + 1), x), _y, f(x)), C1),</span>
<span class="go"> &#39;separable_Integral&#39;: Eq(Integral(1, (_y, f(x))), C1 + Integral(x**2*sin(x) - sqrt(x**2 + 1), x)),</span>
<span class="go"> &#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters_Integral&#39;: Eq(f(x), C1 - Integral(-x**2*sin(x) + sqrt(x**2 + 1), x)),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), C1 - Integral(-x**2*sin(x) + sqrt(x**2 + 1), x)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;Bernoulli_Integral&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;nth_algebraic&#39;,</span>
<span class="go"> &#39;order&#39;: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">Eq(f(x), C1 - x**2*cos(x) - x*sqrt(x**2 + 1)/2 + 2*x*sin(x) + 2*cos(x) - asinh(x)/2)</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h4><a class="toc-backref" href="#id33">変数分離形常微分方程式</a><a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h4>
<p>変数分離系は微分方程式入門の最初の方に乗っている基本形だ。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">(&#39;separable&#39;,</span>
<span class="go"> &#39;1st_exact&#39;,</span>
<span class="go"> &#39;Bernoulli&#39;,</span>
<span class="go"> &#39;1st_power_series&#39;,</span>
<span class="go"> &#39;lie_group&#39;,</span>
<span class="go"> &#39;separable_Integral&#39;,</span>
<span class="go"> &#39;1st_exact_Integral&#39;,</span>
<span class="go"> &#39;Bernoulli_Integral&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">{&#39;Bernoulli_Integral&#39;: Eq(f(x), 1/(C1 + Integral(-x**2/sqrt(3 - x**2), x))),</span>
<span class="go"> &#39;1st_exact&#39;: Eq(f(x), 2/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3))),</span>
<span class="go"> &#39;1st_power_series&#39;: Eq(f(x), C1 + sqrt(3)*C1**2*x**3/9 + sqrt(3)*C1**2*x**5/90 + O(x**6)),</span>
<span class="go"> &#39;lie_group&#39;: Eq(f(x), 2/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3))),</span>
<span class="go"> &#39;Bernoulli&#39;: Eq(f(x), 1/(C1 + x*sqrt(3 - x**2)/2 - 3*asin(sqrt(3)*x/3)/2)),</span>
<span class="go"> &#39;1st_exact_Integral&#39;: Eq(Subs(Integral(_y**(-2), _y) + Integral(-x**2/sqrt(3 - x**2), x), _y, f(x)), C1),</span>
<span class="go"> &#39;separable&#39;: Eq(f(x), 2/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3))),</span>
<span class="go"> &#39;separable_Integral&#39;: Eq(Integral(_y**(-2), (_y, f(x))), C1 + Integral(x**2/sqrt(3 - x**2), x)),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), 2/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3))),</span>
<span class="go"> &#39;best_hint&#39;: &#39;separable&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;separable&#39;,</span>
<span class="go"> &#39;order&#39;: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">Eq(f(x), 2/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3)))</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">{&#39;separable&#39;: Eq(f(x), log(1/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3))) + log(2)),</span>
<span class="go"> &#39;1st_power_series&#39;: Eq(f(x), sqrt(3)*x**3*exp(C1)/9 + sqrt(3)*x**5*exp(C1)/90 + C1 + O(x**6)),</span>
<span class="go"> &#39;separable_Integral&#39;: Eq(Integral(exp(-_y), (_y, f(x))), C1 + Integral(x**2/sqrt(3 - x**2), x)),</span>
<span class="go"> &#39;lie_group&#39;: Eq(f(x), log(2/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3)))),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), log(1/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3))) + log(2)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;separable&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;separable&#39;,</span>
<span class="go"> &#39;order&#39;: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">Eq(f(x), log(1/(C1 + x*sqrt(3 - x**2) - 3*asin(sqrt(3)*x/3))) + log(2))</span>
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h4><a class="toc-backref" href="#id34">一階同次常微分方程式</a><a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h4>
<p>変数変換 <span class="math notranslate nohighlight">\(z = y/x\)</span> で変数分離形常微分方程式になるものを一つ示す。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">Eq(f(x), x*sqrt(C1*x**4 + 2)/2)],</span>
<span class="go"> &#39;best&#39;: Eq(f(x), sqrt(x**6*(C1 + 1/(2*x**4)))),</span>
<span class="go"> &#39;best_hint&#39;: &#39;Bernoulli&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;Bernoulli&#39;,</span>
<span class="go"> &#39;order&#39;: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">Eq(f(x), sqrt(x**6*(C1 + 1/(2*x**4))))</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h4><a class="toc-backref" href="#id35">一階線形常微分方程式</a><a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h4>
<p>一階線形方程式の例だ。非同次項があるものを試す。
<code class="docutils literal notranslate"><span class="pre">exp</span></code> と <code class="docutils literal notranslate"><span class="pre">Integral</span></code> が目につくのがいかにもそれらしい。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">{&#39;almost_linear&#39;: Eq(f(x), (C1 + Integral(exp(3*x)*exp(x**2/2), x))*exp(-x**2/2)),</span>
<span class="go"> &#39;Bernoulli_Integral&#39;: Eq(f(x), (C1 - Integral(-exp(3*x)*exp(Integral(x, x)), x))*exp(-Integral(x, x))),</span>
<span class="go"> &#39;1st_linear_Integral&#39;: Eq(f(x), (C1 + Integral(exp(3*x)*exp(Integral(x, x)), x))*exp(-Integral(x, x))),</span>
<span class="go"> &#39;1st_exact&#39;: Eq(Integral((x*f(x) - exp(3*x))*exp(x**2/2), x), C1),</span>
<span class="go"> &#39;1st_power_series&#39;: Eq(f(x), x + x**2*(3 - C1)/2 + 7*x**3/6 + x**4*(C1 + 6)/8 + 53*x**5/120 + C1 + O(x**6)),</span>
<span class="go"> &#39;1st_linear&#39;: Eq(f(x), (C1 + Integral(exp(3*x)*exp(x**2/2), x))*exp(-x**2/2)),</span>
<span class="go"> &#39;lie_group&#39;: Eq(f(x), (C1 + Integral(exp(3*x)*sqrt(exp(x**2)), x))/sqrt(exp(x**2))),</span>
<span class="go"> &#39;Bernoulli&#39;: Eq(f(x), (C1 + Integral(exp(3*x)*exp(x**2/2), x))*exp(-x**2/2)),</span>
<span class="go"> &#39;1st_exact_Integral&#39;: Eq(Subs(Integral((_y*x - exp(3*x))*exp(x**2/2), x) + Integral(exp(x**2/2) - Integral(x*exp(x**2/2), x), _y), _y, f(x)), C1),</span>
<span class="go"> &#39;almost_linear_Integral&#39;: Eq(f(x), (C1 + Integral(exp(3*x)*exp(Integral(x, x)), x))*exp(-Integral(x, x))),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), x + x**2*(3 - C1)/2 + 7*x**3/6 + x**4*(C1 + 6)/8 + 53*x**5/120 + C1 + O(x**6)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;1st_power_series&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;1st_exact&#39;,</span>
<span class="go"> &#39;order&#39;: 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="go">Eq(f(x), x + x**2*(3 - C1)/2 + 7*x**3/6 + x**4*(C1 + 6)/8 + 53*x**5/120 + C1 + O(x**6))</span>
</pre></div>
</div>
</div>
<div class="section" id="bernoulli">
<h4><a class="toc-backref" href="#id36">Bernoulli 常微分方程式</a><a class="headerlink" href="#bernoulli" title="Permalink to this heading">¶</a></h4>
<p>Bernoulli 常微分方程式を解く。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>

<span class="gp">In [2]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">{&#39;Bernoulli_Integral&#39;: Eq(f(x), 1/sqrt((C1 + 2*Integral(-x**3*exp(-2*Integral(11*x, x)), x))*exp(2*Integral(11*x, x)))),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), 1/sqrt((C1 + 2*Integral(-x**3*exp(-2*Integral(11*x, x)), x))*exp(2*Integral(11*x, x)))),</span>
<span class="go"> &#39;best_hint&#39;: &#39;Bernoulli_Integral&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;Bernoulli&#39;,</span>
<span class="go"> &#39;order&#39;: 1}</span>

<span class="gp">In [3]: </span><span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="gh">Out[3]: </span><span class="go">Eq(f(x), 1/sqrt((C1 + (11*x**2 + 1)*exp(-11*x**2)/121)*exp(11*x**2)))</span>

<span class="gp">In [4]: </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">(&#39;Bernoulli&#39;, &#39;lie_group&#39;, &#39;Bernoulli_Integral&#39;)</span>

<span class="gp">In [6]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[6]:</span>
<span class="go">{&#39;Bernoulli_Integral&#39;: Eq(f(x), ((C1 + 4*Integral(-7*exp(-4*Integral(-1/(3*x), x))*log(x)/3, x))*exp(4*Integral(-1/(3*x), x)))**(-1/4)),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), ((C1 + 4*Integral(-7*exp(-4*Integral(-1/(3*x), x))*log(x)/3, x))*exp(4*Integral(-1/(3*x), x)))**(-1/4)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;Bernoulli_Integral&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;Bernoulli&#39;,</span>
<span class="go"> &#39;order&#39;: 1}</span>
</pre></div>
</div>
</div>
<div class="section" id="riccati">
<h4><a class="toc-backref" href="#id37">Riccati 常微分方程式</a><a class="headerlink" href="#riccati" title="Permalink to this heading">¶</a></h4>
<p>Riccati 型 <span class="math notranslate nohighlight">\(y^\prime = P(x)y + Q(x)y + R(x)y^2,\;P(x) \ne 0,\;R(x) \ne 0\)</span> を試す。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dsolve</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="go">{&#39;separable_reduced_Integral&#39;: Eq(Integral(1/(_y*(3*_y + 1 - 2/_y)), (_y, x*f(x))), C1 + Integral(1/x, x)),</span>
<span class="go"> &#39;lie_group&#39;: Eq(f(x), -(2*C1/3 + x**5)/(x*(-C1 + x**5))),</span>
<span class="go"> &#39;Riccati_special_minus2&#39;: Eq(f(x), -(-5*I*tan(C1 + 5*I*log(x)/2) + 1)/(6*x)),</span>
<span class="go"> &#39;separable_reduced&#39;: Eq(f(x), (-C1*x**4 - 2/(3*x))/(C1*x**5 - 1)),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), -(2*C1/3 + x**5)/(x*(-C1 + x**5))),</span>
<span class="go"> &#39;best_hint&#39;: &#39;lie_group&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;Riccati_special_minus2&#39;,</span>
<span class="go"> &#39;order&#39;: 1}</span>
</pre></div>
</div>
<p>デフォルトとして認識されていることがわかる。</p>
</div>
<div class="section" id="id14">
<h4><a class="toc-backref" href="#id38">定数係数二階線形常微分方程式</a><a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h4>
<p>この型のものは同次形ならば <code class="docutils literal notranslate"><span class="pre">dsolve()</span></code> に頼らなくでもなんとかなる。</p>
<p>特性方程式の解のパターン別に試す。ソルバーが適切なタイプ判定をしていることがわかる。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">{&#39;best&#39;: Eq(f(x), C1*exp(-6*x) + C2*exp(x)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;nth_linear_constant_coeff_homogeneous&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;nth_linear_constant_coeff_homogeneous&#39;,</span>
<span class="go"> &#39;nth_linear_constant_coeff_homogeneous&#39;: Eq(f(x), C1*exp(-6*x) + C2*exp(x)),</span>
<span class="go"> &#39;order&#39;: 2}</span>

<span class="gp">In [3]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[4]:</span>
<span class="go">{&#39;best&#39;: Eq(f(x), (C1 + C2*x)*exp(3*x)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;nth_linear_constant_coeff_homogeneous&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;nth_linear_constant_coeff_homogeneous&#39;,</span>
<span class="go"> &#39;nth_linear_constant_coeff_homogeneous&#39;: Eq(f(x), (C1 + C2*x)*exp(3*x)),</span>
<span class="go"> &#39;order&#39;: 2}</span>

<span class="gp">In [5]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[5]:</span>
<span class="go">{&#39;best&#39;: Eq(f(x), (C1*sin(sqrt(3)*x/2) + C2*cos(sqrt(3)*x/2))*sqrt(exp(x))),</span>
<span class="go"> &#39;best_hint&#39;: &#39;nth_linear_constant_coeff_homogeneous&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;nth_linear_constant_coeff_homogeneous&#39;,</span>
<span class="go"> &#39;nth_linear_constant_coeff_homogeneous&#39;: Eq(f(x), (C1*sin(sqrt(3)*x/2) + C2*cos(sqrt(3)*x/2))*sqrt(exp(x))),</span>
<span class="go"> &#39;order&#39;: 2}</span>
</pre></div>
</div>
</div>
<div class="section" id="euler">
<h4><a class="toc-backref" href="#id39">Euler 常微分方程式</a><a class="headerlink" href="#euler" title="Permalink to this heading">¶</a></h4>
<p>Euler 常微分方程式のデモを示す。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">{&#39;best&#39;: Eq(f(x), (C1*sin(sqrt(2)*log(x)) + C2*cos(sqrt(2)*log(x)))/x**2),</span>
<span class="go"> &#39;best_hint&#39;: &#39;nth_linear_euler_eq_homogeneous&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;nth_linear_euler_eq_homogeneous&#39;,</span>
<span class="go"> &#39;nth_linear_euler_eq_homogeneous&#39;: Eq(f(x), (C1*sin(sqrt(2)*log(x)) + C2*cos(sqrt(2)*log(x)))/x**2),</span>
<span class="go"> &#39;order&#39;: 2}</span>
</pre></div>
</div>
<p>次のものは非同次？</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">(&#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters&#39;,</span>
<span class="go"> &#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters_Integral&#39;)</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">Eq(f(x), C1/x + C2*x**2 + x*exp(x) - 2*exp(x) + 2*exp(x)/x)</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h4><a class="toc-backref" href="#id40">特殊な二階常微分方程式</a><a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h4>
<p>Airy 微分方程式を解く。ここではべき級数の形で一般解を得たが、よそではある広義積分で与えられる。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]: </span><span class="go">(&#39;2nd_power_series_ordinary&#39;,)</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">{&#39;2nd_power_series_ordinary&#39;: Eq(f(x), C2*(x**3/6 + 1) + C1*x*(x**3/12 + 1) + O(x**6)),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), C2*(x**3/6 + 1) + C1*x*(x**3/12 + 1) + O(x**6)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;2nd_power_series_ordinary&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;2nd_power_series_ordinary&#39;,</span>
<span class="go"> &#39;order&#39;: 2}</span>
</pre></div>
</div>
<p>Bessel 微分方程式を解く。またしてもべき級数の形で一般解が得られる。
SymPy は Airy 関数も Bessel 関数も持っているのに、微分方程式のモジュールには関与していないということだろうか。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]: </span><span class="go">(&#39;2nd_power_series_regular&#39;,)</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">{&#39;2nd_power_series_regular&#39;: Eq(f(x), C1*x**4 + O(x**6)),</span>
<span class="go"> &#39;best&#39;: Eq(f(x), C1*x**4 + O(x**6)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;2nd_power_series_regular&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;2nd_power_series_regular&#39;,</span>
<span class="go"> &#39;order&#39;: 2}</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h4><a class="toc-backref" href="#id41">二階線形非同次常微分方程式</a><a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h4>
<p>解けているように見えるが、ヒントを <code class="code docutils literal notranslate"><span class="pre">all</span></code> にすると返って来ない？後半で同次版も解いてみる。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">(&#39;nth_linear_euler_eq_nonhomogeneous_undetermined_coefficients&#39;,</span>
<span class="go"> &#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters&#39;,</span>
<span class="go"> &#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters_Integral&#39;)</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">Eq(f(x), C1*sqrt(x)*sin(sqrt(3)*log(x)/2) + C2*sqrt(x)*cos(sqrt(3)*log(x)/2) + x**2/3)</span>

<span class="gp">In [4]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">(&#39;nth_linear_euler_eq_homogeneous&#39;, &#39;2nd_power_series_regular&#39;)</span>

<span class="gp">In [6]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[6]: </span><span class="go">Eq(f(x), sqrt(x)*(C1*sin(sqrt(3)*log(x)/2) + C2*cos(sqrt(3)*log(x)/2)))</span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h4><a class="toc-backref" href="#id42">二階非線形常微分方程式</a><a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h4>
<p>Liouville 型は解ける。それ以外が解けない。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]: </span><span class="go">(&#39;Liouville&#39;, &#39;Liouville_Integral&#39;)</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">{&#39;Liouville_Integral&#39;: Eq(C1 + C2*Integral(exp(-Integral(-5*x, x)), x) + Integral(exp(Integral(-1, _y)), (_y, f(x))), 0),</span>
<span class="go"> &#39;best&#39;: Eq(C1 + C2*Integral(exp(-Integral(-5*x, x)), x) + Integral(exp(Integral(-1, _y)), (_y, f(x))), 0),</span>
<span class="go"> &#39;best_hint&#39;: &#39;Liouville_Integral&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;Liouville&#39;,</span>
<span class="go"> &#39;order&#39;: 2}</span>

<span class="gp">In [4]: </span><span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="gh">Out[4]: </span><span class="go">Eq(C1 + sqrt(10)*sqrt(pi)*C2*erfi(sqrt(10)*x/2)/10 - exp(-f(x)), 0)</span>

<span class="gp">In [5]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="gp">In [6]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[6]: </span><span class="go">()</span>

<span class="gp">In [11]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[12]: </span><span class="go">(&#39;Liouville&#39;, &#39;Liouville_Integral&#39;)</span>

<span class="gp">In [13]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[13]:</span>
<span class="go">{&#39;Liouville_Integral&#39;: Eq(C1 + C2*Integral(exp(-Integral(-x**2, x)), x) + Integral(exp(Integral(_y, _y)), (_y, f(x))), 0),</span>
<span class="go"> &#39;best&#39;: Eq(C1 + C2*Integral(exp(-Integral(-x**2, x)), x) + Integral(exp(Integral(_y, _y)), (_y, f(x))), 0),</span>
<span class="go"> &#39;best_hint&#39;: &#39;Liouville_Integral&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;Liouville&#39;,</span>
<span class="go"> &#39;order&#39;: 2}</span>

<span class="gp">In [14]: </span><span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="gh">Out[14]: </span><span class="go">Eq(C1 + 3**(1/3)*C2*exp(-I*pi/3)*gamma(1/3)*lowergamma(1/3, x**3*exp_polar(I*pi)/3)/(9*gamma(4/3)) + sqrt(2)*sqrt(pi)*erfi(sqrt(2)*f(x)/2)/2, 0)</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h4><a class="toc-backref" href="#id43">定数係数高階線形常微分方程式</a><a class="headerlink" href="#id18" title="Permalink to this heading">¶</a></h4>
<p>SymPy のソルバーは 2 階以上は全部高階扱い。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="mi">17</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">108</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span><span class="mi">330</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">488</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">280</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]: </span><span class="go">(&#39;nth_linear_constant_coeff_homogeneous&#39;,)</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">{&#39;best&#39;: Eq(f(x), (C1 + C2*x + C5*exp(5*x) + (C3*sin(x) + C4*cos(x))*exp(x))*exp(2*x)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;nth_linear_constant_coeff_homogeneous&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;nth_linear_constant_coeff_homogeneous&#39;,</span>
<span class="go"> &#39;nth_linear_constant_coeff_homogeneous&#39;: Eq(f(x), (C1 + C2*x + C5*exp(5*x) + (C3*sin(x) + C4*cos(x))*exp(x))*exp(2*x)),</span>
<span class="go"> &#39;order&#39;: 5}</span>
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h4><a class="toc-backref" href="#id44">高階 Euler 常微分方程式</a><a class="headerlink" href="#id19" title="Permalink to this heading">¶</a></h4>
<p>SymPy のソルバーは 2 階以上は全部高階扱い。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]: </span><span class="go">(&#39;nth_linear_euler_eq_homogeneous&#39;,)</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">{&#39;best&#39;: Eq(f(x), C1*x**RootOf(_x**4 - 8*_x**3 + 16*_x**2 - 4*_x + 1, 0) + C2*x**RootOf(_x**4 - 8*_x**3 + 16*_x**2 - 4*_x + 1, 1) + C3*x**RootOf(_x**4 - 8*_x**3 + 16*_x**2 - 4*_x + 1, 2) + C4*x**RootOf(_x**4 - 8*_x**3 + 16*_x**2 - 4*_x + 1, 3)),</span>
<span class="go"> &#39;best_hint&#39;: &#39;nth_linear_euler_eq_homogeneous&#39;,</span>
<span class="go"> &#39;default&#39;: &#39;nth_linear_euler_eq_homogeneous&#39;,</span>
<span class="go"> &#39;nth_linear_euler_eq_homogeneous&#39;: Eq(f(x), C1*x**RootOf(_x**4 - 8*_x**3 + 16*_x**2 - 4*_x + 1, 0) + C2*x**RootOf(_x**4 - 8*_x**3 + 16*_x**2 - 4*_x + 1, 1) + C3*x**RootOf(_x**4 - 8*_x**3 + 16*_x**2 - 4*_x + 1, 2) + C4*x**RootOf(_x**4 - 8*_x**3 + 16*_x**2 - 4*_x + 1, 3)),</span>
<span class="go"> &#39;order&#39;: 4}</span>
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h4><a class="toc-backref" href="#id45">特殊な高階常微分方程式</a><a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h4>
<p>二階で望みの形が得られないようならば、高階でもそうだ。次の例題は Airy 関数と Bessel 関数で一般解を返して欲しいもの。これはアウトのようだ。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]: </span><span class="go">()</span>

<span class="gp">In [3]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">11</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[4]: </span><span class="go">()</span>
</pre></div>
</div>
<p>次の例題はある高次整方程式の解で一般解が表現できる。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">13</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">19</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">33</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">(&#39;nth_linear_constant_coeff_undetermined_coefficients&#39;,</span>
<span class="go"> &#39;nth_linear_constant_coeff_variation_of_parameters&#39;,</span>
<span class="go"> &#39;nth_linear_constant_coeff_variation_of_parameters_Integral&#39;)</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">Eq(f(x), C1*exp(x*RootOf(_x**4 - 13*_x**2 + 19*_x + 33, 0)) + C2*exp(x*RootOf(_x**4 - 13*_x**2 + 19*_x + 33, 1)) + C3*exp(x*RootOf(_x**4 - 13*_x**2 +19*_x + 33, 2)) + C4*exp(x*RootOf(_x**4 - 13*_x**2 + 19*_x + 33, 3)) + 38*sin(2*x)/11645 + 101*cos(2*x)/11645)</span>
</pre></div>
</div>
<p>こちらは完全にダメだ。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">eq</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">11</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">In [1]: </span><span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>

<span class="gh">Out[2]: </span><span class="go">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id21">
<h3><a class="toc-backref" href="#id46">連立常微分方程式</a><a class="headerlink" href="#id21" title="Permalink to this heading">¶</a></h3>
<p>何となく動作が不安定であるように見受けられる。場合によってはバグレポートを開発陣に提出するかもしれない。</p>
<div class="section" id="id22">
<h4><a class="toc-backref" href="#id47">線形</a><a class="headerlink" href="#id22" title="Permalink to this heading">¶</a></h4>
<p>以下の例では、次の前処理を実施済みであることを事前条件としている。</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.solvers.ode</span> <span class="kn">import</span> <span class="n">classify_sysode</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>まずは定数係数の例を示す。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="gp">In [2]: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
<span class="gh">Out[2]: </span><span class="go">{1: 1, 2: 1}</span>

<span class="gp">In [3]: </span><span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>

<span class="gp">In [4]: </span><span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gh">Out[5]:</span>
<span class="go">{&#39;eq&#39;: [-4*x(t) + 6*y(t) + Derivative(x(t), t),</span>
<span class="go">  -x(t) + y(t) + Derivative(y(t), t)],</span>
<span class="go"> &#39;func&#39;: [x(t), y(t)],</span>
<span class="go"> &#39;func_coeff&#39;: {(0, y(t), 0): 6,</span>
<span class="go">  (0, x(t), 0): -4,</span>
<span class="go">  (1, y(t), 0): 1,</span>
<span class="go">  (1, y(t), 1): 1,</span>
<span class="go">  (1, x(t), 0): -1,</span>
<span class="go">  (0, x(t), 1): 1,</span>
<span class="go">  (0, y(t), 1): 0,</span>
<span class="go">  (1, x(t), 1): 0},</span>
<span class="go"> &#39;is_linear&#39;: True,</span>
<span class="go"> &#39;no_of_equation&#39;: 2,</span>
<span class="go"> &#39;order&#39;: {x(t): 1, y(t): 1},</span>
<span class="go"> &#39;type_of_equation&#39;: &#39;type1&#39;}</span>

<span class="gp">In [6]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gh">Out[6]: </span><span class="go">[Eq(x(t), -6*C1*exp(t) - 6*C2*exp(2*t)),</span>
<span class="go">         Eq(y(t), -3*C1*exp(t) - 2*C2*exp(2*t))]</span>
</pre></div>
</div>
<p>次の常微分方程式系は <code class="code docutils literal notranslate"><span class="pre">type_of_equation</span></code> が None とされている。つまりタイプ不明ゆえ解けない。こういう場合は <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> の呼び出しを諦めてしまってよい。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

<span class="gp">In [2]: </span><span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">{&#39;eq&#39;: [y(t) + Derivative(x(t), t, t, t),</span>
<span class="go">  -64*x(t) + Derivative(y(t), t, t, t)],</span>
<span class="go"> &#39;func&#39;: [x(t), y(t)],</span>
<span class="go"> &#39;func_coeff&#39;: {(0, x(t), 2): 0,</span>
<span class="go">  (0, y(t), 0): 1,</span>
<span class="go">  (1, y(t), 0): 0,</span>
<span class="go">  (1, y(t), 1): 0,</span>
<span class="go">  (1, x(t), 2): 0,</span>
<span class="go">  (1, x(t), 3): 0,</span>
<span class="go">  (0, x(t), 3): 1,</span>
<span class="go">  (1, x(t), 1): 0,</span>
<span class="go">  (1, x(t), 0): -64,</span>
<span class="go">  (0, y(t), 2): 0,</span>
<span class="go">  (0, x(t), 0): 0,</span>
<span class="go">  (1, y(t), 3): 1,</span>
<span class="go">  (0, x(t), 1): 0,</span>
<span class="go">  (0, y(t), 3): 0,</span>
<span class="go">  (0, y(t), 1): 0,</span>
<span class="go">  (1, y(t), 2): 0},</span>
<span class="go"> &#39;is_linear&#39;: True,</span>
<span class="go"> &#39;no_of_equation&#39;: 2,</span>
<span class="go"> &#39;order&#39;: {x(t): 3, y(t): 3},</span>
<span class="go"> &#39;type_of_equation&#39;: None}</span>
</pre></div>
</div>
<p>次は非定数係数の線形常微分方程式系の一例だが、解きたそうなのに解けないようだ。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

<span class="gp">In [2]: </span><span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gh">Out[2]:</span>
<span class="go">{&#39;eq&#39;: [-x(t)*sin(t) + Derivative(x(t), t), -t**2*y(t) + Derivative(y(t), t)],  &#39;func&#39;: [x(t), y(t)],</span>
<span class="go"> &#39;func_coeff&#39;: {(0, y(t), 0): 0,</span>
<span class="go">  (0, x(t), 0): -sin(t),</span>
<span class="go">  (1, y(t), 0): -t**2,</span>
<span class="go">  (1, y(t), 1): 1,</span>
<span class="go">  (1, x(t), 0): 0,</span>
<span class="go">  (0, x(t), 1): 1,</span>
<span class="go">  (0, y(t), 1): 0,</span>
<span class="go">  (1, x(t), 1): 0},</span>
<span class="go"> &#39;is_linear&#39;: True,</span>
<span class="go"> &#39;no_of_equation&#39;: 2,</span>
<span class="go"> &#39;order&#39;: {x(t): 1, y(t): 1},</span>
<span class="go"> &#39;type_of_equation&#39;: &#39;type6&#39;}</span>

<span class="gp">In [3]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-223-094226d3d973&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">dsolve</span><span class="nt">(eq, func, hint, simplify, ics, xi, eta, x0, n, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">614</span>             <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">615</span>                 <span class="n">solvefunc</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;sysode_nonlinear_</span><span class="si">%(no_of_equation)s</span><span class="s1">eq_order</span><span class="si">%(order)s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">match</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">616</span>             <span class="n">sols</span> <span class="o">=</span> <span class="n">solvefunc</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span>             <span class="k">return</span> <span class="n">sols</span>
<span class="g g-Whitespace">    </span><span class="mi">618</span>     <span class="k">else</span><span class="p">:</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">sysode_linear_2eq_order1</span><span class="nt">(match_)</span>
<span class="g g-Whitespace">   </span><span class="mi">6418</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_linear_2eq_order1_type5</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6419</span>     <span class="k">if</span> <span class="n">match_</span><span class="p">[</span><span class="s1">&#39;type_of_equation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;type6&#39;</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">6420</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_linear_2eq_order1_type6</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6421</span>     <span class="k">if</span> <span class="n">match_</span><span class="p">[</span><span class="s1">&#39;type_of_equation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;type7&#39;</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">6422</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_linear_2eq_order1_type7</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">_linear_2eq_order1_type6</span><span class="nt">(x, y, t, r)</span>
<span class="g g-Whitespace">   </span><span class="mi">6725</span>     <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">6726</span>         <span class="n">equ</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)))</span>
<span class="ne">-&gt; </span><span class="mi">6727</span>         <span class="n">hint1</span> <span class="o">=</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">equ</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">6728</span>         <span class="n">sol1</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">equ</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="n">hint1</span><span class="o">+</span><span class="s1">&#39;_Integral&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rhs</span>
<span class="g g-Whitespace">   </span><span class="mi">6729</span>         <span class="n">sol2</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">sol1</span> <span class="o">+</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">classify_ode</span><span class="nt">(eq, func, dict, ics, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">817</span>         <span class="s2">&quot;work with functions of one variable, not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">818</span>     <span class="k">if</span> <span class="n">prep</span> <span class="ow">or</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">819</span>         <span class="n">eq</span><span class="p">,</span> <span class="n">func_</span> <span class="o">=</span> <span class="n">_preprocess</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">820</span>         <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">821</span>             <span class="n">func</span> <span class="o">=</span> <span class="n">func_</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\deutils.py</span> in <span class="ni">_preprocess</span><span class="nt">(expr, func, hint)</span>
<span class="g g-Whitespace">     </span><span class="mi">75</span>         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The function cannot be &#39;</span>
<span class="ne">---&gt; </span><span class="mi">77</span>                 <span class="s1">&#39;automatically detected for </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">expr</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>         <span class="n">func</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span>     <span class="n">fvars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

<span class="ne">ValueError</span>: The function cannot be automatically detected for nan.
</pre></div>
</div>
<p>次は成功例。積分もおそらく評価し切れる。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)]];</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>

<span class="gp">In [2]: </span><span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="p">]</span>

<span class="gp">In [3]: </span><span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">{&#39;eq&#39;: [-x(t)*exp(t) - y(t)*tan(t) + Derivative(x(t), t),</span>
<span class="go">  x(t)*tan(t) - y(t)*exp(t) + Derivative(y(t), t)],</span>
<span class="go"> &#39;func&#39;: [x(t), y(t)],</span>
<span class="go"> &#39;func_coeff&#39;: {(0, y(t), 0): -tan(t),</span>
<span class="go">  (0, x(t), 0): -exp(t),</span>
<span class="go">  (1, y(t), 0): -exp(t),</span>
<span class="go">  (1, y(t), 1): 1,</span>
<span class="go">  (1, x(t), 0): tan(t),</span>
<span class="go">  (0, x(t), 1): 1,</span>
<span class="go">  (0, y(t), 1): 0,</span>
<span class="go">  (1, x(t), 1): 0},</span>
<span class="go"> &#39;is_linear&#39;: True,</span>
<span class="go"> &#39;no_of_equation&#39;: 2,</span>
<span class="go"> &#39;order&#39;: {x(t): 1, y(t): 1},</span>
<span class="go"> &#39;type_of_equation&#39;: &#39;type4&#39;}</span>

<span class="gp">In [4]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gh">Out[4]: </span><span class="go">[Eq(x(t), (C1*cos(Integral(tan(t), t)) + C2*sin(Integral(tan(t), t)))*exp(Integral(exp(t), t))), Eq(y(t), (-C1*sin(Integral(tan(t), t)) + C2*cos(Integral(tan(t), t)))*exp(Integral(exp(t), t)))]</span>
</pre></div>
</div>
<p>次のものは解けないと言われる。本筋とは外れるが、関数 <code class="code docutils literal notranslate"><span class="pre">classify_sysode</span></code> の出力にある dict オブジェクトのアイテム順はなんとかならないか。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]);</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>

<span class="gp">In [2]: </span><span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="p">]</span>

<span class="gp">In [3]: </span><span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">{&#39;eq&#39;: [-x(t)*exp(t) - 2*y(t) - 3*z(t) + Derivative(x(t), t),</span>
<span class="go">  -2*y(t) + z(t) + Derivative(y(t), t),</span>
<span class="go">  -z(t) + Derivative(z(t), t)],</span>
<span class="go"> &#39;func&#39;: [x(t), y(t), z(t)],</span>
<span class="go"> &#39;func_coeff&#39;: {(0, y(t), 0): -2,</span>
<span class="go">  (0, z(t), 1): 0,</span>
<span class="go">  (1, y(t), 0): -2,</span>
<span class="go">  (1, y(t), 1): 1,</span>
<span class="go">  (2, z(t), 1): 1,</span>
<span class="go">  (1, z(t), 0): 1,</span>
<span class="go">  (2, z(t), 0): -1,</span>
<span class="go">  (0, y(t), 1): 0,</span>
<span class="go">  (1, x(t), 1): 0,</span>
<span class="go">  (2, y(t), 0): 0,</span>
<span class="go">  (0, x(t), 0): -exp(t),</span>
<span class="go">  (2, x(t), 1): 0,</span>
<span class="go">  (2, y(t), 1): 0,</span>
<span class="go">  (1, x(t), 0): 0,</span>
<span class="go">  (0, x(t), 1): 1,</span>
<span class="go">  (0, z(t), 0): -3,</span>
<span class="go">  (2, x(t), 0): 0,</span>
<span class="go">  (1, z(t), 1): 0},</span>
<span class="go"> &#39;is_linear&#39;: True,</span>
<span class="go"> &#39;no_of_equation&#39;: 3,</span>
<span class="go"> &#39;order&#39;: {x(t): 1, y(t): 1, z(t): 1},</span>
<span class="go"> &#39;type_of_equation&#39;: None}</span>
</pre></div>
</div>
</div>
<div class="section" id="id23">
<h4><a class="toc-backref" href="#id48">非線形</a><a class="headerlink" href="#id23" title="Permalink to this heading">¶</a></h4>
<p>謎のエラーが出てソルバーにたどり着けない。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">))]</span>

<span class="gp">In [3]: </span><span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">funcs</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-25-65d1e646ce2f&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">funcs</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">classify_sysode</span><span class="nt">(eq, funcs, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1389</span>                 <span class="n">func_dict</span><span class="p">[</span><span class="n">eq_no</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
<span class="g g-Whitespace">   </span><span class="mi">1390</span>             <span class="n">order</span><span class="p">[</span><span class="n">func</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_order</span>
<span class="ne">-&gt; </span><span class="mi">1391</span>     <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">func_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func_dict</span><span class="p">))]</span>
<span class="g g-Whitespace">   </span><span class="mi">1392</span>     <span class="n">matching_hints</span><span class="p">[</span><span class="s1">&#39;func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funcs</span>
<span class="g g-Whitespace">   </span><span class="mi">1393</span>     <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">   </span><span class="mi">1389</span>                 <span class="n">func_dict</span><span class="p">[</span><span class="n">eq_no</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
<span class="g g-Whitespace">   </span><span class="mi">1390</span>             <span class="n">order</span><span class="p">[</span><span class="n">func</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_order</span>
<span class="ne">-&gt; </span><span class="mi">1391</span>     <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">func_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func_dict</span><span class="p">))]</span>
<span class="g g-Whitespace">   </span><span class="mi">1392</span>     <span class="n">matching_hints</span><span class="p">[</span><span class="s1">&#39;func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funcs</span>
<span class="g g-Whitespace">   </span><span class="mi">1393</span>     <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>

<span class="ne">KeyError</span>: 2
</pre></div>
</div>
<p>次の例ではソルバーの処理中に謎のエラーが出る。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u v&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

<span class="gp">In [3]: </span><span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gh">Out[3]:</span>
<span class="go">{&#39;eq&#39;: [Derivative(u(t), t) - 1/sqrt(v(t)), -u(t) + Derivative(v(t), t)],</span>
<span class="go"> &#39;func&#39;: [u(t), v(t)],</span>
<span class="go"> &#39;func_coeff&#39;: {(1, v(t), 1): 1,</span>
<span class="go">  (0, u(t), 1): 1,</span>
<span class="go">  (0, v(t), 1): 0,</span>
<span class="go">  (1, u(t), 1): 0,</span>
<span class="go">  (0, u(t), 0): 0,</span>
<span class="go">  (1, v(t), 0): 0,</span>
<span class="go">  (0, v(t), 0): 0,</span>
<span class="go">  (1, u(t), 0): -1},</span>
<span class="go"> &#39;is_linear&#39;: False,</span>
<span class="go"> &#39;no_of_equation&#39;: 2,</span>
<span class="go"> &#39;order&#39;: {u(t): 1, v(t): 1},</span>
<span class="go"> &#39;type_of_equation&#39;: &#39;type3&#39;}</span>

<span class="gp">In [4]: </span><span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-30-094226d3d973&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">dsolve</span><span class="nt">(eq, func, hint, simplify, ics, xi, eta, x0, n, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">615</span>             <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">616</span>                 <span class="n">solvefunc</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;sysode_nonlinear_</span><span class="si">%(no_of_equation)s</span><span class="s1">eq_order</span><span class="si">%(order)s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">match</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">617</span>             <span class="n">sols</span> <span class="o">=</span> <span class="n">solvefunc</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">618</span>             <span class="k">return</span> <span class="n">sols</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span>     <span class="k">else</span><span class="p">:</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">sysode_nonlinear_2eq_order1</span><span class="nt">(match_)</span>
<span class="g g-Whitespace">   </span><span class="mi">7772</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_nonlinear_2eq_order1_type2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7773</span>     <span class="k">elif</span> <span class="n">match_</span><span class="p">[</span><span class="s1">&#39;type_of_equation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;type3&#39;</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">7774</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_nonlinear_2eq_order1_type3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7775</span>     <span class="k">elif</span> <span class="n">match_</span><span class="p">[</span><span class="s1">&#39;type_of_equation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;type4&#39;</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">7776</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_nonlinear_2eq_order1_type4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>

<span class="nn">D:\home\yojyo\devel\sympy\sympy\solvers\ode.py</span> in <span class="ni">_nonlinear_2eq_order1_type3</span><span class="nt">(x, y, t, eq)</span>
<span class="g g-Whitespace">   </span><span class="mi">7894</span>     <span class="n">G</span> <span class="o">=</span> <span class="n">r2</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">v</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7895</span>     <span class="n">sol2r</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="n">u</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">/</span><span class="n">F</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">u</span><span class="p">))))</span>
<span class="ne">-&gt; </span><span class="mi">7896</span>     <span class="k">for</span> <span class="n">sol2s</span> <span class="ow">in</span> <span class="n">sol2r</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">7897</span>         <span class="n">sol1</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">F</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">sol2s</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span> <span class="o">-</span> <span class="n">C2</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">7898</span>     <span class="n">sol</span> <span class="o">=</span> <span class="p">[]</span>

<span class="ne">TypeError</span>: &#39;Equality&#39; object is not iterable
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="integrals.html" title="Previous document">積分</a>
        </li>
        <li>
          <a href="pde.html" title="Next document">偏微分方程式</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">読書ノート</a></h1>



<p class="blurb">個人的な読書、学習、研究ノート。</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mathseminar72.html">数学 100 の発見 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gamma95/index.html">オブジェクト指向における再利用のためのデザインパターン改訂版 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hunt00/index.html">達人プログラマー 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sutter00.html">Exceptional C++ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alexandrescu01/index.html">Modern C++ Design 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meyers01.html">Effective STL 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sutter02.html">More Exceptional C++ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../joel04/index.html">Joel on Software 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graham04.html">ハッカーと画家 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../angel05/index.html">OpenGL: A Primer Second Edition 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yamamoto05/index.html">入門 xyzzy 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../newham05/index.html">入門 bash 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsuboi05/index.html">幾何学 I 多様体入門 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../subramaniam06.html">アジャイルプラクティス 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../asaoka06.html">SE・製造技術者・理工系学生のための技術文書の作り方・書き方 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../levin06/index.html">Shaping Functions 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsuboi08/index.html">幾何学 III 微分形式 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loeliger09.html">実用 Git 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../griffiths10.html">プログラミング C# 第 6 版 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onodera10.html">ORACLE MASTER Bronze 11g SQL 基礎 I 必修教本 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hosoda10/index.html">Python 入門［２＆３対応］読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nishiyama12/index.html">幾何学と不変量 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../omg15/index.html">Unified Modeling Language 2.5 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gorelick14.html">ハイパフォーマンス Python 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stroustrup14.html">C++ のエッセンス 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stepanov15.html">その数式、プログラムできますか？ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../khronos15/index.html">WebGL Specification 1.0 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vivo15/index.html">The Book of Shaders 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saha16.html">Python からはじめる数学入門 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slatkin16.html">Effective Python 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guntheroth16.html">Optimized C++ 下読みノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speinellis17.html">Effective Debugging 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bancila18.html">Modern C++ チャレンジ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../haverbeke18/index.html">Eloquent JavaScript 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../khronos18/index.html">OpenGL Shading Language 4.60 Specification 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kantor22/index.html">The Modern JavaScript Tutorial 読書ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2014.html">ノート準備中書籍群 2014 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2015.html">ノート準備中書籍群 2015 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2016.html">ノート準備中書籍群 2016 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2017.html">ノート準備中書籍群 2017 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2018.html">ノート準備中書籍群 2018 年編</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bash-v2.html">What’s New In Bash 2 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash-v3.html">What’s New In Bash 3 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash-v4.html">What’s New In Bash 4 ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cpp11/index.html">What’s New In C++11 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp14/index.html">What’s New In C++14 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp17/index.html">What’s New In C++17 ノート</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../python-3.0.html">What’s New In Python 3.0 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.1.html">What’s New In Python 3.1 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.2.html">What’s New In Python 3.2 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.3.html">What’s New In Python 3.3 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.4.html">What’s New In Python 3.4 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.5.html">What’s New In Python 3.5 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.6.html">What’s New In Python 3.6 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.7.html">What’s New In Python 3.7 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.8.html">What’s New In Python 3.8 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.9.html">What’s New In Python 3.9 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.10.html">What’s New In Python 3.10 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pip.html">pip 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pylint.html">Pylint 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-docutils/index.html">Docutils 解読ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-restview.html">Restview 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-nose.html">Nose 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-ipython.html">IPython 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-jupyter.html">Jupyter 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-numpy/index.html">NumPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-scipy/index.html">SciPy 利用ノート</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">SymPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-apgl.html">Another Python Graph Library (APGL) 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pil.html">PIL 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pillow.html">Pillow 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-matplotlib/index.html">Matplotlib 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-networkx/index.html">NetworkX 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-quaternion.html">Quaternion 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-jinja2.html">Jinja2 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pygments.html">Pygments 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-bs4.html">BeautifulSoup4 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-selenium.html">Selenium 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-scrapy.html">Scrapy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-twitter/index.html">Python Twitter Tools 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-isbn-hyphenate.html">isbn-hyphenate 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyopengl/index.html">PyOpenGL 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyqt4.html">PyQt4 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyqt5.html">PyQt5 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pandas/index.html">Pandas 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pygame.html">Pygame 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pytube.html">Pytube 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-py2exe.html">Py2exe 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-upgrade.html">Python 移行ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-miniconda.html">Miniconda 利用ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../milestone09/index.html">ラジルギノア プレイノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../freeware.html">Windows 用フリーウェア 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../winget.html">Windows Package Manager CLI 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cygwin.html">Cygwin 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chrome.html">Chrome DevTools 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/index.html">Git 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../twitter.html">Twitter 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inkscape/index.html">Inkscape 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mathjax.html">MathJax 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript-mermaid/index.html">Mermaid 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../css-selector.html">CSS セレクター学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xpath.html">XPath 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hxutils.html">HTML-XML-utils 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webgl.html">WebGL 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandoc.html">Pandoc 利用ノート</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">SymPy 利用ノート</a><ul>
      <li>Previous: <a href="integrals.html" title="previous chapter">積分</a></li>
      <li>Next: <a href="pde.html" title="next chapter">偏微分方程式</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2022, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>