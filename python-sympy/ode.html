
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>常微分方程式 &#8212; 読書ノート v1.4</title>
    <link rel="stylesheet" href="../_static/prefab.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/mathjaxconf.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="next" title="偏微分方程式" href="pde.html" />
    <link rel="prev" title="積分" href="integrals.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="pde.html" title="偏微分方程式"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="integrals.html" title="積分"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">SymPy 利用ノート</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id23">常微分方程式</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>モジュール <code class="docutils literal notranslate"><span class="pre">sympy.solvers.ode</span></code> が提供する、常微分方程式を解くための機能に関する覚え書きを記す。</p>
<div class="contents topic" id="id2">
<p class="topic-title first">ノート目次</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id23">常微分方程式</a><ul>
<li><a class="reference internal" href="#id3" id="id24">基本機能</a></li>
<li><a class="reference internal" href="#id4" id="id25">下回りの機能</a></li>
<li><a class="reference internal" href="#id5" id="id26">特化型ソルバー</a></li>
<li><a class="reference internal" href="#id6" id="id27">連立常微分方程式</a></li>
<li><a class="reference internal" href="#id7" id="id28">演習</a><ul>
<li><a class="reference internal" href="#id8" id="id29">常微分方程式</a><ul>
<li><a class="reference internal" href="#id9" id="id30">求積法だけで解が求まる常微分方程式</a></li>
<li><a class="reference internal" href="#id10" id="id31">変数分離形常微分方程式</a></li>
<li><a class="reference internal" href="#id11" id="id32">一階同次常微分方程式</a></li>
<li><a class="reference internal" href="#id12" id="id33">一階線形常微分方程式</a></li>
<li><a class="reference internal" href="#bernoulli" id="id34">Bernoulli 常微分方程式</a></li>
<li><a class="reference internal" href="#riccati" id="id35">Riccati 常微分方程式</a></li>
<li><a class="reference internal" href="#id13" id="id36">定数係数二階線形常微分方程式</a></li>
<li><a class="reference internal" href="#euler" id="id37">Euler 常微分方程式</a></li>
<li><a class="reference internal" href="#id14" id="id38">特殊な二階常微分方程式</a></li>
<li><a class="reference internal" href="#id15" id="id39">二階線形非同次常微分方程式</a></li>
<li><a class="reference internal" href="#id16" id="id40">二階非線形常微分方程式</a></li>
<li><a class="reference internal" href="#id17" id="id41">定数係数高階線形常微分方程式</a></li>
<li><a class="reference internal" href="#id18" id="id42">高階 Euler 常微分方程式</a></li>
<li><a class="reference internal" href="#id19" id="id43">特殊な高階常微分方程式</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id20" id="id44">連立常微分方程式</a><ul>
<li><a class="reference internal" href="#id21" id="id45">線形</a></li>
<li><a class="reference internal" href="#id22" id="id46">非線形</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>紙幅の都合上、出力を一部手で改行した。</p>
<p>本文中のすべての IPython セッション中のサンプルコードで、以下のインポートおよび出力書式設定が済んでいるものとする。</p>
<div class="code python3 last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">init_printing</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id24">基本機能</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>ここに記す関数は isympy シェルがデフォルトで実行するインポート <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">sympy</span> <span class="pre">import</span> <span class="pre">*</span></code> だけで利用可能だ。</p>
<p>SymPy で常微分方程式を解くには、関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> を用いる。簡単なケースではこれ一本で事足りる。何か凝ったことをする場合に、その他の関数やデータを併用するという方針でよさそうだ。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">dsolve(eq,</span> <span class="pre">...)</span></code></dt>
<dd><p class="first">常微分方程式系を解く。</p>
<p>方程式を一個解くときには、引数 <code class="code docutils literal notranslate"><span class="pre">eq</span></code> には何か導関数を含むような数式オブジェクトを指定する。方程式を複数個解くときには、同様に数式オブジェクトの list オブジェクトを指定する。ソルバーは各方程式が 0 と等しい条件を求める。</p>
<ul class="last">
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">func=None</span></code> は <code class="code docutils literal notranslate"><span class="pre">eq</span></code> がどの一変数関数に関する微分方程式なのかを指示する。方程式を複数個解くときには、やはり list の形式をとる。普通はソルバーが自動検出するため、指定しない。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">hint='default'</span></code> ではソルバーに微分方程式のタイプについてヒントを教える。このヒントによって方程式の解法を調整することになる。</p>
<p>方程式を一個解くときには、与え得るパラメーターは次のとおり（すべて文字列だが、引用符を省略する）。</p>
<ul class="simple">
<li><code class="code docutils literal notranslate"><span class="pre">default</span></code>: 後述の関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode(eq,</span> <span class="pre">...)</span></code> にて記す。</li>
<li><code class="code docutils literal notranslate"><span class="pre">all</span></code>: 全部の解法候補を適用する。この場合はソルバーの戻り値がキーと値をタイプ名と解からなる dict オブジェクトになる。タイプ名は文字列で、解は Equality オブジェクトだと思われる。それに加えて、ベスト解や階数等の副次的な情報も併せて含む。</li>
<li><code class="code docutils literal notranslate"><span class="pre">all_Integral</span></code>: <code class="code docutils literal notranslate"><span class="pre">all</span></code> と同様に振る舞うが、もしタイプ xxx とタイプ xxx_Integral が候補にある場合、前者を省略するという点が異なる。後者の解法は結果オブジェクト内に Integral オブジェクトが未評価のまま残るが、計算処理が速いという特徴がある。</li>
<li><code class="code docutils literal notranslate"><span class="pre">best</span></code>: 全部の候補を試して、もっとも解が単純なものを返す。</li>
<li>あるいはユーザーが別途関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode(eq,</span> <span class="pre">...)</span></code> を呼び出して得たタイプのうちの一つ。</li>
</ul>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">simplify=True</span></code> はソルバー内部が関数 <code class="code docutils literal notranslate"><span class="pre">odesimp</span></code> を呼び出すかどうかを指定する。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">ics=None</span></code> は境界条件を dict オブジェクトで指定できる。</p>
<ul class="simple">
<li>キーの例 <code class="code docutils literal notranslate"><span class="pre">func(x0)</span></code>, <code class="code docutils literal notranslate"><span class="pre">func(x).diff(x).subs(x,</span> <span class="pre">x2)</span></code></li>
<li>利用可能になる条件は一階常微分方程式のべき級数？</li>
</ul>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">xi=None</span></code> および <code class="code docutils literal notranslate"><span class="pre">eta=None</span></code> は無限小関数。後述する関数 <code class="code docutils literal notranslate"><span class="pre">infinitesimals</span></code> の項で解説する。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">x0=0</span></code> は微分方程式のべき級数解をどの点周りに評価するかを指定する。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">n=6</span></code> はべき級数の指数をどこまで上げてよいかを指定する。</p>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode(eq,</span> <span class="pre">...)</span></code></dt>
<dd><p class="first">常微分方程式 <code class="code docutils literal notranslate"><span class="pre">eq</span> <span class="pre">==</span> <span class="pre">0</span></code> のタイプを返す。微分方程式の教科書と考え方は同じで、ソルバーは微分方程式を解く手法を何種類かに名前をつけて分類している。この関数は与えられた微分方程式を解くのに相応しいであろう手法の名前を列挙するものだ。</p>
<ul class="last simple">
<li>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">func=None</span></code> および <code class="code docutils literal notranslate"><span class="pre">ics=None</span></code> はソルバー関数と同じ。</li>
<li>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">dict=False</span></code> はソルバー関数が内々に利用するもの。</li>
<li>戻り値は文字列からなる tuple オブジェクトである。<ul>
<li>ソルバーが方程式を解くのにデフォルトで採用するのは、この最初のタイプである。特定の方法で解かせたいならば、関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> の <code class="code docutils literal notranslate"><span class="pre">hint</span></code> として、この候補のいずれかのタイプを指定する。</li>
<li>タイプは基本的には「このタイプとみなせば、方程式を解きやすいだろう」という順序で列挙されている。</li>
</ul>
</li>
<li>サポートするタイプは <code class="code docutils literal notranslate"><span class="pre">allhints</span></code> という tuple オブジェクトが知っている。手許の環境では 34 個ある。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">checkodesol(ode,</span> <span class="pre">sol,</span> <span class="pre">...)</span></code></dt>
<dd><p class="first">これは微分方程式の解を求めた後に、それを検算するのに用いる。オブジェクト <code class="code docutils literal notranslate"><span class="pre">sol</span></code> をソルバーに渡したものと同じ <code class="code docutils literal notranslate"><span class="pre">ode</span></code> に代入して、ゼロになることを見たい。</p>
<ul class="last simple">
<li>戻り値は 2 要素の tuple である。<ul>
<li>[0]: 代入結果がゼロならば True であり、そうでなければ False である。</li>
<li>[1]: [0] が True ならば <code class="docutils literal notranslate"><span class="pre">0</span></code> である（逆は必ずしも成り立たない）。それ以外は代入結果が何になったのかを表現する値が入る。</li>
</ul>
</li>
<li>この関数の呼び出しがなかなか返って来ないときは、間違いなく <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> がキツイためだろう。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">homogeneous_order(eq,</span> <span class="pre">*symbols)</span></code></dt>
<dd><p class="first">同次方程式 <code class="code docutils literal notranslate"><span class="pre">eq</span> <span class="pre">==</span> <span class="pre">0</span></code> の次数を返す。</p>
<ul class="last simple">
<li>非同次であれば None を返す。</li>
<li>シンボル関数も <code class="code docutils literal notranslate"><span class="pre">eq</span></code> になれるが、関数のすべての変数がシンボルである必要がある。なおかつ、数式中のその関数の変数が <code class="code docutils literal notranslate"><span class="pre">*symbols</span></code> にマッチしている必要がある。</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id25">下回りの機能</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>ここからはモジュール <code class="docutils literal notranslate"><span class="pre">sympy.solvers.ode</span></code> からの明示的なインポートを必要とする機能を記す。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">infinitesimals(eq,</span> <span class="pre">...)</span></code></dt>
<dd><p class="first">一階常微分方程式 <span class="math notranslate nohighlight">\(y' = f(x, y)\)</span> に対して、次の条件をみたすような点変換 <span class="math notranslate nohighlight">\(\xi(x, y)\)</span> と <span class="math notranslate nohighlight">\(\eta(x, y)\)</span> を返す：</p>
<p>これらの点変換が次のリー群について、元の <span class="math notranslate nohighlight">\(f\)</span> を用いて変換先の各変数に関する微分方程式 <span class="math notranslate nohighlight">\((y^*)'=f(x^*, y^*)\)</span> が成り立つ。</p>
<div class="math notranslate nohighlight">
\begin{align*}
x^* &amp;=&amp; X(x, y;\eps) = x + \eps \xi(x, y),\\
y^* &amp;=&amp; Y(x, y;\eps) = y + \eps \eta(x, y)
\end{align*}</div><ul class="last simple">
<li>戻り値は dict の list の型をとる。内側の dict は、キーが点変換関数オブジェクトで、値が Function 系オブジェクトまたは定数である。</li>
<li>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">hint</span></code> を用いて、点変換関数の計算方法のヒューリスティックを調整できるもよう。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">checkinfsol(eq,</span> <span class="pre">infinitesimals,</span> <span class="pre">...)</span></code></dt>
<dd><p class="first">この関数は上述の関数 <code class="code docutils literal notranslate"><span class="pre">infinitesimals</span></code> の結果を検証するのに用いられる。</p>
<ul class="last">
<li><p class="first">引数 <code class="code docutils literal notranslate"><span class="pre">infinitesimals</span></code> の型は（というか値は）先ほどの関数の戻り値と同じようにする。</p>
</li>
<li><p class="first">戻り値は list オブジェクトである。この要素は各点変換のペアに対応するブーリアン値と検算結果の値とのペアである。検算結果とは、次の偏微分に点変換関数を代入して評価した値である。</p>
<div class="math notranslate nohighlight">
\begin{align*}
\frac{\partial \eta}{\partial x} + \left(\frac{\partial \eta}{\partial y}
 - \frac{\partial \xi}{\partial x}\right)\diff{y}{x}
 - \frac{\partial \xi}{\partial y} \left(\diff{y}{x}\right)^{2}
 - \xi\frac{\partial h}{\partial x} - \eta\frac{\partial h}{\partial y}
\end{align*}</div><p>すなわち、妥当な関数を与えればリストが含む要素はすべて <code class="code docutils literal notranslate"><span class="pre">(True,</span> <span class="pre">0)</span></code> となる。</p>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">odesimp(eq,</span> <span class="pre">func,</span> <span class="pre">order,</span> <span class="pre">constants,</span> <span class="pre">hint)</span></code></dt>
<dd><p class="first">常微分方程式の単純化処理のための関数。</p>
<ul class="last simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> が本関数を呼び出すので、これを単体で利用するケースというのは一般ユーザーにはまれだということだ。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">constant_renumber(expr,</span> <span class="pre">symbolname,</span> <span class="pre">startnumber,</span> <span class="pre">endnumber)</span></code></dt>
<dd><p class="first">式に含まれる任意定数の番号付けを変更する関数。</p>
<p class="last">式 <code class="code docutils literal notranslate"><span class="pre">expr</span></code> 中にはいくつかの Symbol オブジェクトがあるという前提。そのオブジェクト名が <code class="code docutils literal notranslate"><span class="pre">symbolname</span></code> に末尾から数字のくっついたもので、さらにその数字が範囲 <cite>[startnumber, endnumber)</cite> にあれば、リネームの対象になる。新たに 1 から範囲の長さまでの連番が振られる。</p>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">constantsimp(expr,</span> <span class="pre">constants)</span></code></dt>
<dd><p class="first">式に含まれる任意定数に対する単純化処理のための関数。</p>
<ul class="last simple">
<li><code class="code docutils literal notranslate"><span class="pre">C1</span> <span class="pre">+</span> <span class="pre">C2</span></code> → <code class="code docutils literal notranslate"><span class="pre">C1</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">C1</span> <span class="pre">*</span> <span class="pre">C2</span></code> → <code class="code docutils literal notranslate"><span class="pre">C1</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">exp(C1)</span></code> → <code class="code docutils literal notranslate"><span class="pre">C1</span></code></li>
<li>etc.</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">ode_sol_simplicity(sol,</span> <span class="pre">func,</span> <span class="pre">trysolving=True)</span></code></dt>
<dd><p class="first">解の簡単さを示す数値を返す関数。例えば <code class="code docutils literal notranslate"><span class="pre">ode_sol_simplicity(A,</span> <span class="pre">f)</span> <span class="pre">&lt;</span> <span class="pre">ode_sol_simplicity(B,</span> <span class="pre">f)</span></code> なる <code class="code docutils literal notranslate"><span class="pre">A</span></code> と <code class="code docutils literal notranslate"><span class="pre">B</span></code> については、
<code class="code docutils literal notranslate"><span class="pre">A</span></code> のほうが <code class="code docutils literal notranslate"><span class="pre">B</span></code> よりも解が簡単であると解釈する。</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">-2</span></code> や <code class="docutils literal notranslate"><span class="pre">-1</span></code> が戻ってくる場合は「解けている」または「解けていないが、解ける」を意味する。</li>
<li>何か正の整数が戻ってくる場合は「解けない」か「与えられた <code class="code docutils literal notranslate"><span class="pre">func</span></code> について解けない」を意味する。この値は解の文字列的な長さである。長い方程式のほうが難しそうだからこうしたのか。</li>
<li><code class="code docutils literal notranslate"><span class="pre">oo</span></code> が戻ってくる場合、解が未評価の Integral オブジェクトを含むことを意味する。</li>
<li>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">trysolving</span></code> は、ユーザーが既に解が解けないことを知っているときに利用できる。値 False を指示することで、計算を省略する。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> の <code class="code docutils literal notranslate"><span class="pre">simplify=False</span></code> と連動している。</li>
</ul>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id26">特化型ソルバー</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>SymPy のドキュメントが関数名と微分方程式の数式 (LaTeX) を併記していて素晴らしいので、カタログのように参照すると目当てのタイプのソルバーが提供されているかどうかはすぐにわかるだろう。</p>
<p>ここでは関数名だけを列挙するに留める。対応するヒント名を併記するとメモ代わりになるか。</p>
<ul class="simple">
<li><code class="code docutils literal notranslate"><span class="pre">ode_1st_exact</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_1st_homogeneous_coeff_subs_dep_div_indep</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_1st_homogeneous_coeff_subs_indep_div_dep</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_1st_linear</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_almost_linear</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_Bernoulli</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_linear_coefficients</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_Liouville</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_nth_linear_constant_coeff_homogeneous</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_nth_linear_constant_coeff_undetermined_coefficients</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_nth_linear_constant_coeff_variation_of_parameters</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_Riccati_special_minus2</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_separable</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">ode_separable_reduced</span></code></li>
</ul>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id27">連立常微分方程式</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>連立常微分方程式を <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> に評価させると、最初に関数 <code class="code docutils literal notranslate"><span class="pre">classify_sysode</span></code> を呼ぶ。これで方程式のタイプを判定して、特化型のソルバーに処理を委ねる。</p>
<p>このタイプ判定が下の図のように入れ子になっていて、末端のソルバーでは結局 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> を単一の方程式に対して適用することを繰り返す。</p>
<div class="code text highlight-default notranslate"><div class="highlight"><pre><span></span>sysode_linear_neq_order&lt;M&gt;
    sysode_linear_neq_order1
        _linear_neq_order1_type1
sysode_linear_&lt;N&gt;eq_order&lt;M&gt;
    sysode_linear_2eq_order1
        _linear_2eq_order1_type&lt;i&gt; i: 1-7
    sysode_linear_2eq_order2
        _linear_2eq_order2_type&lt;i&gt; i: 1-11
    sysode_linear_3eq_order1
        _linear_3eq_order1_type&lt;i&gt; i: 1-4
        _linear_neq_order1_type1 も流用。
sysode_nonlinear_&lt;N&gt;seq_order&lt;M&gt;
    sysode_nonlinear_2eq_order1
        _nonlinear_2eq_order1_type&lt;i&gt; i: 1-4
    sysode_nonlinear_3eq_order1
        _nonlinear_3eq_order1_type&lt;i&gt; i: 1-5
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2><a class="toc-backref" href="#id28">演習</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>ここに出てくる微分方程式は次の文書から拝借した。</p>
<ul class="simple">
<li><a class="reference external" href="http://reference.wolfram.com/language/tutorial/DSolveOverview.html">DSolveで解く微分方程式</a></li>
<li><a class="reference external" href="http://math.stackexchange.com/questions/650774/non-homogeneous-2nd-order-euler-cauchy-differential-equation">Non-homogeneous 2nd order Euler-Cauchy differential equation</a></li>
</ul>
<p>演習で得た自分なりのコツを次にまとめる。</p>
<ul class="simple">
<li>長い数式で表現される常微分方程式は SymPy のオブジェクトとしても長い表現になる。何度もタイプするハメにならぬように、素直にローカル変数を宣言してバインドしておく。</li>
<li>ソルバーに渡す前に関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode</span></code> で常微分方程式のタイプを判定しておく。その結果が次の <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> 呼び出しの <code class="code docutils literal notranslate"><span class="pre">hint</span></code> パラメーターを
<code class="code docutils literal notranslate"><span class="pre">all</span></code> にするか <code class="code docutils literal notranslate"><span class="pre">all_Integral</span></code> にするかの判断材料になる。<ul>
<li>空の tuple オブジェクトが戻ってくるようならば、残念だがその常微分方程式を SymPy で解くのを諦める。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> を呼び出すときは許される限り <code class="code docutils literal notranslate"><span class="pre">all_Integral</span></code> を指定する。この戻り値をザッと見ると、未評価の積分オブジェクトが一般解に含まれているだろう。必要ならばこれを <code class="code docutils literal notranslate"><span class="pre">doit()</span></code> にて手動で遅延評価する。</li>
</ul>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id29">常微分方程式</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>連立しないほうのパターン。</p>
<div class="section" id="id9">
<h4><a class="toc-backref" href="#id30">求積法だけで解が求まる常微分方程式</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>次のデモは単に <code class="code docutils literal notranslate"><span class="pre">integrate</span></code> するだけで解が得られる常微分方程式を与えるものだ。
SymPy のソルバーは一階線形常微分方程式の特別に単純な場合として処理する。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;1st_exact_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="p">),</span>
 <span class="s1">&#39;1st_linear_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">-</span> <span class="n">Integral</span><span class="p">((</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">((</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;1st_linear_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;separable&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_constant_coeff_variation_of_parameters_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span> <span class="o">-</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">)),</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;separable_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">))}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span> <span class="n">asinh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h4><a class="toc-backref" href="#id31">変数分離形常微分方程式</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>次のデモは、変数分離形のつもりで常微分方程式を解いたところ、むしろ Bernoulli 型のほうが解きやすい？と言われたものだ。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">(</span><span class="s1">&#39;separable&#39;</span><span class="p">,</span>
 <span class="s1">&#39;1st_exact&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bernoulli&#39;</span><span class="p">,</span>
 <span class="s1">&#39;1st_power_series&#39;</span><span class="p">,</span>
 <span class="s1">&#39;lie_group&#39;</span><span class="p">,</span>
 <span class="s1">&#39;separable_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;1st_exact_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;1st_exact_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">_y</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="p">),</span>
 <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;separable&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;separable_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">_y</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="p">))}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">asin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>変数分離形としてだけ扱われる常微分方程式を解く。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">_y</span><span class="p">),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span><span class="n">x</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;separable_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;separable&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;separable_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">_y</span><span class="p">),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="p">))}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">C1</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">asin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id11">
<h4><a class="toc-backref" href="#id32">一階同次常微分方程式</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>次のデモは同次常微分方程式を解くものだ。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;1st_homogeneous_coeff_subs_dep_div_indep_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">_u1</span> <span class="o">+</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">_u1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">_u1</span><span class="p">),</span> <span class="p">(</span><span class="n">_u1</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;1st_homogeneous_coeff_subs_indep_div_dep_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">_u2</span><span class="o">*</span><span class="p">(</span><span class="n">_u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="n">_u2</span><span class="p">,</span> <span class="n">x</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">_u2</span><span class="o">/</span><span class="p">(</span><span class="n">_u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">_u2</span><span class="p">,</span> <span class="n">x</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))))),</span>
 <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">C1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)))),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="n">_u2</span><span class="o">*</span><span class="p">(</span><span class="n">_u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="n">_u2</span><span class="p">,</span> <span class="n">x</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">_u2</span><span class="o">/</span><span class="p">(</span><span class="n">_u2</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">_u2</span><span class="p">,</span> <span class="n">x</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))))),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;1st_homogeneous_coeff_subs_indep_div_dep_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;Bernoulli&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h4><a class="toc-backref" href="#id33">一階線形常微分方程式</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>一階線形方程式の例だ。どのような常微分方程式のタイプとして扱っても厳しい積分が現れる。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;1st_exact_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="n">C1</span><span class="p">),</span>
 <span class="s1">&#39;1st_linear_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">-</span> <span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;almost_linear_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;1st_linear_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;1st_exact&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="bernoulli">
<h4><a class="toc-backref" href="#id34">Bernoulli 常微分方程式</a><a class="headerlink" href="#bernoulli" title="Permalink to this headline">¶</a></h4>
<p>Bernoulli 常微分方程式を解く。二番目のものは積分に時間が掛かるのだろうか、ついに返って来なかったので諦めた。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">((</span><span class="n">C1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)))),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">((</span><span class="n">C1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)))),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;Bernoulli&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">((</span><span class="n">C1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">121</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;Bernoulli&#39;</span><span class="p">,</span> <span class="s1">&#39;lie_group&#39;</span><span class="p">,</span> <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">((</span><span class="n">C1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">((</span><span class="n">C1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;Bernoulli_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;Bernoulli&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="riccati">
<h4><a class="toc-backref" href="#id35">Riccati 常微分方程式</a><a class="headerlink" href="#riccati" title="Permalink to this headline">¶</a></h4>
<p>ある Riccati 常微分方程式を試したところ、ベストは <code class="code docutils literal notranslate"><span class="pre">separable_reduced</span></code> だと判定された。それにしては解の有理式の形がやや不自然なようだ。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;Riccati_special_minus2&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">I</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span>  <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;separable_reduced&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;Riccati_special_minus2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;lie_group&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))),</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;separable_reduced&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)),</span>
 <span class="s1">&#39;separable_reduced_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">_y</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">_y</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="n">_y</span><span class="p">)),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="n">C1</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))}</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h4><a class="toc-backref" href="#id36">定数係数二階線形常微分方程式</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>特性方程式の解のパターン別に試す。ソルバーが適切なタイプ判定をしていることがわかる。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="euler">
<h4><a class="toc-backref" href="#id37">Euler 常微分方程式</a><a class="headerlink" href="#euler" title="Permalink to this headline">¶</a></h4>
<p>Euler 常微分方程式のデモを示す。同次。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_euler_eq_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_euler_eq_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_euler_eq_homogeneous&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">/</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
<p>次のものは非同次？</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">(</span><span class="s1">&#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters_Integral&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">/</span><span class="n">x</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h4><a class="toc-backref" href="#id38">特殊な二階常微分方程式</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>Airy 微分方程式を解く。ここではべき級数の形で一般解を得たが、よそではある広義積分で与えられる。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;2nd_power_series_ordinary&#39;</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;2nd_power_series_ordinary&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">)),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="mi">12</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;2nd_power_series_ordinary&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;2nd_power_series_ordinary&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
<p>Bessel 微分方程式を解く。またしてもべき級数の形で一般解が得られる。
SymPy は Airy 関数も Bessel 関数も持っているのに、微分方程式のモジュールには関与していないということだろうか。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;2nd_power_series_regular&#39;</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;2nd_power_series_regular&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">)),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;2nd_power_series_regular&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;2nd_power_series_regular&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h4><a class="toc-backref" href="#id39">二階線形非同次常微分方程式</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>解けているように見えるが、ヒントを <code class="code docutils literal notranslate"><span class="pre">all</span></code> にすると返って来ない？後半で同次版も解いてみる。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">(</span><span class="s1">&#39;nth_linear_euler_eq_nonhomogeneous_undetermined_coefficients&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_euler_eq_nonhomogeneous_variation_of_parameters_Integral&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;nth_linear_euler_eq_homogeneous&#39;</span><span class="p">,</span> <span class="s1">&#39;2nd_power_series_regular&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h4><a class="toc-backref" href="#id40">二階非線形常微分方程式</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>Liouville 型は解ける。それ以外が解けない。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;Liouville&#39;</span><span class="p">,</span> <span class="s1">&#39;Liouville_Integral&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;Liouville_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">_y</span><span class="p">)),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="mi">0</span><span class="p">),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">_y</span><span class="p">)),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="mi">0</span><span class="p">),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;Liouville_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;Liouville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">C2</span><span class="o">*</span><span class="n">erfi</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">11</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;Liouville&#39;</span><span class="p">,</span> <span class="s1">&#39;Liouville_Integral&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;Liouville_Integral&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">_y</span><span class="p">)),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="mi">0</span><span class="p">),</span>
 <span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Integral</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)),</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">_y</span><span class="p">)),</span> <span class="p">(</span><span class="n">_y</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">))),</span> <span class="mi">0</span><span class="p">),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;Liouville_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;Liouville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">_</span><span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">C2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">lowergamma</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">exp_polar</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">erfi</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h4><a class="toc-backref" href="#id41">定数係数高階線形常微分方程式</a><a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h4>
<p>SymPy のソルバーは 2 階以上は全部高階扱い。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="mi">17</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mi">108</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span><span class="mi">330</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">488</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">280</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">C5</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">C3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">C4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_constant_coeff_homogeneous&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">C5</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">C3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">C4</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h4><a class="toc-backref" href="#id42">高階 Euler 常微分方程式</a><a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p>SymPy のソルバーは 2 階以上は全部高階扱い。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;nth_linear_euler_eq_homogeneous&#39;</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="s1">&#39;all_Integral&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;best&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">C3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">C4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
 <span class="s1">&#39;best_hint&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_euler_eq_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;nth_linear_euler_eq_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_euler_eq_homogeneous&#39;</span><span class="p">:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">C3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">C4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h4><a class="toc-backref" href="#id43">特殊な高階常微分方程式</a><a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>二階で望みの形が得られないようならば、高階でもそうだ。次の例題は Airy 関数と Bessel 関数で一般解を返して欲しいもの。これはアウトのようだ。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">11</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">()</span>
</pre></div>
</div>
<p>次の例題はある高次整方程式の解で一般解が表現できる。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">13</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">19</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">33</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">(</span><span class="s1">&#39;nth_linear_constant_coeff_undetermined_coefficients&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_constant_coeff_variation_of_parameters&#39;</span><span class="p">,</span>
 <span class="s1">&#39;nth_linear_constant_coeff_variation_of_parameters_Integral&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">13</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">19</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">13</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">19</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="n">C3</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">13</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span><span class="mi">19</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="n">C4</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">RootOf</span><span class="p">(</span><span class="n">_x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">13</span><span class="o">*</span><span class="n">_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">19</span><span class="o">*</span><span class="n">_x</span> <span class="o">+</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="mi">38</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">11645</span> <span class="o">+</span> <span class="mi">101</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">11645</span><span class="p">)</span>
</pre></div>
</div>
<p>こちらは完全にダメだ。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">11</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id20">
<h3><a class="toc-backref" href="#id44">連立常微分方程式</a><a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<p>何となく動作が不安定であるように見受けられる。場合によってはバグレポートを開発陣に提出するかもしれない。</p>
<div class="section" id="id21">
<h4><a class="toc-backref" href="#id45">線形</a><a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>以下の例では、次の前処理を実施済みであることを事前条件としている。</p>
<div class="code python3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.solvers.ode</span> <span class="k">import</span> <span class="n">classify_sysode</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y z&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>まずは定数係数の例を示す。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;eq&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">),</span>
  <span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func_coeff&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">6</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">},</span>
 <span class="s1">&#39;is_linear&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;no_of_equation&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">},</span>
 <span class="s1">&#39;type_of_equation&#39;</span><span class="p">:</span> <span class="s1">&#39;type1&#39;</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="p">[</span><span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">C2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)),</span>
         <span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">C2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">))]</span>
</pre></div>
</div>
<p>次の常微分方程式系は <code class="code docutils literal notranslate"><span class="pre">type_of_equation</span></code> が None とされている。つまりタイプ不明ゆえ解けない。こういう場合は <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> の呼び出しを諦めてしまってよい。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mi">64</span> <span class="o">*</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;eq&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>
  <span class="o">-</span><span class="mi">64</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func_coeff&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">64</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">0</span><span class="p">},</span>
 <span class="s1">&#39;is_linear&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;no_of_equation&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">3</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">3</span><span class="p">},</span>
 <span class="s1">&#39;type_of_equation&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>
</div>
<p>次は非定数係数の線形常微分方程式系の一例だが、解きたそうなのに解けないようだ。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;eq&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">),</span> <span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)],</span>  <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func_coeff&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">},</span>
 <span class="s1">&#39;is_linear&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;no_of_equation&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">},</span>
 <span class="s1">&#39;type_of_equation&#39;</span><span class="p">:</span> <span class="s1">&#39;type6&#39;</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">223</span><span class="o">-</span><span class="mi">094226</span><span class="n">d3d973</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">hint</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">ics</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">614</span>             <span class="k">else</span><span class="p">:</span>
    <span class="mi">615</span>                 <span class="n">solvefunc</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;sysode_nonlinear_</span><span class="si">%(no_of_equation)s</span><span class="s1">eq_order</span><span class="si">%(order)s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">match</span><span class="p">]</span>
<span class="o">--&gt;</span> <span class="mi">616</span>             <span class="n">sols</span> <span class="o">=</span> <span class="n">solvefunc</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>
    <span class="mi">617</span>             <span class="k">return</span> <span class="n">sols</span>
    <span class="mi">618</span>     <span class="k">else</span><span class="p">:</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">sysode_linear_2eq_order1</span><span class="p">(</span><span class="n">match_</span><span class="p">)</span>
   <span class="mi">6418</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_linear_2eq_order1_type5</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
   <span class="mi">6419</span>     <span class="k">if</span> <span class="n">match_</span><span class="p">[</span><span class="s1">&#39;type_of_equation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;type6&#39;</span><span class="p">:</span>
<span class="o">-&gt;</span> <span class="mi">6420</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_linear_2eq_order1_type6</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
   <span class="mi">6421</span>     <span class="k">if</span> <span class="n">match_</span><span class="p">[</span><span class="s1">&#39;type_of_equation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;type7&#39;</span><span class="p">:</span>
   <span class="mi">6422</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_linear_2eq_order1_type7</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_linear_2eq_order1_type6</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
   <span class="mi">6725</span>     <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
   <span class="mi">6726</span>         <span class="n">equ</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)))</span>
<span class="o">-&gt;</span> <span class="mi">6727</span>         <span class="n">hint1</span> <span class="o">=</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">equ</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
   <span class="mi">6728</span>         <span class="n">sol1</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">equ</span><span class="p">,</span> <span class="n">hint</span><span class="o">=</span><span class="n">hint1</span><span class="o">+</span><span class="s1">&#39;_Integral&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rhs</span>
   <span class="mi">6729</span>         <span class="n">sol2</span> <span class="o">=</span> <span class="n">s</span><span class="o">*</span><span class="n">sol1</span> <span class="o">+</span> <span class="n">C1</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">Integral</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">classify_ode</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">ics</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">817</span>         <span class="s2">&quot;work with functions of one variable, not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">func</span><span class="p">)</span>
    <span class="mi">818</span>     <span class="k">if</span> <span class="n">prep</span> <span class="ow">or</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">819</span>         <span class="n">eq</span><span class="p">,</span> <span class="n">func_</span> <span class="o">=</span> <span class="n">_preprocess</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
    <span class="mi">820</span>         <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="mi">821</span>             <span class="n">func</span> <span class="o">=</span> <span class="n">func_</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">deutils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_preprocess</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
     <span class="mi">75</span>         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
     <span class="mi">76</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The function cannot be &#39;</span>
<span class="o">---&gt;</span> <span class="mi">77</span>                 <span class="s1">&#39;automatically detected for </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">expr</span><span class="p">)</span>
     <span class="mi">78</span>         <span class="n">func</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
     <span class="mi">79</span>     <span class="n">fvars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

<span class="ne">ValueError</span><span class="p">:</span> <span class="n">The</span> <span class="n">function</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">automatically</span> <span class="n">detected</span> <span class="k">for</span> <span class="n">nan</span><span class="o">.</span>
</pre></div>
</div>
<p>次は成功例。積分もおそらく評価し切れる。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="p">[</span><span class="o">-</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)]];</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;eq&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">),</span>
  <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func_coeff&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">},</span>
 <span class="s1">&#39;is_linear&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;no_of_equation&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">},</span>
 <span class="s1">&#39;type_of_equation&#39;</span><span class="p">:</span> <span class="s1">&#39;type4&#39;</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">[</span><span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">))),</span> <span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">C1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span> <span class="o">+</span> <span class="n">C2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)))]</span>
</pre></div>
</div>
<p>次のものは解けないと言われる。本筋とは外れるが、関数 <code class="code docutils literal notranslate"><span class="pre">classify_sysode</span></code> の出力にある dict オブジェクトのアイテム順はなんとかならないか。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]);</span> <span class="n">X</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;eq&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">),</span>
  <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">),</span>
  <span class="o">-</span><span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func_coeff&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">},</span>
 <span class="s1">&#39;is_linear&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
 <span class="s1">&#39;no_of_equation&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">},</span>
 <span class="s1">&#39;type_of_equation&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id22">
<h4><a class="toc-backref" href="#id46">非線形</a><a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>謎のエラーが出てソルバーにたどり着けない。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;p q r s&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">))]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">funcs</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span>                                  <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">25</span><span class="o">-</span><span class="mi">65</span><span class="n">d1e646ce2f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="n">funcs</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">q</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">funcs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
   <span class="mi">1389</span>                 <span class="n">func_dict</span><span class="p">[</span><span class="n">eq_no</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
   <span class="mi">1390</span>             <span class="n">order</span><span class="p">[</span><span class="n">func</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_order</span>
<span class="o">-&gt;</span> <span class="mi">1391</span>     <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">func_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func_dict</span><span class="p">))]</span>
   <span class="mi">1392</span>     <span class="n">matching_hints</span><span class="p">[</span><span class="s1">&#39;func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funcs</span>
   <span class="mi">1393</span>     <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">listcomp</span><span class="o">&gt;</span><span class="p">(</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
   <span class="mi">1389</span>                 <span class="n">func_dict</span><span class="p">[</span><span class="n">eq_no</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
   <span class="mi">1390</span>             <span class="n">order</span><span class="p">[</span><span class="n">func</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_order</span>
<span class="o">-&gt;</span> <span class="mi">1391</span>     <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">func_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">func_dict</span><span class="p">))]</span>
   <span class="mi">1392</span>     <span class="n">matching_hints</span><span class="p">[</span><span class="s1">&#39;func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funcs</span>
   <span class="mi">1393</span>     <span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<p>次の例ではソルバーの処理中に謎のエラーが出る。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u v&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">sys</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">classify_sysode</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">&#39;eq&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">Derivative</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="o">-</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span>
 <span class="s1">&#39;func_coeff&#39;</span><span class="p">:</span> <span class="p">{(</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span>
  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">},</span>
 <span class="s1">&#39;is_linear&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;no_of_equation&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
 <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">},</span>
 <span class="s1">&#39;type_of_equation&#39;</span><span class="p">:</span> <span class="s1">&#39;type3&#39;</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>
<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">30</span><span class="o">-</span><span class="mi">094226</span><span class="n">d3d973</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">sys</span><span class="p">)</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">hint</span><span class="p">,</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">ics</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">615</span>             <span class="k">else</span><span class="p">:</span>
    <span class="mi">616</span>                 <span class="n">solvefunc</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()[</span><span class="s1">&#39;sysode_nonlinear_</span><span class="si">%(no_of_equation)s</span><span class="s1">eq_order</span><span class="si">%(order)s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">match</span><span class="p">]</span>
<span class="o">--&gt;</span> <span class="mi">617</span>             <span class="n">sols</span> <span class="o">=</span> <span class="n">solvefunc</span><span class="p">(</span><span class="n">match</span><span class="p">)</span>
    <span class="mi">618</span>             <span class="k">return</span> <span class="n">sols</span>
    <span class="mi">619</span>     <span class="k">else</span><span class="p">:</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">sysode_nonlinear_2eq_order1</span><span class="p">(</span><span class="n">match_</span><span class="p">)</span>
   <span class="mi">7772</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_nonlinear_2eq_order1_type2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
   <span class="mi">7773</span>     <span class="k">elif</span> <span class="n">match_</span><span class="p">[</span><span class="s1">&#39;type_of_equation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;type3&#39;</span><span class="p">:</span>
<span class="o">-&gt;</span> <span class="mi">7774</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_nonlinear_2eq_order1_type3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
   <span class="mi">7775</span>     <span class="k">elif</span> <span class="n">match_</span><span class="p">[</span><span class="s1">&#39;type_of_equation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;type4&#39;</span><span class="p">:</span>
   <span class="mi">7776</span>         <span class="n">sol</span> <span class="o">=</span> <span class="n">_nonlinear_2eq_order1_type4</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">ode</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_nonlinear_2eq_order1_type3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">eq</span><span class="p">)</span>
   <span class="mi">7894</span>     <span class="n">G</span> <span class="o">=</span> <span class="n">r2</span><span class="p">[</span><span class="n">g</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">v</span><span class="p">)</span>
   <span class="mi">7895</span>     <span class="n">sol2r</span> <span class="o">=</span> <span class="n">dsolve</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="n">u</span><span class="p">),</span> <span class="n">G</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">/</span><span class="n">F</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">u</span><span class="p">))))</span>
<span class="o">-&gt;</span> <span class="mi">7896</span>     <span class="k">for</span> <span class="n">sol2s</span> <span class="ow">in</span> <span class="n">sol2r</span><span class="p">:</span>
   <span class="mi">7897</span>         <span class="n">sol1</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">F</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">sol2s</span><span class="o">.</span><span class="n">rhs</span><span class="p">),</span> <span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">doit</span><span class="p">()</span> <span class="o">-</span> <span class="n">t</span> <span class="o">-</span> <span class="n">C2</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
   <span class="mi">7898</span>     <span class="n">sol</span> <span class="o">=</span> <span class="p">[]</span>

<span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;Equality&#39;</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">iterable</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="pde.html" title="偏微分方程式"
             >next</a></li>
        <li class="right" >
          <a href="integrals.html" title="積分"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >SymPy 利用ノート</a> &#187;</li> 
      </ul>
    </div>
    <div id="footer">
      <div id="footer_logo">
        <a class="imga" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png" width="88" height="31" /></a>
      </div>
      <div id="footer_copyright">
        Since 1999<br />
        Copyright &copy; 1999-2018, プレハブ小屋 All rights reserved.
      </div>
    </div>
  </body>
</html>