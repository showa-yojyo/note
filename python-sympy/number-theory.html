
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>整数論 &#8212; 読書ノート v1.4</title>
    <link rel="stylesheet" href="../_static/prefab.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/mathjaxconf.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="next" title="ディオファントス方程式" href="diophantine.html" />
    <link rel="prev" title="多項式" href="polynomials.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="diophantine.html" title="ディオファントス方程式"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="polynomials.html" title="多項式"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">SymPy 利用ノート</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id10">整数論</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://www.sympy.org/">SymPy</a> の整数論モジュールについて記す。</p>
<div class="contents topic" id="id2">
<p class="topic-title first">ノート目次</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id10">整数論</a><ul>
<li><a class="reference internal" href="#id3" id="id11">素数</a><ul>
<li><a class="reference internal" href="#sieve" id="id12">クラス Sieve</a></li>
<li><a class="reference internal" href="#id4" id="id13">素数に関連する関数</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5" id="id14">素因数分解と約数</a></li>
<li><a class="reference internal" href="#id6" id="id15">合同式</a></li>
<li><a class="reference internal" href="#id7" id="id16">二項係数と多項係数</a></li>
<li><a class="reference internal" href="#id8" id="id17">剰余</a></li>
<li><a class="reference internal" href="#id9" id="id18">連分数</a></li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>本文中のすべての IPython セッション中のサンプルコードで、以下のインポートおよび出力書式設定が済んでいるものとする。</p>
<div class="code python3 last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">init_printing</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id11">素数</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sieve">
<h3><a class="toc-backref" href="#id12">クラス Sieve</a><a class="headerlink" href="#sieve" title="Permalink to this headline">¶</a></h3>
<p>クラス Sieve は素数全体を表現する。または表現したい。「エラトステネスのふるい」にちなんだクラス名は、クラスの素数の管理方法をなんとなく示唆している。</p>
<ul class="simple">
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">extend</span></code> で、指定素数までの全ての素数をオブジェクトが保持するようにできる。</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">extend_to_no</span></code> で任意番目の素数までの以下同文。</li>
</ul>
<p>ユーザーが自分でコンストラクター経由でオブジェクトを生成するのもよいが、実は <code class="code docutils literal notranslate"><span class="pre">sympy</span></code> スコープにオブジェクト <code class="code docutils literal notranslate"><span class="pre">sieve</span></code> が存在している。まずはこれを試すとよい。</p>
<ul class="simple">
<li><code class="code docutils literal notranslate"><span class="pre">p</span> <span class="pre">in</span> <span class="pre">sieve</span></code> で <code class="code docutils literal notranslate"><span class="pre">p</span></code> が素数がどうかをテストできる。<ul>
<li>テストまでにユーザーが <code class="code docutils literal notranslate"><span class="pre">sieve</span></code> を大きくする必要はない。オブジェクト自身が必要に応じて <code class="code docutils literal notranslate"><span class="pre">extend(p)</span></code> のようなことをする。</li>
<li>運が悪いとメソッドが例外 MemoryError を送出する。</li>
</ul>
</li>
<li><code class="code docutils literal notranslate"><span class="pre">sieve.primerange(a,</span> <span class="pre">b)</span></code> で <code class="code docutils literal notranslate"><span class="pre">a</span></code> 以上 <code class="code docutils literal notranslate"><span class="pre">b</span></code> 未満のすべての素数を列挙するジェネレーターを生成する。</li>
<li><code class="code docutils literal notranslate"><span class="pre">sieve.search(n)</span></code> が少しわかりづらい。ドキュメントによると <code class="code docutils literal notranslate"><span class="pre">i</span> <span class="pre">&lt;=</span> <span class="pre">n</span> <span class="pre">&lt;</span> <span class="pre">j</span></code> なる素数列の添字 <code class="code docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> を返すようだが、
<code class="code docutils literal notranslate"><span class="pre">n</span></code> が素数ならば <code class="code docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">i)</span></code> を返す。はて <code class="code docutils literal notranslate"><span class="pre">j</span></code> は常に <code class="code docutils literal notranslate"><span class="pre">i</span></code> または <code class="code docutils literal notranslate"><span class="pre">i</span> <span class="pre">+</span> <span class="pre">1</span></code> ではないのだろうか。</li>
</ul>
</div>
<div class="section" id="id4">
<h3><a class="toc-backref" href="#id13">素数に関連する関数</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>素数に関連する関数は主にモジュール <code class="docutils literal notranslate"><span class="pre">sympy.ntheory.generate</span></code> に定義されている。憶測だが（コードを読めば直ちに判明するが）、これらの関数の内部では上述のオブジェクト <code class="code docutils literal notranslate"><span class="pre">sieve</span></code> を参照しているのではないだろうか。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">prime(i)</span></code></dt>
<dd>任意 <code class="code docutils literal notranslate"><span class="pre">i</span></code> 番目の素数を得られる。</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">primepi(n)</span></code></dt>
<dd><p class="first">指定した数よりも小さい素数の個数を返す。引数が素数の場合はそれも含んで計上する。</p>
<ul class="last simple">
<li>10 億を試したら MemoryError で失敗。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">integrate</span></code> の被積分関数として扱えない？</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">nextprime(n,</span> <span class="pre">i=1)</span></code>, <code class="code docutils literal notranslate"><span class="pre">prevprime(n,</span> <span class="pre">i=1)</span></code></dt>
<dd><p class="first">指定した数から大きい、または小さい <code class="code docutils literal notranslate"><span class="pre">i</span></code> 番目の素数を返す。</p>
<ul class="last simple">
<li>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">i</span></code> に負の値を指定すると、直感に反する値が返る。</li>
<li><code class="code docutils literal notranslate"><span class="pre">prevprime</span></code> のほうは例外 ValueError を送出することがある。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">primorial</span></code></dt>
<dd>どう使おう。引数の意味をキーワード引数 <code class="code docutils literal notranslate"><span class="pre">nth</span></code> で変えられることに注意。</dd>
</dl>
<p>次の素数に関連する関数はモジュール <code class="docutils literal notranslate"><span class="pre">primetest</span></code> に存在する。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">isprime(p)</span></code></dt>
<dd><p class="first">指定した数が素数かどうかテストする。</p>
<p class="last">ただし、この関数が正確にテストするために <code class="code docutils literal notranslate"><span class="pre">p</span></code> に上限があるようだ。</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id14">素因数分解と約数</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>モジュール <code class="docutils literal notranslate"><span class="pre">sympy.ntheory.factor_</span></code> には素因数分解や約数にまつわる関数がある。本当は 10 個を軽く超える関数が提供されているのだが、私が理解できるものだけをここに記す。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">factorint(n)</span></code></dt>
<dd><p class="first">正の整数 <code class="code docutils literal notranslate"><span class="pre">n</span></code> を素因数分解して、結果を通常は dict オブジェクトの形で返す。</p>
<ul class="last simple">
<li>例えば <code class="code docutils literal notranslate"><span class="pre">factorint(2000)</span></code> は <code class="code docutils literal notranslate"><span class="pre">{2:4,</span> <span class="pre">5:3}</span></code> を返す。キーが素因数、値が指数のペアの辞書。</li>
<li>キーワード引数がたくさんある。</li>
<li>実装コードを見たらわけがわからない。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">primefactors(n)</span></code></dt>
<dd><p class="first">因数のリストだけを返す。指数は捨てられる。</p>
<p class="last">内部で <code class="code docutils literal notranslate"><span class="pre">factorint</span></code> を利用しており、キーワード引数 <code class="code docutils literal notranslate"><span class="pre">limit</span></code> と <code class="code docutils literal notranslate"><span class="pre">verbose</span></code> が引き継がれる。</p>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">divisors(n,</span> <span class="pre">generator=False)</span></code></dt>
<dd><p class="first">整数 <code class="code docutils literal notranslate"><span class="pre">n</span></code> の約数を 1 から <code class="code docutils literal notranslate"><span class="pre">n</span></code> までソートして list オブジェクトで返す。</p>
<p class="last">ただしキーワード引数で <code class="code docutils literal notranslate"><span class="pre">generator=True</span></code> とするとき、動きが全く異なる。関数が約数を列挙するジェネレーターを返す。さらに yield する値の順番は関数のそれとは異なる。</p>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">divisor_count(n,</span> <span class="pre">modulus=1)</span></code></dt>
<dd><p class="first">整数 <code class="code docutils literal notranslate"><span class="pre">n</span></code> の約数の個数を返す。</p>
<p class="last">実装は関数 <code class="code docutils literal notranslate"><span class="pre">factorint</span></code> の返す各素因数の指数を利用している。</p>
</dd>
</dl>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">udivisors</span></code>, <code class="code docutils literal notranslate"><span class="pre">udivisor_count</span></code> というものもある。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">antidivisors</span></code>, <code class="code docutils literal notranslate"><span class="pre">antidivisor_count</span></code> というものもある。</li>
</ul>
<dl class="docutils">
<dt>クラス <code class="code docutils literal notranslate"><span class="pre">totient</span></code></dt>
<dd><p class="first">オイラーの totient 関数を計算するクラス。実装で関数 <code class="code docutils literal notranslate"><span class="pre">factorint</span></code> の結果をフル活用している。</p>
<ul class="last">
<li><p class="first">クラス Function のサブクラスなので、評価をするには <code class="code docutils literal notranslate"><span class="pre">totient(n)</span></code> のようにする。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">[</span><span class="n">totient</span><span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">40000</span><span class="p">,</span> <span class="mi">400000</span><span class="p">,</span> <span class="mi">4000000</span><span class="p">,</span> <span class="mi">40000000</span><span class="p">,</span> <span class="mi">400000000</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">digits(n,</span> <span class="pre">p=10)</span></code></dt>
<dd>任意整数 <code class="code docutils literal notranslate"><span class="pre">n</span></code> を <code class="code docutils literal notranslate"><span class="pre">p</span></code> 進数表現して、その各桁をリストする。戻り値は list オブジェクトだが、最初の要素は <code class="code docutils literal notranslate"><span class="pre">p</span></code> そのものなので捨ててよい。</dd>
</dl>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id15">合同式</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>モジュール <code class="docutils literal notranslate"><span class="pre">sympy.ntheory.modular</span></code> は合同式に関係する機能を提供する。使えそうなものをピックアップしていこう。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">crt(m,</span> <span class="pre">v,</span> <span class="pre">symmetric=False,</span> <span class="pre">check=True)</span></code></dt>
<dd><p class="first">中国剰余定理に基づく問題を解くのに利用できる。例を示す。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">crt</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">105</span><span class="p">)</span>
</pre></div>
</div>
<p>23 + 105k を 3, 5, 7 でそれぞれ割ると余りが 2, 3, 2 になるという解が得られた。</p>
<ul class="last">
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">symmetric=True</span></code> とすると、剰余が対称になるように、解が必要に応じて非負で得られる。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">check=False</span></code> の使いどころが不明。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">crt</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">crt</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">solve_congruence(*remainder_modulus_pairs,</span> <span class="pre">**hint)</span></code></dt>
<dd><p class="first">合同式を解くわけだが、前述の関数 <code class="code docutils literal notranslate"><span class="pre">crt</span></code> と同様だと思う。ただし引数の順序が異なる。</p>
<ul class="last simple">
<li><code class="code docutils literal notranslate"><span class="pre">solve_congruence((2,</span> <span class="pre">3),</span> <span class="pre">(3,</span> <span class="pre">5),</span> <span class="pre">(2,</span> <span class="pre">7))</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">solve_congruence(*zip((2,</span> <span class="pre">3,</span> <span class="pre">2),</span> <span class="pre">(3,</span> <span class="pre">5,</span> <span class="pre">7)))</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">crt</span></code> が <code class="code docutils literal notranslate"><span class="pre">solve_congruence</span></code> を利用している。</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id7">
<h2><a class="toc-backref" href="#id16">二項係数と多項係数</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>モジュール <code class="docutils literal notranslate"><span class="pre">sympy.ntheory.multinomial</span></code> にある関数について記す。モジュール名は多項係数だが、二項係数に特化した関数も存在する。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">binomial_coefficients(n)</span></code></dt>
<dd><p class="first">パスカルの三角形の n 段目を dict で返す。</p>
<p class="last">辞書のキーは tuple オブジェクト <code class="code docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">n)</span></code>, <code class="code docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">n</span> <span class="pre">-</span> <span class="pre">1)</span></code>, … , <code class="code docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">0)</span></code> である。分母に来る階乗ふたつの引数と覚えられる。辞書の値は、それぞれのキーに対応する二項係数を表す。</p>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">binomial_coefficients_list(n)</span></code></dt>
<dd><p class="first">パスカルの三角形の n 段目を全部得る。戻り値は list である。</p>
<p class="last">こちらは単に二項係数が一列に並んだものが得られる。</p>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">multinomial_coefficients(m,</span> <span class="pre">n)</span></code></dt>
<dd><p class="first">二項係数を得る関数 <code class="code docutils literal notranslate"><span class="pre">binomial_coefficients(n)</span></code> の一般化版。</p>
<p class="last">二項係数は <span class="math notranslate nohighlight">\((a_1 + a_2) ^ n\)</span> の各項の係数だが、多項係数は
<span class="math notranslate nohighlight">\((a_1 + a_2 + ... + a_k) ^ n\)</span> の各項の係数を表現する。</p>
</dd>
<dt>ジェネレーター <code class="code docutils literal notranslate"><span class="pre">multinomial_coefficients_iterator(m,</span> <span class="pre">n)</span></code></dt>
<dd>関数 <code class="code docutils literal notranslate"><span class="pre">multinomial_coefficients(m,</span> <span class="pre">n)</span></code> のジェネレーター版。関数版よりも空間的にも時間的にも効率的であることが期待できる。</dd>
</dl>
</div>
<div class="section" id="id8">
<h2><a class="toc-backref" href="#id17">剰余</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>モジュール <code class="docutils literal notranslate"><span class="pre">sympy.ntheory.residue_ntheory</span></code> にある関数について記す。ただしインポートは <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">sympy.ntheory</span> <span class="pre">import</span> <span class="pre">...</span></code> で可能。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">n_order(a,</span> <span class="pre">n)</span></code></dt>
<dd><p class="first">乗積順序を求める。
<code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">**</span> <span class="pre">k</span> <span class="pre">%</span> <span class="pre">n</span> <span class="pre">==</span> <span class="pre">1</span></code> を満たす最小の整数 <code class="code docutils literal notranslate"><span class="pre">k</span></code> を返す。これを &lt;the order of <cite>a</cite> modulo <cite>n</cite>&gt; と英語では言うらしい。日本語なら「<cite>a</cite> の法 <cite>n</cite> の位数」か。</p>
<div class="code ipython last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">n_order</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">prime</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="mi">3959</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">Pow</span><span class="p">(</span><span class="n">Pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">3959</span><span class="p">)</span> <span class="o">%</span> <span class="n">prime</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="mi">1</span>
</pre></div>
</div>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">is_primitive_root(a,</span> <span class="pre">p)</span></code></dt>
<dd><p class="first"><code class="code docutils literal notranslate"><span class="pre">a</span></code> が <code class="code docutils literal notranslate"><span class="pre">p</span></code> の原始根であるかをテストする。</p>
<p class="last">意味としては <code class="code docutils literal notranslate"><span class="pre">a</span></code> と <code class="code docutils literal notranslate"><span class="pre">p</span></code> が互いに素であり、かつ <code class="code docutils literal notranslate"><span class="pre">p</span></code> が <code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">**</span> <span class="pre">totient(p)</span> <span class="pre">%</span> <span class="pre">p</span> <span class="pre">==</span> <span class="pre">1</span></code> を満たす最小の <code class="code docutils literal notranslate"><span class="pre">p</span></code> であるかどうかをテストする。言い換えると <code class="code docutils literal notranslate"><span class="pre">a</span></code> の位数が <code class="code docutils literal notranslate"><span class="pre">p</span> <span class="pre">-</span> <span class="pre">1</span></code> であるかどうかをテストする。</p>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">primitive_root(p)</span></code></dt>
<dd><p class="first">存在するときに限り <code class="code docutils literal notranslate"><span class="pre">p</span></code> の最小の原始根を返す。つまり <code class="code docutils literal notranslate"><span class="pre">p</span></code> と互いに素で、かつ <code class="code docutils literal notranslate"><span class="pre">p</span></code> を法とする整数の乗法群の生成元を求める。</p>
<div class="code ipython last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">primitive_root</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="mi">2</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="nb">any</span><span class="p">([(</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="mi">27</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">)])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="kc">True</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">n_order</span><span class="p">(</span><span class="n">primitive_root</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span> <span class="mi">27</span><span class="p">)</span> <span class="o">==</span> <span class="n">totient</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="kc">True</span>
</pre></div>
</div>
</dd>
</dl>
<p>他にも色々あるので、アレがないかコレがないかというときはドキュメントを当たるべし。</p>
</div>
<div class="section" id="id9">
<h2><a class="toc-backref" href="#id18">連分数</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>モジュール <code class="docutils literal notranslate"><span class="pre">sympy.ntheory.continued_fraction</span></code> に置いてある、連分数を扱う関数各種について記す。</p>
<dl class="docutils">
<dt>ジェネレーター <code class="code docutils literal notranslate"><span class="pre">continued_fraction_iterator(x)</span></code></dt>
<dd><p class="first">引数 <code class="code docutils literal notranslate"><span class="pre">x</span></code> の連分数展開（分子は全部 1 とする）を求め、その分母をひとつずつ yield する。</p>
<p>一度実装を見ておいたほうがよい。</p>
<ul class="last">
<li><p class="first">これは微妙に使いにくい。値によっては自分でループを書く必要があるだろう。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">islice</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="nb">list</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">continued_fraction_iterator</span><span class="p">(</span><span class="n">coth</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">39</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="nb">list</span><span class="p">(</span><span class="n">islice</span><span class="p">(</span><span class="n">continued_fraction_iterator</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Pi</span><span class="p">),</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">292</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</dd>
<dt>ジェネレーター <code class="code docutils literal notranslate"><span class="pre">continued_fraction_convergents(cf)</span></code></dt>
<dd><p class="first">連分数 <code class="code docutils literal notranslate"><span class="pre">cf</span></code> の「真の値」に収束する数列の数をひとつずつ yield する。</p>
<ul class="last simple">
<li><code class="code docutils literal notranslate"><span class="pre">cf</span></code> は連分数の各項（分母）を list オブジェクト等に収容したもの。</li>
<li><code class="code docutils literal notranslate"><span class="pre">cf</span></code> の各項の分子が 1 であるという条件は特に課せられていない。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">continued_fraction_periodic(p,</span> <span class="pre">q,</span> <span class="pre">d=0)</span></code></dt>
<dd><p class="first">整数係数二次方程式の根となる無理数の循環連分数展開を返す。単に <code class="code docutils literal notranslate"><span class="pre">(p</span> <span class="pre">+</span> <span class="pre">sqrt(d))</span> <span class="pre">/</span> <span class="pre">q</span></code> の連分数を返すと覚えておいて支障はない。</p>
<ul class="last simple">
<li>戻り値は入れ子の list オブジェクトで、内側のそれが循環部分を示す。</li>
<li>根号の中 <code class="code docutils literal notranslate"><span class="pre">d</span></code> が平方数の場合は連分数は循環しない。戻り値はフラットな list オブジェクトとなる。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">continued_fraction_reduce(cf)</span></code></dt>
<dd><p class="first">連分数 <code class="code docutils literal notranslate"><span class="pre">cf</span></code> を連分数でない形で返す。</p>
<div class="code ipython last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">continued_fraction_reduce</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">c</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="diophantine.html" title="ディオファントス方程式"
             >next</a></li>
        <li class="right" >
          <a href="polynomials.html" title="多項式"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >SymPy 利用ノート</a> &#187;</li> 
      </ul>
    </div>
    <div id="footer">
      <div id="footer_logo">
        <a class="imga" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png" width="88" height="31" /></a>
      </div>
      <div id="footer_copyright">
        Since 1999<br />
        Copyright &copy; 1999-2018, プレハブ小屋 All rights reserved.
      </div>
    </div>
  </body>
</html>