
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>チュートリアルを読む &#8212; 読書ノート v1.4</title>
    <link rel="stylesheet" href="../_static/prefab.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/mathjaxconf.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="next" title="プロットを利用する" href="plotting.html" />
    <link rel="prev" title="ドキュメントをビルドする" href="doc.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="plotting.html" title="プロットを利用する"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="doc.html" title="ドキュメントをビルドする"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">SymPy 利用ノート</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id4">チュートリアルを読む</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>本稿は <a class="reference external" href="http://www.sympy.org/">SymPy</a> の SymPy Tutorial を読んだときのメモである。</p>
<div class="contents topic" id="id2">
<p class="topic-title first">ノート目次</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id4">チュートリアルを読む</a><ul>
<li><a class="reference internal" href="#preliminaries" id="id5">Preliminaries</a><ul>
<li><a class="reference internal" href="#installtion" id="id6">Installtion</a></li>
<li><a class="reference internal" href="#exercises" id="id7">Exercises</a></li>
<li><a class="reference internal" href="#about-this-tutorial" id="id8">About This Tutorial</a></li>
</ul>
</li>
<li><a class="reference internal" href="#introduction" id="id9">Introduction</a><ul>
<li><a class="reference internal" href="#what-is-symbolic-computation" id="id10">What is Symbolic Computation?</a></li>
<li><a class="reference internal" href="#a-more-interesting-example" id="id11">A More Interesting Example</a></li>
<li><a class="reference internal" href="#the-power-of-symbolic-computation" id="id12">The Power of Symbolic Computation</a></li>
<li><a class="reference internal" href="#why-sympy" id="id13">Why SymPy?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gotchas" id="id14">Gotchas</a><ul>
<li><a class="reference internal" href="#symbols" id="id15">Symbols</a></li>
<li><a class="reference internal" href="#equals-signs" id="id16">Equals signs</a></li>
<li><a class="reference internal" href="#two-final-notes-and" id="id17">Two Final Notes: <code class="code docutils literal notranslate"><span class="pre">^</span></code> and <code class="code docutils literal notranslate"><span class="pre">/</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-operations" id="id18">Basic Operations</a><ul>
<li><a class="reference internal" href="#substitution" id="id19">Substitution</a></li>
<li><a class="reference internal" href="#converting-strings-to-sympy-expressions" id="id20">Converting Strings to SymPy Expressions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#printing" id="id21">Printing</a><ul>
<li><a class="reference internal" href="#printers" id="id22">Printers</a></li>
<li><a class="reference internal" href="#setting-up-pretty-printing" id="id23">Setting up Pretty Printing</a></li>
<li><a class="reference internal" href="#printing-functions" id="id24">Printing Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simplification" id="id25">Simplification</a><ul>
<li><a class="reference internal" href="#simplify" id="id26"><code class="code docutils literal notranslate"><span class="pre">simplify</span></code></a></li>
<li><a class="reference internal" href="#polynomial-rational-function-simplification" id="id27">Polynomial/Rational Function Simplification</a></li>
<li><a class="reference internal" href="#trigonometric-simplification" id="id28">Trigonometric Simplification</a></li>
<li><a class="reference internal" href="#powers" id="id29">Powers</a></li>
<li><a class="reference internal" href="#exponentials-and-logarithms" id="id30">Exponentials and logarithms</a></li>
<li><a class="reference internal" href="#special-functions" id="id31">Special Functions</a></li>
<li><a class="reference internal" href="#example-continued-fractions" id="id32">Example: Continued Fractions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calculus" id="id33">Calculus</a><ul>
<li><a class="reference internal" href="#derivatives" id="id34">Derivatives</a></li>
<li><a class="reference internal" href="#integrals" id="id35">Integrals</a></li>
<li><a class="reference internal" href="#limits" id="id36">Limits</a></li>
<li><a class="reference internal" href="#series-expansion" id="id37">Series Expansion</a></li>
<li><a class="reference internal" href="#finite-differences" id="id38">Finite differences</a></li>
</ul>
</li>
<li><a class="reference internal" href="#solvers" id="id39">Solvers</a><ul>
<li><a class="reference internal" href="#a-note-about-equations" id="id40">A Note about Equations</a></li>
<li><a class="reference internal" href="#solving-equations-algebraically" id="id41">Solving Equations Algebraically</a></li>
<li><a class="reference internal" href="#solving-differential-equations" id="id42">Solving Differential Equations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#matrices" id="id43">Matrices</a><ul>
<li><a class="reference internal" href="#id3" id="id44">Basic Operations</a></li>
<li><a class="reference internal" href="#basic-methods" id="id45">Basic Methods</a></li>
<li><a class="reference internal" href="#matrix-constructors" id="id46">Matrix Constructors</a></li>
<li><a class="reference internal" href="#advanced-methods" id="id47">Advanced Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-expression-manipulation" id="id48">Advanced Expression Manipulation</a><ul>
<li><a class="reference internal" href="#understanding-expression-trees" id="id49">Understanding Expression Trees</a></li>
<li><a class="reference internal" href="#recursing-through-an-expression-tree" id="id50">Recursing through an Expression Tree</a></li>
<li><a class="reference internal" href="#walking-the-tree" id="id51">Walking the Tree</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="preliminaries">
<h2><a class="toc-backref" href="#id5">Preliminaries</a><a class="headerlink" href="#preliminaries" title="Permalink to this headline">¶</a></h2>
<p>読者は Python プログラミングの基本と、それなりの数学の知識があればよい。チュートリアルに出てくる例はだいたい微分積分レベル。</p>
<div class="section" id="installtion">
<h3><a class="toc-backref" href="#id6">Installtion</a><a class="headerlink" href="#installtion" title="Permalink to this headline">¶</a></h3>
<p>私はインストールは無事に出来たので、ここは読み飛ばした。</p>
<ul>
<li><p class="first">ドキュメント内の至る所にサンプルコードがあり、Sphinx の拡張機能で
SymPy Live shell が試せる。よく出来ている。</p>
<ul class="simple">
<li>デフォルトの出力書式が LaTeX なので見栄えがする。</li>
</ul>
</li>
<li><p class="first">最初のサンプル、私の <a class="reference external" href="http://ipython.org/">IPython</a> シェルで実行したら次のようになった。若干異なる。おそらく関数 <code class="code docutils literal notranslate"><span class="pre">init_printing</span></code> を異なる引数で適用したか、利用するコンソール環境の Unicode サポート状況に違いがあるのだろう。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Integral</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
  <span class="o">/</span>
 <span class="o">|</span>                 <span class="n">x</span>           <span class="n">x</span>
 <span class="o">|</span>  <span class="n">x</span>             <span class="n">e</span> <span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>   <span class="n">e</span> <span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
 <span class="o">|</span> <span class="n">e</span> <span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">---------</span> <span class="o">+</span> <span class="o">---------</span>
 <span class="o">|</span>                    <span class="mi">2</span>           <span class="mi">2</span>
<span class="o">/</span>
</pre></div>
</div>
<p>以下追記。起動直後に <code class="code docutils literal notranslate"><span class="pre">init_printing(pretty_print=False)</span></code> を呼び出すか、または起動時にコマンドラインオプション <code class="docutils literal notranslate"><span class="pre">--pretty=no</span></code> とすれば、出力の書式がコンソールにやさしいものに変わる。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">init_printing</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">doit</span><span class="p">())</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">Integral</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="exercises">
<h3><a class="toc-backref" href="#id7">Exercises</a><a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>このチュートリアルの基となっている &lt;the 2013 SciPy conference in Austin, TX&gt;
とやらを後でチェックしたい。<ul>
<li>HTML 版はほとんどこのチュートリアルと同じ内容だった。</li>
<li>YouTube にビデオ版が公開されている。Part 5 of 6 がおもしろかった。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="about-this-tutorial">
<h3><a class="toc-backref" href="#id8">About This Tutorial</a><a class="headerlink" href="#about-this-tutorial" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>このチュートリアルは SymPy の機能をたくさん紹介するが、余すところなくというほどではない。</li>
<li>紹介している機能についても、その全てのオプションや性能を説明しているとは限らない。</li>
<li>全部見たければ API リファレンスを当たればよい。</li>
<li>&lt;These are the goals of this tutorial&gt; の内容がすばらしい。特に後半。<ul>
<li>良い実践、用法を使い、アンチパターンを避けること。</li>
<li>一貫性を保つこと。</li>
<li>不必要な重複を避けること。</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id9">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-is-symbolic-computation">
<h3><a class="toc-backref" href="#id10">What is Symbolic Computation?</a><a class="headerlink" href="#what-is-symbolic-computation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>以下、symbolic computation を記号計算と訳しておく。</li>
<li>数学オブジェクトを近似ではなく、厳密に表現する。<ul>
<li>（例）関数 <code class="code docutils literal notranslate"><span class="pre">sympy.sqrt</span></code> と <code class="code docutils literal notranslate"><span class="pre">math.sqrt</span></code> の違い。</li>
<li>さらに <code class="code docutils literal notranslate"><span class="pre">sympy.sqrt(9)</span></code> と <code class="code docutils literal notranslate"><span class="pre">sympy.sqrt(8)</span></code> の違いについて。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="a-more-interesting-example">
<h3><a class="toc-backref" href="#id11">A More Interesting Example</a><a class="headerlink" href="#a-more-interesting-example" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>上で見たように、SymPy を用いて無理数を操作できる。</li>
<li>記号計算システムは「変数のある記号式の計算」機能を有する。変な訳だ。</li>
<li><code class="code docutils literal notranslate"><span class="pre">x</span></code> や <code class="code docutils literal notranslate"><span class="pre">y</span></code> など、記号の定義をするには関数 <code class="code docutils literal notranslate"><span class="pre">symbols</span></code> を用いる。<ul>
<li>記号は参照する前に定義しなければならない。Python だから。</li>
<li>式 <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">y</span></code> は <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">y</span></code> とは書けない。Python だから。</li>
</ul>
</li>
<li>本ノートでは simplify を簡略化と訳すことにする。</li>
<li>大部分の簡略化は自動的にはなされない。</li>
<li>まずは関数 <code class="code docutils literal notranslate"><span class="pre">expand</span></code> と <code class="code docutils literal notranslate"><span class="pre">factor</span></code> を試す。</li>
</ul>
</div>
<div class="section" id="the-power-of-symbolic-computation">
<h3><a class="toc-backref" href="#id12">The Power of Symbolic Computation</a><a class="headerlink" href="#the-power-of-symbolic-computation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>記号計算システムの本来の力は、あらゆる種類の計算を記号的に行うことにある。</li>
<li>SymPy は次のことができる。すべてを記号的に計算する。<ul>
<li>式を簡略化する</li>
<li>微分を計算する</li>
<li>積分を計算する</li>
<li>極限を求める</li>
<li>方程式を解く</li>
<li>行列を用いる</li>
<li>and more</li>
</ul>
</li>
<li>SymPy は次の機能のためのモジュールからなる。<ul>
<li>プロット</li>
<li>出力（数式をアスキーアートで表現したり LaTeX 記法で表記したり）</li>
<li>コード生成</li>
<li>物理学</li>
<li>統計学</li>
<li>組合せ論（この日本語何とかならないか）</li>
<li>数論</li>
<li>幾何学</li>
<li>論理学</li>
<li>and more</li>
</ul>
</li>
<li><code class="code docutils literal notranslate"><span class="pre">init_printing(use_unicode=True)</span></code> を私のコンソールで実行したら、豆腐系の文字化けが発生した。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">latex</span></code> で式の LaTeX コードを出力する。これはたいへん便利なので多用したい。</li>
</ul>
</div>
<div class="section" id="why-sympy">
<h3><a class="toc-backref" href="#id13">Why SymPy?</a><a class="headerlink" href="#why-sympy" title="Permalink to this headline">¶</a></h3>
<p>CAS としての SymPy の利点を 3 つ挙げる。</p>
<ol class="arabic simple">
<li>完全フリー（自由・無料）である。</li>
<li>Python を利用する。Python で実行できる。</li>
<li>SymPy をライブラリーとして利用できる。</li>
</ol>
</div>
</div>
<div class="section" id="gotchas">
<h2><a class="toc-backref" href="#id14">Gotchas</a><a class="headerlink" href="#gotchas" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>SymPy は Python ライブラリーであるので、Python から来る制限は SymPy でも引き継がれる。<ul>
<li>さっきも書いたが、例えば Mathematica みたいに <code class="code docutils literal notranslate"><span class="pre">3</span> <span class="pre">x</span></code> と書いてしまうのはダメ。</li>
</ul>
</li>
</ul>
<div class="section" id="symbols">
<h3><a class="toc-backref" href="#id15">Symbols</a><a class="headerlink" href="#symbols" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>さっきも書いたが、いきなり <code class="code docutils literal notranslate"><span class="pre">x</span></code> は使えない。関数 <code class="code docutils literal notranslate"><span class="pre">symbols</span></code> を呼び出してシンボルオブジェクトを生成する必要がある。<ul>
<li>この際可能な限り Python の変数と SymPy シンボルとを同じ名前に割り当てるようにする。この例では <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">symbols('x')</span></code> のようにする。</li>
<li>呼び出し <code class="code docutils literal notranslate"><span class="pre">symbols('x</span> <span class="pre">y</span> <span class="pre">z')</span></code> で 3 つのシンボルを一度に生成できる。</li>
</ul>
</li>
<li>式中のシンボルに値を代入（代入にも置換にも解釈できるのがミソ）するにはメソッド <code class="code docutils literal notranslate"><span class="pre">subs</span></code> を用いる。</li>
</ul>
</div>
<div class="section" id="equals-signs">
<h3><a class="toc-backref" href="#id16">Equals signs</a><a class="headerlink" href="#equals-signs" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>クラス Eq のオブジェクトは方程式を表現する。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">Eq(lhs,</span> <span class="pre">rhs)</span></code> で <code class="code docutils literal notranslate"><span class="pre">lhs</span> <span class="pre">==</span> <span class="pre">rhs</span></code> を表現する方程式オブジェクトとなるわけだ。</li>
<li>単に <code class="code docutils literal notranslate"><span class="pre">lhs</span> <span class="pre">==</span> <span class="pre">rhs</span></code> とすると、両辺が構造的に一致していれば True が得られる。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> で引数の数式を簡略化する。<ul>
<li>詳しい説明は後述するらしい。</li>
<li>おそらく、式に含まれるシンボルの量をなるべく少なくするような式変形をするのだろう。</li>
</ul>
</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">equals</span></code> で式同士が同値かテストする。</li>
</ul>
</div>
<div class="section" id="two-final-notes-and">
<h3><a class="toc-backref" href="#id17">Two Final Notes: <code class="code docutils literal notranslate"><span class="pre">^</span></code> and <code class="code docutils literal notranslate"><span class="pre">/</span></code></a><a class="headerlink" href="#two-final-notes-and" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>演算子 <code class="code docutils literal notranslate"><span class="pre">^</span></code> は Python の規約に従い排他的論理和とする。<ul>
<li>Xor という型のオブジェクトになるらしい。</li>
</ul>
</li>
<li>二項演算子 <code class="code docutils literal notranslate"><span class="pre">/</span></code> の int 型値への適用は
Python のバージョンにより整数除算か浮動小数点除算のどちらかになる。<ul>
<li>私は Python 3 を使うので、常に浮動小数点型の値を商として得る。</li>
</ul>
</li>
<li>クラス Integer は整数を表現する。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">Integer(a)/Integer(b)</span></code> は
<code class="code docutils literal notranslate"><span class="pre">Integer(a)</span></code> が <code class="code docutils literal notranslate"><span class="pre">Integer(b)</span></code> の倍数でなければ
Rational 型オブジェクトとなる。</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="basic-operations">
<h2><a class="toc-backref" href="#id18">Basic Operations</a><a class="headerlink" href="#basic-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="substitution">
<h3><a class="toc-backref" href="#id19">Substitution</a><a class="headerlink" href="#substitution" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">式 <code class="code docutils literal notranslate"><span class="pre">expr</span></code> 内のシンボル <code class="code docutils literal notranslate"><span class="pre">x</span></code> に式 <code class="code docutils literal notranslate"><span class="pre">y</span></code> を代入する操作は
<code class="code docutils literal notranslate"><span class="pre">expr.subs(x,</span> <span class="pre">y)</span></code> のように書く。</p>
</li>
<li><p class="first">代入機能を利用する理由はふつうは次のうちのどれかである。</p>
<ol class="arabic simple">
<li>式をある値で評価するとき</li>
<li>式の部分に別の式を代入するようなとき</li>
</ol>
<p>式の簡略化や展開には微妙なケースがあるらしく、例えばある数式の特定の項だけを展開したいような場合は <code class="code docutils literal notranslate"><span class="pre">subs</span></code> がうってつけらしい。</p>
</li>
<li><p class="first">メソッド <code class="code docutils literal notranslate"><span class="pre">subs</span></code> は元の式を壊さない。そもそも SymPy の式オブジェクトは immutable である。</p>
</li>
<li><p class="first">多変数の同時代入例</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">expr</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">expr</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="mi">40</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="converting-strings-to-sympy-expressions">
<h3><a class="toc-backref" href="#id20">Converting Strings to SymPy Expressions</a><a class="headerlink" href="#converting-strings-to-sympy-expressions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">sympify</span></code> と <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> は違う。前者は文字列を SymPy の式にする関数。<ul>
<li>内部で Python の <code class="code docutils literal notranslate"><span class="pre">eval</span></code> を呼び出すので危ないとのこと。</li>
<li>とは言え、数式の LaTeX 記法を手っ取り早く得る手段として有力のように思う。</li>
</ul>
</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">evalf</span></code> で式全体を数値的に評価する。
e.g. <code class="code docutils literal notranslate"><span class="pre">sqrt(8).evalf()</span></code><ul>
<li>引数で精度を指定できる。任意精度なのですごい。</li>
<li>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">chop</span></code> で丸め誤差を削れる。<code class="code docutils literal notranslate"><span class="pre">chop=True</span></code> とする。</li>
</ul>
</li>
<li>多数の値で評価するような場合は効率の観点から <code class="code docutils literal notranslate"><span class="pre">lambdify</span></code> の出番。
<code class="code docutils literal notranslate"><span class="pre">lambdify(x,</span> <span class="pre">expr,</span> <span class="pre">&quot;numpy&quot;)(a),</span> <span class="pre">a</span> <span class="pre">=</span> <span class="pre">array()</span></code><ul>
<li><code class="code docutils literal notranslate"><span class="pre">numpy.sin</span></code> を利用するという意味か？</li>
<li>自作関数を利用する方法も提供しているが、これ使うか？</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="printing">
<h2><a class="toc-backref" href="#id21">Printing</a><a class="headerlink" href="#printing" title="Permalink to this headline">¶</a></h2>
<p>ところで pretty print を日本語でどう表現するのがよいだろうか。</p>
<div class="section" id="printers">
<h3><a class="toc-backref" href="#id22">Printers</a><a class="headerlink" href="#printers" title="Permalink to this headline">¶</a></h3>
<p>SymPy は数式をさまざまなフォームで出力するように制御できる。</p>
<ul class="simple">
<li>str: <code class="code docutils literal notranslate"><span class="pre">print</span></code> による出力形式</li>
<li>repr: 式を厳密な表現で出力する</li>
<li>ASCII pretty printer: アスキーアート</li>
<li>Unicode pretty printer: 豆腐</li>
<li>LaTeX: 標準的な数式の記法</li>
<li>MathML: XML による</li>
<li>Dot: Graphviz 向け</li>
</ul>
</div>
<div class="section" id="setting-up-pretty-printing">
<h3><a class="toc-backref" href="#id23">Setting up Pretty Printing</a><a class="headerlink" href="#setting-up-pretty-printing" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">関数 <code class="code docutils literal notranslate"><span class="pre">init_printing</span></code> を引数なしで呼び出して、出力制御を初期化する。</p>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">init_session</span></code> が <code class="code docutils literal notranslate"><span class="pre">init_printing</span></code> を内部で呼び出す。</li>
</ul>
</li>
<li><p class="first"><code class="code docutils literal notranslate"><span class="pre">ipython</span> <span class="pre">qtconsole</span></code> かつ LaTeX がインストール済みならば、
LaTeX を使用する printer を採用する。</p>
<ul>
<li><p class="first"><code class="code docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">qtconsole</span></code> で調達可能。同時に Jupyter のコアパッケージもインストールされる。</p>
</li>
<li><p class="first">以前は <code class="code docutils literal notranslate"><span class="pre">--pylab=inline</span></code> のようなコマンドラインオプションも書いていたと記憶しているが、現在では deprecated である。</p>
</li>
<li><p class="first">出来た！</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/sympy-printing-latex.png"><img alt="数式を LaTeX によるイメージで出力する" src="../_images/sympy-printing-latex.png" style="width: 303.5px; height: 283.0px;" /></a>
</div>
</li>
<li><p class="first"><a class="reference external" href="http://matplotlib.org/">Matplotlib</a> がインストール済みでも OK とのこと。</p>
</li>
<li><p class="first">IPython notebook では MathJax を使って LaTeX を描画する。</p>
</li>
</ul>
</li>
<li><p class="first">IPython もしくは Python セッションでは Unicode 出力。ターミナルによる。私のコンソールは豆腐になる。</p>
<ul class="simple">
<li>豆腐が嫌なら <code class="code docutils literal notranslate"><span class="pre">init_printing(use_unicode=False)</span></code> する。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="printing-functions">
<h3><a class="toc-backref" href="#id24">Printing Functions</a><a class="headerlink" href="#printing-functions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>ユーザーが出力関数を明示的に指示することが可能。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">str(expr)</span></code> と <code class="code docutils literal notranslate"><span class="pre">print(expr)</span></code> の見てくれは同じ。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">srepr(expr)</span></code>: <code class="code docutils literal notranslate"><span class="pre">expr</span></code> の「厳密な」表現。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">pprint()</span></code>: ASCII; Unicode をサポートしないターミナルでのデフォルト。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">pretty</span></code><ul>
<li><code class="code docutils literal notranslate"><span class="pre">pretty(expr,</span> <span class="pre">use_unicode=False)</span></code>: string form</li>
<li><code class="code docutils literal notranslate"><span class="pre">pretty(expr,</span> <span class="pre">use_unicode=True)</span></code>: Unicode form</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">latex(expr)</span></code> で LaTex form にする。</li>
<li>MathML は少し面倒。関数 <code class="code docutils literal notranslate"><span class="pre">print_mathml</span></code> がサブモジュール <code class="docutils literal notranslate"><span class="pre">sympy.printing.mathml</span></code> にある。</li>
<li>Graphviz 用の <code class="code docutils literal notranslate"><span class="pre">dotprint(expr)</span></code> もある。</li>
</ul>
</div>
</div>
<div class="section" id="simplification">
<h2><a class="toc-backref" href="#id25">Simplification</a><a class="headerlink" href="#simplification" title="Permalink to this headline">¶</a></h2>
<div class="section" id="simplify">
<h3><a class="toc-backref" href="#id26"><code class="code docutils literal notranslate"><span class="pre">simplify</span></code></a><a class="headerlink" href="#simplify" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> は数式をもっとも単純な形になるようにがんばる。<ul>
<li>ただ単によくある単純化操作を適用するだけなので、思うような結果にならないこともある。</li>
<li>ムダに遅い。</li>
<li>ヒューリスティック。</li>
<li>対話的に利用するのがよいだろう。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="polynomial-rational-function-simplification">
<h3><a class="toc-backref" href="#id27">Polynomial/Rational Function Simplification</a><a class="headerlink" href="#polynomial-rational-function-simplification" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">expand</span></code><ul>
<li>単項式の和の canonical form への展開。何？</li>
<li>名前からは簡略化をするものという印象はないし、実際大きくなる。しかし、しばしば式内の項同士でキャンセルが起こって小さくなる。よって、本関数を簡略化関数とみなすことがある。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">factor</span></code><ul>
<li>多項式の因数分解。有理数上での規約多項式の積の形に分解する。</li>
<li>多変数も OK だ。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">factor_list</span></code> は因数分解の結果をリストで返す。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">collect</span></code><ul>
<li>同類項をまとめる。</li>
<li><code class="code docutils literal notranslate"><span class="pre">expr.coeff(x,</span> <span class="pre">2)</span></code>: 式 <code class="code docutils literal notranslate"><span class="pre">expr</span></code> の <code class="code docutils literal notranslate"><span class="pre">x**2</span></code> の係数を返す。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">cancel</span></code><ul>
<li>有理関数の約分。分子分母を共通因数のない多項式同士にする。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">factor</span></code> でも cancel できるが、式がすでに約分されているものかどうかを確認することだけ知りたければ
<code class="code docutils literal notranslate"><span class="pre">cancel</span></code> のほうがよい。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">apart</span></code><ul>
<li>部分分数分解。</li>
<li>本文のサンプルは pritty print の表示がズレていて読みづらい。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="trigonometric-simplification">
<h3><a class="toc-backref" href="#id28">Trigonometric Simplification</a><a class="headerlink" href="#trigonometric-simplification" title="Permalink to this headline">¶</a></h3>
<p>三角関数編。</p>
<ul class="simple">
<li>SymPy 版の三角関数と逆三角関数の名前は Python 版の対応するものに準拠する。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">trigsimp</span></code><ul>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">simplify</span></code> の三角関数版。三角関数の恒等式に対して適用するのに向いている？</li>
<li>双曲線関数も OK だ。</li>
<li>例によってヒューリスティック。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">expand_trig</span></code><ul>
<li>三角関数の加法定理や倍角の公式を展開する場合に使える。
e.g. <code class="code docutils literal notranslate"><span class="pre">expand_trig(sin(x</span> <span class="pre">+</span> <span class="pre">y))</span></code></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="powers">
<h3><a class="toc-backref" href="#id29">Powers</a><a class="headerlink" href="#powers" title="Permalink to this headline">¶</a></h3>
<p>べき乗・指数編。</p>
<ul class="simple">
<li>本節冒頭にある指数演算法則の説明が初心を思い出させる。
Sufficient conditions to hold は意外に頭にない。</li>
<li>デフォルトでは SymPy はシンボルを複素数の元とみなすことが判明。<ul>
<li>それを回避したければ <code class="code docutils literal notranslate"><span class="pre">symbols</span></code> 呼び出し時にキーワード引数を適宜指定。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">positive=True</span></code> と <code class="code docutils literal notranslate"><span class="pre">real=True</span></code> を例示。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ここではシンボル <code class="code docutils literal notranslate"><span class="pre">x</span></code> と <code class="code docutils literal notranslate"><span class="pre">y</span></code> を正の実数とし、シンボル <code class="code docutils literal notranslate"><span class="pre">a</span></code> と <code class="code docutils literal notranslate"><span class="pre">b</span></code> を実数とする。</p>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">powsimp</span></code><ul>
<li><code class="code docutils literal notranslate"><span class="pre">x**a</span> <span class="pre">*</span> <span class="pre">x**b</span></code> を <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">**</span> <span class="pre">(a</span> <span class="pre">+</span> <span class="pre">b)</span></code> に展開する。</li>
<li><code class="code docutils literal notranslate"><span class="pre">x**a</span> <span class="pre">*</span> <span class="pre">y**a</span></code> を <code class="code docutils literal notranslate"><span class="pre">(x</span> <span class="pre">*</span> <span class="pre">y)</span> <span class="pre">**</span> <span class="pre">a</span></code> に展開する。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">expand_power_exp</span></code> は <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">**</span> <span class="pre">(a</span> <span class="pre">+</span> <span class="pre">b)</span></code> を <code class="code docutils literal notranslate"><span class="pre">x**a</span> <span class="pre">*</span> <span class="pre">x**b</span></code> に展開する。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">expand_power_base</span></code> は <code class="code docutils literal notranslate"><span class="pre">(x</span> <span class="pre">*</span> <span class="pre">y)</span> <span class="pre">**</span> <span class="pre">a</span></code> を <code class="code docutils literal notranslate"><span class="pre">x**a</span> <span class="pre">*</span> <span class="pre">y**a</span></code> に展開する。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">powdenest</span></code> は <code class="code docutils literal notranslate"><span class="pre">(x**a)**b)</span></code> を <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">**</span> <span class="pre">(a*b)</span></code> に展開する。</li>
<li>どの関数にもキーワード引数 <code class="code docutils literal notranslate"><span class="pre">force</span></code> がある。シンボルが複素数でもムリヤリ展開するようだ。</li>
</ul>
</div>
<div class="section" id="exponentials-and-logarithms">
<h3><a class="toc-backref" href="#id30">Exponentials and logarithms</a><a class="headerlink" href="#exponentials-and-logarithms" title="Permalink to this headline">¶</a></h3>
<p>指数と対数編。</p>
<ul class="simple">
<li>SymPy が気を利かせて Python では与えていない <code class="code docutils literal notranslate"><span class="pre">ln</span> <span class="pre">=</span> <span class="pre">log</span></code> のような定義をしている。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">log</span></code> の引数は複素数でも当然構わないのだが、最初は面倒だからやめるか？ここで言う <code class="code docutils literal notranslate"><span class="pre">positive=True</span></code>, <code class="code docutils literal notranslate"><span class="pre">real=True</span></code> を暗黙に前提としていることが多いから。</li>
</ul>
<p>ここではシンボル <code class="code docutils literal notranslate"><span class="pre">x</span></code> と <code class="code docutils literal notranslate"><span class="pre">y</span></code> を正の実数とし、シンボル <code class="code docutils literal notranslate"><span class="pre">n</span></code> を実数とする。</p>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">expand_log</span></code><ul>
<li><code class="code docutils literal notranslate"><span class="pre">log(x</span> <span class="pre">+</span> <span class="pre">y)</span></code> を <code class="code docutils literal notranslate"><span class="pre">log(x)</span> <span class="pre">+</span> <span class="pre">log(y)</span></code> に展開する。</li>
<li><code class="code docutils literal notranslate"><span class="pre">log(x</span> <span class="pre">**</span> <span class="pre">n)</span></code> を <code class="code docutils literal notranslate"><span class="pre">n</span> <span class="pre">*</span> <span class="pre">log(x)</span></code> に展開する。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">logcombine</span></code><ul>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">expand_log</span></code> の逆関数的なはたらきをする。</li>
<li><code class="code docutils literal notranslate"><span class="pre">log(x)</span> <span class="pre">+</span> <span class="pre">log(y)</span></code> を <code class="code docutils literal notranslate"><span class="pre">log(x</span> <span class="pre">+</span> <span class="pre">y)</span></code> に展開する。</li>
<li><code class="code docutils literal notranslate"><span class="pre">n</span> <span class="pre">*</span> <span class="pre">log(x)</span></code> を <code class="code docutils literal notranslate"><span class="pre">log(x</span> <span class="pre">**</span> <span class="pre">n)</span></code> に展開する。</li>
</ul>
</li>
<li>どちらの関数にもキーワード引数 <code class="code docutils literal notranslate"><span class="pre">force</span></code> がある。</li>
</ul>
</div>
<div class="section" id="special-functions">
<h3><a class="toc-backref" href="#id31">Special Functions</a><a class="headerlink" href="#special-functions" title="Permalink to this headline">¶</a></h3>
<p>SymPy の実装している特別関数のうちのいくつかを紹介している。</p>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">factorial</span></code>: <code class="code docutils literal notranslate"><span class="pre">n</span> <span class="pre">=&gt;</span> <span class="pre">n!</span></code></li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">binomial(n,</span> <span class="pre">k)</span></code>: 記法はタテ括弧による。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">gamma(x)</span></code>: ガンマ関数そのもの。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">hyper</span></code><ul>
<li>これは知らん。
Wikipedia のページを見たところ、初めて見る式だらけだ。</li>
</ul>
</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.rewrite()</span></code>: 与えた関数で式を書き直す。<ul>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">tan</span></code> を <code class="code docutils literal notranslate"><span class="pre">sin</span></code> で書き換える。</li>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">factorial</span></code> を <code class="code docutils literal notranslate"><span class="pre">gamma</span></code> で書き換える。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">expand_func(expr)</span></code>: 特別関数を恒等式を用いて展開する。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">hyperexpand</span></code>: 関数 <code class="code docutils literal notranslate"><span class="pre">hyper</span></code> をもっと標準的な関数で書き換える。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">combsimp</span></code>: 組み合わせ関連の式の簡略化。<ul>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">factorial</span></code> 式同士の商を単純な式に簡略化する。</li>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">binomial</span></code> 式同士の商を単純な式に簡略化する。</li>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">gamma</span></code> 式同士の積を単純な三角関数の式に簡略化する。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="example-continued-fractions">
<h3><a class="toc-backref" href="#id32">Example: Continued Fractions</a><a class="headerlink" href="#example-continued-fractions" title="Permalink to this headline">¶</a></h3>
<p>連分数の例。英語で continued fractions というのか。</p>
<ul class="simple">
<li><code class="code docutils literal notranslate"><span class="pre">symbols('a0:5')</span></code> の記法はおもしろい。</li>
<li>連分数を cancel する。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">apart</span></code> で部分分数分解しまくり。</li>
</ul>
</div>
</div>
<div class="section" id="calculus">
<h2><a class="toc-backref" href="#id33">Calculus</a><a class="headerlink" href="#calculus" title="Permalink to this headline">¶</a></h2>
<div class="section" id="derivatives">
<h3><a class="toc-backref" href="#id34">Derivatives</a><a class="headerlink" href="#derivatives" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">diff</span></code><ul>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">diff(x**4,</span> <span class="pre">x,</span> <span class="pre">x,</span> <span class="pre">x)</span></code>: 3 階微分。</li>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">diff(x**4,</span> <span class="pre">x,</span> <span class="pre">3)</span></code>: 同じ 3 階微分。</li>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">diff(expr,</span> <span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">z,</span> <span class="pre">z,</span> <span class="pre">z)</span></code>: 偏微分。</li>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">diff(expr,</span> <span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">2,</span> <span class="pre">z,</span> <span class="pre">4)</span></code>: 同じ偏微分。</li>
<li>メソッド形式の <code class="code docutils literal notranslate"><span class="pre">expr.diff(...)</span></code> も可。</li>
</ul>
</li>
<li>クラス Derivative<ul>
<li>未評価の微分オブジェクトのためのクラス。</li>
<li>あるいは SymPy が微分を求められないような式のためのクラス。</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.doit()</span></code> で関数 <code class="code docutils literal notranslate"><span class="pre">diff</span></code> と同じ結果を得る。</li>
<li>遅延評価に有用。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="integrals">
<h3><a class="toc-backref" href="#id35">Integrals</a><a class="headerlink" href="#integrals" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">integrate</span></code><ul>
<li>不定積分（原始関数）を得るのにも定積分を得るのにも用いる。</li>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">integrate(cos(x),</span> <span class="pre">x)</span></code></li>
<li>定数項は含まないのでユーザーが適宜はからう。</li>
<li>定積分は積分域を指定する。</li>
<li><code class="code docutils literal notranslate"><span class="pre">integrate(exp(-x),</span> <span class="pre">(x,</span> <span class="pre">0,</span> <span class="pre">oo))</span></code><ul>
<li>オブジェクト <code class="code docutils literal notranslate"><span class="pre">oo</span></code> が無限大を表現するシンボルか。</li>
</ul>
</li>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">integrate(exp(-x**2</span> <span class="pre">-</span> <span class="pre">y**2),</span> <span class="pre">(x,</span> <span class="pre">-oo,</span> <span class="pre">oo),</span> <span class="pre">(y,</span> <span class="pre">-oo,</span> <span class="pre">oo))</span></code>: 重積分</li>
</ul>
</li>
<li>クラス Integral<ul>
<li>用途は Derivative の積分版といったところ。</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.doit()</span></code> で関数 <code class="code docutils literal notranslate"><span class="pre">integrate</span></code> と同じ結果を得る。</li>
</ul>
</li>
<li>最後のほう、何を述べているのかわからない。</li>
</ul>
</div>
<div class="section" id="limits">
<h3><a class="toc-backref" href="#id36">Limits</a><a class="headerlink" href="#limits" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">limit</span></code><ul>
<li><code class="code docutils literal notranslate"><span class="pre">expr.subs(x,</span> <span class="pre">oo)</span></code> などのようにせず <code class="code docutils literal notranslate"><span class="pre">limit(expr,</span> <span class="pre">x,</span> <span class="pre">oo)</span></code> とすること</li>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">limit(sin(x)/x,</span> <span class="pre">x,</span> <span class="pre">0)</span></code>: x が 0 に近づくときの極限。</li>
</ul>
</li>
<li>クラス Limit<ul>
<li>用途は Derivative や Integral の極限版といったところ。</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.doit()</span></code> で関数 <code class="code docutils literal notranslate"><span class="pre">limit</span></code> と同じ結果を得る。</li>
</ul>
</li>
<li>右極限、左極限<ul>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">limit(1/x,</span> <span class="pre">x,</span> <span class="pre">0,</span> <span class="pre">'+')</span></code></li>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">limit(1/x,</span> <span class="pre">x,</span> <span class="pre">0,</span> <span class="pre">'-')</span></code></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="series-expansion">
<h3><a class="toc-backref" href="#id37">Series Expansion</a><a class="headerlink" href="#series-expansion" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">series</span></code><ul>
<li><code class="code docutils literal notranslate"><span class="pre">expr.series(x,</span> <span class="pre">x0,</span> <span class="pre">n)</span></code> のようにして、関数 <code class="code docutils literal notranslate"><span class="pre">expr</span></code> のある点 <code class="code docutils literal notranslate"><span class="pre">x0</span></code> における <code class="code docutils literal notranslate"><span class="pre">n</span></code> 次の級数展開を得る。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">x0</span></code> のデフォルト値は 0 である。Maclaurin 展開。</li>
<li><code class="code docutils literal notranslate"><span class="pre">n</span></code> のデフォルト値は 6 である。</li>
</ul>
</li>
<li>出力に <code class="code docutils literal notranslate"><span class="pre">O(x**n)</span></code> のような項が出てくる。</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.removeO()</span></code> でオーダー項が省略できる。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="finite-differences">
<h3><a class="toc-backref" href="#id38">Finite differences</a><a class="headerlink" href="#finite-differences" title="Permalink to this headline">¶</a></h3>
<p>差分商はわからん。</p>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">as_finite_diff</span></code><ul>
<li>任意の Derivative オブジェクトに対して、任意階数の微分値の近似を生成できる。</li>
<li>ここの最初の例は「ある関数 <code class="code docutils literal notranslate"><span class="pre">f</span></code> の一次微分」を
<code class="code docutils literal notranslate"><span class="pre">f(x</span> <span class="pre">-</span> <span class="pre">1/2)</span></code> と <code class="code docutils literal notranslate"><span class="pre">f(x</span> <span class="pre">+</span> <span class="pre">1/2)</span></code> で近似している。</li>
<li>その次の例は「ある関数 <code class="code docutils literal notranslate"><span class="pre">f</span></code> の二次微分」を定義域内の値 <code class="code docutils literal notranslate"><span class="pre">h</span></code> について、以下の値を用いて近似している。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">f(-3</span> <span class="pre">*</span> <span class="pre">h)</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">f(-h)</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">f(2</span> <span class="pre">*</span> <span class="pre">h)</span></code></li>
</ul>
</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">finite_diff_weights</span></code><ul>
<li>各 <code class="code docutils literal notranslate"><span class="pre">f(h)</span></code> の項の係数だけ欲しい場合に用いる。</li>
<li>もはや <code class="code docutils literal notranslate"><span class="pre">f</span></code> も <code class="code docutils literal notranslate"><span class="pre">h</span></code> も引数に要求されないことに注意。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">apply_finite_diff</span></code><ul>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">finite_diff_weights</span></code> を直に使うのは複雑だし、関数 <code class="code docutils literal notranslate"><span class="pre">as_finite_diff</span></code> を <code class="code docutils literal notranslate"><span class="pre">f</span></code> 的なものに操作するのは柔軟性に欠くようならば、本関数を検討する。</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="solvers">
<h2><a class="toc-backref" href="#id39">Solvers</a><a class="headerlink" href="#solvers" title="Permalink to this headline">¶</a></h2>
<p>方程式を解く。</p>
<div class="section" id="a-note-about-equations">
<h3><a class="toc-backref" href="#id40">A Note about Equations</a><a class="headerlink" href="#a-note-about-equations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>もう一度言うが SymPy では記号方程式を Eq オブジェクトを用いて表現する。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">==</span> <span class="pre">y</span></code> を表現したいならばオブジェクト <code class="code docutils literal notranslate"><span class="pre">Eq(x,</span> <span class="pre">y)</span></code> を生成する。</li>
</ul>
</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">solve</span></code><ul>
<li>方程式を指定した未知数シンボルについて解く。</li>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">solve(Eq(x**2,</span> <span class="pre">1),</span> <span class="pre">x)</span></code>: プラマイ 1 を根とする <code class="code docutils literal notranslate"><span class="pre">x</span></code> の二次方程式を解く。</li>
<li>（例） <code class="code docutils literal notranslate"><span class="pre">solve(x**2</span> <span class="pre">-</span> <span class="pre">1,</span> <span class="pre">x)</span></code>: 同上。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="solving-equations-algebraically">
<h3><a class="toc-backref" href="#id41">Solving Equations Algebraically</a><a class="headerlink" href="#solving-equations-algebraically" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">solve</span></code><ul>
<li>呼び出しの構文は <code class="code docutils literal notranslate"><span class="pre">solve(equations</span> <span class="pre">variables)</span></code></li>
<li>単一の方程式を解くときは、関数 <code class="code docutils literal notranslate"><span class="pre">solve</span></code> の戻り値は解の list である。</li>
<li>解が見つからない（存在しないとは言っていない）場合、次のどちらかが起こる。<ul>
<li>空の list が返る。</li>
<li>例外 NotImplementedError が発生する。</li>
</ul>
</li>
<li><code class="code docutils literal notranslate"><span class="pre">solve(f(x,</span> <span class="pre">y),</span> <span class="pre">[x,</span> <span class="pre">y])</span></code> の形で連立方程式が解けるかもしれない。<ul>
<li>多項方程式の重根の多重度も欲しい場合は、関数 <code class="code docutils literal notranslate"><span class="pre">roots</span></code> を用いる。</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="solving-differential-equations">
<h3><a class="toc-backref" href="#id42">Solving Differential Equations</a><a class="headerlink" href="#solving-differential-equations" title="Permalink to this headline">¶</a></h3>
<p>ここの例に出てくるのは常微分方程式。</p>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> は微分方程式の解を求める。<ul>
<li>Function オブジェクトが要る。<ul>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">symbols</span></code> でキーワード引数 <code class="code docutils literal notranslate"><span class="pre">cls=Function</span></code> を指定する。</li>
</ul>
</li>
<li><code class="code docutils literal notranslate"><span class="pre">dsolve(eq,</span> <span class="pre">f(x))</span></code> の形。</li>
<li>戻り値は Eq オブジェクトである。解が <code class="code docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">...</span></code> の形に解けるとは限らないため。</li>
<li>不定積分のときとは異なり、今度は解に任意定数が出てくる。</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="matrices">
<h2><a class="toc-backref" href="#id43">Matrices</a><a class="headerlink" href="#matrices" title="Permalink to this headline">¶</a></h2>
<p>クラス Matrix のコンストラクターは <code class="code docutils literal notranslate"><span class="pre">np.array</span></code> のそれに似ている。</p>
<ul class="simple">
<li>ただし単リストを引数とすると、生成する行列は列ベクトルの形になる。</li>
<li>Matrix のオブジェクトは SymPy の型にしては珍しく mutable である。</li>
<li>一応 immutable 版の行列型 ImmutableMatrix も提供している。</li>
</ul>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id44">Basic Operations</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>どうも NumPy の array にインターフェイスがよく似ているようだ。</p>
<ul class="simple">
<li>プロパティー <code class="code docutils literal notranslate"><span class="pre">.shape</span></code>: 行列の寸法。</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.row(i)</span></code>, および <code class="code docutils literal notranslate"><span class="pre">.col(i)</span></code>: 列全体および行全体にアクセス。</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.row_del(i)</span></code>, <code class="code docutils literal notranslate"><span class="pre">.col_del(i)</span></code>: 列全体および行全体を削除。<ul>
<li>これらは in-place に作用する。</li>
</ul>
</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.row_insert(i,</span> <span class="pre">M)</span></code>, <code class="code docutils literal notranslate"><span class="pre">.col_insert(i,</span> <span class="pre">M)</span></code>: 列全体および行全体を追加。<ul>
<li>これらは in-place に作用しない。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="basic-methods">
<h3><a class="toc-backref" href="#id45">Basic Methods</a><a class="headerlink" href="#basic-methods" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>加算、乗算は普通に演算子で行える。<ul>
<li>二項演算子 <code class="code docutils literal notranslate"><span class="pre">+</span></code> で加算。</li>
<li>二項演算子 <code class="code docutils literal notranslate"><span class="pre">*</span></code> でスカラー倍あるいは行列同士の乗算。</li>
<li>二項演算子 <code class="code docutils literal notranslate"><span class="pre">**</span></code> でべき乗。逆行列もこの記法で <code class="code docutils literal notranslate"><span class="pre">M</span> <span class="pre">**</span> <span class="pre">-1</span></code> のように表現する。</li>
<li>プロパティー <code class="code docutils literal notranslate"><span class="pre">.T</span></code> で転置行列を返す。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="matrix-constructors">
<h3><a class="toc-backref" href="#id46">Matrix Constructors</a><a class="headerlink" href="#matrix-constructors" title="Permalink to this headline">¶</a></h3>
<p>これも NumPy のスタイルを踏襲しているように見える。もしかすると逆かもしれない。</p>
<ul class="simple">
<li>関数 <code class="code docutils literal notranslate"><span class="pre">eye</span></code> で指定次元の単位行列を生成する。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">zeros</span></code> で指定サイズの零行列を生成する。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">ones</span></code> で指定サイズの行列を生成する。各成分は 1 である。</li>
<li>関数 <code class="code docutils literal notranslate"><span class="pre">diag</span></code> で対角行列を生成する。次のどれかが引数になる。<ul>
<li>スカラーのみを左上から右下までカンマ区切りで一気に指定する。結果は正方行列になる。</li>
<li>スカラーか行列で同様にカンマ区切りで一気に指定する。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="advanced-methods">
<h3><a class="toc-backref" href="#id47">Advanced Methods</a><a class="headerlink" href="#advanced-methods" title="Permalink to this headline">¶</a></h3>
<p>NumPy にあるものとないものがあるようだ。</p>
<ul class="simple">
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.det()</span></code> で行列式の値を返す。</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.rref()</span></code> は行列の reduced row echelon form を得る。<ul>
<li>戻り値は行列の reduced row echelon form とピボット列の添字の list のペアである。</li>
</ul>
</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.nullspace()</span></code> で行列の nullspace を探す。<ul>
<li>戻り値はその nullspace を張る列ベクトルの list である。</li>
</ul>
</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.eigenvals()</span></code> は行列の固有値を探す。<ul>
<li>戻り値はキーと値がそれぞれ固有値と（固有多項式の根としての）多重度の dict である。</li>
</ul>
</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.eigenvects()</span></code> は行列の固有ベクトルを探す。<ul>
<li>戻り値は中身が次のような造りの tuple の list である。<ol class="arabic">
<li>固有値</li>
<li>多重度</li>
<li>固有ベクトルの list</li>
</ol>
</li>
<li>固有ベクトルの計算はたいていコストがかかるので、固有値だけ欲しい場合は <code class="code docutils literal notranslate"><span class="pre">.eigenvals()</span></code> で済ませるのがよい。</li>
</ul>
</li>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.diagonalize()</span></code> は行列を対角化する。<ul>
<li>戻り値は Matrix のペアである。それぞれ <code class="code docutils literal notranslate"><span class="pre">M</span> <span class="pre">=</span> <span class="pre">P</span> <span class="pre">*</span> <span class="pre">D</span> <span class="pre">*</span> <span class="pre">(P</span> <span class="pre">**</span> <span class="pre">-1)</span></code> なる <code class="code docutils literal notranslate"><span class="pre">P</span></code> と <code class="code docutils literal notranslate"><span class="pre">D</span></code> である。</li>
</ul>
</li>
<li>行列の固有多項式が欲しいだけならばメソッド <code class="code docutils literal notranslate"><span class="pre">.charpoly</span></code> を使う。<ul>
<li>メソッド <code class="code docutils literal notranslate"><span class="pre">.eigenvals()</span></code> よりも効率が良い。</li>
</ul>
</li>
<li>SymPy では <code class="code docutils literal notranslate"><span class="pre">lambda</span></code> ではなく <code class="code docutils literal notranslate"><span class="pre">lamda</span></code> とつづる。スペリングをうろ覚えの人のようでみっともないが、仕方がない。</li>
</ul>
</div>
</div>
<div class="section" id="advanced-expression-manipulation">
<h2><a class="toc-backref" href="#id48">Advanced Expression Manipulation</a><a class="headerlink" href="#advanced-expression-manipulation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="understanding-expression-trees">
<h3><a class="toc-backref" href="#id49">Understanding Expression Trees</a><a class="headerlink" href="#understanding-expression-trees" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>SymPy は数式を木のように表現する。<ul>
<li>この木を見るには関数 <code class="code docutils literal notranslate"><span class="pre">srepr</span></code> を用いる。数式の木構造を文字列の形で見られる。</li>
</ul>
</li>
<li>チュートリアルの図は Graphviz と関数 <code class="code docutils literal notranslate"><span class="pre">dotprint</span></code> を組み合わせて作られた。<ul>
<li>木の葉に相当する要素は Symbol や Integer など。</li>
<li>それ以外の要素は Add や Mul がある。</li>
</ul>
</li>
<li>除算のクラスは SymPy には存在しない。Pow と <code class="docutils literal notranslate"><span class="pre">-1</span></code> を組み合わせて表現する。<ul>
<li>Rational は数同士</li>
</ul>
</li>
<li><code class="code docutils literal notranslate"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">x</span></code> を評価すると <code class="code docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">1</span></code> と出力されるのは、
SymPy の Add がオペランドを任意の（とはいえ整合性のある）順序に並べることから。<ul>
<li>Add というよりは、可換則の成り立つ演算の際には、ということ。</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="recursing-through-an-expression-tree">
<h3><a class="toc-backref" href="#id50">Recursing through an Expression Tree</a><a class="headerlink" href="#recursing-through-an-expression-tree" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>プロパティー <code class="code docutils literal notranslate"><span class="pre">func</span></code><ul>
<li>式の「先頭」のオブジェクトである。</li>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">(x*y).func</span></code> は Mul オブジェクトである。</li>
<li>ふつうは式オブジェクトのクラスと一致する。</li>
<li>一致しない場合もあり得る。<ul>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">Add(x,</span> <span class="pre">x)</span></code> は実は <code class="code docutils literal notranslate"><span class="pre">Mul(2,</span> <span class="pre">x)</span></code> である。</li>
<li>SymPy は <code class="code docutils literal notranslate"><span class="pre">__new__</span></code> を多用していて、別のクラスのコンストラクターが返されることがあり得る。</li>
</ul>
</li>
</ul>
</li>
<li>プロパティー <code class="code docutils literal notranslate"><span class="pre">args</span></code><ul>
<li>式オブジェクトの（木を逆さに見るときの）トップレベルの引数を指す。</li>
<li>E.g. <code class="code docutils literal notranslate"><span class="pre">(3*y**2*x).args</span></code> は <code class="code docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">x,</span> <span class="pre">y**2)</span></code> である。</li>
</ul>
</li>
<li><code class="code docutils literal notranslate"><span class="pre">func</span></code> と <code class="code docutils literal notranslate"><span class="pre">args</span></code> から、元の式が完全に再現できる。</li>
</ul>
</div>
<div class="section" id="walking-the-tree">
<h3><a class="toc-backref" href="#id51">Walking the Tree</a><a class="headerlink" href="#walking-the-tree" title="Permalink to this headline">¶</a></h3>
<p>ジェネレーター <code class="code docutils literal notranslate"><span class="pre">preorder_traversal</span></code> と
<code class="code docutils literal notranslate"><span class="pre">postorder_traversal</span></code> で数式の木構造を走査できる。</p>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="plotting.html" title="プロットを利用する"
             >next</a></li>
        <li class="right" >
          <a href="doc.html" title="ドキュメントをビルドする"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >SymPy 利用ノート</a> &#187;</li> 
      </ul>
    </div>
    <div id="footer">
      <div id="footer_logo">
        <a class="imga" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png" width="88" height="31" /></a>
      </div>
      <div id="footer_copyright">
        Since 1999<br />
        Copyright &copy; 1999-2018, プレハブ小屋 All rights reserved.
      </div>
    </div>
  </body>
</html>