
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>微分幾何 &#8212; 読書ノート 1.5dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="../_static/mathjax-v3.js"></script>
    <script src="../_static/mermaid.js"></script>
    <link rel="next" title="出力" href="printing.html" />
    <link rel="prev" title="偏微分方程式" href="pde.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="pde.html" title="Previous document">偏微分方程式</a>
        </li>
        <li>
          <a href="printing.html" title="Next document">出力</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="id1">
<h1><a class="toc-backref" href="#id19" role="doc-backlink">微分幾何</a><a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h1>
<p>微分幾何に関係する機能を提供するモジュール <code class="docutils literal notranslate"><span class="pre">sympy.diffgeom</span></code> に関するメモを記す。</p>
<p>これはふたつのサブモジュール <code class="docutils literal notranslate"><span class="pre">diffgeom</span></code> と <code class="docutils literal notranslate"><span class="pre">rn</span></code> から構成されている。理解の都合上、まず <code class="docutils literal notranslate"><span class="pre">diffgeom</span></code> に定義されている基礎的な諸クラスを見ていく。次にサブモジュール <code class="docutils literal notranslate"><span class="pre">rn</span></code> で定義されているすべてのオブジェクトを見ていく。最後に再度
<code class="docutils literal notranslate"><span class="pre">diffgeom</span></code> に戻り、残りの（さらに複雑な概念を表現する）諸機能を見ていく。</p>
<nav class="contents" id="id2">
<p class="topic-title">ノート目次</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id19">微分幾何</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id20">多様体</a></p>
<ul>
<li><p><a class="reference internal" href="#manifold" id="id21">クラス <code class="docutils literal notranslate"><span class="pre">Manifold</span></code></a></p></li>
<li><p><a class="reference internal" href="#patch" id="id22">クラス <code class="docutils literal notranslate"><span class="pre">Patch</span></code></a></p></li>
<li><p><a class="reference internal" href="#coordsystem" id="id23">クラス <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code></a></p></li>
<li><p><a class="reference internal" href="#point" id="id24">クラス <code class="docutils literal notranslate"><span class="pre">Point</span></code></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id4" id="id25">多様体の場および微分演算各種</a></p>
<ul>
<li><p><a class="reference internal" href="#basescalarfield" id="id26">クラス <code class="docutils literal notranslate"><span class="pre">BaseScalarField</span></code></a></p></li>
<li><p><a class="reference internal" href="#basevectorfield" id="id27">クラス <code class="docutils literal notranslate"><span class="pre">BaseVectorField</span></code></a></p></li>
<li><p><a class="reference internal" href="#commutator" id="id28">クラス <code class="docutils literal notranslate"><span class="pre">Commutator</span></code></a></p></li>
<li><p><a class="reference internal" href="#differential" id="id29">クラス <code class="docutils literal notranslate"><span class="pre">Differential</span></code></a></p></li>
<li><p><a class="reference internal" href="#tensorproduct" id="id30">クラス <code class="docutils literal notranslate"><span class="pre">TensorProduct</span></code></a></p></li>
<li><p><a class="reference internal" href="#wedgeproduct" id="id31">クラス <code class="docutils literal notranslate"><span class="pre">WedgeProduct</span></code></a></p></li>
<li><p><a class="reference internal" href="#liederivative" id="id32">クラス <code class="docutils literal notranslate"><span class="pre">LieDerivative</span></code></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id6" id="id33">定義済み多様体オブジェクト</a></p>
<ul>
<li><p><a class="reference internal" href="#id7" id="id34">二次元オブジェクト</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id35">三次元オブジェクト</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id9" id="id36">コード例（基本編）</a></p>
<ul>
<li><p><a class="reference internal" href="#id10" id="id37">局所座標系</a></p></li>
<li><p><a class="reference internal" href="#s-1" id="id38">単位円 <span class="math notranslate nohighlight">\(S^1\)</span></a></p></li>
<li><p><a class="reference internal" href="#id11" id="id39">ベクトル場</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id40">微分形式と外微分</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id13" id="id41">積分曲線</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id42">補助関数</a></p>
<ul>
<li><p><a class="reference internal" href="#id16" id="id43">基底ベクトルの変換</a></p></li>
<li><p><a class="reference internal" href="#id17" id="id44">微分形式から行列を生成する</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id18" id="id45">計量テンソル</a></p>
<ul>
<li><p><a class="reference internal" href="#christoffel" id="id46">Christoffel 記号</a></p></li>
<li><p><a class="reference internal" href="#riemman-christoffel" id="id47">Riemman-Christoffel 曲率テンソル</a></p></li>
<li><p><a class="reference internal" href="#ricci" id="id48">Ricci 曲率テンソル</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>本文中のすべての IPython セッション中のサンプルコードで、以下のインポートおよび出力書式設定が済んでいるものとする。</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy.diffgeom</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">sympy.diffgeom.rn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">init_printing</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="id3">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">多様体</a><a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<p>本節ではサブモジュール <code class="docutils literal notranslate"><span class="pre">sympy.diffgeom.diffgeom</span></code> で定義されている、多様体を表現するための一連のクラス群について記す。</p>
<section id="manifold">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">Manifold</span></code></a><a class="headerlink" href="#manifold" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">Manifold</span></code> は多様体をオブジェクトとして表現する。ここで言う多様体とは、微分可能多様体を意味するものとして話をすすめる。</p>
<ul class="simple">
<li><p>オブジェクトをコンストラクターから直接生成する。名前と多様体次元さえ用意すればよい。生成後にそれぞれをメンバーデータ <code class="docutils literal notranslate"><span class="pre">name</span></code> および <code class="docutils literal notranslate"><span class="pre">dim</span></code> で参照できる。</p>
<ul>
<li><p>あまり凝った名前は付けられない。例えば <code class="docutils literal notranslate"><span class="pre">S^1</span></code> のような文字列を指定すれば、コンストラクター呼び出し中に例外が送出する（あえてやるなら <code class="docutils literal notranslate"><span class="pre">S**1</span></code> とする）。</p></li>
<li><p>なお <code class="docutils literal notranslate"><span class="pre">name</span></code> の型は文字列ではなく <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> であるので注意。</p></li>
</ul>
</li>
<li><p>メンバーデータ <code class="docutils literal notranslate"><span class="pre">patches</span></code> を介してこの多様体の座標近傍系を表現するオブジェクトにアクセスできる。このデータの型は後述する <code class="docutils literal notranslate"><span class="pre">Patch</span></code> オブジェクトの <code class="docutils literal notranslate"><span class="pre">list</span></code>
である。</p></li>
</ul>
</section>
<section id="patch">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">Patch</span></code></a><a class="headerlink" href="#patch" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">Patch</span></code> は多様体上の座標近傍となる開集合一つを表現する型だ。</p>
<p>例えば多様体 <span class="math notranslate nohighlight">\(M\)</span> とその座標近傍系が <span class="math notranslate nohighlight">\(\set{(U_\alpha,
\varphi_\alpha)}_{\alpha \in I}\)</span> のように与えられているとする。この座標近傍
<span class="math notranslate nohighlight">\(U_\alpha\)</span> に相当する概念だと解釈できる。</p>
<ul class="simple">
<li><p>オブジェクトをコンストラクターから直接生成する。この際、この座標近傍自身の名前と、これが含まれる <code class="docutils literal notranslate"><span class="pre">Manifold</span></code> オブジェクトが必要だ。生成後にそれぞれをメンバーデータ <code class="docutils literal notranslate"><span class="pre">name</span></code> および <code class="docutils literal notranslate"><span class="pre">manifold</span></code> で参照できる。</p></li>
<li><p>メンバーデータ <code class="docutils literal notranslate"><span class="pre">coord_systems</span></code> から関連する局所座標系オブジェクトにアクセスできる。これは後述する <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> オブジェクトの <code class="docutils literal notranslate"><span class="pre">list</span></code> オブジェクトである。</p></li>
<li><p>多様体次元はプロパティー <code class="docutils literal notranslate"><span class="pre">dim</span></code> を用いて参照可能。この多様体のある座標近傍と微分同相な開集合を含むユークリッド空間の次元に他ならない。</p></li>
</ul>
</section>
<section id="coordsystem">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code></a><a class="headerlink" href="#coordsystem" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> は多様体の座標近傍ひとつの局所座標系を表現する型だ。</p>
<p>先ほどのモデルで言うと、一つの座標近傍 <span class="math notranslate nohighlight">\({(U_\alpha, \varphi_\alpha)}\)</span> の局所座標系 <span class="math notranslate nohighlight">\({\fn{\varphi_\alpha}{U_\alpha}\RR^n}\)</span> に相当する概念だと解釈できる。</p>
<ul class="simple">
<li><p>オブジェクトをコンストラクターから直接生成する。局所座標系の名前と関連付ける座標近傍に対応する <code class="docutils literal notranslate"><span class="pre">Patch</span></code> オブジェクトが要る。</p>
<ul>
<li><p>他にもオプションで <code class="docutils literal notranslate"><span class="pre">names</span></code> というのがある。これは局所座標成分の名称を
<code class="docutils literal notranslate"><span class="pre">list</span></code> で指定することができる。</p></li>
</ul>
</li>
</ul>
<p>このクラスは特に重要なメソッドが多い。強いて言えば、座標情報と座標変換に関係するものに分類したい。</p>
<p>座標情報にアクセスするメソッドは次のようなものがある：</p>
<dl class="simple">
<dt><code class="code docutils literal notranslate"><span class="pre">coord_function(coord_index)</span></code>, <code class="code docutils literal notranslate"><span class="pre">coord_functions()</span></code></dt><dd><p>多様体上の点を取り、その点の局所座標を関数オブジェクトとして返す。後述のクラス
<code class="docutils literal notranslate"><span class="pre">BaseScalarField</span></code> を参照。</p>
<ul class="simple">
<li><p>単数形の方は <code class="docutils literal notranslate"><span class="pre">coord_index</span></code> 番目の座標成分のものに関するそれを返す。先ほどのモデルで言うと、座標近傍が <span class="math notranslate nohighlight">\({(U_i, \varphi_i = (x_1, \dotsc, x_n))}\)</span>
で表されているとするならば、<span class="math notranslate nohighlight">\({x_{\text{coord_index}}}\)</span> を参照する。</p></li>
<li><p>複数形の方は全成分を <code class="docutils literal notranslate"><span class="pre">list</span></code> で返す。</p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">base_vector(coord_index)</span></code>, <code class="code docutils literal notranslate"><span class="pre">base_vectors()</span></code></dt><dd><p>接空間の基底を返す。微分幾何の教科書で言う <span class="math notranslate nohighlight">\({\dfrac{\partial}{\partial
x_1}, \dotsc, \dfrac{\partial}{\partial x_n}}\)</span> に相当する。</p>
<ul class="simple">
<li><p>単数形の場合、オブジェクトの型は後述のクラス <code class="docutils literal notranslate"><span class="pre">BaseVectorField</span></code> だ。</p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">base_oneform(coord_index)</span></code>, <code class="code docutils literal notranslate"><span class="pre">base_oneforms()</span></code></dt><dd><p>余接空間の基底を返す。微分幾何の教科書で言う <span class="math notranslate nohighlight">\({\dd x_1, \dotsc, \dd
x_n}\)</span> に相当する。</p>
<ul class="simple">
<li><p>単数形の場合、オブジェクトの型は後述のクラス <code class="docutils literal notranslate"><span class="pre">Differential</span></code> だ。</p></li>
</ul>
</dd>
</dl>
<p>座標変換メソッドは次のようなものがある：</p>
<dl>
<dt><code class="code docutils literal notranslate"><span class="pre">connect_to(to_sys,</span> <span class="pre">from_coords,</span> <span class="pre">to_exprs,</span> <span class="pre">inverse=True,</span> <span class="pre">fill_in_gaps=False)</span></code></dt><dd><p>この局所座標系から別の局所座標系 <code class="docutils literal notranslate"><span class="pre">to_sys</span></code> への座標変換を指定する。数式で言うと <span class="math notranslate nohighlight">\({(U_\alpha, \varphi_\alpha)}\)</span> と <span class="math notranslate nohighlight">\({(U_\beta, \varphi_\beta)}\)</span>
の二つの座標近傍について、例えば <span class="math notranslate nohighlight">\({\varphi_\beta \circ
\varphi_\alpha\inv}\)</span> を表現するメソッドだと言える。</p>
<ul class="simple">
<li><p>利用例を知るならモジュール <code class="docutils literal notranslate"><span class="pre">rn</span></code> を見るのが最良。または後述する例題を参照して欲しい。</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">inverse=True</span></code> の指定により、逆写像まで自動的に計算してくれる。</p></li>
<li><p>引数 <code class="docutils literal notranslate"><span class="pre">to_exprs</span></code> で具体的な座標変換式を指定する。</p></li>
</ul>
<p>多様体論では、この座標変換が滑らかであることが死活的に重要なのだが、困ったことに使い勝手が妙に悪い。後述する例題を見て欲しい。</p>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">coord_tuple_transform_to(to_sys,</span> <span class="pre">coords)</span></code></dt><dd><p>この局所座標系における局所座標 <code class="docutils literal notranslate"><span class="pre">coords</span></code> を別の局所座標系 <code class="docutils literal notranslate"><span class="pre">to_sys</span></code> におけるそれに変換する。</p>
<ul class="simple">
<li><p>戻り値は <code class="docutils literal notranslate"><span class="pre">Matrix</span></code> オブジェクトとなる。座標を表現するために便宜上この型を用いている。</p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">point_to_coords(point)</span></code></dt><dd><p>既存の（おそらくは別座標系にある）点オブジェクトから、この座標系での座標を得る。</p>
<ul class="simple">
<li><p>戻り値は <code class="docutils literal notranslate"><span class="pre">Matrix</span></code> オブジェクトとなる。</p></li>
</ul>
</dd>
<dt><code class="code docutils literal notranslate"><span class="pre">jacobian(to_sys,</span> <span class="pre">coords)</span></code></dt><dd><p>当座標系から座標系 <code class="docutils literal notranslate"><span class="pre">to_sys</span></code> に関するヤコビアンを求める。先程から <code class="docutils literal notranslate"><span class="pre">Matrix</span></code>
型が頻出しているのは、このメソッドとの相性のためだろう。</p>
</dd>
</dl>
<p>利用例は後述する。</p>
</section>
<section id="point">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">Point</span></code></a><a class="headerlink" href="#point" title="Permalink to this heading">¶</a></h3>
<p>多様体の一点を表現する型だ。</p>
<ul class="simple">
<li><p>オブジェクトの生成方法はふたつある。このクラスのコンストラクターから直接生成する方法と、クラス <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> のメソッド <code class="docutils literal notranslate"><span class="pre">point</span></code> を呼ぶ方法だ。</p>
<ul>
<li><p>直接生成の場合、局所座標系オブジェクトと座標を要する。前者はもちろん
<code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> オブジェクトであり、後者は単に局所座標成分を <code class="docutils literal notranslate"><span class="pre">list</span></code> で渡せばよい。</p></li>
<li><p>メソッド <code class="docutils literal notranslate"><span class="pre">CoordSystem.point</span></code> の場合は座標成分だけあればよい。対応する局所座標を指定する。</p></li>
</ul>
</li>
<li><p>メソッド <code class="docutils literal notranslate"><span class="pre">coords</span></code> を用いれば、この点の局所座標系が得られる。</p>
<ul>
<li><p>オプションとして別の局所座標系 <code class="docutils literal notranslate"><span class="pre">to_sys</span></code> を与えると、座標変換後の座標を得ることも可能だ。これには前述のクラス <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> のメソッド
<code class="docutils literal notranslate"><span class="pre">coord_tuple_transform_to</span></code> が用いられる。</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="id4">
<h2><a class="toc-backref" href="#id25" role="doc-backlink">多様体の場および微分演算各種</a><a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<p>こちらも利用例は後述することにする。</p>
<section id="basescalarfield">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">BaseScalarField</span></code></a><a class="headerlink" href="#basescalarfield" title="Permalink to this heading">¶</a></h3>
<p>多様体上で定義された関数 <span class="math notranslate nohighlight">\({\fn{f}{M}\RR}\)</span> を構成するための型だ。</p>
<ul>
<li><p>コンストラクターでオブジェクトを生成する場合、<code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> オブジェクトと座標成分番号 <code class="docutils literal notranslate"><span class="pre">i</span></code> を指定する。つまり多様体の局所座標系を一つ指定することになる。</p>
<p>例えば三次元直交座標系の y 成分 (<code class="code docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">1</span></code>) スカラー場を生成する、というような構成をする。</p>
</li>
<li><p>丸括弧で評価するときの引数は <code class="docutils literal notranslate"><span class="pre">Point</span></code> オブジェクトである。点オブジェクトは任意の座標系で表現されていて構わない。戻り値はスカラーだが、座標系の第 <code class="docutils literal notranslate"><span class="pre">i</span></code> 成分に相当する値を示す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BaseScalarField</span></code> オブジェクトを（算術演算等で）組み合わせて、より一般的なスカラー場、つまり多様体上で定義された関数を構成することもできる。</p></li>
</ul>
</section>
<section id="basevectorfield">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">BaseVectorField</span></code></a><a class="headerlink" href="#basevectorfield" title="Permalink to this heading">¶</a></h3>
<p>このクラスが表現するのは多様体上のベクトル場の基底の一つだと思われる。つまりベクトル場 <span class="math notranslate nohighlight">\(\displaystyle \sum_{i=0}^n a_i \frac{\partial}{\partial x_i}\)</span> の
<span class="math notranslate nohighlight">\(\dfrac{\partial}{\partial x_i}\)</span> の部分を表現している。</p>
<p>このクラスはベクトル場を表現するための素材に過ぎない。</p>
<ul class="simple">
<li><p>コンストラクターでオブジェクトを生成する方法は <code class="docutils literal notranslate"><span class="pre">BaseScalarField</span></code> と同じだ。</p></li>
<li><p>丸括弧で評価するときの引数と戻り値の型は両方ともスカラー的な値である。ある点
<code class="docutils literal notranslate"><span class="pre">p</span></code> における座標成分 <code class="docutils literal notranslate"><span class="pre">i</span></code> に関する方向微分を得るには、基底接ベクトル <code class="docutils literal notranslate"><span class="pre">vi</span></code>
を生成した後、結果的に二段階評価を行う。すなわち <code class="code docutils literal notranslate"><span class="pre">vi(f).rcall(p)</span></code> である。</p>
<ul>
<li><p>見慣れぬ <code class="docutils literal notranslate"><span class="pre">rcall</span></code> は丸括弧のようなものなので、気にしないでよい。</p></li>
<li><p>このクラスのオブジェクトを「線形結合」することはできでも、その型が単なる
SymPy の <code class="docutils literal notranslate"><span class="pre">Add</span></code> オブジェクトに過ぎないので、「接ベクトル」に丸括弧をつけて評価することができない。丸括弧の代わりに <code class="code docutils literal notranslate"><span class="pre">rcall()</span></code> を用いる。</p></li>
</ul>
</li>
</ul>
</section>
<section id="commutator">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">Commutator</span></code></a><a class="headerlink" href="#commutator" title="Permalink to this heading">¶</a></h3>
<p>ふたつのベクトル場の交換子、括弧積を表現する。</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">Commutator(X,</span> <span class="pre">Y)</span></code> は <span class="math notranslate nohighlight">\({[X, Y]f \coloneqq X(Yf) - Y(Xf)}\)</span> で定義されるベクトル場を意味する。ここで <code class="docutils literal notranslate"><span class="pre">f</span></code> は多様体上で定義される関数を意味する。</p>
<ul>
<li><p>丸括弧で <code class="docutils literal notranslate"><span class="pre">f</span></code> を評価する前に、交換子オブジェクトがゼロでないことを確認する必要がある。</p></li>
</ul>
</li>
<li><p>ドキュメントにあるように、現行の実装は少々弱いようだ。展開し切れないケースがままある。</p></li>
</ul>
<p><span class="math notranslate nohighlight">\({[X, Y] = -[Y, X]}\)</span> や <span class="math notranslate nohighlight">\({[X, Y] = XY - YX}\)</span> を実感してみよう。次の例では、適当な次元の多様体とその上の適当なベクトル場二つを定義し、この数式の左辺と右辺それぞれに対応する SymPy オブジェクトを生成して、さらに多様体上で定義された適当な関数を評価することによって、間接的に両辺を比較する：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="s1">&#39;R^5&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">U</span> <span class="o">=</span> <span class="n">CoordSystem</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">Patch</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span>

<span class="gp">In [3]: </span><span class="n">x_0</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">x_3</span><span class="p">,</span> <span class="n">x_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">coord_functions</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">X_0</span><span class="p">,</span> <span class="n">X_1</span><span class="p">,</span> <span class="n">X_2</span><span class="p">,</span> <span class="n">X_3</span><span class="p">,</span> <span class="n">X_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">dx0</span><span class="p">,</span> <span class="n">dx_1</span><span class="p">,</span> <span class="n">dx_2</span><span class="p">,</span> <span class="n">dx_3</span><span class="p">,</span> <span class="n">dx_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">base_oneforms</span><span class="p">()</span>
<span class="gp">   ...:</span>

<span class="gp">In [4]: </span><span class="n">X</span> <span class="o">=</span> <span class="n">x2</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">X0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">-</span> <span class="n">X4</span>

<span class="gp">In [5]: </span><span class="n">Y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">**</span> <span class="mi">3</span> <span class="o">+</span> <span class="n">x0</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">X3</span>

<span class="gp">In [6]: </span><span class="n">Commutator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="o">+</span> <span class="n">Commutator</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gh">Out[6]: </span><span class="go">0</span>

<span class="gp">In [7]: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">**</span> <span class="mi">4</span>

<span class="gp">In [8]: </span><span class="n">Commutator</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">-</span> <span class="n">Y</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">f</span><span class="p">)))</span>
<span class="gh">Out[8]: </span><span class="go">0</span>
</pre></div>
</div>
</section>
<section id="differential">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">Differential</span></code></a><a class="headerlink" href="#differential" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">Differential</span></code> は外微分を意味する。スカラー関数を含む微分形式の外微分をオブジェクトとして表現する。</p>
<ul class="simple">
<li><p>コンストラクターには k-形式として扱えるオブジェクトを渡す。ここで k はゼロ以上。</p>
<ul>
<li><p>既存の <code class="docutils literal notranslate"><span class="pre">Differential</span></code> オブジェクトでもかまわないが、結果的にゼロが返る。
<span class="math notranslate nohighlight">\({\dd \circ \dd = 0}\)</span> による。</p></li>
<li><p>先述したメソッド <code class="code docutils literal notranslate"><span class="pre">CoordSystem.base_oneforms</span></code> が返すのは 0-形式
<code class="code docutils literal notranslate"><span class="pre">f_i</span> <span class="pre">=</span> <span class="pre">BaseScalarField(coord,</span> <span class="pre">i)</span></code> の外微分となる 1-形式
<code class="code docutils literal notranslate"><span class="pre">Differential(f_i)</span></code> をすべての <code class="docutils literal notranslate"><span class="pre">i</span></code> 成分について生成したものに他ならない。</p></li>
<li><p>多様体上の関数 <code class="docutils literal notranslate"><span class="pre">f</span></code> からは全微分 <code class="docutils literal notranslate"><span class="pre">df</span></code> が得られる。</p></li>
<li><p>任意のベクトル場 <code class="docutils literal notranslate"><span class="pre">X</span></code> について <code class="code docutils literal notranslate"><span class="pre">df(X)</span> <span class="pre">==</span> <span class="pre">X(f)</span></code> が成り立つ。</p></li>
</ul>
</li>
<li><p>丸括弧で評価する際のオペランドはスカラー関数オブジェクトまたはベクトル場でよい。今度は <code class="docutils literal notranslate"><span class="pre">BaseVectorField</span></code> オブジェクトの線形結合で通じるし、オブジェクトを次元個分カンマ区切りで可変個引数的に渡してもよい。同じ結果が得られると期待してよろしい。</p></li>
<li><p>実装に <code class="docutils literal notranslate"><span class="pre">Commutator</span></code> を用いる。</p></li>
</ul>
</section>
<section id="tensorproduct">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">TensorProduct</span></code></a><a class="headerlink" href="#tensorproduct" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">TensorProduct</span></code> は多様体の座標近傍における（ふつうは一次の）微分形式とベクトル場からなるテンソルを表現することができる。</p>
<p>次の例ではある五次元多様体で簡単な <span class="math notranslate nohighlight">\({(2, 3)}\)</span> テンソルを定義する：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="s1">&#39;R^5&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">U</span> <span class="o">=</span> <span class="n">CoordSystem</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">Patch</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">))</span>

<span class="gp">In [3]: </span><span class="n">x_0</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">x_3</span><span class="p">,</span> <span class="n">x_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">coord_functions</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">X_0</span><span class="p">,</span> <span class="n">X_1</span><span class="p">,</span> <span class="n">X_2</span><span class="p">,</span> <span class="n">X_3</span><span class="p">,</span> <span class="n">X_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">dx_0</span><span class="p">,</span> <span class="n">dx_1</span><span class="p">,</span> <span class="n">dx_2</span><span class="p">,</span> <span class="n">dx_3</span><span class="p">,</span> <span class="n">dx_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">base_oneforms</span><span class="p">()</span>
<span class="gp">   ...:</span>

<span class="gp">In [4]: </span><span class="n">T</span> <span class="o">=</span> <span class="n">TensorProduct</span><span class="p">(</span><span class="n">X_1</span><span class="p">,</span> <span class="n">X_4</span><span class="p">,</span> <span class="n">dx_0</span><span class="p">,</span> <span class="n">dx_2</span><span class="p">,</span> <span class="n">dx_3</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="k">assert</span> <span class="n">covariant_order</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>

<span class="gp">In [6]: </span><span class="k">assert</span> <span class="n">contravariant_order</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">TensorProduct</span></code> 型オブジェクトに対して丸括弧演算子を呼び出すことで、テンソルの多重線形写像としての評価を行うことができる。引数として</p>
<ul class="simple">
<li><p>微分形式に対応する引数にはベクトル場を、</p></li>
<li><p>ベクトル場に対応する引数には局所座標からなるスカラー場を</p></li>
</ul>
<p>それぞれ指定する必要がある。テンソルの各成分ごとの演算結果の積を計算するものと考えるのがわかりやすい：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">var</span>

<span class="gp">In [8]: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;k0:5&#39;</span><span class="p">)</span>
<span class="gh">Out[8]: </span><span class="go">(k0, k1, k2, k3, k4)</span>

<span class="gp">In [9]: </span><span class="n">T</span><span class="p">(</span><span class="n">k0</span><span class="o">*</span><span class="n">x_1</span><span class="p">,</span> <span class="n">k1</span><span class="o">*</span><span class="n">x_4</span><span class="p">,</span> <span class="n">k2</span><span class="o">*</span><span class="n">X_0</span><span class="p">,</span> <span class="n">k3</span><span class="o">*</span><span class="n">X_2</span><span class="p">,</span> <span class="n">k4</span><span class="o">*</span><span class="n">X_3</span><span class="p">)</span>
<span class="gh">Out[9]: </span><span class="go">k0*k1*k2*k3*k4</span>

<span class="gp">In [10]: </span><span class="n">T</span><span class="p">(</span><span class="n">x1</span> <span class="o">**</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">x4</span><span class="p">,</span> <span class="n">X0</span><span class="p">,</span> <span class="n">X0</span> <span class="o">+</span> <span class="n">X1</span> <span class="o">+</span> <span class="n">X2</span> <span class="o">+</span> <span class="n">X3</span> <span class="o">+</span> <span class="n">X4</span><span class="p">,</span> <span class="n">X3</span><span class="p">)</span>
<span class="gh">Out[10]: </span><span class="go">-2/x_1**3</span>
</pre></div>
</div>
<p>空の <code class="docutils literal notranslate"><span class="pre">TensorProduct</span></code> オブジェクトは <code class="docutils literal notranslate"><span class="pre">1</span></code> と評価される。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">TensorProduct</span><span class="p">()</span>
<span class="gh">Out[11]: </span><span class="go">1</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">TensorProduct</span></code> オブジェクトの <code class="docutils literal notranslate"><span class="pre">rcall</span></code> 呼び出しで計量縮約を行なうことができる。次の例は三次元ユークリッド空間にテキトーな計量 <span class="math notranslate nohighlight">\(g\)</span> を定義して、接空間の各基底（当然テンソルの一種とみなせる）と <code class="docutils literal notranslate"><span class="pre">None</span></code> を引数として呼び出すものだ：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">TP</span> <span class="o">=</span> <span class="n">TensorProduct</span>

<span class="gp">In [13]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">k0</span><span class="o">*</span><span class="n">TP</span><span class="p">(</span><span class="n">R3_r</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span> <span class="o">+</span> <span class="n">k1</span><span class="o">*</span><span class="n">TP</span><span class="p">(</span><span class="n">R3_r</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span> <span class="o">+</span> <span class="n">k2</span><span class="o">*</span><span class="n">TP</span><span class="p">(</span><span class="n">R3_r</span><span class="o">.</span><span class="n">dz</span><span class="p">,</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">dz</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">g</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">R3_r</span><span class="o">.</span><span class="n">e_x</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gh">Out[14]: </span><span class="go">k0*dx</span>

<span class="gp">In [15]: </span><span class="n">g</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">R3_r</span><span class="o">.</span><span class="n">e_y</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gh">Out[15]: </span><span class="go">k1*dy</span>

<span class="gp">In [16]: </span><span class="n">g</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">R3_r</span><span class="o">.</span><span class="n">e_z</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="gh">Out[16]: </span><span class="go">k2*dz</span>
</pre></div>
</div>
</section>
<section id="wedgeproduct">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">WedgeProduct</span></code></a><a class="headerlink" href="#wedgeproduct" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">WedgeProduct</span></code> は微分形式オブジェクト同士の外積を表現する。</p>
<ul>
<li><p>スーパークラスは <code class="docutils literal notranslate"><span class="pre">TensorProduct</span></code> だが、混ぜて使わないこと。前項で注意した点がそのまま当クラスの注意点でもある。</p></li>
<li><p>積分の文脈上に限り、反対称性がまともに扱われるとのこと。この注意は、例えば</p>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">WedgeProduct(X,</span> <span class="pre">X)</span></code> のようなオブジェクトを生成しても、直ちにゼロと評価されたりしない</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">WedgeProduct(X,</span> <span class="pre">Y)</span></code> と <code class="code docutils literal notranslate"><span class="pre">-WedgeProduct(Y,</span> <span class="pre">X)</span></code> が等しくならない</p></li>
</ul>
<p>という現象を説明するものだろうか。</p>
</li>
</ul>
</section>
<section id="liederivative">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">クラス <code class="docutils literal notranslate"><span class="pre">LieDerivative</span></code></a><a class="headerlink" href="#liederivative" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">LieDerivative</span></code> はリー微分を表現する。あるベクトル場が生成するフローに沿う何かの微分を計算するのに利用できるはずだ。</p>
<p>次の設定で簡単なテンソル場のリー微分を試すことにする：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">U</span> <span class="o">=</span> <span class="n">CoordSystem</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">Patch</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="n">Manifold</span><span class="p">(</span><span class="s1">&#39;R^5&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>

<span class="gp">In [2]: </span><span class="n">x_0</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">x_3</span><span class="p">,</span> <span class="n">x_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">coord_functions</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">X_0</span><span class="p">,</span> <span class="n">X_1</span><span class="p">,</span> <span class="n">X_2</span><span class="p">,</span> <span class="n">X_3</span><span class="p">,</span> <span class="n">X_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">()</span>
<span class="gp">   ...: </span><span class="n">dx_0</span><span class="p">,</span> <span class="n">dx_1</span><span class="p">,</span> <span class="n">dx_2</span><span class="p">,</span> <span class="n">dx_3</span><span class="p">,</span> <span class="n">dx_4</span> <span class="o">=</span> <span class="n">U</span><span class="o">.</span><span class="n">base_oneforms</span><span class="p">()</span>
<span class="gp">   ...:</span>

<span class="gp">In [3]: </span><span class="n">X</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ci</span> <span class="o">*</span> <span class="n">Xi</span> <span class="k">for</span> <span class="n">ci</span><span class="p">,</span> <span class="n">Xi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;c0:5&#39;</span><span class="p">),</span> <span class="n">U</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">()))</span>

<span class="gp">In [4]: </span><span class="n">L</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">LieDerivative</span><span class="p">,</span> <span class="n">Commutator</span>
</pre></div>
</div>
<p>最初に <span class="math notranslate nohighlight">\({\mathcal L_xf = X(f)}\)</span> と <span class="math notranslate nohighlight">\({\mathcal L_XY = [X, Y]}\)</span> を試してみよう：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">**</span> <span class="mi">2</span>

<span class="gp">In [6]: </span><span class="k">assert</span> <span class="n">L</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">Y</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">x_3</span> <span class="o">*</span> <span class="n">X_0</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">x_1</span> <span class="o">*</span> <span class="n">X_2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x_0</span> <span class="o">*</span> <span class="n">X_4</span>

<span class="gp">In [8]: </span><span class="k">assert</span> <span class="n">L</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="o">==</span> <span class="n">C</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p>次にライプニッツ則スカラー場バージョンを試す：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x_3</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x_4</span> <span class="o">**</span> <span class="mi">2</span>

<span class="gp">In [10]: </span><span class="k">assert</span> <span class="n">L</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">L</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="o">+</span> <span class="n">L</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</pre></div>
</div>
<p>SymPy の FAQ にあるように、こういう複雑な等式のテストにはメソッド
<code class="code docutils literal notranslate"><span class="pre">expand()</span></code> を適用したり、左辺マイナス右辺をゼロと比較したりする必要があることが多い。</p>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p><span class="math notranslate nohighlight">\(f, g \in C^\infty(M)\)</span>, <span class="math notranslate nohighlight">\(X, Y \in \mathfrak X(M)\)</span>,
<span class="math notranslate nohighlight">\(\omega \in \varOmega^1(M)\)</span>,
<span class="math notranslate nohighlight">\(\xi \in \varGamma(T(a, b)),\ \eta \in \varGamma(T(a', b'))\)</span> に対して、例えば次に挙げるリー微分の性質が成り立っているかどうかを試したい：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
&amp;(\mathcal L_X \omega)(Y) = X(\omega(Y)) - \omega([X, Y])\\
&amp;(\mathcal L_X \omega)(fY) = f(\mathcal L_X\omega)(Y)\\
&amp;\mathcal L_X(fY) = f \mathcal L_X(Y) + (\mathcal L_Xf) Y\\
&amp;\mathcal L_X(f\omega) = f \mathcal L_X(\omega) + (\mathcal L_Xf) \omega\\
&amp;\mathcal L_{[X, Y]} = \mathcal L_X \circ \mathcal L_Y - \mathcal L_Y \circ \mathcal L_X\\
&amp;\mathcal L_X(\xi \otimes \eta) = \mathcal L_X\xi \otimes \eta + \xi \otimes \mathcal L_X\eta
\end{align*}\end{split}\]</div>
<p>今のところ与えるテンソルが平凡過ぎて処理中にスカラーになるのがまずいのか、
<code class="docutils literal notranslate"><span class="pre">TypeError:</span> <span class="pre">'Add'</span> <span class="pre">object</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">callable</span></code> というエラーが頻出する。</p>
</div>
</section>
</section>
<section id="id6">
<h2><a class="toc-backref" href="#id33" role="doc-backlink">定義済み多様体オブジェクト</a><a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<p>本節ではサブモジュール <code class="docutils literal notranslate"><span class="pre">sympy.diffgeom.rn</span></code> に定義されているオブジェクトを見ていく。</p>
<p>前節で述べた一連の機能をすぐに試したいが、後で見るように比較的簡単な多様体を構成することすら面倒で困る。そこで、ここにある定義済みオブジェクトをインポートすることが考えられる。それらのオブジェクトを試して、感触を確かめるのがよいだろう。</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>オブジェクト</p></th>
<th class="head"><p>クラス</p></th>
<th class="head"><p>名前</p></th>
<th class="head"><p>意味</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">R2</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Manifold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'R^2'</span></code></p></td>
<td><p>ユークリッド空間 <span class="math notranslate nohighlight">\(\RR^2\)</span> を多様体としてみたもの</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">R2_origin</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Patch</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'origin'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">R2</span></code> の局所（というか大域）座標近傍</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">R2_r</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'rectangular'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">R2_origin</span></code> の局所座標を直交座標系で表現したもの</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">R2_p</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'polar'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">R2_origin</span></code> の極座標系</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">R3</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Manifold</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'R^3'</span></code></p></td>
<td><p>ユークリッド空間 <span class="math notranslate nohighlight">\(\RR^3\)</span> を多様体としてみたもの</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">R3_origin</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Patch</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'origin'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">R3</span></code> の局所（というか大域）座標近傍</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">R3_r</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'rectangular'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">R3_origin</span></code> の局所座標を直交座標系で表現したもの</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">R3_c</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'cylindrical'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">R3_origin</span></code> の局所座標を円柱座標系で表現したもの</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">R3_s</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'spherical'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">R3_origin</span></code> の局所座標を球座標系で表現したもの</p></td>
</tr>
</tbody>
</table>
<p>どちらの次元の多様体にも開集合としての座標近傍は一つしか定義されていないが、それに対して複数の局所座標系が与えられていて、それらの間の座標変換も定義済みだ。</p>
<section id="id7">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">二次元オブジェクト</a><a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">R2</span></code>, <code class="docutils literal notranslate"><span class="pre">R2_origin</span></code>, <code class="docutils literal notranslate"><span class="pre">R2_r</span></code>, <code class="docutils literal notranslate"><span class="pre">R2_p</span></code> には可能な限り次に示すメンバーデータが付与されている。可能な限りというのは「局所座標系 <span class="math notranslate nohighlight">\(A\)</span> 由来のデータは局所座標系 <span class="math notranslate nohighlight">\(B\)</span> には付与しない」という意味だ。</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code></dt><dd><p><code class="code docutils literal notranslate"><span class="pre">R2_r.coord_functions()</span></code> から値を設定。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">e_x</span></code>, <code class="docutils literal notranslate"><span class="pre">e_y</span></code></dt><dd><p><code class="code docutils literal notranslate"><span class="pre">R2_r.base_vectors()</span></code> から値を設定。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dx</span></code>, <code class="docutils literal notranslate"><span class="pre">dy</span></code></dt><dd><p><code class="code docutils literal notranslate"><span class="pre">R2_r.base_oneforms()</span></code> から値を設定。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">theta</span></code></dt><dd><p><code class="code docutils literal notranslate"><span class="pre">R2_p.coord_functions()</span></code> から値を設定。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">e_r</span></code>, <code class="docutils literal notranslate"><span class="pre">e_theta</span></code></dt><dd><p><code class="code docutils literal notranslate"><span class="pre">R2_p.base_vectors()</span></code> から値を設定。</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dr</span></code>, <code class="docutils literal notranslate"><span class="pre">dtheta</span></code></dt><dd><p><code class="code docutils literal notranslate"><span class="pre">R2_p.base_oneforms()</span></code> から値を設定。</p>
</dd>
</dl>
<p>座標成分 <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">theta</span></code> は次の座標変換が（微妙な点もあるが）成り立つように相互に <code class="docutils literal notranslate"><span class="pre">connect_to</span></code> している。数式中の逆三角正接関数は SymPy では関数 <code class="docutils literal notranslate"><span class="pre">atan2</span></code> である。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\varphi_{pr}: (x, y) &amp; \longmapsto (\sqrt{x^2 + y^2}, \tan\inv \frac{y}{x})\\
\varphi_{rp}: (r, \theta) &amp; \longmapsto (r \cos \theta, r \sin \theta)
\end{align*}\end{split}\]</div>
<p>ただし <span class="math notranslate nohighlight">\({\varphi_{rp} = \varphi_r \circ \varphi_p\inv}\)</span> 等と記した。以下同様。</p>
</section>
<section id="id8">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">三次元オブジェクト</a><a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">R3</span></code> 側でも同様の考えの下に、各オブジェクトに局所座標成分、接ベクトル基底、1-
形式基底のメンバーデータが付与されて、関連する三座標系の間に相互に座標変換が定義されている。</p>
<p>以下、座標変換だけ記す。直交座標系と円柱座標系間の座標変換は次のように与えられている：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\varphi_{cr}: (x, y, z) &amp; \longmapsto (\sqrt{x^2 + y^2}, \tan\inv \frac{y}{x}, z)\\
\varphi_{rc}: (\rho, \psi, z) &amp; \longmapsto (\rho \cos \psi, \rho \sin \psi, z)
\end{align*}\end{split}\]</div>
<p>直交座標系と球座標系間の座標変換は次のように与えられている：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\varphi_{sr}: (x, y, z) &amp; \longmapsto (\sqrt{x^2 + y^2 + z^2}, \cos\inv \frac{z}{\sqrt{x^2 + y^2 + z^2}}, \tan\inv \frac{y}{x})\\
\varphi_{rs}: (r, \theta, \varphi) &amp; \longmapsto (r \sin \theta \cos \varphi, r \sin \theta \sin \varphi, r \cos \theta)
\end{align*}\end{split}\]</div>
<p>円柱座標系と球座標系間の座標変換は次のように与えられている：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\varphi_{sc}: (\rho, \psi, z) &amp; \longmapsto (\sqrt{\rho^2 + z^2}, \cos\inv \frac{z}{\sqrt{\rho^2 + z^2}}, \psi)\\
\varphi_{cs}: (r, \theta, \varphi) &amp; \longmapsto (r \sin \theta, \varphi, r \cos \theta)
\end{align*}\end{split}\]</div>
</section>
</section>
<section id="id9">
<h2><a class="toc-backref" href="#id36" role="doc-backlink">コード例（基本編）</a><a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h2>
<p>コード例を書けるだけのクラスとオブジェクトの説明が終わったところで、基本的な用例を示したい。</p>
<p>以下に示す例では、出来合いの <code class="docutils literal notranslate"><span class="pre">R2_r</span></code> 等のオブジェクトを多用する。</p>
<section id="id10">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">局所座標系</a><a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code>, <code class="docutils literal notranslate"><span class="pre">Point</span></code>, <code class="docutils literal notranslate"><span class="pre">BaseScalarField</span></code> の座標成分に関係するメソッドの簡単な例を示す：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">r</span><span class="p">,</span> <span class="n">th</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;r th&#39;</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">polar_coords</span> <span class="o">=</span> <span class="n">R2_p</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="n">r</span><span class="p">,</span> <span class="n">th</span><span class="p">])</span>

<span class="gp">In [3]: </span><span class="n">R2_r</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">polar_coords</span><span class="p">),</span> <span class="n">R2_r</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">polar_coords</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">(r*cos(th), r*sin(th))</span>

<span class="gp">In [4]: </span><span class="n">R2_r</span><span class="o">.</span><span class="n">point_to_coords</span><span class="p">(</span><span class="n">polar_coords</span><span class="p">)</span>
<span class="gh">Out[4]:</span>
<span class="go">Matrix([</span>
<span class="go">[r*cos(th)],</span>
<span class="go">[r*sin(th)]])</span>

<span class="gp">In [5]: </span><span class="n">R2_p</span><span class="o">.</span><span class="n">coord_tuple_transform_to</span><span class="p">(</span><span class="n">R2_r</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">th</span><span class="p">])</span>
<span class="gh">Out[5]:</span>
<span class="go">Matrix([</span>
<span class="go">[r*cos(th)],</span>
<span class="go">[r*sin(th)]])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>[1][2] 記号により二次元極座標系の座標 <code class="code docutils literal notranslate"><span class="pre">(r,</span> <span class="pre">th)</span></code> を定義する。</p></li>
<li><p>[3] <code class="docutils literal notranslate"><span class="pre">BaseScalarField</span></code> オブジェクト:code:<cite>R2_r.x</cite> および <code class="code docutils literal notranslate"><span class="pre">R2r.y</span></code> による局所座標系表示 <code class="docutils literal notranslate"><span class="pre">point</span></code> の x 座標と y 座標成分の取得。</p></li>
<li><p>[4] 同じことをメソッド <code class="code docutils literal notranslate"><span class="pre">CoordSystem.point_to_coords</span></code> で。</p></li>
<li><p>[5] 同じことをメソッド <code class="code docutils literal notranslate"><span class="pre">CoordSystem.coord_tuple_transform_to</span></code> で。これがあるので [2] の前処理なしで済むことがある。</p></li>
</ul>
<p>ドキュメントのそれとたいして変わらないが、ヤコビアンの例を示す：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">th</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y r th&#39;</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">R2_r</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">R2_r</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="gh">Out[2]:</span>
<span class="go">Matrix([</span>
<span class="go">[1, 0],</span>
<span class="go">[0, 1]])</span>

<span class="gp">In [3]: </span><span class="n">R2_r</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">R2_p</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="gh">Out[3]:</span>
<span class="go">Matrix([</span>
<span class="go">[x/sqrt(x**2 + y**2), y/sqrt(x**2 + y**2)],</span>
<span class="go">[   -y/(x**2 + y**2),     x/(x**2 + y**2)]])</span>

<span class="gp">In [4]: </span><span class="n">R2_p</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">R2_r</span><span class="p">,</span> <span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">th</span><span class="p">])</span>
<span class="gh">Out[4]:</span>
<span class="go">Matrix([</span>
<span class="go">[cos(th), -r*sin(th)],</span>
<span class="go">[sin(th),  r*cos(th)]])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>[2] 一応見ておくだけだが、自分自身の座標系でヤコビアンを求めると、恒等行列が得られる。</p></li>
<li><p>[3]二次元直交座標系から極座標系への変換のヤコビアン。</p></li>
<li><p>[4]二次元極座標系から直交座標系への変換のヤコビアン。</p></li>
</ul>
</section>
<section id="s-1">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">単位円 <span class="math notranslate nohighlight">\(S^1\)</span></a><a class="headerlink" href="#s-1" title="Permalink to this heading">¶</a></h3>
<p>ユークリッド空間 <span class="math notranslate nohighlight">\(\RR^2\)</span> の部分集合 <span class="math notranslate nohighlight">\({S^1 = \set{\bm x \in \RR^2
\sth \norm{\bm x} = 1}}\)</span> を一次元多様体として表現してみよう（わかりやすさを優先して、変数を冗長に使い分けている）：</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;s1.py: Construct :math:`S^1` as a smooth manifold.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sympy.diffgeom</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Manifold</span><span class="p">,</span> <span class="n">Patch</span><span class="p">,</span> <span class="n">CoordSystem</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># A unit circle in \RR^2:</span>
    <span class="n">S1</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Coordinate charts :math:`(U_i^\pm, \phi_i^\pm)` for S1:</span>
    <span class="c1"># 0, 1 -&gt; x0, x1</span>
    <span class="c1"># p, m -&gt; +, -</span>
    <span class="n">phip0</span> <span class="o">=</span> <span class="n">CoordSystem</span><span class="p">(</span><span class="s1">&#39;phip0&#39;</span><span class="p">,</span> <span class="n">Patch</span><span class="p">(</span><span class="s1">&#39;Up0&#39;</span><span class="p">,</span> <span class="n">S1</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">])</span>
    <span class="n">phim0</span> <span class="o">=</span> <span class="n">CoordSystem</span><span class="p">(</span><span class="s1">&#39;phim0&#39;</span><span class="p">,</span> <span class="n">Patch</span><span class="p">(</span><span class="s1">&#39;Um0&#39;</span><span class="p">,</span> <span class="n">S1</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">])</span>
    <span class="n">phip1</span> <span class="o">=</span> <span class="n">CoordSystem</span><span class="p">(</span><span class="s1">&#39;phip1&#39;</span><span class="p">,</span> <span class="n">Patch</span><span class="p">(</span><span class="s1">&#39;Up1&#39;</span><span class="p">,</span> <span class="n">S1</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">])</span>
    <span class="n">phim1</span> <span class="o">=</span> <span class="n">CoordSystem</span><span class="p">(</span><span class="s1">&#39;phim1&#39;</span><span class="p">,</span> <span class="n">Patch</span><span class="p">(</span><span class="s1">&#39;Um1&#39;</span><span class="p">,</span> <span class="n">S1</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">])</span>

    <span class="n">intersections</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">phip0</span><span class="p">,</span> <span class="n">phip1</span><span class="p">),</span> <span class="p">(</span><span class="n">phip0</span><span class="p">,</span> <span class="n">phim1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">phim0</span><span class="p">,</span> <span class="n">phip1</span><span class="p">),</span> <span class="p">(</span><span class="n">phim0</span><span class="p">,</span> <span class="n">phim1</span><span class="p">),)</span>

    <span class="c1"># Transition maps:</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x:2&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">phip0</span><span class="o">.</span><span class="n">connect_to</span><span class="p">(</span><span class="n">phip1</span><span class="p">,</span> <span class="p">[</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="p">)],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">phip0</span><span class="o">.</span><span class="n">connect_to</span><span class="p">(</span><span class="n">phim1</span><span class="p">,</span> <span class="p">[</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="p">)],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">phim0</span><span class="o">.</span><span class="n">connect_to</span><span class="p">(</span><span class="n">phip1</span><span class="p">,</span> <span class="p">[</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="p">)],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">phim0</span><span class="o">.</span><span class="n">connect_to</span><span class="p">(</span><span class="n">phim1</span><span class="p">,</span> <span class="p">[</span><span class="n">x1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="p">)],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">phip1</span><span class="o">.</span><span class="n">connect_to</span><span class="p">(</span><span class="n">phip0</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">],</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x0</span><span class="o">**</span><span class="mi">2</span><span class="p">)],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">phip1</span><span class="o">.</span><span class="n">connect_to</span><span class="p">(</span><span class="n">phim0</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">],</span> <span class="p">[</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x0</span><span class="o">**</span><span class="mi">2</span><span class="p">)],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">phim1</span><span class="o">.</span><span class="n">connect_to</span><span class="p">(</span><span class="n">phip0</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x0</span><span class="o">**</span><span class="mi">2</span><span class="p">)],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">phim1</span><span class="o">.</span><span class="n">connect_to</span><span class="p">(</span><span class="n">phim0</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x0</span><span class="o">**</span><span class="mi">2</span><span class="p">)],</span> <span class="n">inverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Jacobian matrices:</span>
    <span class="k">for</span> <span class="n">map0</span><span class="p">,</span> <span class="n">map1</span> <span class="ow">in</span> <span class="n">intersections</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Jacobian </span><span class="si">{</span><span class="n">map0</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> -&gt; </span><span class="si">{</span><span class="n">map1</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">: &#39;</span><span class="p">,</span> <span class="n">map0</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">map1</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Jacobian </span><span class="si">{</span><span class="n">map1</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> -&gt; </span><span class="si">{</span><span class="n">map0</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">: &#39;</span><span class="p">,</span> <span class="n">map1</span><span class="o">.</span><span class="n">jacobian</span><span class="p">(</span><span class="n">map0</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]))</span>

    <span class="c1"># Transition maps:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">phip0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phip1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">phip0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phim1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">phim0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phip1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">phim0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phim1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">phip1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phip0</span><span class="p">),</span>
        <span class="p">(</span><span class="n">phip1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phim0</span><span class="p">),</span>
        <span class="p">(</span><span class="n">phim1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phip0</span><span class="p">),</span>
        <span class="p">(</span><span class="n">phim1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phim0</span><span class="p">),)</span>
    <span class="k">for</span> <span class="n">cfrom</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">cto</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cfrom</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">7.4f</span><span class="si">}</span><span class="s1">) = &#39;</span>
              <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cto</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="n">cto</span><span class="o">.</span><span class="n">point_to_coords</span><span class="p">(</span><span class="n">cfrom</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="n">t</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">7.4f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<ul>
<li><p>序盤の <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> および <code class="docutils literal notranslate"><span class="pre">Patch</span></code> オブジェクトのペア四個は単位円と</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">phip0</span></code>: 半平面 <span class="math notranslate nohighlight">\(x_0 &gt; 0\)</span> との共通部分、</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">phim0</span></code>: 半平面 <span class="math notranslate nohighlight">\(x_0 &lt; 0\)</span> との共通部分、</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">phip1</span></code>: 半平面 <span class="math notranslate nohighlight">\(x_1 &gt; 0\)</span> との共通部分、</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">phim1</span></code>: 半平面 <span class="math notranslate nohighlight">\(x_1 &lt; 0\)</span> との共通部分を</p></li>
</ul>
<p>それぞれ表現するためのものだ。</p>
</li>
<li><p>次に各座標変換 <span class="math notranslate nohighlight">\({\varphi_j^\pm \circ \varphi_i^\pm{}\inv}\)</span> を指定する。ここでは <code class="code docutils literal notranslate"><span class="pre">inverse=False</span></code> として逆写像を自動で計算させる機能を無効化する。</p>
<ul class="simple">
<li><p>こうしないとなぜか <code class="code docutils literal notranslate"><span class="pre">-sqrt(1</span> <span class="pre">-</span> <span class="pre">x0**2)</span></code> の逆写像の評価に失敗するのでそうしているに過ぎない。可能な限り SymPy に逆写像を求めさせるのが楽に決まっている。</p></li>
</ul>
</li>
<li><p>次にオーバーラップする座標近傍における座標変換のヤコビアンを出力する。多様体次元が 1 であるため、一次正方行列として評価される。</p>
<ul class="simple">
<li><p>余裕があればヤコビアンから多様体の臨界点を求める処理を考えてみよう。</p></li>
</ul>
</li>
<li><p>最後に適当な座標近傍上の点について座標変換を見る。 <span class="math notranslate nohighlight">\(\pm\dfrac{1}{2}\)</span> は
<span class="math notranslate nohighlight">\(\pm\dfrac{\sqrt{3}}{2}\)</span> または <span class="math notranslate nohighlight">\(\mp\dfrac{\sqrt{3}}{2}\)</span> に変換されるはずだ。</p></li>
</ul>
<p>実行結果は次のようになる：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Jacobian phip0 -&gt; phip1: Matrix([[-x1/sqrt(-x1**2 + 1)]])
Jacobian phip1 -&gt; phip0: Matrix([[-x0/sqrt(-x0**2 + 1)]])
Jacobian phip0 -&gt; phim1: Matrix([[-x1/sqrt(-x1**2 + 1)]])
Jacobian phim1 -&gt; phip0: Matrix([[x0/sqrt(-x0**2 + 1)]])
Jacobian phim0 -&gt; phip1: Matrix([[x1/sqrt(-x1**2 + 1)]])
Jacobian phip1 -&gt; phim0: Matrix([[-x0/sqrt(-x0**2 + 1)]])
Jacobian phim0 -&gt; phim1: Matrix([[x1/sqrt(-x1**2 + 1)]])
Jacobian phim1 -&gt; phim0: Matrix([[x0/sqrt(-x0**2 + 1)]])
phip0( 0.5000) = phip1( 0.8660)
phip0(-0.5000) = phim1( 0.8660)
phim0( 0.5000) = phip1(-0.8660)
phim0(-0.5000) = phim1(-0.8660)
phip1( 0.5000) = phip0( 0.8660)
phip1(-0.5000) = phim0( 0.8660)
phim1( 0.5000) = phip0(-0.8660)
phim1(-0.5000) = phim0(-0.8660)
</pre></div>
</div>
</section>
<section id="id11">
<h3><a class="toc-backref" href="#id39" role="doc-backlink">ベクトル場</a><a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">BaseVectorField</span></code> の例を示す。三次元空間に何か適当な、例えば原点からの距離の平方に反比例する値を返すスカラー場</p>
<div class="math notranslate nohighlight">
\[\fnm{f}{\RR^2}{\RR}{(r, \theta, \varphi)}-\frac{k}{r^2}.\]</div>
<p>を <code class="docutils literal notranslate"><span class="pre">f</span></code> として定義し、各座標成分について適用させて方向微分を見よう。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">k</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span> <span class="o">*</span> <span class="n">R3_s</span><span class="o">.</span><span class="n">r</span> <span class="o">**</span> <span class="o">-</span><span class="mi">2</span>

<span class="gp">In [3]: </span><span class="n">R3_s</span><span class="o">.</span><span class="n">e_r</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">R3_s</span><span class="o">.</span><span class="n">e_theta</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">R3_s</span><span class="o">.</span><span class="n">e_phi</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gh">Out[3]: </span><span class="go">(2*k/r**3, 0, 0)</span>

<span class="gp">In [4]: </span><span class="n">R3_r</span><span class="o">.</span><span class="n">e_x</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">e_y</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">e_z</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gh">Out[4]: </span><span class="go">(2*k*x/(sqrt(x**2 + y**2 + z**2)*r**3), 2*k*y/(sqrt(x**2 + y**2 + z**2)*r**3), 2*k*z/(sqrt(x**2 + y**2 + z**2)*r**3))</span>

<span class="gp">In [5]: </span><span class="n">R3_c</span><span class="o">.</span><span class="n">e_rho</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">R3_c</span><span class="o">.</span><span class="n">e_psi</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">R3_c</span><span class="o">.</span><span class="n">e_z</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gh">Out[5]: </span><span class="go">(2*k*rho/(sqrt(rho**2 + z**2)*r**3), 0, 2*k*z/(sqrt(rho**2 + z**2)*r**3))</span>
</pre></div>
</div>
<ul>
<li><p>[2] 球座標系でスカラー場 <span class="math notranslate nohighlight">\(f(r, \theta, \varphi) = -\dfrac{k}{r^2}\)</span> を定義する。</p></li>
<li><p>[3] まず球座標系 <code class="docutils literal notranslate"><span class="pre">R3_s</span></code> の <code class="docutils literal notranslate"><span class="pre">BaseVectorField</span></code> オブジェクト <code class="docutils literal notranslate"><span class="pre">e_r</span></code>,
<code class="docutils literal notranslate"><span class="pre">e_theta</span></code>, <code class="docutils literal notranslate"><span class="pre">e_psi</span></code> の丸括弧演算を全成分で評価する。つまり単に勾配ベクトルを手動で求めることになる。前述したとおり <span class="math notranslate nohighlight">\(\dfrac{\partial f}{\partial
r}\)</span> 等が得られている。</p></li>
<li><p>[4][5] 直交座標系 <code class="docutils literal notranslate"><span class="pre">R3_r</span></code> と 円柱座標系 <code class="docutils literal notranslate"><span class="pre">R3_s</span></code> で同じことをする。例えば
<code class="code docutils literal notranslate"><span class="pre">R3_r.e_x(f)</span></code> を見ると、例示したスカラー場がゼロ成分ばかりで検証しにくいが、これは一応次の式に合致した結果である。</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
\frac{\partial f}{\partial x} =
\frac{\partial f}{\partial r}\frac{\partial r}{\partial x} +
\frac{\partial f}{\partial \theta}\frac{\partial \theta}{\partial x} +
\frac{\partial f}{\partial \varphi}\frac{\partial \varphi}{\partial x}
\end{align*}\]</div>
</li>
</ul>
</section>
<section id="id12">
<h3><a class="toc-backref" href="#id40" role="doc-backlink">微分形式と外微分</a><a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h3>
<p>クラス <code class="docutils literal notranslate"><span class="pre">Differential</span></code> と <code class="docutils literal notranslate"><span class="pre">WedgeProduct</span></code> の基本動作を見たい。例えば次の微分形式 <span class="math notranslate nohighlight">\(\omega\)</span> とその外微分 <span class="math notranslate nohighlight">\({\dd \omega}\)</span> をこれらのクラスを用いて再現したい。上側の数式（出典はネットで拾ってきたどこかのベクトル解析の演習問題）のほうをオブジェクトとして表現して、それをうまく処理して下側の数式に相当するオブジェクトを得たい。</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\omega &amp;= axyz \,\dx + bx^2z\,\dd y -3x^2y\,\dd z\\
\dd{\omega} &amp;= (-bx^2 - 3x^2)\,\dd y \wedge \dd z + (axy + 6xy)\,\dd z \wedge \dd x + (2bxz - axz)\,\dd x \wedge \dd y.
\end{align*}\end{split}\]</div>
<p>まずは <code class="docutils literal notranslate"><span class="pre">Differential</span></code> だけでがんばる：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b c&#39;</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">fx</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">z</span>

<span class="gp">In [3]: </span><span class="n">fy</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">z</span>

<span class="gp">In [4]: </span><span class="n">fz</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">y</span>

<span class="gp">In [5]: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">fx</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">dx</span> <span class="o">+</span> <span class="n">fy</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">dy</span> <span class="o">+</span> <span class="n">fz</span> <span class="o">*</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">dz</span><span class="p">;</span> <span class="n">omega</span>
<span class="gh">Out[5]: </span><span class="go">a*x*y*z*dx + b*x**2*z*dy - 3*x**2*y*dz</span>

<span class="gp">In [6]: </span><span class="n">domega</span> <span class="o">=</span> <span class="n">Differential</span><span class="p">(</span><span class="n">omega</span><span class="p">);</span> <span class="n">domega</span>
<span class="gh">Out[6]: </span><span class="go">d(a*x*y*z*dx + b*x**2*z*dy - 3*x**2*y*dz)</span>

<span class="gp">In [7]: </span><span class="n">domega</span><span class="p">(</span><span class="n">ey</span><span class="p">,</span> <span class="n">ez</span><span class="p">),</span> <span class="n">domega</span><span class="p">(</span><span class="n">ez</span><span class="p">,</span> <span class="n">ex</span><span class="p">),</span> <span class="n">domega</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">)</span>
<span class="gh">Out[7]: </span><span class="go">(-b*x**2 - 3*x**2, a*x*y + 6*x*y, -a*x*z + 2*b*x*z)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>[1]-[4] <span class="math notranslate nohighlight">\(\RR^3\)</span> 上の 1-形式 <code class="docutils literal notranslate"><span class="pre">omega</span></code> のセットアップ。</p></li>
<li><p>[5] 内容の確認。ちなみに各単項式の次数が一致していることに気付いて欲しい。</p></li>
<li><p>[6] 外微分オブジェクト <code class="docutils literal notranslate"><span class="pre">domega</span></code> を生成する。</p></li>
<li><p>[7] 丸括弧評価。ここでは <span class="math notranslate nohighlight">\({\dd y \wedge \dd z}\)</span> 等の
<span class="math notranslate nohighlight">\({\extp^2(\RR^3)}\)</span> の基底ごとに係数を得ている。</p>
<ul>
<li><p>先ほどの数式の <span class="math notranslate nohighlight">\({\dd \omega}\)</span> 全体を一度に得られる方法はないのか？</p></li>
<li><p>なぜ <span class="math notranslate nohighlight">\({\omega\left(\dfrac{\partial}{\partial y},
\dfrac{\partial}{\partial z}\right)}\)</span> でそれが得られるのか、考えてみよう。</p></li>
</ul>
</li>
</ul>
<p>次に手動で WedgeProduct を適用することで <span class="math notranslate nohighlight">\({\dd \omega}\)</span> を求めるやり方をとる：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">domega2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">WedgeProduct</span><span class="p">(</span><span class="n">Differential</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">oneform</span><span class="p">)</span>\
<span class="gp">   ...: </span><span class="k">for</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">oneform</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">((</span><span class="n">fx</span><span class="p">,</span> <span class="n">fy</span><span class="p">,</span> <span class="n">fz</span><span class="p">),</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">base_oneforms</span><span class="p">()))</span>
<span class="gh">Out[8]: </span><span class="go">WedgeProduct(d(-3*x**2*y), dz) + WedgeProduct(d(b*x**2*z), dy) + WedgeProduct(d(a*x*y*z), dx)</span>

<span class="gp">In [9]: </span><span class="n">domega2</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">ey</span><span class="p">,</span> <span class="n">ez</span><span class="p">),</span> <span class="n">domega2</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">ez</span><span class="p">,</span> <span class="n">ex</span><span class="p">),</span> <span class="n">domega2</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">ey</span><span class="p">)</span>
<span class="gh">Out[9]: </span><span class="go">(-b*x**2 - 3*x**2, a*x*y + 6*x*y, -a*x*z + 2*b*x*z)</span>
</pre></div>
</div>
<ul>
<li><p>[8] <code class="docutils literal notranslate"><span class="pre">omega</span></code> と同じものを表すハズの <code class="docutils literal notranslate"><span class="pre">omega2</span></code> をセットアップ。外積代数における次の関係式を意識している：</p>
<div class="math notranslate nohighlight">
\[\dd \left(\sum_{i = 1}^n f_i\,\dd x_i\right) = \sum_{i = 1}^n \dd f_i\,\wedge \dd x_i\]</div>
</li>
<li><p>[9] 今度は素の丸括弧は効かないので（式全体が単なる <code class="docutils literal notranslate"><span class="pre">Add</span></code> オブジェクトだから）、代わりに <code class="docutils literal notranslate"><span class="pre">rcall</span></code> を適用する。</p></li>
</ul>
<p>余談だが、テストモジュール <code class="docutils literal notranslate"><span class="pre">test_function_diffgeom_book</span></code> の関数
<code class="docutils literal notranslate"><span class="pre">test_functional_diffgeom_ch6</span></code> を参考にして、 <code class="docutils literal notranslate"><span class="pre">omega</span></code> と <code class="docutils literal notranslate"><span class="pre">omega2</span></code> が同じらしいことを確認するにはこうする：</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">permutations</span>

<span class="gp">In [11]: </span><span class="nb">all</span><span class="p">((</span><span class="n">domega</span> <span class="o">-</span> <span class="n">domega2</span><span class="p">)</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">permutations</span><span class="p">(</span><span class="n">R3_r</span><span class="o">.</span><span class="n">base_vectors</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
<span class="gh">Out[11]: </span><span class="go">True</span>
</pre></div>
</div>
<ul class="simple">
<li><p>[11] xyz のうちの順序を込めた任意ふたつの方向について <code class="docutils literal notranslate"><span class="pre">domega</span></code> と
<code class="docutils literal notranslate"><span class="pre">domega2</span></code> が同じことがわかる。理論がわからないが、全方向で評価すると先程述べたように変な値が出てくる。</p></li>
</ul>
</section>
</section>
<section id="id13">
<h2><a class="toc-backref" href="#id41" role="doc-backlink">積分曲線</a><a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h2>
<p>再びサブモジュール <code class="docutils literal notranslate"><span class="pre">sympy.diffgeom.diffgeom</span></code> に戻り、残りの機能を調べる。</p>
<p>ベクトル場の積分曲線を計算するための関数が定義されている。ベクトル場を <span class="math notranslate nohighlight">\(X\)</span>
とし、局所的に対応する積分曲線を <span class="math notranslate nohighlight">\(\gamma(t)\)</span> とする常微分方程式
<span class="math notranslate nohighlight">\({\displaystyle \diff{\gamma(t)}{t} = X(\gamma(t))}\)</span> の一般解を求めるための関数だ。級数版と微分方程式版のふたつがある。仕様を順に記してから、例を示す。</p>
<dl class="simple">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">intcurve_series(vector_field,</span> <span class="pre">param,</span> <span class="pre">start_point,</span> <span class="pre">n=6,</span> <span class="pre">coord_sys=None,</span> <span class="pre">coeffs=False)</span></code></dt><dd><p>ベクトル場が満たす積分曲線を級数展開の形で返す。</p>
<ul class="simple">
<li><p>引数 <code class="docutils literal notranslate"><span class="pre">vector_field</span></code> は（何らかのフローを生成するような）ベクトル場。</p></li>
<li><p>引数 <code class="docutils literal notranslate"><span class="pre">param</span></code> は積分曲線のパラメーター記号。差し当たり <code class="code docutils literal notranslate"><span class="pre">symbols('t')</span></code>
などを渡せば十分。</p></li>
<li><p>引数 <code class="docutils literal notranslate"><span class="pre">start_point</span></code> は積分曲線の <code class="code docutils literal notranslate"><span class="pre">param=0</span></code> に対応する多様体上の点。ここでは <code class="docutils literal notranslate"><span class="pre">Point</span></code> オブジェクトを渡す。</p></li>
<li><p>キーワード引数 <code class="docutils literal notranslate"><span class="pre">n</span></code> は級数展開の次数。デフォルトの <code class="docutils literal notranslate"><span class="pre">6</span></code> ならば
<span class="math notranslate nohighlight">\(O(n^6)\)</span> の部分はカットされる。</p></li>
<li><p>キーワード引数 <code class="docutils literal notranslate"><span class="pre">coord_sys</span></code> は級数展開を行う局所座標系を指定する。他の引数で示されるものとは異なる座標系を用いる場合にこれを用いる。</p></li>
<li><p>キーワード引数 <code class="docutils literal notranslate"><span class="pre">coeffs</span></code> を <code class="docutils literal notranslate"><span class="pre">True</span></code> にすると、戻り値を級数展開の要素のリストとして返すようになる。</p></li>
<li><p>戻り値はデフォルトでは <code class="docutils literal notranslate"><span class="pre">Matrix</span></code> オブジェクト。各行が積分曲線の座標成分に対応していて、内容は変数 <code class="docutils literal notranslate"><span class="pre">param</span></code> に関する多項式である。</p></li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">intcurve_diffequ(vector_field,</span> <span class="pre">param,</span> <span class="pre">start_point,</span> <span class="pre">coord_sys=None)</span></code></dt><dd><p>ベクトル場が満たす積分曲線を常微分方程式の形で返す。各引数の意味は級数版と同じ。</p>
<ul class="simple">
<li><p>戻り値は二要素 <code class="docutils literal notranslate"><span class="pre">tuple</span></code> オブジェクトである。</p>
<ul>
<li><p>[0]: 各座標成分で積分曲線の微分方程式オブジェクトからなる <code class="docutils literal notranslate"><span class="pre">list</span></code> オブジェクト。</p></li>
<li><p>[1]: それらに対応する、初期条件オブジェクトからなる <code class="docutils literal notranslate"><span class="pre">list</span></code> オブジェクト。</p></li>
</ul>
</li>
</ul>
</dd>
</dl>
<p>例を示す。ユークリッド空間 <span class="math notranslate nohighlight">\(\RR^2\)</span> 上の各点で定義される次のベクトル場
<span class="math notranslate nohighlight">\(X\)</span> が生成するフロー <span class="math notranslate nohighlight">\(\fn{\gamma}{\RR^2}\RR^2\)</span> で、点 <span class="math notranslate nohighlight">\((x_0,
y_0)\)</span> を通るようなものを、上述のそれぞれの関数を用いて求める。</p>
<div class="math notranslate nohighlight">
\[X = -y \frac{\partial}{\partial x} + x \frac{\partial}{\partial y}.\]</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x0 y0 t&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">X</span> <span class="o">=</span> <span class="o">-</span><span class="n">R2</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">R2</span><span class="o">.</span><span class="n">e_x</span> <span class="o">+</span> <span class="n">R2</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">R2</span><span class="o">.</span><span class="n">e_y</span>

<span class="gp">In [3]: </span><span class="n">p0</span> <span class="o">=</span> <span class="n">R2_r</span><span class="o">.</span><span class="n">point</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">])</span>

<span class="gp">In [4]: </span><span class="n">intcurve_series</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>
<span class="gh">Out[4]:</span>
<span class="go">Matrix([</span>
<span class="go">[-t**5*y0/120 + t**4*x0/24 + t**3*y0/6 - t**2*x0/2 - t*y0 + x0],</span>
<span class="go">[ t**5*x0/120 + t**4*y0/24 - t**3*x0/6 - t**2*y0/2 + t*x0 + y0]])</span>

<span class="gp">In [5]: </span><span class="n">eq</span><span class="p">,</span> <span class="n">ini</span> <span class="o">=</span> <span class="n">intcurve_diffequ</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">eq</span>
<span class="gh">Out[6]: </span><span class="go">[f_1(t) + Derivative(f_0(t), t), -f_0(t) + Derivative(f_1(t), t)]</span>

<span class="gp">In [7]: </span><span class="n">ini</span>
<span class="gh">Out[7]: </span><span class="go">[-x0 + f_0(0), -y0 + f_1(0)]</span>
</pre></div>
</div>
<ul>
<li><p>[1]-[3] ベクトル場 <code class="docutils literal notranslate"><span class="pre">X</span></code> と多様体上の点 <code class="docutils literal notranslate"><span class="pre">p0</span></code> をセットする。</p></li>
<li><p>[4] 関数 <code class="docutils literal notranslate"><span class="pre">intcurve_series</span></code> を必要最低限の情報だけで呼び出す。戻り値には積分曲線 <span class="math notranslate nohighlight">\({\gamma(t) = (\gamma_0(t), \gamma_1(t))}\)</span> の級数展開が見える。パッと見は <span class="math notranslate nohighlight">\(\cos\)</span> と <span class="math notranslate nohighlight">\(\sin\)</span> の一次結合のようだ。</p></li>
<li><p>[5] 関数 <code class="docutils literal notranslate"><span class="pre">intcurve_diffequ</span></code> を呼び出す。戻り値は次を意味する：</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\gamma_1(t) + \diff{\gamma_0(t)}{t}  = 0\\
- \gamma_0(t) + \diff{\gamma_1(t)}{t} = 0\\
-x_0 + \gamma_0(0) = 0\\
-y_0 + \gamma_1(0) = 0\\
\end{align*}\end{split}\]</div>
<p>この常微分方程式の解曲線が積分曲線であり、具体的には次のものである：</p>
<div class="math notranslate nohighlight">
\[\gamma(t) = (\gamma_0(t), \gamma_1(t)) = (x_0 \cos t - y_0 \sin t, x_0 \sin t + y_0 \cos t).\]</div>
<p><span class="math notranslate nohighlight">\(\displaystyle X(0) = \left.\diff{\gamma(t)}{t}\right|_{t = 0} = (x_0, y_0)\)</span> が成り立つ。</p>
<div class="admonition-todo admonition" id="id14">
<p class="admonition-title">Todo</p>
<p>上の常微分方程式は簡単なので SymPy に頼らずに解を求めて書いたが、もちろん
SymPy で解きたい。</p>
</div>
</li>
</ul>
</section>
<section id="id15">
<h2><a class="toc-backref" href="#id42" role="doc-backlink">補助関数</a><a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h2>
<section id="id16">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">基底ベクトルの変換</a><a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h3>
<p>座標の変換は各種メソッドで行えるが、ベクトル場のそれは次の関数を用いる。</p>
<dl>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">vectors_in_basis(expr,</span> <span class="pre">to_sys)</span></code></dt><dd><p>式 <code class="docutils literal notranslate"><span class="pre">expr</span></code> に含まれる <code class="docutils literal notranslate"><span class="pre">BaseVectorField</span></code> オブジェクトを座標系 <code class="docutils literal notranslate"><span class="pre">to_sys</span></code> での表現に変換する。</p>
<ul class="simple">
<li><p>引数 <code class="docutils literal notranslate"><span class="pre">expr</span></code> は任意の SymPy 式。</p></li>
<li><p>引数 <code class="docutils literal notranslate"><span class="pre">to_sys</span></code> は座標変換先の <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> オブジェクト。</p></li>
<li><p>戻り値は SymPy 式。</p></li>
<li><p>基底は変換されるが、変換後の基底の係数は変換前の <code class="docutils literal notranslate"><span class="pre">CoordSystem</span></code> の
<code class="docutils literal notranslate"><span class="pre">BaseScalarField</span></code> で表現されている。</p></li>
</ul>
<p>ロジックの概要は次のとおり：</p>
<ol class="arabic simple">
<li><p>式 <code class="docutils literal notranslate"><span class="pre">expr</span></code> に含まれるすべての <code class="docutils literal notranslate"><span class="pre">BaseVectorField</span></code> オブジェクトに対して、座標値の変換メソッドで見たのと同様にヤコビアンを評価する。</p></li>
<li><p>線形代数の要領でベクトルの基底変換を行う。</p></li>
<li><p>次にそれらをメソッド <code class="code docutils literal notranslate"><span class="pre">expr.subs</span></code> で一括置換する。</p></li>
</ol>
</dd>
</dl>
<p>それほど面白い関数ではないので、サンプルコードの記載を省略する。</p>
</section>
<section id="id17">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">微分形式から行列を生成する</a><a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h3>
<p>この関数は後ほど記す関数群の実装のためにあるようだ。</p>
<dl>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">twoform_to_matrix(omega)</span></code></dt><dd><p>2-形式を表現する <code class="docutils literal notranslate"><span class="pre">omega</span></code> から次の性質を持つ行列を生成する。</p>
<div class="math notranslate nohighlight">
\begin{align*}
M_{ij} = \omega\left(\frac{\partial}{\partial x_j}, \frac{\partial}{\partial x_i}\right)
\end{align*}</div></dd>
</dl>
<p>添字の順序については、実装を正とするならばドキュメントの記述が誤りだと思う。例として、先ほどの外微分 <span class="math notranslate nohighlight">\(\dd{\omega}\)</span> がちょうど 2-形式なので、ここで試そう。</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="c1"># See [1]-[6] in section Differential Form and Exterior Derivative</span>

<span class="gp">In [2]: </span><span class="n">m</span> <span class="o">=</span> <span class="n">twoform_to_matrix</span><span class="p">(</span><span class="n">domega</span><span class="p">);</span> <span class="n">m</span>
<span class="gh">Out[2]:</span>
<span class="go">Matrix([</span>
<span class="go">[               0,  a*x*z - 2*b*x*z,   a*x*y + 6*x*y],</span>
<span class="go">[-a*x*z + 2*b*x*z,                0, b*x**2 + 3*x**2],</span>
<span class="go">[  -a*x*y - 6*x*y, -b*x**2 - 3*x**2,               0]])</span>

<span class="gp">In [3]: </span><span class="nb">all</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">domega</span><span class="o">.</span><span class="n">rcall</span><span class="p">(</span><span class="n">R3_r</span><span class="o">.</span><span class="n">base_vector</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">R3_r</span><span class="o">.</span><span class="n">base_vector</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>\
<span class="gp">   ...: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gh">Out[3]: </span><span class="go">True</span>
</pre></div>
</div>
<ul class="simple">
<li><p>[2] 関数 <code class="docutils literal notranslate"><span class="pre">twoform_to_matrix</span></code> を呼び出す。対角成分がゼロの三次交代行列が返るが、これは wedge 積の性質による。</p></li>
<li><p>[3] この行列からは先ほどの <span class="math notranslate nohighlight">\(\dd{\omega}\)</span> の各基底 2-form の係数が得られるようだ。</p></li>
</ul>
</section>
</section>
<section id="id18">
<h2><a class="toc-backref" href="#id45" role="doc-backlink">計量テンソル</a><a class="headerlink" href="#id18" title="Permalink to this heading">¶</a></h2>
<section id="christoffel">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">Christoffel 記号</a><a class="headerlink" href="#christoffel" title="Permalink to this heading">¶</a></h3>
<p>第一種と第二種の Christoffel 記号を求める関数がそれぞれ存在する。ただし、どちらも戻り値の型が記号の概念そのものではなく、和をとる対象の数式を入れ子の <code class="docutils literal notranslate"><span class="pre">tuple</span></code>
オブジェクトとして表現するようだ。テンソルが関係するので入れ子が多用される。</p>
<dl>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">metric_to_Christoffel_1st(expr)</span></code></dt><dd><p>計量テンソル <code class="docutils literal notranslate"><span class="pre">expr</span></code> から第一種 Christoffel 記号
<span class="math notranslate nohighlight">\(\varGamma_{c a b}\)</span> を求める。</p>
<ul class="simple">
<li><p>引数 <code class="docutils literal notranslate"><span class="pre">expr</span></code> は、これから基本計量テンソルを得られる、何らかの
<code class="docutils literal notranslate"><span class="pre">TensorProduct</span></code> オブジェクトの式でなければならない。この関数の実装に
<code class="docutils literal notranslate"><span class="pre">twoform_to_matrix``を利用しており、これが生成する行列が対称行列となるよう</span>
<span class="pre">な</span> <span class="pre">``expr</span></code> を与えなければならない。</p></li>
<li><p>戻り値は第一種 Christoffel 記号の、いわばシグマ記号の中身。</p></li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">metric_to_Christoffel_2nd(expr)</span></code></dt><dd><p>計量テンソル <code class="docutils literal notranslate"><span class="pre">expr</span></code> から第二種 Christoffel 記号 <span class="math notranslate nohighlight">\(\varGamma_{ij}^k\)</span> を求める。</p>
<ul class="simple">
<li><p>引数と戻り値の型の意味は上述の関数と同じ。</p></li>
<li><p>この関数の実装に <code class="docutils literal notranslate"><span class="pre">twoform_to_matrix</span></code> と、当然ながら関数
<code class="docutils literal notranslate"><span class="pre">metric_to_Christoffel_1st</span></code> を用いている。</p></li>
</ul>
<p>第二種の記号が曲面の第一基本形式の E, F, G と関係があるので、私はいつか利用するかもしれない。</p>
</dd>
</dl>
</section>
<section id="riemman-christoffel">
<h3><a class="toc-backref" href="#id47" role="doc-backlink">Riemman-Christoffel 曲率テンソル</a><a class="headerlink" href="#riemman-christoffel" title="Permalink to this heading">¶</a></h3>
<dl>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">metric_to_Riemann_components(expr)</span></code></dt><dd><p>計量テンソル <code class="docutils literal notranslate"><span class="pre">expr</span></code> から Riemman-Christoffel 曲率テンソルを求める。</p>
<ul>
<li><p>引数の意味は関連関数のそれに準じる。</p></li>
<li><p>戻り値は、次の数式の右辺（縮約表現）を <code class="docutils literal notranslate"><span class="pre">tuple</span></code> の入れ子で表現したもの。</p>
<div class="math notranslate nohighlight">
\begin{align*}
R^\rho{}_{\sigma \mu \nu} =
\varGamma_{\sigma \nu, \mu}^\rho
- \varGamma_{\sigma \mu, \nu}^\rho
+ \varGamma_{\sigma \nu}^l \varGamma_{l \mu}^\rho
- \varGamma_{\sigma \mu}^l \varGamma_{l \nu}^\rho
\end{align*}</div></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>実装では当然ながら関数 <code class="docutils literal notranslate"><span class="pre">metric_to_Christoffel_2nd</span></code> を用いている。</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</section>
<section id="ricci">
<h3><a class="toc-backref" href="#id48" role="doc-backlink">Ricci 曲率テンソル</a><a class="headerlink" href="#ricci" title="Permalink to this heading">¶</a></h3>
<dl>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">metric_to_Ricci_components(expr)</span></code></dt><dd><p>計量テンソル <code class="docutils literal notranslate"><span class="pre">expr</span></code> から Ricci 曲率テンソルを求める。</p>
<ul>
<li><p>引数の意味は関連関数のそれに準じる。</p></li>
<li><p>戻り値は、次の数式の右辺の Riemman-Christoffel 曲率テンソルを <code class="docutils literal notranslate"><span class="pre">tuple</span></code> の入れ子で表現したもの。</p>
<div class="math notranslate nohighlight">
\begin{align*}
R_{ij} = R^k {}_{i k j}
\end{align*}</div></li>
<li><p>実装では当然ながら関数 <code class="docutils literal notranslate"><span class="pre">metric_to_Riemann_components</span></code> を用いている。</p></li>
</ul>
</dd>
</dl>
</section>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="pde.html" title="Previous document">偏微分方程式</a>
        </li>
        <li>
          <a href="printing.html" title="Next document">出力</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">読書ノート</a></h1>



<p class="blurb">個人的な読書、学習、研究ノート。</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mathseminar72.html">数学 100 の発見 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gamma95/index.html">オブジェクト指向における再利用のためのデザインパターン改訂版 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hunt00/index.html">達人プログラマー 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sutter00.html">Exceptional C++ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alexandrescu01/index.html">Modern C++ Design 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meyers01.html">Effective STL 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sutter02.html">More Exceptional C++ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../joel04/index.html">Joel on Software 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graham04.html">ハッカーと画家 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../angel05/index.html">OpenGL: A Primer Second Edition 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yamamoto05/index.html">入門 xyzzy 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../newham05/index.html">入門 bash 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsuboi05/index.html">幾何学 I 多様体入門 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../subramaniam06.html">アジャイルプラクティス 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../asaoka06.html">SE・製造技術者・理工系学生のための技術文書の作り方・書き方 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../levin06/index.html">Shaping Functions 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsuboi08/index.html">幾何学 III 微分形式 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loeliger09.html">実用 Git 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../griffiths10.html">プログラミング C# 第 6 版 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onodera10.html">ORACLE MASTER Bronze 11g SQL 基礎 I 必修教本 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hosoda10/index.html">Python 入門［２＆３対応］読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nishiyama12/index.html">幾何学と不変量 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../omg15/index.html">Unified Modeling Language 2.5 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gorelick14.html">ハイパフォーマンス Python 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stroustrup14.html">C++ のエッセンス 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stepanov15.html">その数式、プログラムできますか？ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../khronos15/index.html">WebGL Specification 1.0 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vivo15/index.html">The Book of Shaders 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saha16.html">Python からはじめる数学入門 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slatkin16.html">Effective Python 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guntheroth16.html">Optimized C++ 下読みノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speinellis17.html">Effective Debugging 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bancila18.html">Modern C++ チャレンジ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../haverbeke18/index.html">Eloquent JavaScript 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../khronos18/index.html">OpenGL Shading Language 4.60 Specification 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kantor22/index.html">The Modern JavaScript Tutorial 読書ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2014.html">ノート準備中書籍群 2014 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2015.html">ノート準備中書籍群 2015 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2016.html">ノート準備中書籍群 2016 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2017.html">ノート準備中書籍群 2017 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2018.html">ノート準備中書籍群 2018 年編</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bash-v2.html">What’s New In Bash 2 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash-v3.html">What’s New In Bash 3 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash-v4.html">What’s New In Bash 4 ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cpp11/index.html">What’s New In C++11 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp14/index.html">What’s New In C++14 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp17/index.html">What’s New In C++17 ノート</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../python-3.0.html">What’s New In Python 3.0 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.1.html">What’s New In Python 3.1 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.2.html">What’s New In Python 3.2 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.3.html">What’s New In Python 3.3 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.4.html">What’s New In Python 3.4 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.5.html">What’s New In Python 3.5 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.6.html">What’s New In Python 3.6 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.7.html">What’s New In Python 3.7 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.8.html">What’s New In Python 3.8 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.9.html">What’s New In Python 3.9 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.10.html">What’s New In Python 3.10 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pip.html">pip 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pylint.html">Pylint 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-docutils/index.html">Docutils 解読ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-restview.html">Restview 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-nose.html">Nose 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-ipython.html">IPython 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-jupyter.html">Jupyter 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-numpy/index.html">NumPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-scipy/index.html">SciPy 利用ノート</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">SymPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-apgl.html">Another Python Graph Library (APGL) 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pil.html">PIL 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pillow.html">Pillow 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-matplotlib/index.html">Matplotlib 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-networkx/index.html">NetworkX 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-quaternion.html">Quaternion 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-jinja2.html">Jinja2 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pygments.html">Pygments 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-bs4.html">BeautifulSoup4 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-selenium.html">Selenium 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-scrapy.html">Scrapy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-twitter/index.html">Python Twitter Tools 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-isbn-hyphenate.html">isbn-hyphenate 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyopengl/index.html">PyOpenGL 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyqt4.html">PyQt4 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyqt5.html">PyQt5 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pandas/index.html">Pandas 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pygame.html">Pygame 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pytube.html">Pytube 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-py2exe.html">Py2exe 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-upgrade.html">Python 移行ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-miniconda.html">Miniconda 利用ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../freeware.html">Windows 用フリーウェア 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../google-ime.html">Google 日本語入力利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepl-translator.html">DeepL Translator 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../winget.html">Windows Package Manager CLI 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../powertoys/index.html">Microsoft PowerToys 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows-terminal.html">Windows Terminal 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wsl.html">Windows Subsystem for Linux 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vscode/index.html">Visual Studio Code 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cygwin.html">Cygwin 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chrome.html">Chrome DevTools 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/index.html">Git 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../twitter.html">Twitter 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inkscape/index.html">Inkscape 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mathjax.html">MathJax 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript-mermaid/index.html">Mermaid 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../css-selector.html">CSS セレクター学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xpath.html">XPath 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hxutils.html">HTML-XML-utils 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webgl.html">WebGL 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandoc.html">Pandoc 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoom.html">Zoom Cloud Meetings 利用ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../milestone09/index.html">ラジルギノア プレイノート</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">SymPy 利用ノート</a><ul>
      <li>Previous: <a href="pde.html" title="previous chapter">偏微分方程式</a></li>
      <li>Next: <a href="printing.html" title="next chapter">出力</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2023, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>