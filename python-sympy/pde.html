
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>偏微分方程式 &#8212; 読書ノート v1.4</title>
    <link rel="stylesheet" href="../_static/prefab.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/mathjaxconf.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="next" title="微分幾何" href="diffgeom.html" />
    <link rel="prev" title="常微分方程式" href="ode.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="diffgeom.html" title="微分幾何"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="ode.html" title="常微分方程式"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">SymPy 利用ノート</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1><a class="toc-backref" href="#id9">偏微分方程式</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>モジュール <code class="docutils literal notranslate"><span class="pre">sympy.solvers.pde</span></code> が提供する、偏微分方程式を解くための機能に関する覚え書きを記す。</p>
<div class="contents topic" id="id2">
<p class="topic-title first">ノート目次</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id9">偏微分方程式</a><ul>
<li><a class="reference internal" href="#id3" id="id10">基本機能</a></li>
<li><a class="reference internal" href="#id4" id="id11">特化型ソルバー</a></li>
<li><a class="reference internal" href="#id5" id="id12">演習</a><ul>
<li><a class="reference internal" href="#id6" id="id13">線形偏微分方程式</a></li>
<li><a class="reference internal" href="#id7" id="id14">一階非線形偏微分方程式</a></li>
<li><a class="reference internal" href="#id8" id="id15">二階偏微分方程式</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>紙幅の都合上、出力を一部手で改行した。</p>
<p>本文中のすべての IPython セッション中のサンプルコードで、以下のインポートおよび出力書式設定が済んでいるものとする。</p>
<div class="code python3 last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">init_printing</span><span class="p">(</span><span class="n">pretty_print</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id10">基本機能</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>ここに記す関数は isympy シェルがデフォルトで実行するインポート <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">sympy</span> <span class="pre">import</span> <span class="pre">*</span></code> だけで利用可能だ。</p>
<dl class="docutils">
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">pde_separate(eq,</span> <span class="pre">fun,</span> <span class="pre">sep,</span> <span class="pre">strategy='mul')</span></code></dt>
<dd><p class="first">偏微分方程式に含まれる従属変数的関数を加法的または乗法的に変数分離する。</p>
<ul class="last simple">
<li>引数 <code class="code docutils literal notranslate"><span class="pre">eq</span></code> は偏微分方程式を表す Eq オブジェクト。<ul>
<li>常微分方程式のときのような単なる数式ではダメ。</li>
</ul>
</li>
<li>引数 <code class="code docutils literal notranslate"><span class="pre">fun</span></code> は <code class="code docutils literal notranslate"><span class="pre">eq</span></code> を構成する従属変数的関数を表すオブジェクト。</li>
<li>引数 <code class="code docutils literal notranslate"><span class="pre">sep</span></code> は「分離先の関数」を表すオブジェクト。独立変数の個数に見合う？だけのオブジェクトをコレクションで渡す。</li>
<li>キーワード引数 <code class="code docutils literal notranslate"><span class="pre">strategy</span></code> は分離の戦略（大げさ）を指定する。次のどちらかを選択する。<ul>
<li><code class="code docutils literal notranslate"><span class="pre">'add'</span></code>: 次に記す <code class="code docutils literal notranslate"><span class="pre">pde_separate_add</span></code> を適用する。</li>
<li><code class="code docutils literal notranslate"><span class="pre">'mul'</span></code>: 次に記す <code class="code docutils literal notranslate"><span class="pre">pde_separate_mul</span></code> を適用する。こちらがデフォルト。</li>
</ul>
</li>
<li>戻り値の情報については下記の各関数の説明を参照。</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">pde_separate_add(eq,</span> <span class="pre">fun,</span> <span class="pre">sep)</span></code></dt>
<dd><p class="first">偏微分方程式に含まれる従属変数的関数を加法的に変数分離する。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x t&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">u</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">X</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;X T&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">pde_separate_add</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">E</span><span class="o">**</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))),</span> <span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="p">[</span><span class="n">X</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">T</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">[</span><span class="n">Derivative</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">),</span> <span class="n">exp</span><span class="p">(</span><span class="n">Derivative</span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">))]</span>
</pre></div>
</div>
<ul class="last">
<li><p class="first">[4] 仮に <code class="code docutils literal notranslate"><span class="pre">u(x,</span> <span class="pre">t)</span> <span class="pre">==</span> <span class="pre">X(x)</span> <span class="pre">+</span> <span class="pre">T(t)</span></code> の形に書き直せると考える。このとき何かある定数が存在して、出力結果のリストの各項目に等しい。独立変数の個数分だけの常微分方程式を解いて、それらの和をとれば <code class="code docutils literal notranslate"><span class="pre">u(x,</span> <span class="pre">t)</span></code> が求められる。</p>
<p>ちなみにおそらく <span class="math notranslate nohighlight">\(C_1 x + t  \log C_1 + C_2\)</span> のようなものが一般解である。</p>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">pde_separate_mul(eq,</span> <span class="pre">fun,</span> <span class="pre">sep)</span></code></dt>
<dd><p class="first">偏微分方程式に含まれる従属変数的関数を乗法的に変数分離する。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">u</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;X Y&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">pde_separate_mul</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)),</span> <span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">[</span><span class="n">X</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Y</span><span class="p">(</span><span class="n">y</span><span class="p">)])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">[</span><span class="n">Derivative</span><span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">X</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">Derivative</span><span class="p">(</span><span class="n">Y</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">Y</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
</pre></div>
</div>
<ul class="last">
<li><p class="first">[4] 仮に <code class="code docutils literal notranslate"><span class="pre">u(x,</span> <span class="pre">y)</span> <span class="pre">==</span> <span class="pre">X(x)</span> <span class="pre">*</span> <span class="pre">Y(y)</span></code> の形に書き直せると考える。このとき何かある定数が存在して、出力結果のリストの各項目に等しい。常微分方程式を項目数分解いて、それらの積をとれば <code class="code docutils literal notranslate"><span class="pre">u(x,</span> <span class="pre">y)</span></code> が得られる。</p>
<p>ちなみに <span class="math notranslate nohighlight">\((C_1 e^{-C_0 x} + C_2 e^{C_0 x})(C_3 e^{-C_0 y} + C_4 e^{C_0y})\)</span>
のようなものが一般解だ。</p>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">pdsolve(eq,</span> <span class="pre">...)</span></code></dt>
<dd><p class="first">二変数関数に関する偏微分方程式を解く。</p>
<ul class="last">
<li><p class="first">引数 <code class="code docutils literal notranslate"><span class="pre">eq</span></code> は対象となる偏微分方程式。いちおう Eq オブジェクトで渡してもよいし、ゼロに等しいとみなす数式オブジェクトでもよいことになっている。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">func=None</span></code> は偏微分方程式を構成する二変数関数を指定する。ふつうは明示的に指定する必要はない。ソルバーが自動検出する。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">hint='default'</span></code> ではソルバーに微分方程式のタイプについてヒントを教える。このヒントによって方程式の解法を調整することになる。</p>
<p>以下、対応する <code class="code docutils literal notranslate"><span class="pre">dsolve</span></code> のそれと同様。</p>
<ul class="simple">
<li><code class="code docutils literal notranslate"><span class="pre">default</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">all</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">all_Integral</span></code></li>
<li><code class="code docutils literal notranslate"><span class="pre">classify_pde(eq,</span> <span class="pre">...)</span></code> が返すタイプ名</li>
</ul>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">dict=False</span></code> はソルバー関数が内々に利用するもの。このパラメーターはドキュメント化されていない。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">solvefun=None</span></code> はソルバーが返す任意関数に用いられる記号を指定する。特に指示のない場合は <code class="code docutils literal notranslate"><span class="pre">F</span></code> が採用される。</p>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">classify_pde(eq,</span> <span class="pre">...)</span></code></dt>
<dd><p class="first">偏微分方程式 <code class="code docutils literal notranslate"><span class="pre">eq</span></code> のタイプを返す。関数 <code class="code docutils literal notranslate"><span class="pre">classify_ode</span></code> の偏微分方程式バージョン。</p>
<ul class="last">
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">func=None</span></code> はソルバー関数と同じ。</p>
</li>
<li><p class="first">キーワード引数 <code class="code docutils literal notranslate"><span class="pre">dict=False</span></code> はソルバー関数が内々に利用するもの。</p>
</li>
<li><p class="first">戻り値は文字列からなる tuple オブジェクトである。内容の順序についても「先頭ほど良く速く」である。</p>
</li>
<li><p class="first">全サポート分類を保持する <code class="code docutils literal notranslate"><span class="pre">allhints</span></code> オブジェクト。偏微分方程式バージョンは 4 個しかない。実質 3 個だ。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">sympy.solvers.pde</span> <span class="k">import</span> <span class="n">allhints</span>

<span class="n">In</span> <span class="p">[</span><span class="n">t2</span><span class="p">]:</span> <span class="n">allhints</span>
<span class="n">Out</span><span class="p">[</span><span class="n">t2</span><span class="p">]:</span>
<span class="p">(</span><span class="s1">&#39;1st_linear_constant_coeff_homogeneous&#39;</span><span class="p">,</span>
 <span class="s1">&#39;1st_linear_constant_coeff&#39;</span><span class="p">,</span>
 <span class="s1">&#39;1st_linear_constant_coeff_Integral&#39;</span><span class="p">,</span>
 <span class="s1">&#39;1st_linear_variable_coeff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd>
<dt>関数 <code class="code docutils literal notranslate"><span class="pre">checkpdesol(pde,</span> <span class="pre">sol,</span> <span class="pre">...)</span></code></dt>
<dd><p class="first">これは微分方程式の解を求めた後に、それを検算するのに用いる。関数 <code class="code docutils literal notranslate"><span class="pre">checkodesol</span></code> の偏微分方程式バージョン。</p>
<ul class="last simple">
<li>もし解が既知の微分方程式を評価して False が戻ってくるようならば、それはおそらく <code class="code docutils literal notranslate"><span class="pre">doit()</span></code> が式をゼロに簡単化することが不能なためと思われる。</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id11">特化型ソルバー</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>ここからはモジュール <code class="docutils literal notranslate"><span class="pre">sympy.solvers.pde</span></code> からの明示的なインポートを必要とする機能を記す。</p>
<p>次の表はすべてのソルバー名と対応する偏微分方程式の形式だ。サポートしている偏微分方程式は一階線形タイプのみのようだ。</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="38%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ソルバー</th>
<th class="head">偏微分方程式</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="code docutils literal notranslate"><span class="pre">pde_1st_linear_constant_coeff</span></code></td>
<td><span class="math notranslate nohighlight">\(a \frac{\partial f(x, y)}{\partial x} + b \frac{\partial f(x, y)}{\partial y} + c f(x, y) = G(x, y)\)</span></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal notranslate"><span class="pre">pde_1st_linear_constant_coeff_homogeneous</span></code></td>
<td><span class="math notranslate nohighlight">\(a \frac{\partial f(x, y)}{\partial x} + b \frac{\partial f(x, y)}{\partial y} + c f(x, y) = 0\)</span></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal notranslate"><span class="pre">pde_1st_linear_variable_coeff</span></code></td>
<td><span class="math notranslate nohighlight">\(a(x, y) \frac{\partial f(x, y)}{\partial x} + b(x, y) \frac{\partial f(x, y)}{\partial y} + c(x, y) f(x, y) = G(x, y)\)</span></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id12">演習</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>ここに出てくる微分方程式は次の文書から拝借した。</p>
<ul class="simple">
<li><a class="reference external" href="http://reference.wolfram.com/language/tutorial/DSolveOverview.html">DSolveで解く微分方程式</a></li>
</ul>
<p>以降のコードでは次の前処理を済ませている。</p>
<div class="code python3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;a b c x y&#39;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id13">線形偏微分方程式</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>ここでは線形偏微分方程式を解く様子をひたすら例示する。</p>
<p>定数係数同次一階線形偏微分方程式の例を示す。指数が汚いようだ。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">q</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;1st_linear_constant_coeff_homogeneous&#39;</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">pdsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">13</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mi">13</span><span class="p">))</span>
</pre></div>
</div>
<p>輸送方程式の例を示す。一般解に指数関数が出てこない。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;1st_linear_constant_coeff_homogeneous&#39;</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">pdsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
<p>非同次一階線形偏微分方程式の例を示す。指数が汚いのはソルバーのクセのようなものか。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="mi">7</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">q</span> <span class="o">+</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;1st_linear_constant_coeff&#39;</span><span class="p">,</span> <span class="s1">&#39;1st_linear_constant_coeff_Integral&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">pdsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">7</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">58</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mi">58</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>変数係数同次線形偏微分方程式の例を示す。これは残念ながら解けない。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">p</span> <span class="o">+</span> <span class="n">E</span><span class="o">**</span><span class="n">q</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">()</span>
</pre></div>
</div>
<p>変数係数非同次線形偏微分方程式の例を示す。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">(</span><span class="s1">&#39;1st_linear_variable_coeff&#39;</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">pdsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">Eq</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<p>一階準線形偏微分方程式の例を示す。これは残念ながら解けない。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">()</span>
</pre></div>
</div>
<p>非粘性 Burgers 方程式の例を示す。これは残念ながら解けない。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">eq</span> <span class="o">=</span> <span class="n">Eq</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">z</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id14">一階非線形偏微分方程式</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>現在、SymPy のソルバーは一階非線形偏微分方程式に対応していない。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="c1"># simple (envelop 1)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="c1"># simple (envelop 2)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="c1"># Eikonal</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span> <span class="c1"># Clairaut</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">))</span> <span class="c1"># separable</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">p</span> <span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># missing independent variables</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="c1"># reducible to f(x, y) == 0 by X = log(x), Y = log(y)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">((</span><span class="n">y</span><span class="o">*</span><span class="n">p</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">q</span><span class="p">),</span> <span class="n">b</span><span class="p">))</span> <span class="c1"># solvable by polar coordinates transform</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="n">q</span> <span class="o">-</span> <span class="n">z</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1"># solvable by Legendre transform</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="o">*</span><span class="n">x</span><span class="p">))</span> <span class="c1"># implicit form</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id15">二階偏微分方程式</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>先ほど記したように、SymPy のソルバーは二階偏微分方程式には対応していない。
Laplace 方程式のもっとも簡単な形のものを試してみよう。</p>
<div class="code ipython highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
<span class="o">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">13</span><span class="o">-</span><span class="n">d4ae5395f9e0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">Eq</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">pde</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">classify_pde</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="mi">277</span>
    <span class="mi">278</span>     <span class="k">if</span> <span class="n">prep</span> <span class="ow">or</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="o">--&gt;</span> <span class="mi">279</span>         <span class="n">prep</span><span class="p">,</span> <span class="n">func_</span> <span class="o">=</span> <span class="n">_preprocess</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
    <span class="mi">280</span>         <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="mi">281</span>             <span class="n">func</span> <span class="o">=</span> <span class="n">func_</span>

<span class="n">D</span><span class="p">:</span>\<span class="n">home</span>\<span class="n">yojyo</span>\<span class="n">devel</span>\<span class="n">sympy</span>\<span class="n">sympy</span>\<span class="n">solvers</span>\<span class="n">deutils</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_preprocess</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">hint</span><span class="p">)</span>
     <span class="mi">75</span>         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">funcs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
     <span class="mi">76</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The function cannot be &#39;</span>
<span class="o">---&gt;</span> <span class="mi">77</span>                 <span class="s1">&#39;automatically detected for </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">expr</span><span class="p">)</span>
     <span class="mi">78</span>         <span class="n">func</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
     <span class="mi">79</span>     <span class="n">fvars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

<span class="ne">ValueError</span><span class="p">:</span> <span class="n">The</span> <span class="n">function</span> <span class="n">cannot</span> <span class="n">be</span> <span class="n">automatically</span> <span class="n">detected</span> <span class="k">for</span> <span class="kc">True</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="diffgeom.html" title="微分幾何"
             >next</a></li>
        <li class="right" >
          <a href="ode.html" title="常微分方程式"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">読書ノート</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >SymPy 利用ノート</a> &#187;</li> 
      </ul>
    </div>
    <div id="footer">
      <div id="footer_logo">
        <a class="imga" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png" width="88" height="31" /></a>
      </div>
      <div id="footer_copyright">
        Since 1999<br />
        Copyright &copy; 1999-2018, プレハブ小屋 All rights reserved.
      </div>
    </div>
  </body>
</html>