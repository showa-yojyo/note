<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The Secret Life of Objects &#8212; 読書ノート 1.5dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/mermaid.js"></script>
    <link rel="next" title="Project: A Robot" href="chapter07.html" />
    <link rel="prev" title="Higher-Order Functions" href="chapter05.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="chapter05.html" title="Previous document">Higher-Order Functions</a>
        </li>
        <li>
          <a href="chapter07.html" title="Next document">Project: A Robot</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="the-secret-life-of-objects">
<h1><a class="toc-backref" href="#id2" role="doc-backlink">The Secret Life of Objects</a><a class="headerlink" href="#the-secret-life-of-objects" title="Permalink to this heading">¶</a></h1>
<p><a class="reference external" href="https://eloquentjavascript.net/">Eloquent JavaScript</a> Chapter 6 の読書ノート。</p>
<p>本章では JavaScript 流オブジェクト指向プログラミングの様式を見ていく。C++ や
Python との考え方の違いに注目するといいかもしれない。私がモダンな Java を知っていたらとよかったのだが。</p>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#the-secret-life-of-objects" id="id2">The Secret Life of Objects</a></p>
<ul>
<li><p><a class="reference internal" href="#encapsulation" id="id3">Encapsulation</a></p></li>
<li><p><a class="reference internal" href="#methods" id="id4">Methods</a></p></li>
<li><p><a class="reference internal" href="#prototype" id="id5">Prototype</a></p></li>
<li><p><a class="reference internal" href="#classes" id="id6">Classes</a></p></li>
<li><p><a class="reference internal" href="#class-notation" id="id7">Class notation</a></p></li>
<li><p><a class="reference internal" href="#overriding-derived-properties" id="id8">Overriding derived properties</a></p></li>
<li><p><a class="reference internal" href="#map" id="id9">Map</a></p></li>
<li><p><a class="reference internal" href="#polymorphism" id="id10">Polymorphism</a></p></li>
<li><p><a class="reference internal" href="#symbols" id="id11">Symbols</a></p></li>
<li><p><a class="reference internal" href="#the-iterator-interface" id="id12">The iterator interface</a></p></li>
<li><p><a class="reference internal" href="#getters-setters-and-statics" id="id13">Getters, setters, and statics</a></p></li>
<li><p><a class="reference internal" href="#inheritance" id="id14">Inheritance</a></p></li>
<li><p><a class="reference internal" href="#the-instanceof-operator" id="id15">The instanceof operator</a></p></li>
<li><p><a class="reference internal" href="#summary" id="id16">Summary</a></p></li>
<li><p><a class="reference internal" href="#exercises" id="id17">Exercises</a></p>
<ul>
<li><p><a class="reference internal" href="#a-vector-type" id="id18">A vector type</a></p></li>
<li><p><a class="reference internal" href="#groups" id="id19">Groups</a></p></li>
<li><p><a class="reference internal" href="#iterable-groups" id="id20">Iterable groups</a></p></li>
<li><p><a class="reference internal" href="#borrowing-a-method" id="id21">Borrowing a method</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="encapsulation">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Encapsulation</a><a class="headerlink" href="#encapsulation" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>オブジェクト指向プログラミングの基本的な考え方とは、プログラムを小さな欠片に分割して、それぞれの状態を管理するというものだ。</p></li>
<li><p>このようなプログラムの断片は、オブジェクトを使ってモデル化される。そのインターフェースはメソッドとプロパティーの（クライアントに対しては限定された）集合で構成される。</p></li>
<li><p>多くの言語は、<code class="docutils literal notranslate"><span class="pre">public</span></code> と <code class="docutils literal notranslate"><span class="pre">private</span></code> のプロパティーを区別する方法を提供しているが、ミニマリスト的な方法論を採っている JavaScript では、少なくとも今のところはない。</p>
<ul>
<li><p>現在、この機能を言語に追加する作業が行われているそうだ。</p></li>
<li><p>JavaScript のプログラマーは <code class="docutils literal notranslate"><span class="pre">public</span></code>/<code class="docutils literal notranslate"><span class="pre">private</span></code> を区別するという考えを利用している。一般的に、利用可能なインターフェイスは、ドキュメントやコメントに記述されている。また、プロパティがプライベートであることを示すのに、変数名の最初の一文字を <code class="docutils literal notranslate"><span class="pre">_</span></code> とするのも一般的だ。</p>
<ul>
<li><p>ということは Python のプログラマーに近い。</p></li>
</ul>
</li>
</ul>
</li>
<li><p>インターフェースと実装を分離することは素晴らしい考えだ。この考え方をカプセル化と呼ぶ。</p></li>
</ul>
</section>
<section id="methods">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Methods</a><a class="headerlink" href="#methods" title="Permalink to this heading">¶</a></h2>
<p>メソッドは関数値を保持するプロパティーに過ぎない。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">rabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="nx">rabbit</span><span class="p">.</span><span class="nx">speak</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`The rabbit says &#39;</span><span class="si">${</span><span class="nx">line</span><span class="si">}</span><span class="sb">&#39;`</span><span class="p">);</span>
<span class="p">};</span>
<span class="nx">rabbit</span><span class="p">.</span><span class="nx">speak</span><span class="p">(</span><span class="s2">&quot;I&#39;m alive.&quot;</span><span class="p">);</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">speak</span><span class="p">(</span><span class="nx">line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`The </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="si">}</span><span class="sb"> rabbit says &#39;</span><span class="si">${</span><span class="nx">line</span><span class="si">}</span><span class="sb">&#39;`</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">whiteRabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">speak</span><span class="p">};</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hungryRabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;hungry&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">speak</span><span class="p">};</span>
<span class="nx">whiteRabbit</span><span class="p">.</span><span class="nx">speak</span><span class="p">(</span><span class="s2">&quot;Oh my ears and whiskers, how late it&#39;s getting!&quot;</span><span class="p">);</span>
<span class="nx">hungryRabbit</span><span class="p">.</span><span class="nx">speak</span><span class="p">(</span><span class="s2">&quot;I could use a carrot right now.&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>メソッドの元になる関数に対して <code class="docutils literal notranslate"><span class="pre">call</span></code> メソッドをオブジェクトを第一引数として呼び出すと、オブジェクトのメソッドの形式でそれが呼び出される：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">speak</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">hungryRabbit</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Burp!&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>キーワード <code class="docutils literal notranslate"><span class="pre">this</span></code> を次のようにして用いることもある：</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">normalize</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">));</span>
<span class="p">}</span>

<span class="nx">normalize</span><span class="p">.</span><span class="nx">call</span><span class="p">({</span><span class="nx">coords</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">],</span><span class="w"> </span><span class="nx">length</span><span class="o">:</span><span class="w"> </span><span class="mf">5</span><span class="p">});</span>
</pre></div>
</div>
<p>仮に <code class="docutils literal notranslate"><span class="pre">map</span></code> の呼び出しに対する実引数がキーワード <code class="docutils literal notranslate"><span class="pre">function</span></code> で書かれた関数だったら、このコードは動作しなかった。</p>
<ul class="simple">
<li><p>上のコードは本書から無修正で引用したものだが、この関数はベクトルの正規化になっていない。</p></li>
</ul>
</section>
<section id="prototype">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Prototype</a><a class="headerlink" href="#prototype" title="Permalink to this heading">¶</a></h2>
<p>オブジェクトのほとんどには、プロトタイプと呼ばれる、プロパティーの代替となる別のオブジェクトがある。</p>
<ul class="simple">
<li><p>オブジェクトが持っていないプロパティーが参照されると、まずはそのオブジェクトのプロトタイプが検索される。そこにもないときには、次にそのプロトタイプのプロトタイプが検索される、以下それを繰り返す、という具合だ。最後に
<code class="docutils literal notranslate"><span class="pre">Object.prototype</span></code> に到達する。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Object.getPrototypeOf</span></code> は与えられたオブジェクトのプロトタイプを返す。</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">({})</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>オブジェクトの多くは、そのプロトタイプとして <code class="docutils literal notranslate"><span class="pre">Object.prototype</span></code> を直接は持っていない。</p></li>
<li><p>関数は <code class="docutils literal notranslate"><span class="pre">Function.prototype</span></code> から派生する。</p></li>
<li><p>配列は <code class="docutils literal notranslate"><span class="pre">Array.prototype</span></code> から派生する。</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">([])</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</pre></div>
</div>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Object.create</span></code> を使用して、特定のプロトタイプを持つオブジェクトを作成することができる。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">protoRabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">speak</span><span class="p">(</span><span class="nx">line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`The </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="si">}</span><span class="sb"> rabbit says &#39;</span><span class="si">${</span><span class="nx">line</span><span class="si">}</span><span class="sb">&#39;`</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">killerRabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">protoRabbit</span><span class="p">);</span>
<span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;killer&quot;</span><span class="p">;</span>
<span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">speak</span><span class="p">(</span><span class="s2">&quot;SKREEEE!&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>オブジェクト式の <code class="docutils literal notranslate"><span class="pre">speak(line)</span></code> のようなプロパティーは、メソッドを定義するための略記法。つまり <code class="docutils literal notranslate"><span class="pre">speak:</span> <span class="pre">speak(line){</span> <span class="pre">...</span> <span class="pre">}</span></code> ということだ。</p></li>
<li><p>これは Prototype デザインパターンそのものであり、興味深い。</p></li>
</ul>
</li>
</ul>
</section>
<section id="classes">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Classes</a><a class="headerlink" href="#classes" title="Permalink to this heading">¶</a></h2>
<p>JavaScript のプロトタイプシステムは、クラスと呼ばれるオブジェクト指向の概念を、やや非公式に取り入れたものと解釈される。</p>
<ul class="simple">
<li><p>クラスは、どのようなメソッドやプロパティを持っているかなどの型と呼ばれる概念を定義する。</p></li>
<li><p>クラスに対して、どんな値のプロパティーを持つかなどを設定したものをインスタンスと呼ぶ。</p></li>
<li><p>プロトタイプは、メソッドなど、クラスのすべてのインスタンスが同じ値を持つプロパティーを定義するのに便利だ。</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">makeRabbit</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">rabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">protoRabbit</span><span class="p">);</span>
<span class="w">    </span><span class="nx">rabbit</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">type</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">rabbit</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>JavaScript はコンストラクターという考え方もサポートする。キーワード <code class="docutils literal notranslate"><span class="pre">new</span></code> を関数呼び出しの前に置くと、その関数はコンストラクターとして扱われる。正しいプロトタイプを持つオブジェクトが自動的に作成され、<code class="docutils literal notranslate"><span class="pre">return</span></code> 文はないものの、それが返される。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span><span class="w"> </span><span class="nx">Rabbit</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">type</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">speak</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`The </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="si">}</span><span class="sb"> rabbit says &#39;</span><span class="si">${</span><span class="nx">line</span><span class="si">}</span><span class="sb">&#39;`</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">weirdRabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Rabbit</span><span class="p">(</span><span class="s2">&quot;weird&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>オブジェクトを構築する際に使用されるプロトタイプオブジェクトは、コンストラクター関数の <code class="docutils literal notranslate"><span class="pre">prototype</span></code> プロパティーを取得することで確認できる。</p></li>
<li><p>コンストラクターの名前は、他の関数と簡単に区別できるように、慣習的に大文字で表記する。</p></li>
<li><p>プロトタイプがコンストラクターに関連付けられているかどうかを理解することは重要。</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">Rabbit</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">Function</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">weirdRabbit</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="class-notation">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Class notation</a><a class="headerlink" href="#class-notation" title="Permalink to this heading">¶</a></h2>
<p>前節で JavaScript のクラスは <code class="docutils literal notranslate"><span class="pre">prototype</span></code> を持つコンストラクター関数であることを見た。2015 年までは、そのように書く必要があったが、最近ではそれほど厄介ではない記法を採用している。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">Rabbit</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">type</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">speak</span><span class="p">(</span><span class="nx">line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`The </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="si">}</span><span class="sb"> rabbit says &#39;</span><span class="si">${</span><span class="nx">line</span><span class="si">}</span><span class="sb">&#39;`</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">killerRabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Rabbit</span><span class="p">(</span><span class="s2">&quot;killer&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">blackRabbit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Rabbit</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul>
<li><p>キーワード <code class="docutils literal notranslate"><span class="pre">class</span></code> はクラスの定義を開始する。</p></li>
<li><p>コンストラクターを含むメソッドの集合を一度に定義することができる。</p>
<ul class="simple">
<li><p>任意の数のメソッドを宣言の中括弧内に記述することができる。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">constructor</span></code> という名前のメソッドは特別に扱われる。前節の意味でのコンストラクター関数を提供するもので、<code class="docutils literal notranslate"><span class="pre">Rabbit</span></code> という名前にバインドされる。</p></li>
<li><p>その他の関数は、そのコンストラクターのプロトタイプにまとめられる。</p></li>
</ul>
</li>
<li><p>現在、この形式のクラス定義でプロトタイプに追加できるのは、関数を保持するプロパティであるメソッドだけとなっている。</p></li>
<li><p>関数と同様に、クラスは文の中でも式の中でも使うことができる。</p></li>
<li><p>クラス式では、クラス名を省略することが許される。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">object</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">getWord</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s2">&quot;hello&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">};</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">object</span><span class="p">.</span><span class="nx">getWord</span><span class="p">());</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="overriding-derived-properties">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Overriding derived properties</a><a class="headerlink" href="#overriding-derived-properties" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>オブジェクトにプロパティーを追加すると、それがプロトタイプに存在するかどうかに関わらず、オブジェクト自体に追加される。</p></li>
<li><p>プロトタイプに同じ名前のプロパティーが既に存在していた場合、オブジェクトのプロパティーの後ろに隠れてしまうので、これはオブジェクトに影響を与えない。</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">teeth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;small&quot;</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">teeth</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;small&quot;</span><span class="p">);</span>

<span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">teeth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;long, sharp, and bloody&quot;</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nx">killerRabbit</span><span class="p">.</span><span class="nx">teeth</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;long, sharp, and bloody&quot;</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nx">blackRabbit</span><span class="p">.</span><span class="nx">teeth</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;small&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">teeth</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;small&quot;</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>配列に対する <code class="docutils literal notranslate"><span class="pre">.toString()</span></code> はオブジェクト一般のそれとは挙動が異なる。配列に対して <code class="docutils literal notranslate"><span class="pre">.join(&quot;,&quot;)</span></code> を呼び出したのと同じような結果になる。</p></li>
</ul>
</section>
<section id="map">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Map</a><a class="headerlink" href="#map" title="Permalink to this heading">¶</a></h2>
<p>今までは Python の <code class="docutils literal notranslate"><span class="pre">dict</span></code> のようなデータ構造として次のようにしていた：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">ages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">Boris</span><span class="o">:</span><span class="w"> </span><span class="mf">39</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Liang</span><span class="o">:</span><span class="w"> </span><span class="mf">22</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Júlia</span><span class="o">:</span><span class="w"> </span><span class="mf">62</span>
<span class="p">};</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Júlia is </span><span class="si">${</span><span class="nx">ages</span><span class="p">[</span><span class="s2">&quot;Júlia&quot;</span><span class="p">]</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Is Jack&#39;s age known?&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Jack&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">ages</span><span class="p">);</span><span class="w"> </span><span class="c1">// false</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Is toString&#39;s age knew?&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;toString&quot;</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">ages</span><span class="p">);</span><span class="w"> </span><span class="c1">// true; これがまずい</span>
</pre></div>
</div>
<p>これは危ないのでクラス <code class="docutils literal notranslate"><span class="pre">Map</span></code> を利用する。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">ages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Map</span><span class="p">();</span>
<span class="nx">ages</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Boris&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">39</span><span class="p">);</span>
<span class="nx">ages</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Liang&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">22</span><span class="p">);</span>
<span class="nx">ages</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;Júlia&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">62</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Júlia is </span><span class="si">${</span><span class="nx">ages</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;Júlia&quot;</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span><span class="w"> </span><span class="c1">// Júlia is 62</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Is Jack&#39;s age known?&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">ages</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s2">&quot;Jack&quot;</span><span class="p">));</span><span class="w"> </span><span class="c1">// false</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">ages</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="s2">&quot;toString&quot;</span><span class="p">));</span><span class="w"> </span><span class="c1">// false</span>
</pre></div>
</div>
<ul>
<li><p>メソッド <code class="docutils literal notranslate"><span class="pre">set</span></code>, <code class="docutils literal notranslate"><span class="pre">get</span></code>, <code class="docutils literal notranslate"><span class="pre">has</span></code> は <code class="docutils literal notranslate"><span class="pre">Map</span></code> オブジェクトのインターフェースの一部だ。</p></li>
<li><p>何らかの理由でマップとして扱う必要がある普通のオブジェクトがある場合、
<code class="docutils literal notranslate"><span class="pre">Object.keys()</span></code> がそのオブジェクト自身のキーしか返さないことを知っていると便利だ。</p></li>
<li><p>演算子 <code class="docutils literal notranslate"><span class="pre">in</span></code> の代わりにメソッド <code class="docutils literal notranslate"><span class="pre">hasOwnProperty</span></code> を使うこともできる。これはオブジェクトのプロトタイプを無視する。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">({</span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">}.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="o">!</span><span class="p">{</span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">}.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s2">&quot;toString&quot;</span><span class="p">));</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="polymorphism">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Polymorphism</a><a class="headerlink" href="#polymorphism" title="Permalink to this heading">¶</a></h2>
<p>例えば次のように <code class="docutils literal notranslate"><span class="pre">toString()</span></code> を上書きすることができる。こういう技法をポリモーフィズムという。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`a </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">type</span><span class="si">}</span><span class="sb"> rabbit`</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>例えば <code class="docutils literal notranslate"><span class="pre">for</span></code>/<code class="docutils literal notranslate"><span class="pre">of</span></code> ループもポリモーフィズムの一種だ。データ構造が特定のインターフェイスを提供することを期待している。</p>
</section>
<section id="symbols">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Symbols</a><a class="headerlink" href="#symbols" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p>プロパティー名は通常は <code class="docutils literal notranslate"><span class="pre">String</span></code> だが <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> であることがある。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Symbol</span></code> のオブジェクトは一意的であり、同じ値を二度作ることができない。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">sym</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Symbol</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nx">sym</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">Symbol</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">));</span>

<span class="nx">Rabbit</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">sym</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">55</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nx">blackRabbit</span><span class="p">[</span><span class="nx">sym</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">55</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>次のような不思議なことができる。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">toStringSymbol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Symbol</span><span class="p">(</span><span class="s2">&quot;toString&quot;</span><span class="p">);</span>
<span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">toStringSymbol</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="si">}</span><span class="sb"> cm of blue yarn`</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">].</span><span class="nx">toString</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;1,2&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">([</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">][</span><span class="nx">toStringSymbol</span><span class="p">]()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;2 cm of blue yarn&quot;</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
<p>今の時点でこの機能に深入りするのは危険な気がする。</p>
</section>
<section id="the-iterator-interface">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">The iterator interface</a><a class="headerlink" href="#the-iterator-interface" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">for</span></code>/<code class="docutils literal notranslate"><span class="pre">of</span></code> ループに渡されるオブジェクトは、iterable であることが期待される。あるオブジェクトが iterable であるとは、それが名前が <code class="docutils literal notranslate"><span class="pre">Symbol.iterator</span></code> であるメソッドを持つことをいう。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">let</span><span class="w"> </span><span class="nx">okIterator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;OK&quot;</span><span class="p">[</span><span class="nb">Symbol</span><span class="p">.</span><span class="nx">iterator</span><span class="p">]();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">okIterator</span><span class="p">.</span><span class="nx">next</span><span class="p">());</span><span class="w"> </span><span class="c1">// → {value: &quot;O&quot;, done: false}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">okIterator</span><span class="p">.</span><span class="nx">next</span><span class="p">());</span><span class="w"> </span><span class="c1">// → {value: &quot;K&quot;, done: false}</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">okIterator</span><span class="p">.</span><span class="nx">next</span><span class="p">());</span><span class="w"> </span><span class="c1">// → {value: undefined, done: true}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>このメソッドが呼ばれると iterator なるものを返す。これが実際に反復処理を行う。これには次の結果を返すメソッド <code class="docutils literal notranslate"><span class="pre">next</span></code> を持ち、次の結果を返す。その結果とは、次の値を提供するプロパティー <code class="docutils literal notranslate"><span class="pre">value</span></code> とプロパティー <code class="docutils literal notranslate"><span class="pre">done</span></code> を持つオブジェクトだ。これ以上の結果がない場合は <code class="docutils literal notranslate"><span class="pre">true</span></code> を、それ以外の場合は <code class="docutils literal notranslate"><span class="pre">false</span></code> になるはずだ。</p></li>
<li><p>プロパティー <code class="docutils literal notranslate"><span class="pre">next</span></code>, <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">done</span></code> の名前は、<code class="docutils literal notranslate"><span class="pre">Symbol</span></code> ではなく
<code class="docutils literal notranslate"><span class="pre">String</span></code> であることに注意が要る。というより、<code class="docutils literal notranslate"><span class="pre">Symbol</span></code> なのは <code class="docutils literal notranslate"><span class="pre">iterator</span></code>
だけだ。</p></li>
</ul>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>行列の要素を反復するためのコードが少しむずかしい。</p>
<p>Iterator デザインパターンの基本に則っているコードであることは読める。</p>
</div>
</section>
<section id="getters-setters-and-statics">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Getters, setters, and statics</a><a class="headerlink" href="#getters-setters-and-statics" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Python で言う <code class="docutils literal notranslate"><span class="pre">&#64;propery</span></code> のようなメソッド機能が JavaScript でもサポートされている。</p></li>
<li><p>Python で言う <code class="docutils literal notranslate"><span class="pre">&#64;staticmethod</span></code> のような機能もサポートされている。</p></li>
</ul>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">Temperature</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">celsius</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">celsius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">celsius</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">get</span><span class="w"> </span><span class="nx">fahrenheit</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">celsius</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">1.8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">32</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">set</span><span class="w"> </span><span class="nx">fahrenheit</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">celsius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">32</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1.8</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="nx">fromFahrenheit</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Temperature</span><span class="p">((</span><span class="nx">value</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">32</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1.8</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="inheritance">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Inheritance</a><a class="headerlink" href="#inheritance" title="Permalink to this heading">¶</a></h2>
<p>JavaScript でもサブクラスを定義することができる。本書の例をそのまま引用する。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">SymmetricMatrix</span><span class="w"> </span><span class="k">extends</span><span class="w"> </span><span class="nx">Matrix</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">size</span><span class="p">,</span><span class="w"> </span><span class="nx">element</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">undefined</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">(</span><span class="nx">size</span><span class="p">,</span><span class="w"> </span><span class="nx">size</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">element</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">);</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">element</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">set</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">super</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">matrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">SymmetricMatrix</span><span class="p">(</span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">x</span><span class="si">}</span><span class="sb">,</span><span class="si">${</span><span class="nx">y</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</pre></div>
</div>
<ul class="simple">
<li><p>構文としては Java に酷似していて、キーワード <code class="docutils literal notranslate"><span class="pre">extends</span></code> を用いて基底クラスを指定し、サブクラスの定義を始める。</p></li>
<li><p>メソッドからキーワード <code class="docutils literal notranslate"><span class="pre">super</span></code> を使って、基底クラス自身のメンバーを参照する。</p>
<ul>
<li><p>Python と使われ方が異なるので注意。いきなりドットを書く。<code class="docutils literal notranslate"><span class="pre">this</span></code> ではなく
<code class="docutils literal notranslate"><span class="pre">super</span></code> という感じか。</p></li>
</ul>
</li>
<li><p>継承は、カプセル化やポリモーフィズムと並んで、オブジェクト指向の基本だ。後者の二つが素晴らしいアイデアだと一般的に評価されているのに対し、継承に対しては手ばなしに素晴らしいとは言えない。後者二つはプログラム要素間の結合の度合いを明らかに下げるが、継承はむしろ上げてしまう。</p></li>
</ul>
</section>
<section id="the-instanceof-operator">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">The instanceof operator</a><a class="headerlink" href="#the-instanceof-operator" title="Permalink to this heading">¶</a></h2>
<p>二項演算子 <code class="docutils literal notranslate"><span class="pre">instanceof</span></code> はあるオブジェクトが特定のクラスか、それの派生クラスであるかどうかをテストする。第一オペランドと第二オペランドにオブジェクトとコンストラクター関数をそれぞれ渡す。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">SymmetricMatrix</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">SymmetricMatrix</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">SymmetricMatrix</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">Matrix</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Matrix</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nx">SymmetricMatrix</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">([</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="nb">Array</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="summary">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Summary</a><a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>オブジェクトに付随するプロトタイプという概念がある。</p></li>
<li><p>単純なオブジェクトはプロトタイプとして <code class="docutils literal notranslate"><span class="pre">Object.prototype</span></code> を有する。</p></li>
<li><p>コンストラクターの</p>
<ul>
<li><p>通常は名前が大文字で始まる関数となっている。</p></li>
<li><p>コンストラクターを演算子 <code class="docutils literal notranslate"><span class="pre">new</span></code> と一緒に使用して新しいオブジェクトを作成する。</p></li>
<li><p>オブジェクトのプロトタイプは、コンストラクターのプロパティー <code class="docutils literal notranslate"><span class="pre">prototype</span></code>
で指定されたオブジェクトとなる。</p></li>
</ul>
</li>
<li><p>オブジェクトのプロパティーにアクセスするたびに、関連するメソッドを暗黙的に呼び出すという getter や setter を定義することができる。</p></li>
<li><p>静的メソッドとは、クラスのプロトタイプではなく、コンストラクターに格納されているメソッドだ。</p></li>
<li><p>演算子 <code class="docutils literal notranslate"><span class="pre">instanceof</span></code> はオブジェクトのクラスをテストする。</p></li>
<li><p>オブジェクトは、そのインターフェースを介してのみオブジェクトとアクセスできるようにすると利用させやすい。</p></li>
<li><p>複数の型が同じインターフェイスを実装することができる。インターフェイスを使用するように書かれたコードは、そのインターフェイスを備える、異なるオブジェクトを操作する方法が自動的にわかっている。この仕組みをポリモーフィズムという。</p></li>
<li><p>詳細がわずかしか違わないクラスを複数定義する場合は、継承の技法が有効だ。</p></li>
</ul>
</section>
<section id="exercises">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Exercises</a><a class="headerlink" href="#exercises" title="Permalink to this heading">¶</a></h2>
<section id="a-vector-type">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">A vector type</a><a class="headerlink" href="#a-vector-type" title="Permalink to this heading">¶</a></h3>
<p><strong>問題</strong> 二次元空間のベクトルを表現するクラス <code class="docutils literal notranslate"><span class="pre">Vec</span></code> を書け。これは数 <code class="docutils literal notranslate"><span class="pre">x</span></code>,
<code class="docutils literal notranslate"><span class="pre">y</span></code> を引数として取り、同じ名前のプロパティーに保存されるものとする。</p>
<p>次に <code class="docutils literal notranslate"><span class="pre">Vec</span></code> のプロトタイプにメソッド <code class="docutils literal notranslate"><span class="pre">plus</span></code> および <code class="docutils literal notranslate"><span class="pre">minus</span></code> を与えろ。これらは別のベクトルを引数とし、メソッド名の示唆する新しいベクトルを返す。</p>
<p>取得プロパティー <code class="docutils literal notranslate"><span class="pre">length</span></code> をプロトタイプに加えろ。ベクトルの大きさを計算してそれを返すものだ。</p>
<p><strong>解答</strong> そういえば JavaScript には演算子のオーバーロード機能はないのだろうか。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">Vec</span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">){</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">x</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">y</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">get</span><span class="w"> </span><span class="nx">length</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="mf">2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>

<span class="nx">Vec</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">plus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">other</span><span class="p">){</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Vec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">other</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">other</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">Vec</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">minus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">other</span><span class="p">){</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Vec</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">other</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">other</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="groups">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Groups</a><a class="headerlink" href="#groups" title="Permalink to this heading">¶</a></h3>
<p><strong>問題</strong> 次の仕様に従うクラス <code class="docutils literal notranslate"><span class="pre">Group</span></code> を書け。</p>
<ul class="simple">
<li><p>このクラスには標準 JavaScript にあるクラス <code class="docutils literal notranslate"><span class="pre">Set</span></code> のようにメソッド <code class="docutils literal notranslate"><span class="pre">add</span></code>,
<code class="docutils literal notranslate"><span class="pre">delete</span></code>, <code class="docutils literal notranslate"><span class="pre">has</span></code> がある。</p>
<ul>
<li><p>コンストラクターは空の <code class="docutils literal notranslate"><span class="pre">Group</span></code> を作成する。</p></li>
<li><p>メソッド <code class="docutils literal notranslate"><span class="pre">add</span></code> は引数がまだメンバーでない場合に限り、それを <code class="docutils literal notranslate"><span class="pre">Group</span></code> に追加する。</p></li>
<li><p>メソッド <code class="docutils literal notranslate"><span class="pre">delete</span></code> は引数がメンバーである場合にそれを <code class="docutils literal notranslate"><span class="pre">Group</span></code> から削除する。</p></li>
<li><p>メソッド <code class="docutils literal notranslate"><span class="pre">has</span></code> は引数が <code class="docutils literal notranslate"><span class="pre">Group</span></code> のメンバーであるかどうかを示す真偽値を返す。</p></li>
</ul>
</li>
<li><p>二つの値が同じかどうかを判断するには演算子 <code class="docutils literal notranslate"><span class="pre">===</span></code> または <code class="docutils literal notranslate"><span class="pre">indexOf</span></code> などの同等の何かを使え。</p>
<ul>
<li><p>ノート：メソッド <code class="docutils literal notranslate"><span class="pre">Array.prototype.indexOf</span></code> が暗に使う比較演算は演算子
<code class="docutils literal notranslate"><span class="pre">===</span></code> に基づく。</p></li>
</ul>
</li>
<li><p>このクラスには iterable を引数として取り、それを反復して生成されたすべての値を含む``Group`` を作成する静的メソッド <code class="docutils literal notranslate"><span class="pre">from</span></code> を実装しろ。</p></li>
</ul>
<p><strong>解答</strong> 基本型 <code class="docutils literal notranslate"><span class="pre">Array</span></code> を使って実装して構わないと解釈する。本物の集合クラスを書くのは無理がある。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">Group</span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(){</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">add</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">element</span><span class="p">)){</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="ow">delete</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">where</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="nx">where</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">){</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">where</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">has</span><span class="p">(</span><span class="nx">element</span><span class="p">){</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="kr">from</span><span class="p">(</span><span class="nx">iterable</span><span class="p">){</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Group</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">iterable</span><span class="p">){</span>
<span class="w">            </span><span class="nx">group</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">group</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="iterable-groups">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Iterable groups</a><a class="headerlink" href="#iterable-groups" title="Permalink to this heading">¶</a></h3>
<p><strong>問題</strong> 前の演習で定義したクラス <code class="docutils literal notranslate"><span class="pre">Group</span></code> を iterable にしろ。</p>
<p><code class="docutils literal notranslate"><span class="pre">Group</span></code> のメンバーを表すのに配列を使用した場合、配列に対してメソッド
<code class="docutils literal notranslate"><span class="pre">Symbol.iterator</span></code> を呼び出して作成した反復子を返すだけではいけない（それでうまくいったとしても、この演習の目的に反する）。</p>
<p>なお、反復処理中に <code class="docutils literal notranslate"><span class="pre">Group</span></code> が変更されたとき、反復子の動作がおかしくなるのは構わないとする。</p>
<p><strong>解答</strong> 学習中に飛ばした箇所なので、今泥縄でやってみる。</p>
<p>まず <code class="docutils literal notranslate"><span class="pre">Group.prototype</span></code> を次のように拡張する：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">Group</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nb">Symbol</span><span class="p">.</span><span class="nx">iterator</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">GroupIterator</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">};</span>
</pre></div>
</div>
<p>まだ <code class="docutils literal notranslate"><span class="pre">GroupIterator</span></code> を書いていないので、書く：</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span><span class="w"> </span><span class="nx">GroupIterator</span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">group</span><span class="p">){</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">group</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">next</span><span class="p">(){</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">group</span><span class="p">.</span><span class="nx">content</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">content</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="nx">done</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">};</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">i</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">i</span><span class="p">,</span>
<span class="w">            </span><span class="nx">value</span><span class="o">:</span><span class="w"> </span><span class="nx">content</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">i</span><span class="p">]</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">        </span><span class="o">++</span><span class="k">this</span><span class="p">.</span><span class="nx">i</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">done</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="borrowing-a-method">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Borrowing a method</a><a class="headerlink" href="#borrowing-a-method" title="Permalink to this heading">¶</a></h3>
<p><strong>問題</strong> この章の前半で、オブジェクトの <code class="docutils literal notranslate"><span class="pre">hasOwnProperty</span></code> は、プロトタイプのプロパティーを無視したい場合に、演算子 <code class="docutils literal notranslate"><span class="pre">in</span></code> の代わりに、より堅牢な手段として使用できることを述べた。</p>
<p>しかし、マップに <code class="docutils literal notranslate"><span class="pre">&quot;hasOwnProperty&quot;</span></code> という単語を含める必要がある場合はどうだろうか。オブジェクト自身のプロパティがメソッドの値を隠してしまうため、そのメソッドを呼び出すことができなくなる。</p>
<p><code class="docutils literal notranslate"><span class="pre">hasOwnProperty</span></code> という名前のプロパティーを持っているオブジェクトに対して、隠された <code class="docutils literal notranslate"><span class="pre">hasOwnProperty</span></code> を参照する方法はあるか。</p>
<p><strong>解答</strong> ある。<code class="docutils literal notranslate"><span class="pre">Object.prototype</span></code> と <code class="docutils literal notranslate"><span class="pre">call</span></code> を理解していることが急所の問題だ。</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">myobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">myproperty</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;my value&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">hasOwnProperty</span><span class="o">:</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="p">};</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="o">!</span><span class="nx">myobj</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;myproperty&#39;</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">myobj</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;myproperty&#39;</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">assert</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">myobj</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;hasOwnProperty&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>参考：
<a class="reference external" href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Object/hasOwnProperty">Object.prototype.hasOwnProperty() - JavaScript | MDN</a></p>
<p>以上</p>
</section>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="chapter05.html" title="Previous document">Higher-Order Functions</a>
        </li>
        <li>
          <a href="chapter07.html" title="Next document">Project: A Robot</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">読書ノート</a></h1>



<p class="blurb">個人的な読書、学習、研究ノート。</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../mathseminar72.html">数学 100 の発見 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gamma95/index.html">オブジェクト指向における再利用のためのデザインパターン改訂版 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hunt00/index.html">達人プログラマー 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sutter00.html">Exceptional C++ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../alexandrescu01/index.html">Modern C++ Design 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meyers01.html">Effective STL 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sutter02.html">More Exceptional C++ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../joel04/index.html">Joel on Software 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graham04.html">ハッカーと画家 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../angel05/index.html">OpenGL: A Primer Second Edition 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../yamamoto05/index.html">入門 xyzzy 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../newham05/index.html">入門 bash 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsuboi05/index.html">幾何学 I 多様体入門 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../subramaniam06.html">アジャイルプラクティス 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../asaoka06.html">SE・製造技術者・理工系学生のための技術文書の作り方・書き方 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../levin06/index.html">Shaping Functions 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tsuboi08/index.html">幾何学 III 微分形式 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loeliger09.html">実用 Git 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../griffiths10.html">プログラミング C# 第 6 版 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../onodera10.html">ORACLE MASTER Bronze 11g SQL 基礎 I 必修教本 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hosoda10/index.html">Python 入門［２＆３対応］読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nishiyama12/index.html">幾何学と不変量 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../omg15/index.html">Unified Modeling Language 2.5 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gorelick14.html">ハイパフォーマンス Python 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stroustrup14.html">C++ のエッセンス 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stepanov15.html">その数式、プログラムできますか？ 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../khronos15/index.html">WebGL Specification 1.0 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vivo15/index.html">The Book of Shaders 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saha16.html">Python からはじめる数学入門 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../slatkin16.html">Effective Python 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guntheroth16.html">Optimized C++ 下読みノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../speinellis17.html">Effective Debugging 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bancila18.html">Modern C++ チャレンジ 読書ノート</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Eloquent JavaScript 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../khronos18/index.html">OpenGL Shading Language 4.60 Specification 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kantor22/index.html">The Modern JavaScript Tutorial 読書ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ou23/index.html">Modern C++ Tutorial: C++ 11/14/17/20 On the Fly 読書ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2014.html">ノート準備中書籍群 2014 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2015.html">ノート準備中書籍群 2015 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2016.html">ノート準備中書籍群 2016 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2017.html">ノート準備中書籍群 2017 年編</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preliminary2018.html">ノート準備中書籍群 2018 年編</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../bash-v2.html">What’s New In Bash 2 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash-v3.html">What’s New In Bash 3 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash-v4.html">What’s New In Bash 4 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash-v5.html">What’s New In Bash 5 ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cpp11/index.html">What’s New In C++11 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp14/index.html">What’s New In C++14 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp17/index.html">What’s New In C++17 ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python-3.0.html">What’s New In Python 3.0 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.1.html">What’s New In Python 3.1 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.2.html">What’s New In Python 3.2 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.3.html">What’s New In Python 3.3 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.4.html">What’s New In Python 3.4 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.5.html">What’s New In Python 3.5 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.6.html">What’s New In Python 3.6 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.7.html">What’s New In Python 3.7 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.8.html">What’s New In Python 3.8 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.9.html">What’s New In Python 3.9 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-3.10.html">What’s New In Python 3.10 ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pip.html">pip 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pylint.html">Pylint 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-docutils/index.html">Docutils 解読ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-restview.html">Restview 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-nose.html">Nose 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-ipython.html">IPython 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-jupyter.html">Jupyter 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-numpy/index.html">NumPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-scipy/index.html">SciPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-sympy/index.html">SymPy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-apgl.html">Another Python Graph Library (APGL) 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pil.html">PIL 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pillow.html">Pillow 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-matplotlib/index.html">Matplotlib 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-networkx/index.html">NetworkX 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-quaternion.html">Quaternion 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-jinja2.html">Jinja2 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pygments.html">Pygments 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-bs4.html">BeautifulSoup4 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-selenium.html">Selenium 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-scrapy.html">Scrapy 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-twitter/index.html">Python Twitter Tools 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-isbn-hyphenate.html">isbn-hyphenate 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyopengl/index.html">PyOpenGL 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyqt4.html">PyQt4 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pyqt5.html">PyQt5 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pandas/index.html">Pandas 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pygame.html">Pygame 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-pytube.html">Pytube 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../youtube-dl.html">youtube-dl 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-py2exe.html">Py2exe 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-upgrade.html">Python 移行ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python-miniconda.html">Miniconda 利用ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../freeware.html">Windows 用フリーウェア 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../google-ime.html">Google 日本語入力利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deepl-translator.html">DeepL Translator 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../winget.html">Windows Package Manager CLI 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../powertoys/index.html">Microsoft PowerToys 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../windows-terminal.html">Windows Terminal 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wsl.html">Windows Subsystem for Linux 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wslg.html">Windows Subsystem for Linux GUI 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vscode/index.html">Visual Studio Code 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cygwin.html">Cygwin 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chrome.html">Chrome DevTools 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../git/index.html">Git 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oh-my-posh.html">Oh My Posh 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../twitter.html">Twitter 利用ノート [obsolete]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../inkscape/index.html">Inkscape 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ffmpeg/index.html">FFmpeg 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mathjax.html">MathJax 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript-mermaid/index.html">Mermaid 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../css-selector.html">CSS セレクター学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../xpath.html">XPath 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hxutils.html">HTML-XML-utils 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../webgl.html">WebGL 学習ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandoc.html">Pandoc 利用ノート</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zoom.html">Zoom Cloud Meetings 利用ノート</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../milestone09/index.html">ラジルギノア プレイノート</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Eloquent JavaScript 読書ノート</a><ul>
      <li>Previous: <a href="chapter05.html" title="previous chapter">Higher-Order Functions</a></li>
      <li>Next: <a href="chapter07.html" title="next chapter">Project: A Robot</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../_static/logos.png"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2023, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>