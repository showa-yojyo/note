======================================================================
Writer Guide Chapter 10, Working with Templates ノート
======================================================================

.. include:: ./abbrev.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

雛形とは他の文書を作成する際に使用するモデル文書のことだ。例えば、最初のページに
会社のロゴが入った業務報告書用の雛形を作成することが可能だ。この雛形から作成され
た新規文書はすべて、最初のページに会社のロゴが入る。

雛形にはテキスト、画像、スタイルの集合、測定単位、言語、既定の印刷機、ツールバー
やメニューのカスタマイズなどの使用者固有の構成情報など、通常の文書が含むことがで
きるあらゆるものを含めることが可能だ。

LibreOffice の文書はすべて雛形に基づいている。雛形はいくつでも作成したり、ダウン
ロードしてインストールすることができ、文書の種類（テキスト、スプレッドシート、図
面、説明会）ごとに既定の雛形を設定できる。新しい Writer 文書を開始するときに雛形
を選択しなかった場合、それでもその文書はテキスト文書用の既定雛形に基づいて作成さ
れる。既定の雛形を指定しなかった場合、Writer は LibreOffice にインストールされて
いるテキスト文書用の組み込みの空白雛形を使用する。:ref:`writer10-anchorA` を見ろ。

Writer は通常の文書だけでなく、マスター文書の雛形もサポートしている。マスター
文書については |Chapter16| を見ろ。

この章では LibreOffice の雛形管理機能について説明する。雛形は他の方法でも管理お
よび使用できるが、その効果は少し異なる。詳しくは :ref:`writer10-anchorB` を見ろ。

.. _writer10-anchorH:

Creating a document from a template
======================================================================

LibreOffice の新規インストールには雛形があまり含まれていないことがあるが、

* 自分で作成したり (:ref:`writer10-anchorC`)
* 他のソースから入手した雛形をインストールしたり (:ref:`writer10-anchorD`)

できる。

雛形から文書を作成する手順：

#. 次のいずれかの方法で :guilabel:`Templates` ダイアログボックスを開く：

   * メニューの :menuselection:`&File --> &New --> Te&mplates...` または
     :menuselection:`&File --> Te&mplates --> &Manage Templates...` を選択
   * キーバインド :kbd:`Ctrl` + :kbd:`Shift` + :kbd:`N`
   * :guilabel:`Standard` ツールバーの :guilabel:`New` 図像の横にある矢印をク
     リックし、:guilabel:`Te&mplates...` を選択
   * Start Center [#writer10-footnote-center]_ で :menuselection:`&File -->
     &Templates --> &Manage Templates...` を選択
#. :guilabel:`Template` ダイアログボックスの上部にある :guilabel:`Filter` 一覧
   で、使用したい雛形の種類と区分を選択できる。関連する雛形がダイアログボックス
   に一覧される。区分一覧の右側にある図像をクリックすると、サムネイル表示と一覧
   表示を切り替えることができる。
#. 必要な雛形を見つけてダブルクリックするか、雛形を選択して
   :menuselection:`&Open` を選択する。選択した雛形に基づく新しい文書が Writer で
   開く。その後、新しい文書を編集して保存できる。

文書の基となる雛形は :menuselection:`&File --> Propert&ies...` で開くダイアログ
ボックスの :guilabel:`General` ページに記載されている。

.. tip::

   Start Center で :guilabel:`&Templates` ボタンを押すか、ドロップダウンメニュー
   を開いて雛形の種類を選択すると、:guilabel:`Templates` ダイアログボックスを開
   かずに利用可能な雛形が表示される。必要な雛形をクリックして、新しい文書を作成
   する。

.. note::

   雛形が変更され、雛形に合わせて文書を更新しない限り、雛形と文書の接続は維持さ
   れる。

   その雛形のコピーがインストールされていない別の計算機に文書をコピーまたは移動
   した場合、文書の性質にその雛形が表示され続けていても、接続は切断される。雛形
   を文書に再接続する方法については :ref:`writer10-anchorE` を見ろ。

.. _writer10-anchorC:

Creating a template
======================================================================

雛形を作成するには、文書を雛形として保存する方法と、ウィザードを使用する方法があ
る。

Creating a template from a document
----------------------------------------------------------------------

書式設定だけでなく、文書に追加したり変更したりできるあらゆる設定を雛形内に保存で
きる。例えば、印刷機の設定、パスや色など |Options| から設定する一般的な動作、
|Chapter20| で説明するメニューやツールバーのカスタマイズなどだ。

雛形にはテキストを含めることもできるので、文書を新規作成するたびにテキストを入力
する手間が省ける。例えば、手紙の雛形には、著者の名前、住所、挨拶を入れることがで
きる。

文書から雛形を作成する手順：

#. 新規または既存の Writer 文書を開く。
#. 新規雛形から作成する文書に表示させたい内容、たとえば会社のロゴや著作権声明
   などを追加する。
#. 新規雛形で使用したいスタイルを作成または変更する。
#. メニューで :menuselection:`&File --> Te&mplates --> &Save as Template...` を
   選択する。:guilabel:`Save As Template` ダイアログボックスが開き、既存の雛形区
   分と新規雛形に対する名前入力欄が表示される。
#. :guilabel:`My Templates` や :guilabel:`Business Correspondence` など、区分を
   選択する。この時、この雛形を既定雛形として設定することもできる。
#. :guilabel:`&Save` を押す。

Creating a template using a wizard
----------------------------------------------------------------------

ウィザードを使用して、手紙、ファックス、議事録の雛形を作成できる。ウィザードを使
用して雛形を作成する手順：

#. メニュー :menuselection:`&File --> &Wizards -->` から必要なテンプレートを選択
   する。
#. ウィザードのページの指示に従え。この過程は雛形の型によって若干異なるが、形式
   は似ている。
#. ウィザードの最後の部分では、:guilabel:`Templates` ダイアログボックスに表示さ
   れる雛形名と、雛形を保存するファイル名と保存場所を指定する。既定の保存場所は
   使用者雛形フォルダーだが、別の場所を選択することもできる。
#. ファイル名を設定したり、フォルダを変更するには :guilabel:`Path` ボタン（場所
   の右にある三つの点）を押す。:guilabel:`名前を付けて保存` ダイアログボックスで
   選択し、:guilabel:`保存 (&S)` を押してウィザードに戻る。
#. 最後に、雛形から新しい文書をすぐに作成するか、雛形を手動で変更するかを選択す
   る。:guilabel:`&Finish` を押して雛形を保存する。

.. _writer10-anchorD:

Adding templates obtained from other sources
======================================================================

雛形のソースを保管庫と呼ぶ。保管庫は二つに分類される：

ローカル
   雛形をダウンロードした計算機内のディレクトリー
リモート
   雛形をダウンロードできる URL

LibreOffice 公式雛形保管庫を開くには、

* Web ブラウザーで <https://extensions.libreoffice.org/> にアクセスする
* :guilabel:`Extensions` ダイアログボックスの :guilabel:`Get more extensions
  online...` リンクをクリックする。|Chapter20| 参照。

Extensions Web ページ 左側の列の :guilabel:`Add tag filters` で
:guilabel:`Templates` と :guilabel:`Writer` を選択する。Web ページが更新される。

または、:guilabel:`What are you looking for?` 欄にキーワードを入力し、
:guilabel:`Search` をクリックする。検索結果から必要な雛形を見つけ、その名前をク
リックすると詳細ページが表示される。下記の :ref:`writer10-anchorF` に進め。

または、:guilabel:`Templates` ダイアログボックスの右上にあるドロップダウンメ
ニューから :menuselection:`&Manage --> E&xtensions` を選択すると、
:guilabel:`Extensions: Templates` ダイアログボックスが開く。ここでは拡張機能の一
覧をスクロールしたり、ダイアログボックス上部のボックスに検索語を入力して一覧を絞
り込むことができる。

他の Web サイトでは .OXT ファイルにパッケージ化された雛形集を見つけることがある。

.. _writer10-anchorF:

Installing templates
----------------------------------------------------------------------

:guilabel:`Templates` ダイアログボックスまたは :guilabel:`Extensions` ダイアログ
ボックスのいずれかを使用して雛形をインストールできる。

:guilabel:`Templates` ダイアログボックスを使用して雛形をインストールする手順：

#. 雛形またはパッケージをダウンロードし、コンピュータの任意の場所に保存する。
#. :guilabel:`Templates` ダイアログボックスで、右上のドロップダウンメニューから
   :menuselection:`&Manage --> Import` を選択。
#. :guilabel:`Select Category` ダイアログボックスで、雛形をインポートする区分を
   選択し、:guilabel:`&OK` を押す。
#. インポートしたい雛形を探して選択し、:guilabel:`開く (&O)` を押す。ファイルダ
   イアログボックスが閉じ、雛形がインポートされ、選択した区分に表示される。

:guilabel:`Extensions` ダイアログボックスを使って雛形をインストールする手順：

#. 雛形またはパッケージをダウンロードし、コンピュータの任意の場所に保存する。
#. LibreOffice でメニューから :menuselection:`&Tools --> &Extensions...` を選択
   する。:guilabel:`Extensions` ダイアログボックスで :guilabel:`&Add` を押して
   ファイルダイアログボックスを開く。
#. インストールしたい雛形または雛形パッケージを検索して選択し、:guilabel:`開く
   (&O)` を押す。パッケージのインストールが始まる。
#. パッケージのインストールが完了したら LibreOffice を再起動する。雛形は
   :guilabel:`Templates` ダイアログボックスから使用でき、拡張機能は
   :guilabel:`Extensions` ダイアログボックスに表示される。

:guilabel:`Extensions` ダイアログボックスの情報は |Chapter20| を見ろ。

.. tip::

   新しい雛形を雛形フォルダーに手動でコピーすることができる。場所は OS によって
   異なる。雛形フォルダーが計算機のどこに保存されているかについては、|Options|
   :menuselection:`LibreOffice --> Paths` ページを当たれ。他の場所に新しい雛形
   フォルダーを追加することも可能。詳細については |Guide| を読め。

Editing a template
======================================================================

LibreOffice 組み込みの雛形を編集することは不可能だ。可能である雛形は自分で作成ま
たはインポートしたものに限る。

雛形のスタイルと内容を編集し、その雛形から作成された文書に雛形のスタイルを必要に
応じて再適用することが可能だ。内容を再適用することは不可能だ。

雛形を編集する手順：

#. :guilabel:`Templates` ダイアログボックスを開いて編集したい雛形を探す
#. 雛形を右クリックして :menuselection:`&Edit` を選択
#. 他の文書と同じように雛形を編集（変更を保存するには上書き保存コマンド）

Updating a document from a changed template
----------------------------------------------------------------------

雛形とそのスタイルに変更を加えた場合、変更前の雛形から作成された文書を次に開くと
確認メッセージが表示される。

文書を更新するには：

#. :guilabel:`Update Styles` を選択して、雛形の変更後スタイルを文書に適用する
#. 雛形で変更したスタイルを文書に適用したくない場合は :guilabel:`Keep Old
   Styles` を選択する（ただし下記を見ろ）

.. caution::

   :guilabel:`Keep Old Styles` を選択すると :guilabel:`Properties` ダイアログ
   ボックス :guilabel:`General` タブに雛形が表示されていても、文書は雛形に接続さ
   れなくなる。文書を雛形に再接続するには次節で説明する手順を使用する。

.. _writer10-anchorE:

Changing the template assigned to a document
======================================================================

文書を別の雛形と関連付けたい場合もあるだろうし、雛形から起稿されない文書や、雛形
から切り離された文書を扱っている場合もあるだろう。

文書に割り当てられている雛形を変更したり、文書を雛形に再接続したりするには、手動
で行う方法と LibreOffice の雛形変更拡張機能を使用する方法の二つがある。

* 雛形を手動で変更または割り当て直すには、:ref:`writer10-anchorG` で説明するよう
  に、まず必要な雛形から空白の文書を新規作成する。次に、古い文書の内容を新しい文
  書にコピーする。
* Template Changer 拡張機能を使用するには、まずダウンロードしてインストール
  し、LibreOffice を再起動して有効にする必要がある。その後、文書を開き、メニュー
  の :menuselection:`&File --> Te&mplates --> &Change template (current
  document)...` を使用できる。

.. note::

   雛形の変更や更新は、スタイルで使用される書式設定にのみ影響する。中身には影響
   しない。また、ロゴ、著作権表示、著作権ページのレイアウトなど、中身を手動で更
   新する必要が生じる場合もある。

.. _writer10-anchorG:

Manually changing the template
----------------------------------------------------------------------

最良の結果を得るためには、スタイルの名前は既存ｑ文書と新しい雛形で同じであるべき
だ。そうでない場合は、古いスタイルを新しいものに置き換える必要があるかもしれな
い。スタイルの置き換えについては |Chapter02| を見ろ。

文書を別の雛形に手動で関連付けるには：

#. :guilabel:`Templates` ダイアログボックスを開いて編集したい雛形を探す。
#. この新しい文書から不要なテキストや画像を削除する。上書き保存コマンドを使用し
   て新しい文書を保存するが、開いたままにしておく。
#. 変更したい文書を開く（新しいウィンドウで開く）
#. :menuselection:`&Edit --> Select &All` を使うか :kbd:`Ctrl` + :kbd:`A` を押し
   て、古い文書のすべてを選択する。
#. :menuselection:`&Edit --> &Copy` を使うか :kbd:`Ctrl` + :kbd:`C` を押して古い
   文書の内容をクリップボードにコピーする。
#. 先ほどの新規文書をクリックする。:menuselection:`&Edit --> &Paste` を使うか
   :kbd:`Ctrl` + :kbd:`V` を押して、古い文書の内容を新規文書に貼り付ける。
#. 目次があれば更新する。
#. :menuselection:`&File --> &Save` を使用して文書を保存する。
#. 古いファイルを保存せずに閉じる。

.. caution::

   古い文書に記録（追跡）された変更はこの処理中に失われる。結果の文書には変更さ
   れたテキストのみが含まれる。

.. _writer10-anchorA:

Setting a default template
======================================================================

メニューの :menuselection:`&File --> &New --> &Text Document` を選択する
か、Start Center の :guilabel:`&Writer Document` ボタンを押して文書を作成すると、
Writer はテキスト文書用の既定雛形から文書を作成する。ただし、カスタム雛形を既定
に設定することもできる。既定は後でリセットすることもできる。

Setting a template as the default
----------------------------------------------------------------------

ページサイズや余白、フォントの選択、行間など、多くの既定設定はスタイルを使用して
変更できるが、これらの変更は作業中の文書にのみ適用される。変更をその文書型の既定
設定にするには、LibreOffice に組み込みの既定雛形を自作の雛形に置き換える必要があ
る。

:guilabel:`Templates` ダイアログボックスのどの雛形もその文書型の既定に設定できる：

#. :guilabel:`Templates` ダイアログボックスを開く
#. 既定に設定したい雛形を含む区分を開き、雛形を選択する
#. 選択した雛形を右クリックし :menuselection:`Set as Default` を選択

既定印の図像がその雛形に移る。

次回 :menuselection:`&File --> &New -->` でその型の文書を作成すると、この雛形か
ら文書が作成される。

Resetting Writer's default template as the default
----------------------------------------------------------------------

Writer の既定雛形原本を既定として有効にするには：

#. :guilabel:`Templates` ダイアログボックスを開く
#. 右上のドロップダウンメニューから :menuselection:`&Manage --> Reset De&fault
   Text Document` を選択

また、以下のように既定の雛形をリセットすることもできる：

#. :guilabel:`Templates` ダイアログボックスを開き、既定に設定した雛形を含む区分
   を開く
#. この雛形を右クリックし、:menuselection:`Reset De&fault` を選択

次回 :menuselection:`&File --> &New -->` または同等の操作で文書を作成する場合、
文書はその型の既定雛形原本から作成される。

Organizing templates
======================================================================

LibreOffice が管理できる雛形は、その雛形区分に分類されているものだけだ。ただし、
これらのフォルダーのいずれにも分類されていない雛形から文書を作成することはできる
(:ref:`writer10-anchorH`)。新しい雛形区分を作成し、それを使って雛形を整理するこ
とができる。たとえば、報告書雛形の区分と、手紙雛形の区分を作成できる。雛形をイン
ポートおよびエクスポートすることもできる。

始めるには :guilabel:`Templates` ダイアログボックスを開く。

Creating a template category
----------------------------------------------------------------------

雛形区分を作成するには：

#. ダイアログボックスの右上にある :menuselection:`&Manage --> &New Category` を
   選択
#. ポップアップダイアログボックスで、新しい区分の名前を入力し、:guilabel:`&OK`
   を押す

新しい区分が区分一覧に表示される。

Deleting a template category
----------------------------------------------------------------------

LibreOffice 組み込みの雛形区分は削除不能だ。また、:guilabel:`Extensions` ダイア
ログボックスを使用して追加した区分は、それをインストールした拡張を削除しない限
り削除不能。

ただし、自作区分は削除可能だ：

#. ダイアログボックス上部の :guilabel:`Filter` ドロップダウンリストで区分を選択
#. :menuselection:`&Manage --> &Delete Category` を選択
#. 確認メッセージボックスが表示されたら :guilabel:`&Yes` を押す

Renaming a template category
----------------------------------------------------------------------

LibreOffice 組み込みの雛形区分の名前は変更できない。名前を変更できるのは自作区分
に限る。

#. ダイアログボックス上部の :guilabel:`Filter` ドロップダウンリストで区分を選択
#. :menuselection:`&Manage --> &Rename Category` を選択
#. ポップアップダイアログボックスで名前を入力し :guilabel:`&OK` を押す

Moving a template
----------------------------------------------------------------------

雛形区分を変更するということだが、それには：

#. ダイアログボックスで対象の雛形を選択
#. 右クリックして :menuselection:`&Move` を選択
#. :guilabel:`Select Category` ダイアログボックスで移動先区分を選択（移動先の区
   分を新しく作成することも可能）
#. :guilabel:`&OK` を押す

選択した雛形が選択した区分に移動する。

Renaming a template
----------------------------------------------------------------------

LibreOffice 組み込みの雛形の名前は変更できない。名前を変更できるのは自作したかイ
ンポートした雛形に限る。

#. ダイアログボックスから対象の雛形を選択
#. 右クリックして :menuselection:`&Rename` を選択
#. ポップアップダイアログボックスで名前を入力し :guilabel:`&OK` を押す
#. :guilabel:`&OK` をクリックする。

この動作は雛形の文書性質の :guilabel:`Description` タブにある :guilabel:`Title`
を変更する。雛形のファイル名は変化しない。

Deleting a template
----------------------------------------------------------------------

LibreOffice に組み込みの雛形は削除不能だ。また、:guilabel:`Extensions` ダイアロ
グボックスを使用してインストールされた雛形も、それをインストールした拡張を削除す
る以外には削除不能だ。ただし、自作またはインポートした雛形は削除可能だ。

#. （オプション）ダイアログボックスの上部にある :guilabel:`Filter` ドロップダウ
   ンリストで、削除対象雛形を含む区分を選択
#. 削除対象雛形を選択
#. 右クリックして :menuselection:`&Delete` を選択
#. 確認メッセージボックスが表示されたら :guilabel:`&Yes` を押す

.. tip::

   :kbd:`Delete` を押すことでも選択した雛形を削除可能。

Exporting a template
----------------------------------------------------------------------

雛形を計算機内またはネットワーク上の別の場所にエクスポートする手順：

#. エクスポートしたい雛形を選択
#. 雛形を右クリックし :menuselection:`E&xport` を選択
#. 雛形をエクスポートしたい場所を探し、:guilabel:`フォルダーの選択` を押す
#. 表示された情報ダイアログボックスで :guilabel:`&OK` を押す

.. note::

   この操作によって雛形のコピーが指定した場所に置かれる。

.. _writer10-anchorB:

Other ways to manage templates
======================================================================

:guilabel:`Templates` ダイアログボックスを使わなくても、計算機のどこにある雛形で
も作成、使用することが可能だ。ただし、本章で説明するものとは異なる結果となるもの
もある。

Creating a document from a template
----------------------------------------------------------------------

Windows Explorer で雛形をダブルクリックすると、それから文書を作成できる。作成さ
れた文書は、作成元の雛形とは関連付けられない：その雛形は文書の性質に列挙されず、
雛形への変更は文書に直接適用できない。手紙を書くなど、多くの目的には、この挙動が
都合が良いことがある。

Creating a template from a document
----------------------------------------------------------------------

文書から雛形を作成するには、

#. :menuselection:`&File --> Save &As...` を選択
#. :guilabel:`ファイルの種類 (&T)` として :guilabel:`ODF Text Document (.odt)`
   を選択

作成された雛形はインポートするか |Options| の :menuselection:`LibreOffice -->
Paths` ページで雛形用に表示されている場所にプロジェクトフォルダーを追加しない限
り :guilabel:`Templates` ダイアログボックスには表示されない。

----

.. rubric:: 章末注

.. [#writer10-footnote-center] LibreOffice では文書が開かれていないときに表示さ
    れる。
