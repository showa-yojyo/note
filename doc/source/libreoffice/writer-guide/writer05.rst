======================================================================
Writer Guide Chapter 5, Formatting Pages: Basics ノート
======================================================================

.. include:: ./abbrev.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

この章はページスタイルの使い方と関連する機能について述べられている。

* 余白
* 改頁
* ヘッダーとフッター
* ページ番号
* 表題ページ
* 脚注

:doc:`Chapter 6 <writer06>` では、段組、枠、図表、節の使用、文書内のページの向き
の変更、境界と背景の使用について説明がある。ページスタイルのその他の使い方につい
ては :doc:`Chapter 8 <writer08>` に説明がある。:guilabel:`Page Style` ダイアログ
ボックスについては :doc:`Chapter 9 <writer09>` に説明がある。

.. note::

   Writer 文書のページはすべてページスタイルに基づいている。他のレイアウト方法
   (:doc:`Chapter 6 <writer06>`) は、基本的なページスタイルに基づいて構築され
   る。

.. tip::

   ページレイアウトは通常、|OptionsDlg| の |ApplicationColors| でテキスト、オブ
   ジェクト、図表、節の境界を表示するオプションを選択し、同ダイアログボックス
   :menuselection:`LibreOffice Writer --> Formatting Aids` で段落末尾、タブ、改
   行、その他の項目を表示するオプションを選択すると簡単だ。

Setting up basic page layout using styles
======================================================================

Writer では、ページスタイルが、ページサイズ、余白、ヘッダーとフッターの配置、境
界と背景、段数、ページ番号など、ページすべての基本的レイアウトを定義する。

Writer にはページスタイルがいくつか付属しており、それらを基にしたり、変更した
り、新しい（カスタム）ページスタイルを定義することができる。

* 単一文書で一つ以上のページスタイルを使用できる。
* ページスタイルを指定しない場合、Default Page Style が用いられる。

個々のページのレイアウトを変更するには、新しいページスタイルを定義するか、
:doc:`Chapter 6 <writer06>` で説明されている技法（節、枠、図表）のいずれかを用い
る。

.. note::

   文書によっては、すべてのレイアウト変更（見開きページのヘッダーやフッターの
   ページ番号やその他の要素の位置など）を単一のページスタイルで定義できるものも
   ある。

.. tip::

   Default Page Style を含むページスタイルの変更は、作業中の文書にしか適用されな
   い。変更を文書すべての既定にしたい場合は、変更をテンプレートに入れ、そのテン
   プレートを既定テンプレートにする必要がある。:doc:`Chapter 10 <writer10>` 参
   照。

Changing page margins
======================================================================

ページの余白は次の方法で変更可能：

* ページ定規を使う。素早く簡単だが、細かく制御できない。
* :guilabel:`Page Style` ダイアログボックスを使う。余白を小数点以下二桁まで指定
  できる。
* Sidebar の :guilabel:`Page` 甲板を使用する。余白すべてを同じ値に変更可能。

.. note::

   これらのいずれかの方法で余白を変更した場合、新しい余白はページスタイルに記録
   され、そのスタイルを使用しているすべてのページに影響する。新しい余白は次に
   :guilabel:`Page Style` ダイアログボックスを開いたときに表示される。

   一部のページの余白を変更し、他のページの余白を変更しないようにするには、異な
   るページスタイルを使用して、それらを切り替える必要がある。後述。

定規を使って余白を変更するには：

#. 定規の網掛け部分は余白だ。灰色の部分と白い部分の間の線にマウスポインターを置
   く。ポインターが両頭矢印に変わり、ツールチップに現在の設定が表示される。
#. マウス左ボタンを押したままドラッグして余白を移動する。

.. note::

   定規上の小さな矢印は、段落の字下げに使用する。ページの余白と同じ位置にあるこ
   とが多いので、矢印ではなく余白マーカーを動かすように注意しろ。図94に示す両頭
   矢印はマウスポインターを正しい位置に置いたものだ。

.. tip::

   変更後、新しい余白にマウスポインターを合わせると、新しい測定値が表示される。

:guilabel:`Page Style` ダイアログボックスを使って余白を変更する手順：

#. ページ上のどこでもよいから右クリック
#. :menuselection:`P&age Style...` を選択
#. ダイアログボックスの :guilabel:`Page` タブで、:guilabel:`Margins` 欄に必要な
   距離を入力する。

   あるいは、:guilabel:`&Gutter` をゼロに設定したまま、綴じ込み余白の量を左余白
   または内余白の値に追加する。綴じ込み余白とは、ページの左端（内端）と左余白
   （内余白）の間に残す余白のことだ。
#. :guilabel:`&OK`

Sidebar の :guilabel:`Page` 甲板を使って余白を変更するには、

* ドロップダウンリストからプリセットの余白を選択するか、
* :guilabel:`Format` 区画の表題バーの右上にある :guilabel:`More Options` アイコ
  ンから :guilabel:`Page Style` ダイアログボックスを開く。

.. note::

   Sidebar の余白を変更すると余白四つがすべて同じ寸法に変更される。異なるサイズ
   の余白が必要な場合は別の方法を使用しろ。

Inserting page breaks
======================================================================

多くの文書（たとえば複数ページ報告書）では、加除修正時にテキストがあるページから
次のページに流れるようにしたい。この節で説明する技法を使ってテキストフローを上書
きしない限りは、Writer が自動的にこれを行う。

Controlling automatic page breaks
----------------------------------------------------------------------

自動テキストフローの一部は、次のような方法で制御する：

* :guilabel:`&Keep with next paragraph` オプションは、たとえば、目録の先頭の文が
  目録から切り離されるのを防ぐために使用する。このオプションは
  :guilabel:`Paragraph` ダイアログボックスの :guilabel:`Text Flow` タブにある。
* :guilabel:`Paragraph` ダイアログボックスの :guilabel:`Text Flow` タブ（個々の
  段落に対して）または :guilabel:`Paragraph Style` ダイアログボックス（そのスタ
  イルを持つすべての段落に対して）の :guilabel:`&Do not split paragraph` オプ
  ションを使用する。
* 段落スタイルを使って段落を新しいページから始めるようにする。典型的な使い方は、
  章見出しがつねに新しい右ページ（奇数ページ）から始まるようにすることだ。これを
  定義するには :guilabel:`Paragraph Style` ダイアログボックスを使いる。

Inserting a page break without changing the page style
----------------------------------------------------------------------

特定の場所で改頁するには、たとえば、新しいページの一番上に見出しを置くには：

#. 新しいページを始めたい位置にキャレットを置く
#. メニュー :menuselection:`&Insert --> &Page Break` を選択

Inserting a page break and changing to a new page style
----------------------------------------------------------------------

新しいページに別のページスタイルを使用させるには、たとえば、First Page スタイル
から Left Page スタイルに変更するには、以下のいずれかの方法を使用する。

.. caution::

   改頁を挿入せずに単一ページのページスタイルを変更しようとしてはいけない。変更
   されたページの前後の他のページの一部またはすべてのページスタイルも変更される
   可能性がある。:doc:`Chapter 8 <writer08>` を見ろ。

.. rubric:: 方法一

#. 次のページを始めたい位置にキャレットを置く
#. :menuselection:`&Insert --> More &Breaks --> Manual &Break...` を選択
#. :guilabel:`Insert Break` ダイアログボックスの :guilabel:`Type` 区画で
   :guilabel:`&Page break` があらかじめ選択され、:guilabel:`Page &Style` が
   :guilabel:`[None]` に設定されている。このドロップダウンリストで次のページに対
   するページスタイルを選択する。
#. :guilabel:`&OK`

.. rubric:: 方法二

#. キャレットを次のページの最初にしたい段落に置く
#. 右クリックし、:menuselection:`P&arapgaph --> P&aragraph...` を選択
#. :guilabel:`Paragraph` ダイアログボックスの :guilabel:`Text Flow` ページ
   で、

   * :guilabel:`Breaks` 区画の :guilabel:`&Insert` をオン
   * :guilabel:`With page st&yle` をオン
#. ドロップダウンリストで次のページに対するページスタイルを選択
#. :guilabel:`&OK`

.. tip::

   これらのページ番号フィールドの使用については :ref:`writer05-anchor5` を参照。

.. _writer05-anchor1:

Creating headers and footers
======================================================================

ヘッダーとフッターは各ページの上部と下部にそれぞれ表示される部分だ。ヘッダーには
通常、ページ番号と題名などの文書情報が含まれる。

Writer ではヘッダーとフッターはページスタイルで指定する。そのため、同じページス
タイルを持つページはすべて同じヘッダーとフッターを表示するが、ヘッダー、フッター
の内容は異なる場合がある。例えば、節、章、文書の最初のページのヘッダー、フッター
は、ページスタイルが同じでも、文書内の他のヘッダーやフッターとは異なる情報を含む
ことがある。後述。

.. admonition:: 術語

   見出しとは、文書の章や節を紹介する段落のことで、例えば上記の Creating headers
   and footers のようなものだ。ヘッダー（欄外見出しとも呼ばれる）は各ページの一
   番上の余白に表示され、文書に関する情報を通常、表示する。

ヘッダーを挿入するには以下のいずれかを行う（フッターも類似の操作）：

* テキストエリアの上部をクリックする。:guilabel:`Header` マーカーが表示された
  らプラス記号をクリックする。
* メニューから :menuselection:`&Insert --> He&ader and Footer --> He&ader -->`
  からページスタイルを選択

  サブメニューには文書で使用されているページスタイルと、文書のすべてのページスタ
  イルでヘッダーを有効にする :menuselection:`&All` という項目が表示される。
* ページ上の任意の場所で右クリックし、メニューから Page Style を選択す
  る。:guilabel:`Page Style` ダイアログボックスの :guilabel:`Header` タブで
  :guilabel:`Hea&der on` をオンにする。この方法はある一つのページスタイルにしか
  影響しない。

Formatting headers and footers
----------------------------------------------------------------------

Writer ではヘッダーとフッターは段落だ。したがって、文書本文のテキストの書式設定
と同じ技法を使用して、ヘッダーまたはフッターのテキストを書式設定できる。
:doc:`Chapter 4 <writer04>` を参照しろ。また、:doc:`Chapter 11 <writer11>` で説
明されている技法のいずれかを使用して、ヘッダーとフッターに画像を追加したり、
:doc:`Chapter 6 <writer06>` で説明されているように、図表を使って情報を並べたりす
ることもできる。

.. tip::

   Writer にはヘッダーとフッター用の段落スタイルが用意されており、他の段落スタイ
   ルと同じように変更して使用することができる。:doc:`Chapter 8 <writer08>` と
   :doc:`Chapter 9 <writer09>` を見ろ。

Sidebar の :guilabel:`Page` タブを使って、余白や間隔、同じ中身を最初のページや左
右のページに配置するかどうかなど、いくつかの書式を適用することが可能だ。

さらなるオプションについては :guilabel:`Page Style` ダイアログボックスを使え。

#. :guilabel:`Page Style` ダイアログボックスを開く。以下のいずれかの方法による：

   * ページ上のどこでもいいからクリックし、メニューから :menuselection:`F&ormat
     --> &Page Style...` を選択
   * ページ上の右クリックメニューから :menuselection:`&Page Style...` を選択
   * ページにヘッダーがある場合はヘッダー領域をクリックする。:guilabel:`Header`
     マーカーが表示されたら下矢印をクリックし、:menuselection:`Format Header...`
     を選択
   * Sidebar の :guilabel:`Page` タブで、ヘッダーの表題バーの右にある
     :guilabel:`More Options` 図像をクリック
#. :guilabel:`Page Style` ダイアログボックスの :guilabel:`Header` タブで、余白、
   間隔、高さを変更
#. :guilabel:`&More...` をクリックして :guilabel:`Border/Background` ダイアログ
   ボックスを開き、ヘッダーに境界、背景色、背景画像を追加可能

Numbering pages
======================================================================

ヘッダーまたはフッターに :guilabel:`Page Number` ページ番号フィールドを置くと、
そのページスタイルのすべてのページに番号が表示され、ページごとに自動的に変更され
る。ページ番号は灰色の背景で表示される。この灰色の背景はフィールドを表すもので、
背景は画面上では視認されるが、印刷はされない。

.. tip::

   灰色の背景を消すには |View-->FieldShadings| を選ぶか :kbd:`Ctrl` + :kbd:`F8`
   を押す。数字の代わりに :guilabel:`Page number` という文字が表示されたら
   :kbd:`Ctrl` + :kbd:`F9` を押す。これにより、Writer はフィールドに対する名前と
   中身の表示を切り替える。

このトピックでは文書のヘッダーやフッターに次のような関連情報を挿入する技法につい
て述べている：

* :ref:`writer05-anchor2`
* :ref:`writer05-anchor3`
* :ref:`writer05-anchor4`
* :ref:`writer05-anchor5`
* :ref:`writer05-anchor6`

.. _writer05-anchor2:

Simple page numbering
----------------------------------------------------------------------

最も単純な場合、ページ番号を各ページの天井か床下に表示し、それ以外には何も表示し
ない。これを行うには、

* :menuselection:`&Insert --> &Page Number...` を選択するか、
* ヘッダーまたはフッターにキャレットを置き、:menuselection:`&Insert --> Fiel&d
  --> &Page Number` を選択する。

前者の方法では :guilabel:`Page Number Wizard` が開く。後者の方法ではページ番号を
直接挿入し、後で設定を調整する。

Page number wizard
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

メニューから :menuselection:`&Insert --> &Page Number...` を選択すると
:guilabel:`Page Number Wizard` が開き、

* 位置（ヘッダーまたはフッター）、
* 配置（右、中央、左）、
* 番号スタイル（ローマ数字、アラビア数字、その他の変種）、
* ページ番号に対するその他の設定

を選択できる。

:guilabel:`Page Number Wizard` を使用しない、または設定を変更する場合は、次の二
節を参照。

ページ番号の追加設定については :ref:`writer05-anchor4` と
:ref:`writer05-anchor5` を見ろ。

Page number alignment
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ページ番号を左、右、または中央に揃えるには、ヘッダーまたはフッターをクリックし、
次のいずれかの方法でフッター段落を変更する：

* :guilabel:`Formatting` ツールバーの整列図像のどれかをクリック。
* Sidebar の :guilabel:`Properties` 甲板を開く。:guilabel:`Paragraph` 区画で整列
  図像のどれかをクリック。
* 右クリックし、:menuselection:`P&aragraph --> P&aragraph...` を選択。
  :guilabel:`Paragraph` ダイアログボックスの :guilabel:`Alignment` タブで整列オ
  プションを選択し、:guilabel:`&OK` を押す。

.. _writer05-anchor3:

Page number format
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ページ番号を何種類かの数字で表示するように設定できる：

* アラビア数字 (1, 2, 3)
* 小文字ローマ数字 (i, ii, iii)
* 序数 (1st, 2nd, 3rd)
* その他

そのためには、ページ番号をダブルクリックして、:guilabel:`Edit Fields` ダイアログ
ボックスで所望の書式を選択するか、次の手順のようにページスタイルで数字の書式を指
定する：

#. ページのテキストエリアを右クリックし、コンテキストメニューから
   :menuselection:`&Page Style...` を選択
#. :guilabel:`Page Style` ダイアログボックスの :guilabel:`Page` タブで、右側の
   :guilabel:`Layout Settings `区画で、小文字ローマ数字を使用するために
   :guilabel:`Page nu&mbers` ドロップダウンリストで :guilabel:`i, ii, iii, ...`
   を選択

.. caution::

   番号の書式を変更すると、その書式を変更する方法にかかわらず、そのページスタイ
   ルを使用しているすべてのページのページ番号に影響する。すべてのページではな
   く、一部のページのページ番号の書式を変更するには、別のページスタイルを使用す
   る必要がある。:ref:`次節 <writer05-anchor5>` を見ろ。

.. _writer05-anchor4:

Restarting page numbering and changing numbering format
----------------------------------------------------------------------

書籍など、多くの文書では前見出し（目次など）にローマ数字で、本文にアラビア数字で
番号が振られ、ページ数は 1 から始まる。次はページ番号を 1 から付け直す手順だ。

まず、二つのページスタイルについて番号の書式を定義する：

* Front Matter
* Default Page Style

これらについては :ref:`writer05-anchor8` と :ref:`前節 <writer05-anchor3>` を参
照。

次に、文書の前見出しにページ番号を挿入する。:ref:`writer05-anchor2` を参照。

その後、ページ番号付けを再開する：

#. Default Page Style にするページの最初の段落にキャレットを置く（見出しは段落の
   一種だ）。
#. メニューの :menuselection:`F&ormat --> P&aragraph...` を選択するか、右クリッ
   クして :menuselection:`P&aragraph --> P&aragraph...` を選択し、
   :guilabel:`Paragraph` ダイアログボックスを表示
#. :guilabel:`Text Flow` タブの :guilabel:`Breaks` で、

   #. :guilabel:`&Insert` を選択
   #. :guilabel:`&Type` ドロップダウンリストで :guilabel:`Page` を選択
   #. :guilabel:`&Position` ドロップダウンリストで :guilabel:`Before` を選択
#. :guilabel:`With page st&yle` をオンにしてドロップダウンリストから次のページに
   対するスタイルを選択
#. :guilabel:`Page &number` をオンにしてフィールドを活性化し ``1`` を入力
#. :guilabel:`&OK` を押す

.. _writer05-anchor5:

Numbering the first page something other than 1
----------------------------------------------------------------------

ページ番号が 1 より大きい文書を開始する手順は、前節の工程 3 と同様。

#. 先述の方法でヘッダー（フッター）にページ番号を挿入
#. テキストエリアの最初の段落をクリック
#. 先述の方法で :guilabel:`Paragraph` ダイアログボックスを表示
#. :guilabel:`Text Flow` タブの :guilabel:`Breaks` で、

   #. :guilabel:`&Insert` を選択
   #. :guilabel:`&Type` ドロップダウンリストで :guilabel:`Page` を選択
   #. :guilabel:`With page st&yle` をオンにしてドロップダウンリストから最初の
      ページに使われるスタイルを選択
#. :guilabel:`Page &number` をオンにしてフィールドを活性化し、開始ページ番号を入
   力
#. :guilabel:`&OK` を押す

.. note::

   選択した開始ページ番号が偶数の場合、最初のページの前に空白ページが発生す
   る。LibreOffice では奇数ページ番号は右ページ、偶数ページ番号は左ページという
   慣例に従っている。

   この空白ページは、ファイルを印刷したり PDF として書き出したりするときに表示さ
   れる。:doc:`Chapter 7 <writer07>` 参照。

.. _writer05-anchor6:

Numbering pages by chapter
----------------------------------------------------------------------

技術文書ではヘッダーやフッターにページ番号とともに章番号を入れがちだ。たとえば、
1-1, 1-2, 1-3, ..., 2-1, 2-2, 2-3, ... といった具合だ。このようなページ番号を設
定するには次のようにする：

#. 章の表題はすべて同じ段落スタイル、例えば :guilabel:`Heading 1` スタイルで識別
   されるようにしろ。
#. :menuselection:`&Tools --> Heading &Numbering` を使って :guilabel:`&Level` 1
   に使用する段落スタイルを Writer に伝え、:guilabel:`&Number` 欄で
   :guilabel:`1, 2, 3, ...` を指定する。
#. 文書に章番号を挿入する：

   #. 先に挿入したページ番号の直前のヘッダーまたはフッターにキャレットを置き、メ
      ニューで :menuselection:`&Insert --> Fiel&d --> &More Fields...` を選択
   #. :guilabel:`Field` ダイアログボックスで :guilabel:`Document` タブに移動す
      る。

      * :guilabel:`&Type` 一覧で :guilabel:`Heading` を指定
      * :guilabel:`&Format ` 一覧で :guilabel:`Heading number` を指定
      * :guilabel:`&Up tp level` 欄で :guilabel:`1` を指定

      :guilabel:`&Insert` を押す。
   #. 章番号とページ番号の間にハイフンなどの句読点を打ち込む

Including other information in headers and footers
======================================================================

ページ番号だけでなく、他の情報をヘッダーやフッターに入れることもよくある。例えば：

* :guilabel:`Page Number` フィールドの前に Page という単語（と空白）を入力し、
  ヘッダーが Page 1, Page 2 などとなるようにする。
* :guilabel:`Page Count` フィールドと :guilabel:`Page Number` フィールドを使い、
  ヘッダーが Page 1 of 4, Page 2 of 4,などとなるようにする。
* 文書の表題や章の表題を入力するか、（よりよい方法として）フィールドとして追加す
  ることができる。そうすれば、何か変更があった場合、ヘッダーとフッターはすべて自
  動的に更新される。

フィールドについては :doc:`Chapter 17 <writer17>` で扱う。ここではある例が役に立
つ。文書の表題を Default Page Style のヘッダーに挿入するには：

#. メニューの :menuselection:`&File --> Propert&ies` を選択
#. :guilabel:`Description` タブ
#. :guilabel:`&Title` 欄に文書の表題を入力
#. :guilabel:`&OK` を押して :guilabel:`Properties` ダイアログボックスを閉じる
   クスを閉じる。
#. 上述のようにしてヘッダーを追加
#. ページのヘッダー部分にキャレットを置く
#. メニューから :menuselection:`&Insert --> Fiel&d --> T&itle` を選択

文書の表題を変更するには手順の前半を再現する。

Defining a different first page for a document
======================================================================

手紙や覚書などの文書の多くには、他のページとは異なる最初のページがある。例えば、
レターヘッドの最初のページには通常、異なるヘッダーがある。また、報告書の最初の
ページにはヘッダーもフッターもないが、他のページにはそれらがある。

これにはいくつかの方法がある：

* 文書の Default またはその他のページスタイルを使用する。:guilabel:`Page Style`
  ダイアログボックスの :guilabel:`Header` タブで :guilabel:`Same content on
  first &page` をオフにし、文書の最初のページと他のページに異なるヘッダーを追加
  する。:ref:`次節<writer05-anchor7>` 参照。
* 最初のページと後続ページで異なるページスタイルを使う。次のページが自動的に後続
  ページのスタイルになるように、最初のページに :guilabel:`Next Page` 属性を設定
  する。:ref:`writer05-anchor8` 参照。
* 文書の冒頭に表題ページを追加する。:ref:`writer05-anchor9` 参照。

いずれの方法の詳細も後述。

.. _writer05-anchor7:

Using one page style
----------------------------------------------------------------------

この例は Default Page Style を用いる。

.. admonition:: 読者ノート

   以下、ヘッダーについてしかノートを記しさないが、フッターでも当然成り立つ。

#. ページ上のどこでもいいから右クリックし、:menuselection:`&Page Style...` を選
   択する。:guilabel:`Page Style` ダイアログボックスの :guilabel:`Header` タブで
   :guilabel:`Hea&der on` をオンにし、最初のページで同じ内容の選択を解除する。オ
   プションで :guilabel:`Same co&ntent on left and right pages` を選択する。
#. Default Page Style を使用して、任意のページにヘッダーを挿入する。
   :ref:`writer05-anchor1` 参照。
#. 文書の最初のページと他のページに、異なるヘッダーの内容を追加する。例えば、最
   初のページのヘッダーは空白のままにしておく。

.. _writer05-anchor8:

Using different page styles
----------------------------------------------------------------------

例として、LibreOffice に付属している First Page と Default ページスタイルを使用
する。最初のページに既定のページを表示し、それ以降のページをすべて既定のページス
タイルにすることを検討する。

これを行うには、

#. First Page スタイルに対する :guilabel:`Page Style` ダイアログボックスを開く
#. :guilabel:`Organizer` タブ
#. :guilabel:`Ne&xt Style` ドロップダウンリストで :guilabel:`Default Page Style`
   を選択

.. _writer05-anchor9:

Adding title pages
----------------------------------------------------------------------

文書に表題ページを追加し、オプションで文書本文のページ番号を 1 から再開するため
の、迅速で便利な方法が Writer には備わっている。

メニューで :menuselection:`F&ormat --> Title Page...` を選択し、:guilabel:`Title
Page` ダイアログボックスを開く。

:guilabel:`Title Page` ダイアログボックスでは、次の選択ができる：

* 既存ページを表題ページに変換するか、新しい表題ページを挿入するか
* 変換または挿入するページ数
* ページを配置する位置
* ページ番号付けを再開するかどうか、再開する場所と開始番号
* 表題ページに使用するページスタイル

この技法を使えば、例えば、章と章の間に装飾的なページを追加したり、本の冒頭に表題
や著作権などのページを追加したりするなど、文書のさまざまな箇所に複数の「表題ペー
ジ」を挿入することが可能だ。

Formatting footnotes and endnotes
======================================================================

脚注は参照されたページの床下に表示される。巻末注は文書の最後に集められる。

既定のものが要求に合致しない場合、脚注と巻末注を効果的に機能させるには次のように
する：

* 脚注を挿入し、その書式を定義する (:doc:`Chapter 3 <writer03>`)
* ページ上の脚注の位置、および区切り線の色と線スタイルを定義する

Defining footnote location and separator line
----------------------------------------------------------------------

ページ上の脚注の位置と、脚注とテキストを区切る線の色とスタイルは、ページスタイル
で定義する。複数のページスタイルを使っていて、そのどれかに脚注がある場合は、必ず
それぞれのページスタイルで脚注の位置と区切り線を定義しろ。

メニューの :menuselection:`F&ormat --> &Page Style...` を選択するか、ページを右
クリックメニューから :menuselection:`&Page Style...` を選択すると
:guilabel:`Page Style` ダイアログボックスが表示される。:guilabel:`Footnote` タブ
に移動して選択し、:guilabel:`&OK` 押して変更を保存する。

既定の :guilabel:`&Not larger than page area` 設定を維持すると、脚注の数に基づい
て脚注領域が自動的に計算される。脚注の最大空間を手動で制御するには
:guilabel:`Maximum footnote &height` をオンにし、希望する単位で値を入力する。

最大高を超える脚注は次のページにはみ出す。ページの二番目の区画を使用して、脚注と
メインテキストエリアの間の分離帯をカスタマイズしろ。

Inserting column and line breaks
======================================================================

手動改頁に加えて、改段や改行を使いたい場合もある。これらの改行の挿入方法は、手動
改頁の方法と似ている。

Column breaks
----------------------------------------------------------------------

手動による改段は複数段組の文書または節でしか使用できない。手動改段を挿入するに
は：

#. キャレットを新しい段を開始したい位置に置く
#. メニューから :menuselection:`&Insert --> More &Breaks --> Manual &Break...`
   を選択
#. :guilabel:`Insert Break` ダイアログボックスの :guilabel:`Type` 区画で
   :guilabel:`Column &break` をオン
#. :guilabel:`&OK`

:guilabel:`Paragraph` ダイアログボックスの :guilabel:`Breaks` 区画を使用すること
も可能。

Line breaks
----------------------------------------------------------------------

改行を使用して、いくつかの方法でテキストを手動で書式を整えることが可能だ：

* 次の行に続く（既定）
* 現在の行と交差するすべての錨付き物の下の、次の完全な行に続く
* 左側がブロックされていない次の行に続く
* 右側がブロックされていない次の行に続く

既定の改行を挿入するには :kbd:`Shift` + :kbd:`Enter` を押す。

その他の改行を挿入するには：

#. テキストを改行したい位置にキャレットを置く
#. :guilabel:`Insert Break` ダイアログボックスの :guilabel:`Type` 区画で
   :guilabel:`&Line break` をオンにする
#. 必要な改行の型を選択
#. :guilabel:`&OK`

Changing page orientation within a document
======================================================================

文書には複数の向きのページを含めることができる。よくあるシナリオは、文書の真ん中
か最後に横向きのページがあり、他のページは縦向きというものだ。

Setting up a landscape page style
----------------------------------------------------------------------

#. 余白を他のページと同じにするには、現在のページスタイル（:guilabel:`Page
   Style` ダイアログボックスの :guilabel:`Page` タブ）の余白設定に注意しろ。
#. Sidebar の :guilabel:`Styles` 甲板で :guilabel:`Page Styles` 一覧から
   :guilabel:`Landscape` を右クリックし、:menuselection:`&Edit Style...` を選択
   する。
#. :guilabel:`Page Style` ダイアログボックスの :guilabel:`Organizer` タブ
   で、:guilabel:`Ne&xt style` が :guilabel:`Landscape` に設定されていることを確
   認。
#. :guilabel:`Page Style` ダイアログボックスの :guilabel:`Page` タブで、
   :guilabel:`&Orientation` が :guilabel:`L&andscape` になっていることを確認す
   る。
#. 余白を縦書きページの余白に対応するように変更する。すなわち、縦長の上余白が横
   長の左余白になるようにする。
#. :guilabel:`&OK`

Inserting a landscape page into a portrait document
----------------------------------------------------------------------

Landscape ページスタイルが定義された後、それを適用する方法：

#. キャレットを横書きに設定したいページの先頭にある段落または図表に置く
#. 右クリックメニューから次のどちらかを選択：

   * :guilabel:`P&aragraph --> P&aragraph...`
   * :guilabel:`&Table Properties...`
#. ダイアログボックスの :guilabel:`Text Flow` ページで、:guilabel:`&Insert` また
   は :guilabel:`&Break` を選択し、:guilabel:`With Page St&yle` をオン
#. プロパティーを :guilabel:`Landscape` に設定
#. :guilabel:`&OK` を押す

縦長に戻す手順もわかるだろう。

Portrait headers or footers on landscape pages
----------------------------------------------------------------------

.. admonition:: 読者ノート

   以下、手順がどうしても面倒で検証していない。

横長ページにヘッダーやフッターを定義すると、ページ長辺に配置される。横長ページが
縦長ページの間に挿入される場合、ヘッダーやフッターを横長ページの短辺に配置し、横
長ページを 90 度回転させると（印刷された本のように）縦長ページと同じレイアウトに
なるようにしたい場合がある。

枠を使えば、横長ページに縦長向きのヘッダーやフッターを設定可能だ。枠を設定するの
は少し面倒だが、一度設定すれば Landscape ページスタイルの一部となり、文書内の横
長ページすべてに表示される。

下の例では、横長ページを文書に挿入し、縦長ページと同じヘッダー、フッター、余白を
持たせている。この例では、既定ページスタイルは縦長、A4 サイズ、ヘッダーとフッ
ターは 0.5 cm, 間隔は 0.5 cm だ。

横長ページのレイアウトを縦長ページのレイアウトに合わせるには：

* 横長ページは、ヘッダーは有効にするが、フッターは有効にしない。
* 横長ページの上余白は、縦長ページの左余白より 1 センチ小さくなる。なぜならば、
  縦長ページには（空の）ヘッダーがあり、そこに垂直ヘッダーとフッター枠の両方を固
  定するからだ。
* 横ページの下余白は縦ページの右余白と同じになる。
* 両ページの縦方向の寸法が一致するように、横長ページの左右の余白は、縦長ページの
  対応する上下の余白より 1 センチ大きくなければならない。この 1 センチは、本文に
  ヘッダー (0.5 cm) やフッター (0.5 cm) の寸法と間隔 (1.0 cm) を足したものだ。

このような結果を得る手順は：

#. 両方のページスタイルでテキストスペースの寸法が同じになるように Landscape ペー
   ジスタイルの余白を変更する。
#. 横長ページを表示したい場所に手動改頁を挿入（方法は先述）し、ページスタイルに
   :guilabel:`Landscape` を選択する。
#. 縦長ページのフッターからすべての内容をコピー＆ペーストし、横長ページの空白の
   段落に貼り付けます。このテキストに :guilabel:`Footer` 段落スタイルがあること
   を確認し、フォント設定が一致するようにする。
#. 貼り付けたテキスト（フィールドを含む）全体を選択する。
#. :menuselection:`F&ormat --> C&haracter...` を選択する。
#. ダイアログボックスで :guilabel:`Position` タブを選択し、:guilabel:`Rotation /
   Scaling` を :guilabel:`&270 degrees` に設定する。
#. :guilabel:`&OK` を押す。
#. テキストを選択したまま、:guilabel:`&Insert --> &Frame --> F&rame` を選択する。
#. ダイアログボックスで :guilabel:`Position and Size` タブを選択し、フッターの
   幅、高さ、水平および垂直位置を入力する。

   :guilabel:`&Width` と :guilabel:`&Height` の自動寸法調整オプションをオフにす
   る。
#. 枠全体を選択し、幅と高さを修正する：

   * 幅は 0.5 cm にする。縦書きページスタイルのフッターの高さだ。
   * 高さは Din A4 ページの幅 (21 cm) から、上下の余白の合計 2.8 cm と 1.8 cm を
     引いた 16.4 cm にする。
#. 枠をカットし、横長ページのヘッダーに移動してペースト、空のヘッダー段落に固定
   し、横長ページを挿入するたびに繰り返すようにする。
#. ページ全体に対する枠の位置を設定する：

   * 垂直位置 2.80 cm
   * 水平位置 1.50 cm
#. フッターでテキストの上に行がある場合は :guilabel:`Borders` タブで右枠線を選択
   し、枠の内容に合わせて行の幅と間隔を指定する。
#. :guilabel:`&OK` を押す。

回転したテキストではタブが表示されないので、タブのあったテキストの末尾の枠をク
リックし、縦書きページに合うようにレイアウトに必要な数の空きを入力しろ。

.. tip::

   横長のページに縦長のヘッダーを設定するには、この手順の途中からを繰り返す。た
   だし、横方向の位置を 27.70 cm に設定する。余白とヘッダーから 2 cm を引いた値
   だ。
