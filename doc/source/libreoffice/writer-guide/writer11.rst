======================================================================
Writer Guide Chapter 11, Images and Graphics ノート
======================================================================

.. include:: ./abbrev.txt
.. |Pos&SizeMenu| replace:: :menuselection:`Position and Si&ze...`
.. |GIF| replace:: :abbr:`GIF (Graphics Interchange Format)`
.. |GIMP| replace:: GIMP_
.. |JPG| replace:: :abbr:`JPEG (Joint Photographic Experts Group)`
.. |PNG| replace:: :abbr:`PNG (Portable Network Graphics)`

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

Writer 文書には写真、図面、スキャン画像などの画像ファイル追加可能だ。さまざまな
線画、ビットマップ形式のインポートが可能だ。

Writer にある画像は次の基本的な型のものだ：

* 写真、図面、スキャン画像などの画像ファイル
* LibreOffice の図面ツールを使用して作成された図式
* クリップアートまたは Fontwork を使用して作成された芸術作品
* LibreOffice Calc を使用して作成された図式

.. admonition:: 読者ノート

   ここまで来て a diagram も a chart も図式と訳してきていることに気づく。混乱し
   ても問題ないから放置する。

この章では画像、図式、芸術作品について説明する。

* 図表の作成方法については |Chapter19| で説明している。
* 図面ツールの詳細については |Draw| を参照。
* 図式については |Calc| を参照。

Creating and editing images
======================================================================

Writer はさまざま線画画像を取り込むことができ、そのような画像を回転させたり反転
させたりすることが可能だ。Writer はビットマップファイル形式も取り扱っており、
もっとも一般的なものは |GIF|, |JPG|, |PNG|, BMP だ。完全な一覧は |Help| を見ろ。

Writer は Microsoft Office ファイルから SmartArt 画像をインポートすることが可能
だ。SmartArt を含む Microsoft Word ファイルを開き、画像を編集することも可能だ。

写真やその他のビットマップ画像を編集するには、ビットマップエディターを使用しろ。
線画を編集するには、ベクトル描画プログラムを使用しろ。多くの画像は LibreOffice
Drawで 十分だ。|GIMP| や Inkscape のようなオープンソースのツールは優れている。

.. admonition:: 読者ノート

   :doc:`/inkscape/index`

画像を選択または作成する際に考慮すべき点には、画質や、画像を色で印刷するか白黒で
印刷するかなどがある。

最良の結果を得るために：

* 文書に必要な正確な寸法の画像を作成するか、適切な画像パッケージを使用して写真や
  大きな図面を必要な寸法に拡大縮小しろ。Writer には画像を拡大縮小するツールがあ
  るが、Writer では拡大縮小するな。
* その他の必要な画像操作（明るさ、色対比、色調整、切り抜き、灰色階調への変換な
  ど）は、Writer ではなく画像パッケージで行う。
* 文書が画面上でのみ使用されるのであれば、300 dpi 以上の高解像度画像を使用する必
  要はない。解像度を下げても、表示される画像に悪影響はない。印刷では、一般的に
  300 dpi 以上が好まれる。

Preparing images for black-and-white printing
----------------------------------------------------------------------

色画像を灰色階調で印刷する場合は、隣接する色の対比が良好で、十分に濃く印刷される
ことを確認しろ。さらに、写真エディターまたは Writer 自体で、画像の「モード」を灰
色階調に変更する。:ref:`writer11-anchor-image-mode` を見ろ。

.. admonition:: 読者ノート

   本書の図版二つでは、色付き画像だと良く見えるのに、灰色階調では違いが明確でな
   くなる例を図解している。どちらでも明確になるように色を指定して視認性を上げろ
   とある。

文書が白黒印刷でしか利用できない場合は、色塗りではなく灰色階調塗りを選択した方が
良い結果が得られることがよくある。

Adding images to a document
======================================================================

追加方法はさまざまだ：

* 計算機やネットワークに保存されている画像ファイルをはめ込む
* 画像プログラムや光学走査装置から直接はめ込む
* クリップアートの内部 Gallery からドラッグする
* 計算機で表示しているところからコピー＆ペーストする

Inserting an image file
----------------------------------------------------------------------

画像が計算機に保存されている場合は、次のいずれかの方法で Writer 文書にはめ込め：

Drag and drop
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ドラッグ＆ドロップでは画像ファイル（の複製）を文書に埋め込む。埋め込む代わりにリ
ンクするには :kbd:`Ctrl` + :kbd:`Shift` を押しながらドラッグしろ。

#. Windows Explorer などからはめ込む画像を探す
#. 画像を Writer 文書にドラッグし、表示させたい場所にドロップする

画像がドロップされる場所には縦線がかすかに描かれる。

Insert Image dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 画像を表示したい文書中の場所をクリック
#. メニューの :menuselection:`&Insert-->&Image...` を選択するか、
   |StandardToolbar| :guilabel:`Insert Image` 図像をクリック
#. :guilabel:`Insert Image` ダイアログボックスで画像ファイルを選択

   * ダイアログボックスの下部に :guilabel:`Link` オプションがある。
#. |Open| を押す

.. admonition:: 読者ノート

   ファイル選択時のプレビューは Windows Explorer の機能で間に合う。

.. note::

   :guilabel:`Link` をオンにして開くとメッセージボックスが表示される。代わりに画
   像を埋め込むかどうかを尋ねる。

   * リンクが必要な場合は :guilabel:`Keep Link`
   * 必要でない場合は :guilabel:`Embed Graphic`

   を選択しろ。このメッセージが再び表示されないようにするには、メッセージの下部
   にある :guilabel:`Ask when linking a graphic` をオフにする。

Copy and paste
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

クリップボードを使用すると、他の LibreOffice 文書や他のプログラムから
LibreOffice 文書に画像をコピーできる。

#. 原文書と対象 Writer 文書の両方を開く
#. 原文書からコピーする画像を選択
#. 画像をクリップボードにコピー
#. 対象文書に切り替える。
#. 画像をはめ込む場所にキャレットを置いてクリック
#. キーバインド |Ctrl+V| で画像を貼る

.. caution::

   画像を貼り付ける前にコピー元のアプリケーションを終了すると、クリップボードに
   保存されていた画像が失われる可能性がある。

Linking an image file
----------------------------------------------------------------------

:guilabel:`Insert Image` ダイアログボックスで :guilabel:`Link` をオンにすると、
Writer は文書に画像のコピーを保存する代わりに、画像を含むファイルへのリンクを作
成する。画像は文書内に表示されるが、文書が保存されるときに画像そのものではなく、
画像ファイルへの参照しか使わない。文書と画像は二つの別々のファイルとして残り、文
書を再び開いたときに初めて併合される。

画像のリンク方式における利点と欠点：

* 利点：画像ファイルを独立して変更でき、次に文書を開いたときに変更後の画像が表示
  される。画像作者と文書著者が異なるなどの場合に大きな利点となる。
* 利点：画像データそのものが含まれないため、リンクは保存時の文書容量を小さくする
  ことができる。しかし、最近の計算機ではファイル容量が問題になることは通常なく、
  LibreOffice は比較的大きなファイルを扱うことが可能だ。
* 欠点：文書を他の人に送ったり、別の計算機に移動したりする場合、画像ファイルも一
  緒に扱う必要がある。画像のパスを追跡し、文書がそれらを見つけることができるよう
  に、受信者がそれらを置くパスを知っていることを保証する必要がある。

.. note::

   文書に同じ画像を何度もはめ込む場合、LibreOffice は画像ファイルのコピーを一つ
   だけ埋め込む。

Embedding linked images
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

リンクされた画像は後で簡単に埋め込みに変えることが可能だ。次のようにする：

#. Writer で文書を開く。
#. メニューから :menuselection:`&Edit-->E&xternal Links...` を選択する。
#. :guilabel:`Edit Link` ダイアログボックスには、リンクされたファイルすべてが一
   覧表示される。:guilabel:`Source file` 一覧から対象ファイルを選択する。
#. :guilabel:`&Break Link` ボタンを押す。
#. |Yes| を押す。

Linking an embedded image
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

画像を埋め込みからリンクに変更するには：

#. 画像が別ファイルになっていることを確認しろ。必要ならば埋め込まれた画像をファ
   イルとしてエクスポートしろ。:ref:`writer11-anchor-export` を見ろ。
#. Writer 文書で埋め込み画像を選択する。
#. 右クリック :menuselection:`&Properties...` を選択する。
#. |ImageDlg| で :guilabel:`Rotation` タブに進む。埋め
   込み画像の場合、:guilabel:`&File name` 欄は空だ。
#. 右にある |Browse| を押す。ファイルダイアログボックスが開く。
#. リンクするファイルを見つけて選択し |Open| を押す。選択したファイルのパスが
   :guilabel:`&File name` 欄に表示される。
#. |ImageDlg| で |OK| を押す。

これで埋め込みファイルはリンクに置き換えられる。

Inserting an image using a scanner
----------------------------------------------------------------------

光学走査装置が計算機に接続されている場合、Writer は光学走査アプリケーションを呼
び出し、読み取った画像を文書にはめ込むことが可能だ。

#. メニューから :menuselection:`&Insert-->&Media-->&Scan-->&Select Source...` を
   選択し、利用可能な周辺機器一覧から走査源を選択する。
#. 画像をはめ込む文書をクリックする。
#. :menuselection:`&Insert-->&Media-->&Scan-->&Request...` を選択する。画
   像処理ソフトウェアが開くので、画質、寸法、その他の属性の設定を調整する。

この方法は素早く簡単だが、正しい寸法の高品質な画像に仕上がる可能性は低い。
Writer に画像をはめ込む前に、素材を画像プログラムに読み込み、そこで画像を調整す
るほうが良好な結果を得られるだろう。

.. admonition:: 読者ノート

   ハードがないので試していない。

Inserting an image from the Gallery
----------------------------------------------------------------------

Gallery は文書にはめ込める画像や音声などの再利用可能な物を群れにする便利な方法が
備わっている。Gallery は LibreOffice Writer, Calc, Impress, Draw で利用可能だ。
Gallery から物を文書にコピーまたはリンクすることが可能だ。

Gallery の詳細については |Guide| を参照しろ。

Gallery から文書に物をはめ込むには：

#. Sidebar の :guilabel:`Gallery` 図像をクリック
#. 一覧からテーマを選択
#. 物をシングルクリックで選択
#. 画像を文書にドラッグ＆ドロップするか、物を右クリックしてコンテキストメニュー
   から :menuselection:`&Insert` を選択する
#. 画像の寸法を調整し、必要に応じて位置や錨を調整する

.. _writer11-anchor-positioning:

Positioning images within the text
======================================================================

テキスト文書に画像を追加する場合、テキストや他の画像に対して画像をどのように配置
するかを決める必要がある。位置は四つの設定によって制御する：

* 配置とは、架空の縦軸上に画像を置くことだ。画像同士をどのように重ねるか、あるい
  はテキストとどのように相対させるかを制御する。
* 位置揃えとは、選択した錨に対して画像を縦または横に置くことだ。
* 錨とは、画像への参照点だ。この点は物があるページや枠、段落、文字であることもあ
  る。画像には必ず錨が一つある。
* 折り返しとは、画像と周囲のテキストとの関係であって、テキストは片側または両側で
  画像の周囲を折り返したり、画像の後ろや前に刷り重ねたり、画像を独立した段落や文
  字として扱ったりすることができる。

設定は画像の性質に応じていくつかの方法でアクセスできる：

* メニュー :menuselection:`F&ormat-->` 以下にある

  * :menuselection:`Anc&hor-->`
  * :menuselection:`&Wrap-->`
  * :menuselection:`A&rrange-->`
* 画像を右クリックしたときに表示されるコンテキストメニューには
  :menuselection:`Alig&n Objects-->` サブメニューもある。
* 画像に対しては |ImageDlg| の |Pos&SizeTab| と |WrapTab| にある。
* 図面物に対しては |Position&SizeDlg| の |Pos&SizeTab| にある。ダイアログボック
  スを開くには、図面物を右クリックし、コンテキストメニューから |Pos&SizeMenu| を
  選択する。
* 埋め込み物（Calc スプレッドシートや Draw 文書など）の場合は :guilabel:`OLE
  Object` ツールバーにある。

.. note::

   この節で説明した位置操作技術はすべて枠に対しても同様に適用可能だが、枠に対し
   ては輪郭の折り返しは不可能だ。

Arranging images
----------------------------------------------------------------------

画像の配置とは、他の画像やテキストとの相対的な位置を決めることだ。配置は物同士が
重なり合う場合にしか関係しない。一般的な設定四つに加え、物を描画するための五つ目
の特別な設定を選択できる：

:menuselection:`&Bring to Front`
   画像を他の画像やテキストの上に配置する。
:menuselection:`&Forward One`
   画像をスタックの一段上に持ってきます。重なっているオブジェクトの数によっては、このオプションを数回適用しないと望ましい結果が得られない場合がある。
:menuselection:`Back &One`
   画像をオブジェクトスタックの一段下に送る。
:menuselection:`&Send to Back`
   画像をスタックの一番下に送る。
:menuselection:`To Ba&ckground`, :menuselection:`&To Foreground`
   図面物に対してのみ有効で、図面物をそれぞれテキストの後ろまたは前に移動する。

.. tip::

   他の物に覆われている物を選択するには、:kbd:`Tab` を押して目的の物に到達するま
   で物の間を移動しろ。

Anchoring images
----------------------------------------------------------------------

画像を文字として、またはページ、段落、文字に繋留することが可能だ。また、画像を枠
内に配置し、枠のほうを繋留することも可能だ。

:guilabel:`To Page`
   |ImageDlg| でのみ利用可能。

   画像はページの余白に対して同じ位置を保つ。テキストや他の画像を加除しても画像
   は動かない。この方法は、新聞などレイアウトを多用する文書を作成する場合や、レ
   ターヘッドにロゴを配置する場合に便利だ。

   この繋留方式は非推奨だ。
:menuselection:`To &Paragraph`
   画像は段落に関連付けられ、段落と一緒に移動する。余白や他の場所に配置すること
   もある。この方式は段落の横に図像を配置する図表代わりに便利だ。
:menuselection:`To &Character`
   画像は一文字に関連付けられるが、テキスト連なりには含まれない。この方式は段落
   への繋留と似ている。
:menuselection:`As C&haracter`
   画像は他の文字と同じように文書内に配置される。したがって、テキスト行の高さや
   改行に影響する。画像の前にテキストを加除すると、画像はテキストと一緒に移動す
   る。スクリーンショットを手順の中で順番に並べたり（空白の段落に文字として固定
   する）、文中に小さな（インラインの）図像を順番に追加したりするのに便利な方式
   だ。
:menuselection:`To &Frame`
   画像が枠内に配置されている場合、枠内の固定位置に画像を繋留することが可能だ。
   枠はページに、段落に、文字に、または文字として繋留することが可能だ。

.. tip::

   画像に対する既定繋留は |OptionsDlg| の :menuselection:`LibreOffice Writer-->
   Formatting Aids` ページで設定可能。

Aligning images
----------------------------------------------------------------------

画像の錨ポイントが決まったら、錨に対する画像の位置を決める。六つのオプションから
選びます：

* 画像を水平に揃える三つのオプション（左、中央、右）
* 画像を垂直に揃える三つのオプション（上、中央、下）

水平方向の位置揃えは :guilabel:`&As Character` 方式で繋留された画像では利用不能
だ。

位置揃えをより細かく制御するには |ImageDlg| |Pos&SizeTab| :guilabel:`Position`
オプションを用いる。

:guilabel:`Hori&zontal`, :guilabel:`&Vertical` ともに、まず右側のドロップダウン
リストで基準点を選び、次に最初のドロップダウンメニューで、

* :guilabel:`Left`, :guilabel:`Right`, :guilabel:`Center`
* :guilabel:`Top`, :guilabel:`Bottom`, :guilabel:`Middle`

から選択する。:guilabel:`From left` または :guilabel:`From top` を選択した場合
は、距離を指定することが可能だ。

Wrapping text around images
----------------------------------------------------------------------

:guilabel:`Wrap` 設定はテキストと画像の関係を決定する。通常は画像に対する繋留と
位置揃えの後に選択する。コンテキストメニューの項目は錨設定の選択に応じていくつか
用意されており、|ImageDlg| の |WrapTab| にはそのほかにも選択肢があ
る。

.. rubric:: Settings

:guilabel:`W&rap Off`
   物を文書内の別の行に配置する。テキストは画像の上下に配置されるが、左右には配
   置されない。
:guilabel:`Be&fore`
   十分な場所があれば、物の左側にテキストを折り返す。
:guilabel:`Aft&er`
   十分な場所があれば、物の右側にテキストを折り返す。
:guilabel:`&Parallel`
   オブジェクトの境界枠の四方にテキストを折り返す。
:guilabel:`Thro&ugh`
   テキストに画像を重ねる。つまり、画像はテキストの手前にある。このオプションは
   画像の下のテキストを見えるようにするために、画像透過設定と一緒に使う必要があ
   る。
:guilabel:`&Optimal`
   テキストは画像の周りを流れる。画像をページ内で動かすと、その左右のスペースを
   埋めるようにテキストが再配置される。画像と余白の間隔が 2 cm 未満の場合、テキ
   ストが画像の横に配置されるのを防ぐ。

.. rubric:: Options

:guilabel:`&First paragraph`
   テキストが画像に回り込む可能性があっても、画像の後に新しい段落を開始する。
:guilabel:`In Bac&kground`
   :guilabel:`Thro&ugh` と似ているが、画像はテキストの後ろに配置されるので、テキ
   ストを見えるようにするために透明度を変更せずに済むことがある。対比があまり強
   くない画像や、異なる色の画像に使うのが最適だ。
:guilabel:`&Contour`
   テキストを物の形に巻き付ける。
:guilabel:`Outsi&de only`
   物の輪郭にのみテキストを回り込ませ、物の形状の中の開いている部分にはテキスト
   回り込ませない。
:guilabel:`&Allow overlap`
   物が他と重なることを許可するかどうかを指定する。このオプションは折り返す物に
   は影響せず、常に重なり合うことができる。

.. note::

   画像を :guilabel:`&As Character` 方式で繋留する場合、画像とテキストの間隔は調
   整できるが、折り返しオプションは利用不能となる。

画像とテキストの間隔を調整するには |WrapTab| :guilabel:`Spacing` 区画を使え。

Editing the contour
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

輪郭を作成するには：

* 画像の |WrapTab| で :guilabel:`&Contour` を選択（前述の注意点参照）
* 画像を右クリックしてコンテキストメニューから :menuselection:`&Wrap-->&Edit
  Contour...` を選択

輪郭を編集するには：

* 画像を右クリックしてコンテキストメニューから :menuselection:`&Wrap-->&Edit
  Contour...` を選択
* 画像を選択してメニューから :menuselection:`F&ormat-->&Wrap-->&Edit
  Contour...` を選択

:guilabel:`Contour Editor` ダイアログボックスが開く。ツールバーボタン各種を使っ
てテキストで覆われない領域を描くことで指定する。

.. admonition:: 読者ノート

   本書の図を見ると、りんごの輪郭をマウスでなぞるように描いている。

:guilabel:`Contour Editor` で使用できるツールには、矩形、楕円、多角
形、AutoContour がある。複雑な輪郭を作成するには、図面ツールにある程度慣れている
必要があるが、ほとんどの場合、高い精度は必要ない。輪郭の形状を点ごとに調整するに
は :guilabel:`Edit Points` ボタンを押す。詳細は |Draw| を参照しろ。

:guilabel:`Apply` ボタンを押して輪郭を保存する。

Adding captions to images
======================================================================

.. |CaptionDlg| replace:: :guilabel:`Insert Caption` ダイアログボックス

画像に説明を追加するには次の方法がある：

* 自動
* |CaptionDlg|
* 手動

Adding captions automatically
----------------------------------------------------------------------

LibreOffice では画像や図表などを文書にはめ込むたびに、自動的に説明を追加するよう
に構成可能だ。自動的に説明を付ける物、各説明の輪番名（例：「表～」「図～」など）、
説明の位置を選択可能だ。

自動説明を設定するには |OptionsDlg| :menuselection:`LibreOffice Writer-->
AutoCaption` ページを開く。ダイアログボックスの右側で、自動的に説明を付ける物を
選択し、説明の特徴を指定する。

画像をはめ込むと、自動説明が有効になっている場合は、画像の既定の輪番名を含む説明
とともに画像が枠内に配置される。説明領域にキャレットを置き、説明文を入力する。輪
番名は :guilabel:`Category` ドロップダウン一覧から選択するか、自分で入力すること
で変更可能だ。

Adding captions using the Caption dialog
----------------------------------------------------------------------

|CaptionDlg| ダイアログボックスを使って説明を追加する：

#. 画像をはめ込み、

   * 右クリックして :menuselection:`Insert &Caption...` を選択
   * 画像を選択してメニューから :menuselection:`&Insert-->Caption...` を選択
#. |CaptionDlg| :guilabel:`Properties` で次の各欄を選択し、上部の
   :guilabel:`Caption` 欄に説明文を入力する：

   * :guilabel:`&Category`
   * :guilabel:`&Numbering`
   * :guilabel:`&Before caption`
#. |OK| を押す。

画像と説明が枠内に配置される。

.. tip::

   :guilabel:`&Category` には、ドロップダウンリストにない場合は、好きな名前（例
   えば ``Photo`` など）を入力することができる。Writer は AutoCaption 機能を使用
   する場合と同様に、その名前を使用して輪番を作成する。

Numbering images by chapter
----------------------------------------------------------------------

説明の番号付けに関する追加的選択肢を表示するには |CaptionDlg| で
:guilabel:`Option&s...` ボタンを押し、:guilabel:`Caption Options` ダイアログボッ
クスを開く。これらの設定の中には、見出し（アウトライン）レベルを参照するものがあ
り、文書内の章見出しにアウトラインレベルの段落スタイルが使用されている場合に限り
効果がある。

見出し番号付けが設定されると、Writer は各章の説明番号付けを再開する。例えば、第
一章の最後の図の説明が ``Figure 1.15`` で、次の図の説明が第二章の場合、番号付け
は ``Figure 2.1`` から始まる。

説明の章番号のオプションは以下の通り：

* :guilabel:`Ca&ption order` は区分と番号のどちらが説明で最初に表示されるかを指
  定する。
* :guilabel:`Character sty&le` は区分と説明番号の文字スタイルを指定する。これは
  説明・テキストの文字スタイルとは異なることがある。
* :guilabel:`&Use border and shadow of selected object` オプションは図表の説明に
  は適用されない。図表は枠に囲まれている物ではないからだ。
* :guilabel:`&Up to level` はレベル 1 から何段階まで見出し番号を表示するかを指定
  する。見出し番号を表示しない場合は :guilabel:`[None]` を選択する。
* :guilabel:`&Separator` は章番号と図番号の間に表示する文字を指定する。

.. note::

   :guilabel:`&Up to level` または :guilabel:`&Separator` への変更は文書内の既存
   の説明にも適用される。

Adding captions manually
----------------------------------------------------------------------

名前を付けて保存するか、他の形式にエクスポートすると、上記の方法で適用された説明
がエクスポート中に失われることがある。

エクスポート問題を避けるため、あるいは画像の上下に説明を付ける別の方法（通常の場
合）として、次の二つの方法のどちらかを使って手動で説明を付けることが可能だ：

* 画像と説明を別々の段落にする
* 表組を使う

Place the image and its caption in separate paragraphs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

画像をはめ込み、文字として段落に繋留しろ。説明用の新しい段落を作成するために
:kbd:`Enter` を押せ。

#. 説明段落に、例えば ``Figure`` と入力し、空白を入れる。
#. 図版番号を自動的にはめ込むには :menuselection:`&Insert-->Fiel&d-->&More
   Fields...` (:kbd:`Ctrl` + :kbd:`F2`) を選択し、:guilabel:`Variables` タブを選
   択する。
#. :guilabel:`&Type` 一覧で :guilabel:`Number range` を選択
#. :guilabel:`&Select` 一覧で :guilabel:`Figure` を選択
#. :guilabel:`&Format` 一覧で (例) :guilabel:`Arabic (1 2 3)` を選択
#. :guilabel:`&Insert` ボタンを押す
#. 説明の ``Figure`` の後に数字が表示される。説明のテキストを入力しろ。

.. tip::

   この方法で多数の図版に手作業で説明を追加する場合、例えば、Figure と空白、図版
   番号フィールド、オプションの区切りとそのあとの空白を含む AutoText エントリー
   を作成するとよい。

.. tip::

   画像と説明がページ上で一緒に表示されるようにするには、新しい段落スタイル（例
   えば `Figure`）を作成する。画像が説明の上にある場合、`Figure` 段落スタイルの
   テキストフローを :guilabel:`&Keep with next paragraph` と定義し、次のスタイル
   を `Caption` と定義する。逆に、説明が上に来る場合は `Caption` 段落スタイルを
   :guilabel:`&Keep with next paragraph` と定義し、次のスタイルを `Figure` と定
   義する。

Use a table
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

一列二行の表組を作成する。一行に画像を配置し、もう一行に説明を入力するか、説明と
その他のテキスト用に二行以上を使用する。この方法は、番号付きの凡例がある画像に特
に有効だ。

Modifying images
======================================================================

新しい画像をはめ込む場合、文書に合わせて画像を修正することが必要になる場合があ
る。テキストに対する画像の配置については、:ref:`writer11-anchor-positioning` で
説明する。この節では次について説明する：

* |ImageToolbar| の使い方
* 画像寸法変更
* 画像切り取り
* 画像回転

Writer は画像を扱うための多くのツールを用意している。これらのツールは、ほとんど
の人が日常的に必要とするものには十分だ。しかし、専門家の仕上がりを求めるのであれ
ば |GIMP| のような画像加工プログラムを使って画像を加工し、その結果を Writer には
め込むのが一般的だ。

Using the Image toolbar
----------------------------------------------------------------------

画像をはめ込んだり、文書内にすでに存在する画像を選択すると、|ImageToolbar| が出
現する。

|ImageToolbar| を常に表示するように設定 [#footnote]_ し、浮動するか入渠するかを
選択できる。他の二つのツールバーは、このツールバーから開くことができる：

* :guilabel:`Image Filter` ツールバーはウィンドウの他の場所に引き離して配置可能
* :guilabel:`Color` ツールバーは別の浮動ツールバーとして開く

これらの三つのツールバーから、画像に小さな修正を加えたり、特殊効果を得ることがで
きる：

* 透明化
* 色調整
* 反転と回転
* 特殊効果フィルター適用

Image filters
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. admonition:: 読者ノート

   余裕があれば本書 `Table 8` をやる。

画像フィルターの詳細については |Draw| を読め。

.. _writer11-anchor-image-mode:

Image mode
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

色画像を灰色階調、白黒、透かしに変更するには、画像を選択し、画像モード一覧から該
当項目を選択する。

Flip vertically, horizontally or in 90° rotations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

画像を垂直、水平に反転させたり、90 度回転させるには、画像を選択し、|ImageToolbar|
の関連ボタンを押す。

Transparency
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

画像をより透明にするには、|ImageToolbar| の :guilabel:`Transparency` 欄の百分率
値を増やす。透かしを作成する場合や、画像を背景に配置する場合に有用だ。

Color
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

このツールバーを使って、画像の各 RGB 色成分、および輝度、対比、ガンマを変更する。
満足のいく結果が得られない場合は Undo して既定値に戻すことが可能だ。

Using the Formatting toolbar and Image dialog
----------------------------------------------------------------------

画像が選択されているときは、|FormattingToolbar| や、画像を右クリックして
:menuselection:`&Properties...` を選択して開くダイアログボックスで利用できるツー
ルを使って、その見てくれの一部をカスタマイズ可能だ。たとえば、画像の周囲に境界
[#footnote-border]_ を作成してスタイルと色を選択したり、画像に影を追加したりでき
る。

.. _writer11-anchor-crop:

Cropping images
----------------------------------------------------------------------

.. |CropTab| replace:: :guilabel:`Crop` タブ

文書の目的上、画像の一部分にしか興味がない場合、画像の一部をくり抜きたいことがあ
る。Writer にはこの手段が二つある：

* Crop ツール
* |ImageDlg| |CropTab|

Crop ツールを使えば、素早く簡単に画像を切り抜くことができる。

.. note::

   Writer で画像を切り抜いても原画像は変化しない。切り取るのではなく隠すのだ。文
   書を |HTML| にエクスポートする場合は、切り取られた画像ではなく、原画像がエク
   スポートされる。切り抜き画像を個別に書き出すことに関しては
   :ref:`writer11-anchor-export` の記述を見ろ。

Using the Crop tool
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Crop ツール実行手順：

#. 画像を右クリック
#. コンテキストメニューから :menuselection:`Cr&op` を選択
#. 画像の四隅と辺の中点に表示されるハンドルをドラッグして画像の一部を切り取る
#. 画像の外側をクリックして Crop モードをオフにする

Using the Crop tab of the Image dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

画像を切り抜くには、画像を右クリックしてコンテキストメニューから
:menuselection:`&Properties...` を選択し、|ImageDlg| |CropTab| を選択する。

|CropTab| に表示される単位は |OptionsDlg| :menuselection:`LibreOffice
Writer-->General` で設定された単位だ。

:guilabel:`Crop` 区画には二つのオプションがある。

* :guilabel:`Keep &scale` は画像の比率を維持する
* :guilabel:`Keep image si&ze` は画像が歪むことがある。
* :guilabel:`&Left`, :guilabel:`&Right`, :guilabel:`&Top`, :guilabel:`&Bottom`

  の値が変更されると、プレビュー境界が変更され、画像上の切り抜き領域が表示さ
  れ、:guilabel:`Scale` または :guilabel:`Image size` の :guilabel:`&Width` 欄と
  :guilabel:`&Height` 欄が変更される。この結果、画像寸法が変更されるか、固定画像
  寸法に対する尺度が変更される。

原画像寸法は :guilabel:`&Original Size` ボタンの左に表示される。

Resizing an image
----------------------------------------------------------------------

文書に画像を収めるには寸法を変更しなければならないことがある。

寸法を変更するのに手っ取り早く簡単な方法は、画像の寸法変更ハンドルをドラッグする
ことだ：

#. 画像をクリックして寸法調整用のハンドルを表示する。
#. マウスポインターをハンドルのいずれかに合わせる。ポインターの形が変わり、寸法
   変更の方向が表示される。
#. クリック＆ドラッグで画像の寸法を変更する。
#. 新しい寸法に満足したらマウスボタンを離す。

.. tip::

   角ハンドルは画像の幅と高さの両方を同時に変化させるが、他の四つのハンドルは一
   度に一つの寸法だけを変更する。画像の元の比率を維持するには :kbd:`Shift` を押
   しながらこれらのハンドルのいずれかをドラッグする。

画像の寸法をより正確に変更するには |ImageDlg| の |CropTab| または |Pos&SizeTab| のい
ずれかを使用する。

|CropTab| では次の設定を調整できる：

:guilabel:`Scale`
   画像の拡大縮小を百分率で指定する。画像寸法はそれに応じて変化する。左右対称に
   変更するには両方の値を同じにする。
:guilabel:`Image Size`
   画像寸法を単位で指定する。画像はそれに応じて拡大または縮小する。
:guilabel:`&Original Size`
   押すと画像が原寸に戻る。これは切り抜きを行った後の寸法になる。

|ImageDlg| |Pos&SizeTab|  :guilabel:`Size` 区画の :guilabel:`Re&lative to` オプショ
ンを切り替えて、百分率と実寸を切り替える。左右対称に寸法を変化させるには
:guilabel:`&keep ratio` をオンにする。 :guilabel:`&Original Size` ボタンを押す
と、原画像寸法が復元されるが、画像が切り抜かれている場合、縮尺寸法が変更される。

.. _writer11-anchor-rotating:

Rotating or flipping an image
----------------------------------------------------------------------

画像を 90 度または 180 度すばやく回転させたり、垂直または水平に反転させるには、
画像コンテキストメニューから :menuselection:`Rot&ate or Flip-->` を選択し、必要
な結果を選択する。

所要角度で画像を回転させるには次の方法のいずれかを使用する：

* 対話的操作。画像を選択し、|ImageToolbar| :guilabel:`Rotate` 図像をクリックする
  か、右クリックして :menuselection:`Rot&ate or Flip-->&Rotate` を選択する。物の
  周囲に回転ハンドルが表示される。ハンドルの上にマウスポインターを合わせ、ポイン
  タの形が変わったら、クリックして必要な角度までドラッグする。この方法は素早く簡
  単だが、正確ではない。
* |ImageDlg| を使う。正確な回転角度を得るには、画像を右クリックし、
  :menuselection:`&Properties...` を選択する。|ImageDlg| で :guilabel:`Rotation`
  タブを選択する。:guilabel:`Rotation Angle` 区画で :guilabel:`&Angle` 欄に所望
  の回転を指定する。

Image dialog options
----------------------------------------------------------------------

|ImageDlg| にはタブが十個ある。詳しくは |Help| を見ろ。

|CropTab|
   :ref:`writer11-anchor-crop` で述べられている。
|Pos&SizeTab| と |WrapTab|
   :ref:`writer11-anchor-positioning` で説明されている。
:guilabel:`Rotation` タブ
   画像を反転または回転させる。画像が埋め込まれているのではなくリンクされている
   場合は、ファイルの元の場所を表示する。
|OptionsTab|
   画像に説明的な名前を付け、画面読み上げや Web ブラウザーで画像にマウスポイン
   ターを合わせたときに表示される代替テキストや説明を含むaccessibility 情報を準
   備し、画像設定の一部を誤って変更しないように保護し、画像が印刷されないように
   する。画像がロゴや色のついた形など装飾的な場合は :guilabel:`Deco&rative` をオ
   ンにする。
|BordersTab|
   画像の周囲に境界線を作成する。:guilabel:`Borders` ダイアログボックスは表組や
   段落の境界線を定義するときに使うものと同じだ。|Chapter04| 参照。画像に影を足
   すこともできる。
|AreaTab|
   画像の背景色を変更する。この設定は透明度のある画像にしか望ましい結果をもたら
   さない。|Chapter04| 参照。
:guilabel:`Hyperlink` タブ
   画像にハイパーリンクを関連付けるか、:ref:`画像マップ<writer11-anchor-map>` を
   作成する。
|TransparencyTab|
   画像の透明度オプションを設定する。
:guilabel:`Macro` タブ
   マクロを画像に関連付ける。定義済みマクロの中から選ぶことも、マクロを自作する
   ことも可能だ。

Deleting an image
----------------------------------------------------------------------

画像を削除するには、画像をクリックして寸法変更ハンドルを表示させ、:kbd:`Delete`
を押す。

.. _writer11-anchor-export:

Exporting (saving) images
----------------------------------------------------------------------

別のプログラムで画像に複雑な調整を加えたり、別の文書で使用するために画像を保存し
たりするには、文書から直接エクスポートすることが可能だ。画像を右クリックし、コン
テキストメニューから :menuselection:`&Save...` を選択すると、:guilabel:`Image
Export` ダイアログボックスが開く。画像はいくつかの形式で保存可能だ。画像に名前を
付け、:guilabel:`ファイルの種類 (&T)` ドロップダウンリストで希望の画像形式を選択
し、|Save| を押す。

.. admonition:: 読者ノート

   文書内の物に対する右クリックメニューの :menuselection:`&Save...` がエクスポー
   トであるという仕様が盲点だった。

画像が保存される前に別のダイアログボックスが開き、そこでさまざまな画像寸法や形式
のオプションを選択できる。このダイアログボックスの内容は、選択した出力ファイルの
種類によって異なる。画像が Writer 内で変更されている場合、確認ダイアログボックス
が表示され、原版と変更版のどちらを保存するかを選択可能だ。

Compressing images
----------------------------------------------------------------------

大きな画像を文書にはめ込み、ページのレイアウトに合うように寸法を変更すると、その
内容を保持するために原画像全体が文書ファイルに格納されるため、保存したり電子メー
ルで送信したりするにはファイルが大きくなる可能性がある。

画像描画の品質が多少損なわれてもかまわないのであれば、画像物を圧縮したり寸法を変
更したりして、ページレイアウトでの表示を維持したままデータ量を減らすことが可能だ。
専門家が印刷するようなものを圧縮したくはないだろう。

右クリックして画像を選択し、コンテキストメニューを開く。
:menuselection:`&Compress...` を選択して :guilabel:`Compress Image` ダイアログ
ボックスを開く。:guilabel:`Calculate New Size` ボタンを使って、引数集合を変更す
るたびにダイアログボックスの画像情報を更新しろ。

|OK| を押して圧縮設定を適用する。出来上がった画像に問題がある場合は Undo を実行
して元に戻し、別の圧縮設定を選択しろ。詳細については |Help| を見ろ。

.. admonition:: 読者ノート

   |PDF| に変換した後に :program:`ps` で圧縮するので、この工程はそこまで重要では
   ない。

Using Writer's drawing tools
======================================================================

.. |DrawingObjectProperties| replace:: :guilabel:`Drawing Object Properties` ツールバー

Writer の図面ツールを使って、矩形、円、線、テキスト、その他の定義済み図形を使用
して、簡単な図式などの画像を作成できる。複数の図面物をグループ化して、相対的な位
置や比率を維持することもできる。

図面物を文書のページに直接配置したり、枠にはめ込んだりすることが可能だ。

図面ツールを使って写真や画面キャプチャー、他のプログラムで作成した製図に注釈を付
けることもできるが、これは次の理由により勧められない：

* 図面物を含むグループに画像を含めることができない
* Writer 文書を |HTML| などの別の形式に変換すると、図面物と画像は関連付けられず
  に別々に保存される

一般的に、複雑な図面を作成する必要がある場合は、レイヤーやスタイルなど、より多く
の機能を搭載する LibreOffice Draw を使用することが望ましい。

Creating drawing objects
----------------------------------------------------------------------

図面ツールの使用を開始するには、:menuselection:`&View-->&Toolbars-->&Drawing` を
選択するか、|StandardToolbar| :guilabel:`Draw Functions` 図像をクリックして
|DrawingToolbar| を表示する。

|DrawingToolbar| は作業場所の下部または左側に現れる。他の場所に移動して入渠させ
ることも、浮動させて画面上の都合の良い場所に移動させることも可能だ。

図面ツールを使う手順：

#. 図面を繋留したい場所をクリックする。必要ならば、後で錨を変更することが可能だ。
#. |DrawingToolbar| でツールを選択する。ポインターが描画機能ポインターに変わり、
   通常の |FormattingToolbar| が |DrawingObjectProperties| に変わる。
#. 文書内の画像を表示したい場所に十字ポインターを移動し、クリック＆ドラッグして
   図面物を作成する。選択した描画機能は活動中のままなので、同じ種類の別の物を描
   画可能だ。
#. 選択した描画機能を中止するには、

   * :kbd:`Esc` を押すか、
   * |DrawingToolbar| の :guilabel:`Select` 図像（矢印）をクリックする。

これで、図面物の性質（塗りつぶしの色、線の種類と太さ、錨など）を、
|DrawingObjectProperties| か、図面物を右クリックして表示されるメニューやダイアロ
グボックスを使って変更可能になる。

Setting or changing properties for drawing objects
----------------------------------------------------------------------

描画する前に図面物の性質を設定する手順：

#. |DrawingToolbar| で :guilabel:`Select` ツールをクリックする
#. |DrawingObjectProperties| で各性質の図像をクリックし、その性質に必要な
   値を選択する。
#. さらに制御する場合や、新しい属性を定義する場合は、ツールバーの
   :guilabel:`Area` 図像や :guilabel:`Line` 図像をクリックすると、詳細ダイアログ
   ボックスが表示される。

設定した既定値は、現在の文書とセッションに適用される。文書を閉じたり、Writer を
終了したりしても保持されず、他の文書を開いても適用されない。既定はテキストオブ
ジェクトを除くすべての図面物に適用される。

既存の図面物の性質を変更するには、それを選択し、上記の手順を実行する。

図面物の位置や寸法、回転、傾きや角半径の諸性質を指定することも可能だ。図面物を右
クリックし、コンテキストメニューから |Pos&SizeMenu| を選択する。必要に応じて、任
意の性質を選択する。

Resizing a drawing object
----------------------------------------------------------------------

図面物の寸法を変更するには、

#. 物を選択
#. その周りにある八つのハンドルのうちの一つをクリック
#. 新しい寸法までドラッグ

物は拡大または縮小される。

物の辺または角ハンドルをつかんでドラッグすると、物の比率は保持されない。
:kbd:`Shift` を押しながらドラッグすると維持される。

物の寸法をより正確に制御するには、次のどちらかを選択する：

* 右クリックメニューから |Pos&SizeMenu|
* メニューから :menuselection:`F&ormat-->Text Box and Shap&e-->Position and
  Si&ze...`

|Pos&SizeTab| を使用して寸法を個別に設定しろ。:guilabel:`&Keep Ratio` がオンである場
合、比率が維持されるように縦横が変更される。

Grouping drawing objects
----------------------------------------------------------------------

図面物をグループ化することで、相対的な寸法や位置を保持したまま、複数の物を一つの
実体として扱うことが容易になる。物がグループ化されると、そのグループに対して行わ
れる編集操作はグループのすべてのメンバーに適用される。グループの一つのメンバーを
クリックすると、グループ全体が選択される。

図面物をグループ化するには：

#. 物を一つ選択し、:kbd:`Shift` を押しながらグループに含めたい他の物を選択
#. 選択した状態で物の上にマウスポインターを置き、

   * メニューから :menuselection:`F&ormat-->&Group-->&Group` を選択
   * |DrawingObjectProperties| の :guilabel:`Group` 図像をクリック
   * 右クリックメニューから :menuselection:`&Group` を選択する

.. admonition:: 読者ノート

   複数選択はこの方法では不可能だと思う。マウスでラバーバンド選択すると成功する。

.. note::

   図面物を含むグループには、埋め込みまたはリンクされた画像を含めることはできな
   い。

グループを解除または分割することなく、グループの個々のメンバーを編集することがで
きる。グループを選択し、次のいずれかを行う：

#. メニューから :menuselection:`F&ormat-->&Group-->&Enter Group` を選択
#. |DrawingObjectProperties| :guilabel:`Enter Group` 図像をクリック
#. 右クリックメニュー :menuselection:`&Enter Group` を選択

グループメンバーの編集が終了したら、次のいずれかを行え：

#. メニューで:menuselection:`F&ormat-->&Group-->E&xit Group` を選択
#. |DrawingObjectProperties| :guilabel:`Exit Group` 図像をクリック
#. 右クリックメニューから :menuselection:`E&xit Group` を選択

グループを解散するには、グループを選択し、次のいずれかを行う：

#. メニューから :menuselection:`F&ormat-->&Group-->Ungroup` を選択
#. |DrawingObjectProperties| :guilabel:`Ungroup` 図像をクリックする
#. 右クリックメニューから :menuselection:`Ungroup` を選択

Rotating drawing objects
----------------------------------------------------------------------

図面物の回転は :ref:`画像のそれ<writer11-anchor-rotating>` と同様の方法で行うこ
とが可能だ。図面物を任意の角度に回転させるには、以下のいずれかの方法をとる：

* 対話的操作。図面物を選択し、|DrawingObjectProperties| の :guilabel:`Rotate` 図
  像をクリックする。回転ハンドルが物の周囲に表示される。マウスポインターをハンド
  ルの上に合わせ、ポインターの形が変わったら、必要な角度までドラッグする。
* |Position&SizeDlg|。オブジェクトを右クリックし |Pos&SizeMenu| を選択する。ダイ
  アログボックスで :guilabel:`Rotate` タブを選択する。:guilabel:`Rotation Angle`
  区画で必要な回転を指定する。既定では、回転は物の中心周りに行われるが、別のピ
  ボット点を選択することも可能だ。

.. _writer11-anchor-map:

Creating an image map
======================================================================

画像マップは、Web アドレス、計算機上の他のファイル、または同じ文書の一部へのハイ
パーリンクを持つ画像の領域（ホットスポットと呼ばれる）を定義する。ホットスポット
はテキストのハイパーリンクに相当する画像だ。ホットスポットをクリックする
と、LibreOffice はリンク先のページを適切なプログラムで開く。たとえば |HTML| ペー
ジではブラウザーで、ODS ファイルでは LibreOffice Calc で、|PDF| では |PDF|
閲覧ソフトで。さまざまな形のホットスポットを作成したり、同じ画像に複数のホットス
ポットを含めることができる。

.. |ImageMapEditor| replace:: :guilabel:`ImageMap Editor`

|ImageMapEditor| を使うには：

#. Writer 文書でホットスポットを定義したい画像を選択する。
#. メニューから :menuselection:`&Tools-->Image&Map` を選択する。|ImageMapEditor|
   が開く。
#. ダイアログボックス内のツールやフィールド（後述）を使って、ホットスポットやリ
   ンクを定義する。
#. :guilabel:`Apply` 図像をクリックして設定を適用する。
#. 完了したら :guilabel:`Save...` 図像をクリックし 画像マップをファイルに保存し、
   ダイアログボックスを閉じる。

ダイアログボックスの主要部分にはホットスポットが定義された画像が表示される。ホッ
トスポットはその形状を示す線によって識別される。

ダイアログボックス上部のツールバーにあるツールは次のとおり：

* :guilabel:`Apply`: 変更を適用する。
* :guilabel:`Open...`, :guilabel:`Save...`, :guilabel:`Close`,
  :guilabel:`Select`.
* :guilabel:`Rectangle`, :guilabel:`Ellipse`, :guilabel:`Polygon`,
  :guilabel:`Freeform Polygon`: ホットスポットの形状を描画するツール。これらの
  ツールは |DrawingToolbar| のものと同様に機能する。
* :guilabel:`Edit Points`, :guilabel:`Move Points`, :guilabel:`Insert Points`,
  :guilabel:`Delete Points`: ポリゴンホットスポット形状を操作するための高度な編
  集ツールだ。:guilabel:`Edit Points` ツールを選択すると他のツールが活動開始す
  る。
* :guilabel:`Undo` および :guilabel:`Redo`: 直前の操作を取り消したり、取り消した
  操作を再度適用したりする。
* :guilabel:`Active`: 選択したホットスポットの状態をアクティブと非アクティブの間
  で切り替える。
* :guilabel:`Macro`: ハイパーリンクを関連付ける代わりに、ホットスポットにマクロ
  を関連付ける。
* :guilabel:`Properties`: ハイパーリンクの性質を設定し、ハイパーリンクに `Name`
  属性を追加する。

ツールバーの下部で選択したホットスポットに対して指定する：

* :guilabel:`&Address`：ハイパーリンクが指すアドレス。文書内の錨を指すことも可能。
  その場合は次の形式でアドレスを記述する：

     ``file:///<path>/document_name#anchor_name``

* :guilabel:`&Text alternative`: マウスポインターをホットスポット上に移動したと
  きに表示させたいテキストを入力する。
* :guilabel:`&Frame`: ハイパーリンクの対象を開く場所。次から選択：

  * :guilabel:`_blank` 新しいブラウザーウィンドウに開く
  * :guilabel:`_self` 自身のウィンドウに開く
  * :guilabel:`_top`
  * :guilabel:`_parent`

.. tip::

   対象枠の値 :guilabel:`_self` はほとんどの場合において機能する。したがって、ど
   うしても必要な場合を除き、他の選択肢を使うことは推奨されない。

Managing the LibreOffice Gallery
======================================================================

既定では、Gallery は Sidebar に開かれる。他の Sidebar 甲板と同様、
:guilabel:`Gallery` を浮動させることができる。:guilabel:`Gallery` を
:guilabel:`Icon View` または :guilabel:`Detailed View` で表示することが可能で、
Sidebar のバツボタンをクリックすることで :guilabel:`Gallery` を隠したり現したり
することが可能だ。

Gallery の画像は :guilabel:`Arrows`, :guilabel:`Diagrams`, :guilabel:`People` な
どのテーマごとにグループ化されている。他のグループやテーマを作成し、独自画像を追
加したり、より多くの画像を含む拡張を見つけることができる。テーマをクリックすると
その内容が :guilabel:`Gallery` ウィンドウに表示される。

.. note::

   LibreOffice に付属している既定テーマはカスタマイズ不能だが、新しいテーマを追
   加することは可能だ。カスタマイズから閉じているテーマは右クリックで簡単に認識
   できる。コンテキストメニューの唯一のオプションは
   :menuselection:`Propert&ies...` だ。

Adding a new theme to the Gallery
----------------------------------------------------------------------

例えば、会社のロゴなど、頻繁に使用する画像やその他のオブジェクトを保持するために
Gallery に独自のテーマを追加することができる。または、複数のテーマを追加し、それ
ぞれに特定のプロジェクト用の画像を保存することもできる。

Gallery に新しいテーマを追加する手順：

#. テーマの一覧の下にある :guilabel:`New...` ボタンをクリック
#. :guilabel:`Properties of New Theme` ダイアログボックスで :guilabel:`General`
   タブをクリック
#. 新しいテーマの名前を入力
#. :guilabel:`Files` タブをクリックし、次節以降の説明に従ってテーマに画像を追加
   する。

また、LibreOffice 拡張 の `Web サイト <https://extensions.libreoffice.org/>`__
から、LibreOffice にインストールされていない旧版のテーマも含め、より多くの
Gallery テーマを入手できる。拡張機能のテーマは自動的にインストールされる。

Adding objects to the Gallery
----------------------------------------------------------------------

作成したテーマに物を追加する手順：

#. テーマの名前を右クリックし、:menuselection:`Propert&ies...` を選択
#. |PropertiesDlg| で :guilabel:`Files` タブをクリック

ファイルを一度に複数追加する手順：

#. |PropertiesDlg| で :guilabel:`Find Files` ボタンを押す。
#. :guilabel:`Select Path` ダイアログボックスが開く。:guilabel:`Path` 欄にファイ
   ルのディレクトリーのパスを入力するか、ファイルのディレクトリーを探す。
#. :guilabel:`Select` ボタンを押して検索を開始する。ファイルの一覧が
   |PropertiesDlg| に表示される。ファイル型のドロップダウンリストを使用して表示
   されるファイルを絞り込むことができる。
#. 一覧に表示されているすべてのファイルを追加するには :guilabel:`Add All` をク
   リックする。それ以外の場合は、追加するファイルを選択し、:guilabel:`Add` をク
   リックする。

ファイル一つを追加する手順：

#. |PropertiesDlg| で :guilabel:`Add` をクリックして :guilabel:`Gallery` ダイア
   ログボックスを開く。
#. テーマに追加する画像を探す。
#. 画像を選択し |Open| を押してテーマに追加する。
#. |PropertiesDlg| の |OK| を押して閉じる。

Deleting images and themes from the Gallery
----------------------------------------------------------------------

テーマから画像を削除するには、Gallery の画像ファイル名またはサムネイル上で右ク
リックし、コンテキストメニューの :menuselection:`Delete` を選択する。メッセージ
が表示される。|Yes| を押す。

.. note::

   Gallery の一覧からファイル名を削除しても、そのファイルは記憶装置や他の場所か
   ら削除されることはない。

Gallery からテーマを削除するには、テーマ一覧からテーマを選択し、右クリックし、コ
ンテキストメニューの :menuselection:`Delete` を選択する。LibreOffice 組み込みの
テーマは削除不能だ。

Location of the Gallery and the objects in it
----------------------------------------------------------------------

Gallery に表示される画像およびその他の物は、計算機の記憶装置、ネットワークドライ
ブ、またはその他のリムーバブルメディアのどこにでも配置することが可能だ。Gallery
に画像を追加するときにファイルは移動もコピーもされない。新しい物の位置は単に参照
として追加される。

ワークグループでは

* 共有 Gallery: 許可されない限り、内容を変更することは不可
* 使用者 Gallery: 内容を追加、変更、削除することができる

にアクセスすることができる。

使用者 Gallery の場所は |OptionsDlg| :menuselection:`LibreOffice-->Paths` で指定
する。この場所は変更可能であり、Gallery のファイル (SDV) を他の計算機にコピーす
ることが可能だ。LibreOffice が用意している Gallery の中身は別の場所に格納され、
変更することは不可能だ。

.. note::

   LibreOffice 拡張で配布される Gallery テーマの場所は拡張の構成によって決まる。

Using Fontwork
======================================================================

Fontwork を使えば、グラフィカルなテキスト芸術品を作成し、作品をより魅力的にする
ことが可能だ。テキスト芸術品にはさまざまな設定（線、領域、位置、寸法など）がある
ので、選択の幅が広がる。

Creating a Fontwork object
----------------------------------------------------------------------

.. |FontworkToolbar| replace:: :guilabel:`Fontwork` ツールバー

#. |FontworkToolbar| [#footnote-fontwork]_ または |DrawingToolbar|
   で、:guilabel:`Insert Fontwork Text` 図像をクリックするか、メニューから
   :menuselection:`&Insert-->Font&work...` を選択する。
#. :guilabel:`Fontwork Gallery` ダイアログボックスでスタイルを選択
#. |OK| を押す。
#. Fontwork オブジェクトが文書に表示される。辺の周りの四角（物が選択されているこ
   とを示す）と色の違う点に注目しろ。これらについては
   :ref:`writer11-anchor-moving` で述べられる。
#. 角ハンドルの一つを使って物の寸法を変更するか、右クリックしてコンテキストメ
   ニューから |Pos&SizeMenu| を選択すると、より正確な寸法指定が可能。
#. Fontwork テキストを編集するには、物をダブルクリックする。物の上に表示される黒
   いテキストの代わりに、独自のテキストを入力。
#. 空いている場所のどこかをクリックするか :kbd:`Esc` を押して変更を適用。

Editing a Fontwork object
----------------------------------------------------------------------

Fontwork 物が作成されて、その属性の一部を編集することが可能だ。これを行うには次
のいずれかを用いる：

* |FontworkToolbar|
* Sidebar |PropertiesDeck| にある :guilabel:`Fontwork` 盤
* |FormattingToolbar|
* 本節で説明するメニューオプション

選択した Fontwork オブジェクトが 3D オブジェクトの場合、:guilabel:`3D-Settings`
ツールバーを使うことも可能だ。

Using the Fontwork toolbar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|FontworkToolbar| が表示されていることを確認 [#footnote-fontwork]_ する。図像を
クリックして Fontwork 物を編集する。

:guilabel:`Insert Fontwork Text`
   :guilabel:`Fontwork Gallery` を開く。
:guilabel:`Fontwork Shape`
   選択した物の形状を編集する。形状パレットから選択可能。
:guilabel:`Fontwork Same Letter Heights`
   物体内の文字の高さを変更する。

   * 通常の高さ（大文字、d, h, l など、一部の文字が他の文字より高い）と
   * すべての文字が同じ高さ

   の切り替え。
:guilabel:`Fontwork Alignment`
   文字の配置を変更する。

   * :menuselection:`Align &Left`
   * :menuselection:`&Center`
   * :menuselection:`Align &Right`
   * :menuselection:`S&tretch Justify`

   から選択できる。文字揃えの効果は、テキストが二行以上にわたる場合にのみ見え
   る。 :menuselection:`S&tretch Justify` はすべての行を完全に満たす。
:guilabel:`Fontwork Character Spacing`
   物体の文字間隔と kerning を変更する。選択肢は

   * :menuselection:`&Very Tight`
   * :menuselection:`&Tight`
   * :menuselection:`&Normal`
   * :menuselection:`&Loose`
   * :menuselection:`Very &Loose`
   * :menuselection:`&Custom...` で、小さなダイアログボックスが開き、百分率を指
     定可能。
:guilabel:`Toggle Extrusion`
   2D Fontwork 物を 3D 物に、または 3D 物を 2D 物に変更する。

Using the Formatting toolbar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Fontwork 物はさらにいくつかの属性でカスタマイズできる。物をクリックすると
|FormattingToolbar| が変化し、物をカスタマイズするための選択肢が表示される。これ
らの選択肢は本章で前述した他の図面物の選択肢と同じだ。|Draw| も見ろ。

Using menu options
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

選択した Fontwork 物を繋留、整列、配置、グループ化したり、テキストを回り込ませた
り、水平や垂直に反転させたりするには :menuselection:`F&ormat-->` メニューの選択
肢のうちいくつかを用いる。

また、Fontwork 物を右クリックし、コンテキストメニューで同じ選択肢の多くを選択す
ることも可能だ。コンテキストメニューからは :guilabel:`Line`, :guilabel:`Area`,
|Position&SizeDlg| にも素早くアクセスできる。|Position&SizeDlg| では寸法と位置に
正確な値を入力可能だ。これらのメニューの詳細については |Draw| を見ろ。

Using the 3D-Settings toolbar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

選択した Fontwork 物が 3D 物体の場合、:guilabel:`3D-Settings` ツールバーの選択肢
も使用可能だ。また、|FontworkToolbar| の :guilabel:`Toggle Extrusion` 図像をク
リックすることで、2D Fontwork 物を 3D 物に変更（またはその逆）することもできる。
詳しくは |Draw| を見ろ。

.. _writer11-anchor-moving:

Moving and resizing Fontwork objects
----------------------------------------------------------------------

Fontwork 物を選択すると、いつものように物の辺の周りに八つの四角（ハンドル）が表
示される。これらのハンドルをドラッグして物の寸法を変更できる。濃い色や色のついた
点も物体上に表示される。この点はハンドルと同じ場所にある場合もあれば、別の場所に
ある場合もある。この点の上にマウスポインターを置くと、ポインターの形が変わる。

点をさまざまな方向にドラッグして、物体を歪ませることが可能だ。

マウスポインターを物の他の部分に合わせると、ポインターは物をページの他の部分にド
ラッグするための通常の図像に変わる。

物の位置と寸法を正確に制御し、物を回転させるには |Position&SizeDlg| を用いる。

----

.. rubric:: 章末注

.. [#footnote] :menuselection:`&View-->&Toolbars-->Image`
.. [#footnote-border] |ImageDlg| の :guilabel:`Borders` タブで。
.. [#footnote-fontwork] 表示されていない場合は :menuselection:`&View-->&Toolbars-->Font&work` を選択。
.. _GIMP: https://www.gimp.org/
