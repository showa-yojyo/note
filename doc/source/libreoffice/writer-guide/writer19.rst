======================================================================
Writer Guide Chapter 19, Spreadsheets, Charts, Other Objects ノート
======================================================================

.. include:: ./abbrev.txt
.. |DDE| replace:: :abbr:`|DDE| (Dynamic Data Exchange)`

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction: OLE and DDE objects
======================================================================

物の埋め込みやリンクには |OLE| と |DDE| がある。どちらの方法でも、あるアプリケー
ション (e.g. Calc) の情報を別のアプリケーション (Writer) で使用することができ
る。|DDE| 物とリンクされた |OLE| 物の違いは、リンクされた |OLE| 物は、リンクとし
て追加された文書から編集できるが、|DDE| 物は編集できないことだ。

たとえば、Calc スプレッドシートが |DDE| 物として Writer 文書に貼り付けられている
場合、Writer 文書でスプレッドシートを編集することはできない。しかし、元の Calcス
プレッドシートが更新されると、Writer 文書で自動的に変更が行われる。スプレッド
シートがリンクされた |OLE| 物として Writer 文書にはめ込まれる場合、スプレッド
シートは Calc 文書と同様に Writer でも編集でき、両方の文書が互いに同期される。

リンクも埋め込みも、ある文書から別の文書に情報をはめ込むものだが、情報の保存方法
が異なる。物を作成したアプリケーションで開いて編集できるため、情報を直接コピー＆
ペーストするのとは異なる。

埋め込まれた |OLE| 物は他の文書からの情報の複写だ。原文書へのリンクはなく、原文
書に加えられた変更は、リンク先文書には反映されない。物を作成したアプリケーション
を編集に使用したいが、原文書の情報を編集しても |OLE| 物が更新されないようにした
い場合は、物を埋め込む。

リンクされた物は別の文書内の情報への参照だ。同じ情報を複数の文書で使用する場合は
物をリンクする。そうすれば、元の情報を変更した場合、|OLE| 物を含む文書を更新する
ためにリンクしか更新しないで済む。リンクを自動的に更新するように設定することもで
きる。物をリンクする場合、リンク元のアプリケーションとリンク先の文書へのアクセス
を維持する必要がある。どちらかの名前を変更したり移動したりした場合はリンクを再構
築する必要がある。

.. admonition:: 読者ノート

   |OLE| をシンボリックリンクのような概念だと理解して差し支えないだろう。

次の種類のファイルや文書を、|OLE| 物として Writer 文書に挿入できる：

* スプレッドシート
* 図表
* 図面
* 数式
* 紙芝居

.. admonition:: 読者ノート

   原文の a chart を図表と訳出しておく。辞書によると «a sheet of information in
   the form of a table, graph, or diagram» ということだ。

Inserting a new OLE object
----------------------------------------------------------------------

.. |InsertOLEMenu| replace:: :menuselection:`&Insert-->&OLE Object-->&OLE Object...`
.. |InsertOLEDlg| replace:: :guilabel:`Insert OLE Object` ダイアログボックス

新しい |OLE| 物を文書にはめ込むと、それは埋め込みになる。つまり、その物はその文
書でしか使用可能ではなく、Writer を使用してしか編集不能だ。

新しい |OLE| 物を文書にはめ込むには：

#. 物をはめ込みたい場所をクリックする。
#. |MenuBar| で |InsertOLEMenu| を選択する。
#. |InsertOLEDlg| で :guilabel:`Create &new` を選択する。
#. 作成する物の型を選択し、|OK| を押す。
#. 新しい |OLE| 物が編集モードで文書にはめ込まれる。Writer に表示されるツール
   バーが変わり、|OLE| 物の新規作成に必要なツールを搭載している。

.. note::

   Microsoft Windows を実行している計算機では、:guilabel:`Object Type` 一覧に
   :guilabel:`Further objects` という追加のオプションが表示される。このオプショ
   ンを選択すると、|OLE| および LibreOffice と互換性のある他のソフトウェアを使用
   して |OLE| 物を作成するためのダイアログボックスが開く。このオプションは新しい
   |OLE| 物と別のファイルから作成した |OLE| 物で使用できる。

新しい |OLE| 物が作成されると、:ref:`writer19-anchor-formatting` で述べられるよ
うに書式設定できる。

.. _writer19-anchor-inserting:

Inserting a file as an OLE object
----------------------------------------------------------------------

既存のファイル（スプレッドシートなど）を |OLE| 物として Writer 文書にはめ込む場
合、埋め込みかリンクかを選択できる。

#. ファイルを挿入したい場所をクリックし、|MenuBar| で |InsertOLEMenu| を選択する。
#. |InsertOLEDlg| で :guilabel:`Create &from file` を選択する。ダイアログボック
   スの表示が変わり、:guilabel:`File` テキストボックスが表示される。
#. :guilabel:`&Search...` を押して |OpenFileDlg| を開く。
#. 対象ファイルを探し、|Open| を押す。

   * ファイルを生リンクとして挿入し、変更が原書とこの文書の両方で同期されるよう
     にするには :guilabel:`Link to file` をオンにする。
   * ファイルの内容を表示する代わりに、ファイルを作成したアプリケーションの選択
     可能な図像を表示するには、:guilabel:`&Display as icon` をオンにする。

#. |OK| を押してファイルを |OLE| 物としてはめ込む。

ファイルを |OLE| 物としてはめ込んだ後、:ref:`writer19-anchor-formatting` にある
ように、物を整形することが可能だ。

Editing OLE objects
----------------------------------------------------------------------

作成した後やファイルからはめ込んだ後に |OLE| 物を編集する手順：

#. |OLE| 物をダブルクリックして編集モードで開く。Writer に表示されるツールバーが
   物の編集に必要なツールを載せたものに変わる。
#. 物の編集が終了したら編集モードを終了する。物の外側をどこでもいいからクリック
   しろ。
#. Writer 文書を保存する。|OLE| 物に加えられた変更も保存される。

|OLE| 物がリンクされている場合、Writer でスプレッドシートを変更すると Calc でも
変更され、Calc で変更すると Writer でも変更される。Calc のデータを使って Writer
で報告書を作成するときに、Calc を開かずにすばやく変更できるので、これは強力だ。

Creating a DDE link in Writer
----------------------------------------------------------------------

Calc から Writer への |DDE| リンクを作成する手順：

#. Writer 文書と Calc スプレッドシートの両方を開く。
#. Calc で |DDE| リンクを作成する升目を選択する。それらをコピーする。
#. Writer 文書で |DDE| リンクを作成する場所に移動する。
   :menuselection:`&Edit-->Paste &Special-->Paste &Special...` を選択。Writer に
   :guilabel:`Paste Special` ダイアログボックスが開く。
#. :guilabel:`&Selection` 一覧から :guilabel:`Dynamic Data Exchange (DDE link)`
   を選択する。
#. |OK| を押す。これで Writer にリンクが作成される。Calc スプレッドシートが更新
   されると、Writer の表組も自動的に更新される。

Spreadsheets
======================================================================

Writer文書にスプレッドシートを含めるには、上で説明したように、既存のスプレッド
シートファイルまたは新しいスプレッドシートを |OLE| 物としてはめ込むか、|DDE| 物
を作成する。

Embedding or linking a spreadsheet
----------------------------------------------------------------------

Writer にスプレッドシートを埋め込むと Calc スプレッドシートのほとんどの機能が利
用できる。Writer は複雑な計算やデータ分析を実行できる。ただし、複雑なデータや数
式を使用する予定がある場合は、別の Calc スプレッドシートでそれらの操作を実行し、
結果を埋め込んだスプレッドシートを表示するためだけに Writer を使用することをお勧
めする。

複雑な表組を作成したり、表形式でデータを表示したりするために、Writer でスプレッ
ドシートを使用する人もいる。しかし、データの複雑さによっては、Writer の表組機能
の方がより適切で、より速く使えることがよくある。|Chapter13| を見ろ。

スプレッドシートを Writer 文書に埋め込むには :ref:`writer19-anchor-inserting` の
手順をとれ。

スプレッドシート全体を文書にはめ込む際に、シートが複数含まれていて必要なシートが
見えていない場合には、スプレッドシートをダブルクリックし、下部のシートタブの行か
ら別のシートを選択する。

スプレッドシートを |OLE| 物として挿入した後は、:ref:`writer19-anchor-formatting`
にあるように書式を設定することができる。

Resizing and moving spreadsheet objects
----------------------------------------------------------------------

選択されると、スプレッドシート物は他の物と同じように扱われる。

Resizing
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スプレッドシートが占める領域の規模を変更する手順：

#. 物をクリックして、境界線に選択ハンドルを表示する。
#. マウスポインターをハンドルの上に移動する。ポインターの形が変わり、その領域に
   適用された効果が視覚的に表示される。
#. マウスの左ボタンをクリックしたままハンドルをドラッグする。角のハンドルは隣接
   する二つの辺を同時に動かし、辺の中点にあるハンドルは一度に一つの寸法を変更す
   る。

Moving
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スプレッドシート物を移動して文書内の位置を変更する方法は、Writer の他の物を移動
する方法と同じだ：

#. 物をクリックして、境界線に選択ハンドルを表示する。
#. マウスポインターを形状が変化するまで物の上で動かす。通常は手の形になる。スプ
   レッドシート物をダブルクリックして、編集モードが発動しないように注意しろ。
#. 物をクリックし、目的の位置までドラッグする。マウスボタンを離す。

Editing a spreadsheet object
----------------------------------------------------------------------

.. |FormulaBar| replace:: Formula 棒
.. |FormulaIcon| replace:: :guilabel:`Formula` 図像
.. |CancelIcon| replace:: :guilabel:`Cancel` 図像
.. |AcceptIcon| replace:: :guilabel:`Accept` 図像

スプレッドシート物を編集するには、物をダブルクリックするか、物を選択して

* |MenuBar| から :menuselection:`&Edit-->OLE Ob&ject` を選択するか、
* 右クリックしてコンテキストメニューから :menuselection:`&Edit` を選択する。

物は Writer 文書内の枠内で編集されるが、ツールバーの一部は Writer 内で変更され
る。最も重要な変更の一つは |FormulaBar| の存在だ：

* 活動中升目参照または選択升目範囲の名前を表示する :guilabel:`Name Box`.
* :guilabel:`Function Wizard` 図像。
* スプレッドシートでの編集操作に応じて、:guilabel:`Select Function` ドロップダウ
  ンメニューと |FormulaIcon|、または |CancelIcon| と |AcceptIcon| が表示される。
* 活動中升目の内容を入力または確認するための長い :guilabel:`Input Line` 欄。

ツールやメニュー項目はすぐに分かるだろう。詳しくは |Guide| または |Calc| を見ろ。

Spreadsheet organization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スプレッドシートはシートと呼ばれるページで構成されている。しかし、複数のシートを
持つスプレッドシートを Writer 文書に埋め込んだ場合、一度に表示できるのは一つの
シートに限られる。

各シートはスプレッドシートの基本単位である升目で構成されている。升目は行番号（左
側に表示）と列文字（一番上の行に表示）で識別される。例えば、左上の升目は A1, 二
行目の三番目の升目は C2 と識別される。テキスト、数値、数式を問わず、すべてのデー
タ要素は升目に入力される。

.. note::

   埋め込まれたスプレッドシートに複数のシートがある場合、編集モードを終了する
   と活動中のシートだけがページに表示される。

Working with embedded sheets
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

埋め込みスプレッドシートでシートの挿入、名前の変更、削除、編集が可能だ。まず、埋
め込みスプレッドシートをダブルクリックして編集モードで開く。編集が終了したら境界
線の外側をクリックして編集モードを終了し、変更を保存する。これらの手続きの詳細は
|Guide| を見ろ。

.. rubric:: Inserting sheets

#. シート名を右クリックして、コンテキストメニューから :menuselection:`Insert
   &Sheet...` を選択するか、Manu バーから :menuselection:`&Sheet-->Insert
   &Sheet...` を選択して :guilabel:`Insert Sheet` ダイアログボックスを開く。
#. :guilabel:`Insert Sheet` ダイアログボックスのオプションからシートの位置、はめ
   込むシートの数、シート名、使用するスプレッドシートファイルを選択する。
#. |OK| を押してダイアログボックスを閉じ、シートをはめ込む。

.. rubric:: Renaming sheets

シートタブを右クリックし、コンテキストメニューから :menuselection:`Rename
S&heet...` を選択するか、|MenuBar| から :menuselection:`&Sheet-->Rename S&heet`
を選択すると :guilabel:`Rename Sheet` ダイアログボックスが開く。

.. rubric:: Moving and copying sheets

#. シート名を右クリックし、コンテキストメニューの :menuselection:`&Move or Copy
   Sheet...` を選択するか、Manu 棒からの :menuselection:`&Sheet--> &Move or Copy
   Sheet...` で :guilabel:`Move/Copy Sheet` ダイアログボックスを開く。
#. シートを移動するかコピーするか、シートの場所と位置、新しいシート名を選択する。
#. |OK| を押してダイアログボックスを閉じ、シートを移動またはコピーする。
#. あるいは、シートタブをクリックし、埋め込みスプレッドシートの新しい位置にド
   ラッグする。

.. rubric:: Deleting sheets

#. シートタブを右クリックして、コンテキストメニューから :menuselection:`&Delete
   Sheet` を選択するか、Menu バー :menuselection:`&Sheet-->&Delete Sheet...` を
   選択する。スプレッドシートにシートが一つしか残っていない場合はそのシートを削
   除できない。
#. |Yes| を押して確定する。

Cell navigation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スプレッドシートを移動して升目を選択し活動中にするには次のいずれかを実行する：

* キーボードの矢印キーを使用する。
* キャレットを升目に置き左クリックする。
* :kbd:`Enter` を押して升目を一つ下に移動し、:kbd:`Shift` + :kbd:`Enter` で一つ
  上に移動する。
* :kbd:`Tab` を押すと升目を一つ右に移動し、:kbd:`Shift` + :kbd:`Tab` を押すと一
  つ左に移動する。

Entering data
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

升目が活動中でなければデータをそれへ入力できない。活動中の升目は枠線が太くなって
いることで簡単に識別できる。活動中升目への参照（座標）は |FormulaBar| の左端に表
示される。

#. 升目を選択して活動中にし、入力を開始する。データ入力は |FormulaBar| の入力行
   にも表示され、データ入力を読みやすくする。
#. データ、数式、関数を升目に入力するには :guilabel:`Function Wizard`,
   :guilabel:`Select Function`, |FormulaIcon| を使用する。入力が数式でない場合
   （例えばテキストや日付）は :guilabel:`Select Function` と |FormulaIcon| は
   |CancelIcon| と |AcceptIcon| に変わる。
#. 升目へのデータ入力を確定するには、

   * 別の升目を選択するか、
   * :kbd:`Enter` を押すか、
   * |FormulaBar| の |AcceptIcon| をクリックする。

Formatting cell data
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writer は通常、升目に入力された内容（テキスト、数値、日付、時刻など）の種類を認
識し、既定の書式を適用する。ただし、Writer が升目に入力されたデータの種類を誤っ
て認識した場合は、次のようにしろ：

#. 升目を選択し、右クリックしてコンテキストメニューから :menuselection:`&Format
   Cells...` を選択するか、|MenuBar| の :menuselection:`F&ormat-->Ce&lls...` を
   選択するか、キーバインド :kbd:`Ctrl` + :kbd:`1` を使う。
#. :guilabel:`Format Cells` ダイアログボックスで、適切なタブをクリックして適切な
   ページを開き、そのページのオプションを使用して升目データを書式設定する。
#. |OK| を押してダイアログボックスを閉じ、変更を保存する。

.. tip::

   Writer に数字をテキストとして扱わせ（例えば電話番号）、先頭のゼロを削除させた
   り升目内で右揃えにさせないようにするには、数字を入力する前に単引用符を入力し
   ろ。

Formatting spreadsheets
----------------------------------------------------------------------

文書で使用されているスタイルに合わせて、スプレッドシートの書式設定を変更する必要
がある場合がある。

埋め込みスプレッドシートで作業する際にも、Calc で作成した升目スタイルにアクセス
して使用することができる。ただし、Calc の升目スタイルは Writer での作業には適さ
ない場合があるため、スタイルを使用する場合は、埋め込みスプレッドシート専用の升目
スタイルを作成することをお勧めする。

.. admonition:: 読者ノート

   これは面倒くさい。この手法ではダメだ。

Manual formatting
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

埋め込んだスプレッドシートを手動で書式設定するには：

#. 升目またはその範囲を選択する。升目範囲の選択に関する詳細は |Guide| または
   |Calc| を参照しろ。
#. 選択範囲を右クリックして、升目を選択し、右クリックしてコンテキストメニューか
   ら :menuselection:`&Format Cells...` を選択するか、|MenuBar| の
   :menuselection:`F&ormat-->Ce&lls...` を選択するか、キーバインド :kbd:`Ctrl` +
   :kbd:`1` を使う。
#. さまざまなダイアログボックスページを使用して、埋め込まれたスプレッドシートを
   文書のスタイルに合うように書式設定する。
#. |OK| を押してダイアログボックスを閉じ、変更を保存する。
#. 必要であれば、ヘッダー行の二つの列を区切る線の上にマウスポインターを置き、ポ
   インターが両頭の矢印に変わるまでクリックして区切り線を新しい位置までドラッグ
   して列の幅を調整する。
#. 必要であれば、行の高さを調整する。行ヘッダーの二つの行を区切る線の上にマウス
   ポインターを置き、ポインターが両頭の矢印に変わるまで動かす。次にクリックし、
   区切り線を新しい位置までドラッグする。
#. 書式の変更に満足したら、スプレッドシートの領域外をクリックして変更を保存し、
   編集モードを終了する。

Using formatting styles
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

埋め込みスプレッドシートが編集モードの場合、Writer は Sidebar の |StylesDeck| に
スプレッドシートで使用可能なスタイルを表示する。

必要なスタイルがない場合は、作成することができる (|Chapter08|)。埋め込みスプレッ
ドシートで使用するスタイルは Writer で使用する段落スタイルに似ている。

埋め込みスプレッドシートでスタイルを使用するには、Sidebar の |StylesDeck| を開
き、升目内のデータを選択して |StylesDeck| のスタイルをダブルクリックして適用する。

Inserting and deleting rows or columns
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

埋め込みスプレッドシートに行または列をはめ込む手順：

#. 新しい列または行を挿入したい列または行を選択する。
#. |MenuBar| から :menuselection:`&Sheet-->Insert Co&lumns-->Columns &Before` な
   どを選択する。または、列または行のヘッダーを右クリックし、コンテキストメ
   ニューで:menuselection:`Insert Columns &Before` などを選択する。

埋め込まれたスプレッドシートから行または列を削除する手順：

#. 削除する行または列を強調表示する。
#. |MenuBar| から :menuselection:`&Sheet-->Delete R&ows` などを選択するか、右ク
   リックしてコンテキストメニューから :menuselection:`&Delete Rows` を選択する。

Deleting cells
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 削除する升目を選択する。
#. :menuselection:`&Sheet-->Delete C&ells...` を選択するか、:kbd:`Ctrl` +
   :kbd:`-` を押す。または、升目を右クリックし、コンテキストメニューから
   :menuselection:`De&lete...` を選択する。
#. :guilabel:`Delete Cells` ダイアログボックスで必要な選択肢を選択する。

Merging and splitting cells
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

連続する升目を一つの升目に統合する手順：

#. 結合する升目を選択する。
#. 選択した升目を

   * 右クリックし、コンテキストメニューから :menuselection:`Merge Cells` を選択
     するか、
   * |MenuBar| の :menuselection:`F&ormat-->M&erge and Unmerge Cells-->&Merge
     Cells` または :menuselection:`F&ormat-->M&erge and Unmerge Cells-->M&erge
     and Center Cells` を選択するか、
   * |FormattingToolbar| の :guilabel:`Merge and Center Cells` 図像をクリックす
     る。

   升目を結合して中央揃えにすると、升目内のすべての内容が中央揃えになる。
#. 升目にデータが含まれている場合、小さなダイアログボックスが開き、隠れた升目の
   データを移動または隠す選択肢が表示される。選択して |OK| を押す。

結合された升目群を単一の升目に分割する手順：

#. 結合された升目を選択する。
#. 次のいずれかを行う：

   * :menuselection:`F&ormat-->M&erge and Unmerge Cells-->&Unmerge Cell` を選択
   * 右クリックメニューから :menuselection:`&Unmerge Cell` を選択

   分割された升目に以前融合したデータが含まれていた場合、このデータは再度分割さ
   れない。

Charts and graphs
======================================================================

詳細は |Calc| を参照。

Inserting a chart
----------------------------------------------------------------------

図表は |OLE| 物として文書に追加することも、Writer のツールを使って追加することも
できる。

Writer のツールを使って図表を追加するには、|MenuBar| の
:menuselection:`&Insert-->&Chart...` を選択し、キャレット位置に汎用図表をはめ込
む。図表が選択され、メニューとツールバーが図表に適したものに変わる。

Selecting chart type
----------------------------------------------------------------------

.. |ChartTypeDlg| replace:: :guilabel:`Chart Type` ダイアログボックス

データはさまざまな図表を使って表現することができる。Writer には聴衆にメッセージ
を伝えるのに役立つ図表型がいくつかある。:ref:`writer19-anchor-chart-types` を見
ろ。

#. 図表が選択されていることを確認する。図表が選択されていると、枠線と選択ハンド
   ルが表示される。
#. 次のいずれかで |ChartTypeDlg| を開く：

   * |FormattingToolbar| の :guilabel:`Chart Type` 図像をクリック
   * |MenuBar| の :guilabel:`&Format-->Chart T&ype...` を選択
   * 右クリックメニューから :menuselection:`Chart T&ype...` を選択
#. 左側の一覧で選択を変えると、右側の図表例が変わる。図表の効果を見るために、
   |ChartTypeDlg| を片側に寄せることができる。
#. 図表の種類を変えると右側に他の選択項目が現れる。例えば、図表タイプには 3D と
   2D の変種の両方がある。:guilabel:`3D Look` をオンにすると、列や棒の形状を選択
   できるオプションが増える。
#. 必要な図表特性を選択し、|OK| を押して変更を保存し、編集ウィンドウに戻る。
#. 図表の書式設定を続け、データを追加するか、図表の外側をクリックして通常の表示
   に戻る。

.. _writer19-anchor-chart-types:

Chart types
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

利用可能な図表の種類を以下にまとめる。データに適した種類を選択するのに役立つ。こ
れらの型の例は |Calc| で詳しく述べられている。

.. seealso::

   :doc:`/libreoffice/calc-guide/calc03`

Entering chart data
----------------------------------------------------------------------

.. |DataTableDlg| replace:: :guilabel:`Data Table` ダイアログボックス

#. 図表を選択し、図表型を選択する。
#. 次のいずれかで |DataTableDlg| を開く：

   * |FormattingToolbar| :guilabel:`Data Table` 図像をクリック
   * |MenuBar| :menuselection:`&View-->&Data Table...` を選択
   * 右クリックメニュー :menuselection:`&Data Table...` を選択
#. |DataTableDlg| の必要な行と列の升目に情報を打ち込むか貼り付ける。ダイアログ
   ボックスの左上にある図像を使って、データの挿入、削除、移動を行うことも可能。

Adding or removing chart elements
----------------------------------------------------------------------

文書にはめ込んだ標本図表には、図表壁紙と図表凡例の二つの要素が含まれる。図表に対
して構成要素の加除修正が可能だ。

#. 図表が選択され、編集モードになっていることを確認する。
#. 図表に要素を追加するには、|MenuBar| の :menuselection:`&Insert-->` 部分メ
   ニューから要素を選択するか、図表壁または図表要素の右クリックメニューから要素
   を選択する。要素を選択するとダイアログボックスが開き、要素の選択肢を指定でき
   る。

   .. note::

      図表要素を右クリックすると、図表に要素を追加する際に選択できる選択肢が増え
      る。コンテキストメニューで利用可能な挿入選択肢の数は、選択した要素の種類に
      よって変わる。

#. 図表から要素を削除するには、削除する図表要素の右クリックメニューから
   :menuselection:`Delete` を選択する。削除する要素の種類によって、コンテキスト
   メニューの削除オプションが変わる。または、図表内の要素を選択し、:kbd:`Delete`
   または :kbd:`Backspace` を押して図表からその要素を削除する。

   .. admonition:: 読者ノート

      メニュー周りの記述が怪しい。

Chart formatting
----------------------------------------------------------------------

選択した図表の書式を変更する手順：

#. 図表が選択され、編集モードになっていることを確認する。
#. |MenuBar| の :menuselection:`F&ormat-->` から書式を設定する要素を部分メニュー
   から選択するか、図表要素の右クリックメニューから書式オプションを選択する。要
   素を選択すると、その要素の書式オプションを指定できるダイアログボックスが開
   く。

利用できる書式オプションは、図表全体が選択されているか、どの図表要素が選択されて
いるかによって異なる。

Resizing and moving charts
----------------------------------------------------------------------

図表の寸法変更や移動は、対話的に行うことも、|Position&SizeDlg| を使って行うこと
もできる。両方の方法を組み合わせて使うこともできる。

Resizing
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

図表の寸法を対話的に変更する手順：

#. 図表をクリックして選択する。図表の周囲に選択ハンドルが表示される。
#. 図表の高さを増減するには、図表の上部または下部にある選択ハンドルをクリックし
   てドラッグする。
#. 図表の幅を拡大または縮小するには、図表の左または右にある選択ハンドルをクリッ
   クしてドラッグする。
#. 図表の高さと幅の両方を同時に増減するには、いずれかの角にある選択ハンドルをク
   リックしてドラッグする。高さと幅の縦横比を保つには :kbd:`Shift` を押しながら
   クリック＆ドラッグする。

Moving
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

対話的に図表を移動する手順：

#. 図表をクリックして選択する。図表の周囲に選択ハンドルが表示される。
#. 選択ハンドル以外の図表上の任意の場所にマウスポインターを移動する。
#. 図表の形が変わったら、クリックして新しい位置までドラッグする。
#. 図表が所望の位置に来たらマウスボタンを離す。

Position and Size dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|Position&SizeDlg| を使って、図表の寸法を変更したり移動したりする手順：

#. 図表をダブルクリックして編集モードにする。
#. 次のいずれかで |Position&SizeDlg| を開く：

   * |MenuBar| の :menuselection:`F&ormat-->Position and Si&ze...` を選択
   * 図表右クリックメニューから :menuselection:`Position and Si&ze...` を選択

|Position&SizeDlg| の使い方については |Chapter11| を見ろ。

編集モード以外では、|PropertiesDlg| の |Pos&SizeTab| で、図表の位置と寸法を変更
することができる。図表右クリックメニューから :menuselection:`&Properties...` を
選択する。

Chart elements
----------------------------------------------------------------------

図表要素の個々の要素を他の図表要素とは独立して移動または寸法変更できる。例えば、
図表の凡例を他の位置に移動することが可能だ。円グラフでは、円全体を爆発するだけで
なく、円の個々の扇形を移動することが可能だ。

#. 図表をダブルクリックして編集モードにする。
#. 任意の図表要素をクリックして選択する。選択ハンドルが表示される。
#. マウスポインターを選択した要素の上に移動し、ポインターの形が変わったらクリッ
   クしてドラッグして要素を移動する。
#. 要素が所望の位置に来たらマウスボタンを離す。

.. note::

   図表が 3D の場合、丸い選択ハンドルが表示される。丸い選択ハンドルが表示されて
   いる間は、図表の寸法変更や位置変更はできない。:kbd:`Shift` を押しながらクリッ
   クすると、寸法操作用ハンドルに戻る。これで 3D 図表の寸法変更と位置変更が可能
   になる。

Changing chart area background
----------------------------------------------------------------------

図表領域は図表画像を囲む領域で、表題（あれば）と凡例を含む。

#. 図表をダブルクリックして編集モードにする。
#. :guilabel:`Chart Area` ダイアログボックスを開く：

   * |MenuBar| の :menuselection:`F&ormat-->Chart &Area...` を選択
   * 図表領域右クリックメニューから :menuselection:`&Format Chart Area...` を選
     択
   * 図表領域でダブルクリック
#. Area タブをクリックし、使用する背景塗りつぶしの種類に対応するボタンを選択す
   る。選択した塗りつぶしの種類によって、使用できるオプションが変わる。
#. 選択を行い、|OK| を押してダイアログボックスを閉じ、変更を保存する。

.. admonition:: 読者ノート

   当該項目が現れるように右クリックメニューを表示するのが難しい。マウス位置の取
   り方にコツが要る。

Changing chart wall background
----------------------------------------------------------------------

図表壁とは、図表画像を含む領域のことである。円グラフのように、壁を使用しない図表
型もある。

#. 図表をダブルクリックして編集モードにする。
#. 次のいずれかで :guilabel:`Chart Wall` ダイアログボックスを開く：

   * 図表壁を選択し、|MenuBar| の :menuselection:`F&ormat-->Chart &Wall...` を選
     択
   * 図表壁内で右クリックし、コンテキストメニューから :menuselection:`Format
     &Wall...` を選択
   * 図表壁内でダブルクリック
#. |AreaTab| をクリックし、先述のように操作する。
#. |OK| を押してダイアログボックスを閉じ、変更を保存する。

Audio and video
======================================================================

リンクされた音声ファイルや映像ファイルは Writer 文書を印刷する際には関係ないが、
文書を計算機で開いたり、|PDF| や |HTML| にエクスポートしたりする場合は、リンクを
クリックしてファイルを再生することが可能だ。

Using media files
----------------------------------------------------------------------

.. |InsertAVDlg| replace:: :guilabel:`Insert Audio or Video` ダイアログボックス

文書にメディアファイルをはめ込む手順：

#. |MenuBar| の :menuselection:`&Insert-->&Media-->Audio or &Video...` を選択し、
   |InsertAVDlg| を開く。
#. はめ込むメディアファイルを選択し、|Open| を押して物を文書に配置する。

.. tip::

   Writer で支援されている音声および映像ファイルの種類の一覧を表示するには、ファ
   イルタイプのドロップダウンリストを開く。この一覧の既定は「すべての音声および
   映像ファイル」なので、.mov のようなサポートされていないファイルを選択すること
   もできる。

Writer はメディアファイルをリンクするだけで、埋め込まない。そのため、文書を別の
計算機に移動すると、リンクはすべて解除され、メディアファイルは再生されない。これ
を防ぐには：

#. 文書に含まれるメディアファイルを、文書が保存されているフォルダーに置く。
#. 文書にメディアファイルをはめ込む。
#. 文書とメディアファイルの両方を、文書に使用する計算機に送信し、その計算機の同
   じフォルダーに両方のファイルを置く。

Using the Gallery
----------------------------------------------------------------------

Gallery からメディアクリップを直接はめ込む手順：

#. Sidebar |GalleryDeck| に行く。
#. メディアファイルを含むテーマ（例えば :guilabel:`Sounds`）を試す。
#. はめ込む映像または音声をクリックし、文書領域にドラッグする。

Media playback
----------------------------------------------------------------------

.. |MediaPlaybackToolbar| replace:: :guilabel:`Media Player` ツールバー

メディアファイルを選択すると、|MediaPlaybackToolbar| が自動的に開く。ツールバー
の既定の位置は、作業場所の最下部、|DrawingToolbar| のすぐ上だ。ただし、このツー
ルバーは入渠を解除してどこにでも配置できる。ツールバーが開かない場合
は、|MenuBar| :menuselection:`&View-->&Toolbars-->Media &Playback` を選択する。

|MediaPlaybackToolbar| には以下のツールがある：

:guilabel:`Insert Audio or Video`
   |InsertAVDlg| を開く。
:guilabel:`Play`, :guilabel:`Pause`, :guilabel:`Stop`
   メディアの再生を操作する。
:guilabel:`Repeat`
   選択すると、このツールの選択が解除されるまで、メディアは再生を繰り返す。
:guilabel:`Position`
   メディアファイル内で再生を開始する位置を選択する。
:guilabel:`Timer`
   メディアクリップの現在位置とメディアファイルの長さを表示する。
:guilabel:`Mute`
   音声を抑制する。
:guilabel:`Volume`
   メディアファイルの音量を調整する。
:guilabel:`Media path`
   計算機上のファイルの場所。
:guilabel:`View`
   映像のみ使用可能で、クリップの寸法変更が可能だ。

Formulas (equations)
======================================================================

数式の作成方法の詳細については |Math| または |Guide| を参照しろ。

Writer で数式を作成するには、|MenuBar| :menuselection:`&Insert-->OLE
&Object-->&Formula Object...` を選択する。

Writer で簡単に番号付きの数式を追加するには、AutoText 入力 `fn` を使用する：

#. 文書で改行する。
#. キーボードで `fn` と打ち込み :kbd:`F3` を押す。境界線のない二列の表が文書には
   め込まれる。左右の列に数式見本と参照番号がそれぞれ表示される。
#. 数式見本を削除し、左の列に数式を物としてはめ込む。
#. または、まず数式を文書にはめ込んでから、上記の段階を実行し、見本を上書きする。

数式を作成または編集すると、:menuselection:`Math-->` メニューが使用可能になる。

.. admonition:: 読者ノート

   このメニューが見当たらない。

数式を作成するときは、フォントサイズが文書で使用されているそれと同じになるように
注意しろ。数式物のフォント属性を変更するには、数式内をダブルクリックして編集モー
ドに入り、|MenuBar| の :menuselection:`F&ormat-->F&ont Size...` を選択する。フォ
ントの種類を変更するには、:menuselection:`F&ormat-->&Fonts...` を用いる。

Barcodes and QR codes
======================================================================

.. |QR| replace:: :abbr:`QR (Quick Response)`

Writer, Calc, Impress, Draw はバーコードや |QR| コードを生成できる。バーコードは
様々な用途に使われる。|QR| コードはバーコードの一種だ。|QR| コードには Web サイ
トやアプリケーションを示すデータが含まれていることがよくある。

#. |MenuBar| :menuselection:`&Insert-->&OLE Object-->QR and &Barcode...` を選択
   し、:guilabel:`QR and Barcode` ダイアログボックスを開く。
#. :guilabel:`&URL/Text` 欄に入力し、誤り補正係数（生成される画像の複雑さ）、周
   囲の余白の幅、符号の種類を選択し、|OK| を押す。

|QR| コードまたはバーコードが生成されたら、コード内で右クリックし、
:menuselection:`&Edit Barcode...` を選択して編集することができる。

位置や寸法、境界線、背景、錨、折り返しなど、符号の他の側面を整形するには、符号上
で右クリックメニューから選択する。詳細については |Chapter11| を参照しろ。

.. _writer19-anchor-formatting:

Formatting OLE objects
======================================================================

.. |OLEDlg| replace:: :guilabel:`OLE Object` ダイアログボックス

|OLEDlg| 使用して、スプレッドシートやその他の |OLE| 物を、枠や画像の書式設定と同
様の方法で書式設定する（位置、寸法、境界線、背景、透明度など）。物を右クリック
し、コンテキストメニューから :menuselection:`&Properties...` を選択して |OLEDlg|
を開く。
