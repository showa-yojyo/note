======================================================================
Writer Guide Chapter 16, Master Documents ノート
======================================================================

.. include:: ./abbrev.txt

.. contents:: 章見出し
   :depth: 3
   :local:

What is a master document?
======================================================================

宗主文書 (.odm) は別々のテキスト文書 (.odt) を一つの大きな文書に結合し、書式、目
次、書誌、索引、その他の資料を統一する器だ。宗主文書は通常、書籍や論文、長い報告
書など、長い文書を作成する際に使用される。

.. note::

   実際には、宗主文書はリンクされた従属文書を処理するためのいくつかの特別な
   機能を備えた Writer 文書だ。宗主文書では、印刷、|PDF| へのエクスポート、
   従来の Writer テキスト文書へのエクスポートなど、テキスト文書のすべての機能が
   利用できる。

Why use a master document?
======================================================================

宗主文書が特に有用である状況：

* ファイル容量やページ数が大きい場合。文書全体を分割して書くと、執筆、査読、編集
  が容易になる場合がある。
* 保障や信頼性の理由から、章を別々の場所に保存し、文書全体を紛失するを脅威を最小
  限に抑えたい場合。
* 長い報告書で、構造に影響を与えない範囲で、従属文書の単一集合を定期的に更新する
  必要がある場合。
* 異なる人が異なる章や文書の他の部分を執筆する場合。
* ファイルが独立した文書として発行されるだけでなく、より大きな文書の一部となる場
  合。|Writer| の各章はこの使い方の一例だ。
* 従属文書が複数の最終文書で使用される場合。

宗主文書の作成にはいくつかの方法がある。どの方法にも長所と短所がある。どの方法を選
ぶかは何を達成しようとしているかによる。この章では各方法を採用する基準を提案する
とともに説明する。

.. _writer16-anchor-navigator:

Master document Navigator
======================================================================

Writer では Navigator には形式が二つある。一つは通常のテキスト文書で使用され、
もう一つは宗主文書で使用される。

通常のテキスト文書では Navigator は文書内の図形、表組、索引項目、ハイパーリン
ク、参照、その他の項目の一覧を表示する。

.. |ToggleMasterViewIcon| replace:: :guilabel:`Toggle Master View` 図像

宗主文書では、左上の |ToggleMasterViewIcon| をクリックすることで通常ビューと宗主
ビューを切り替えることができる。宗主ビューでは Navigator は従属文書とテキスト節
を一覧表示する。宗主文書での Navigatgor の使い方については、この章の後半で詳しく
説明する：

* :ref:`writer16-anchor-step6`
* :ref:`writer16-anchor-combining`

.. note::

   宗主文書に表示されている従属文書の内容を編集することはできない。従属文書は読
   み取り専用モードで結合している。編集しようとすると警告が表示される。

   しかし、宗主文書 Navigator で従属文書の登録項目をダブルクリックすると、編集用
   に従属文書が開く。これは宗主文書の仕上げをするときに、従属文書ファイルをすば
   やく開く便利な方法だ。

Styles in master documents and subdocuments
======================================================================

それ単体で自立している文書が宗主文書にリンクされると従属文書になる。

文書は、複数の宗主文書で従属文書として使用することができる。各宗主文書は、最終文
書の体裁に影響を与える異なるスタイル定義（フォント、活字サイズ、色、ページサイズ、
余白など）を持つことができるが、個々の文書は元の特性を保持する。

宗主文書とその従属文書のスタイル間の関係：

* 従属文書で使用されている自作スタイルは、宗主文書で自動的に使用できるようにな
  る。これで宗主文書の従属文書の自作書式が保持される。
* 従属文書のスタイルは宗主文書でしか変更されないで、従属文書が編集のために開かれ
  たとき、元の従属文書のスタイルは影響を受けない。これで従属文書のスタイル仕様が
  保持される。
* 宗主文書と従属文書に同じ名前のスタイルが存在する場合（例えば `Default
  Paragraph Style` など）、宗主文書のスタイルが従属文書のスタイルを上書きする。
  これにより、宗主文書の最終結果において、すべての従属文書の内容に書式の一貫性が
  与えられる。
* 複数の従属文書が同じ名前の自作スタイルを使用している場合、リンクされる最初
  の従属文書のものが宗主文書にインポートされる。最初の従属文書の自作スタイル
  は、他の従属文書で使用されている同名の自作スタイルを上書きする。
* 従属文書で使用されている直接書式は宗主文書で保持される。

.. tip::

   宗主文書の best practice では、宗主文書とその従属文書に同じ文書雛形を使用する
   ことを推奨している。従属文書を宗主文書に読み込んだときにも、個々のファイルと
   して見たときと同じように見える。

   スタイルを変更または作成するときは、必ず雛形で変更を行え。従属文書や宗主文書
   を再度開いたときに、雛形からスタイルを更新することができる。

   宗主文書と従属文書が同じ雛形を共用していない場合、従属文書と宗主文書のすべて
   で利用可能なスタイルの集合に対して更新が必要になる場合がある。

Updating a master document
======================================================================

宗主文書は個々の従属文書をリンクするための器であるため、特に従属文書を編集した後
は、定期的に宗主文書を更新し、索引、目次、頁番号、参考文献などを更新すること
が重要だ。

.. note::

   宗主文書を開くと従属文書へのリンクを更新するよう促される。|Yes| を押すと宗主
   文書がただちに更新される。

宗主文書をいつでも更新するには、:menuselection:`&Tools-->&Update-->&Update All`
を選択するか、宗主文書 Navigator にある図像を使用する。

複雑な文書ではこの操作に時間がかかることがある。Writer がリンクファイルをすべて
調べて、すべての参照を調整した宗主文書を再構築するからだ。

.. note::

   宗主文書を保存すると、すべての従属文書が宗主文書に埋め込まれる。これにより、
   リンクされた従属文書が利用できない場合でも、宗主文書を完全に開くことができ
   る。この場合、すべてのリンクを更新するかどうか尋ねられたら |No| を選べ。

Creating a master document: scenarios
======================================================================

宗主文書を作成する最も一般的な三つの方法からどれを選ぶかは、文書の現在の状態
による：

* すでに宗主文書の雛形がある。:ref:`writer16-anchor-master-template` を参照し
  ろ。
* 既存の文書はないが、複数の章を含む長い本を、おそらく複数の著者によって執筆する
  ことになっている。
* 複数の既存の文書（章）があり、宗主文書が統括する一冊の本にまとめたい。
* 一つの既存の文書（本）を、宗主文書が統括する複数の従属文書（章）に分割したい。

以下、これらの筋書きを順番に見ていく。

Starting with a master document template
======================================================================

|Chapter10| で説明したように、以前に作成した宗主文書雛形を使って、白紙の宗主文書
を開始することができる。この雛形には、書式スタイル、文書の表紙と裏表紙、目次、そ
の他最終的な文書の一部を含めるのが理想的だ。

#. テキストや改頁が雛形からこの文書にはめ込まれている場合には、そのテキストを削
   除する。目次、索引、ヘッダーとフッターのフィールドは残せる。
#. :ref:`writer16-anchor-step6` に従って従属文書を追加する。
#. 参照、目次、頁番号、その他の自動操作が更新されるように、宗主文書を更新する。

Starting with no existing documents
======================================================================

既存の文書がない状態から始める場合、最初からすべてを思い通りに設定することができ
る。以下の順番に従え。

.. contents::
   :depth: 1
   :local:

.. _writer16-anchor-step1:

Step 1. Plan the project
----------------------------------------------------------------------

この工程にある段階のほとんどで変更は可能だが、始める前に計画を立てておけば、後で
問題を修正する手間が省ける。以下は、計画する必要がある事柄のうちのいくつかだ。

本や報告書に必要な部分宗主文書にはどのページを、従属文書には何を入れるか。下表に
示す部分を持つ本を例にとって考えてみる：

.. list-table::
   :align: left
   :header-rows: 1
   :stub-columns: 0
   :widths: auto

   * - 部位
     - 位置
   * - 表紙頁
     - 宗主文書内
   * - 著作権頁
     - 宗主文書内
   * - 目次
     - 宗主文書内
   * - 前書
     - 従属文書
   * - 第一..七章
     - それぞれの従属文書
   * - 書誌
     - 宗主文書内
   * - 索引
     - 宗主文書内

ページ、段落、文字、枠、番号スタイル
   使用するスタイルを決める。スタイルを作成または変更する方法や、図書設計におけ
   るスタイルの使用例については、|Chapter08| および |Chapter09| を参照しろ。前者
   の章で説明されているように、スタイルを使った見出しの設定には特に注意しろ。
フィールドと AutoText 登録項目
   必要に応じて対応する。考え方については |Chapter02| を見ろ。
宗主文書と従属文書用に対する一つ以上の雛形
   新しいプロジェクトを始める場合は、宗主文書と従属文書のすべてを同じ雛形から作
   成しろ。同じ雛形を使用しないと、スタイルの不一致が生じ、文書が期待どおりに表
   示されないことがある。例えば、二つの従属文書に同じ名前のスタイルがあり、それ
   ぞれの文書で書式が異なる場合、宗主文書は最初に追加された従属文書の書式を使用
   する。
頁番号
   この例では、表題ページから順に頁番号を振っている。[#writer16-footnote1]_ した
   がって、最初の章は、例えば 5 ページのような、より大きな番号のページから始ま
   る。最初の章の頁番号が 1 から始まる図書を作成するには、追加作業が必要だ。
   :ref:`writer16-anchor-restarting` を見ろ。

Step 2. Create a template
----------------------------------------------------------------------

.. |SaveAsTemplate| replace:: :menuselection:`&File-->Te&mplates-->&Save As Template...`

この文書に必要なページ、段落、文字、その他のスタイルの一部またはすべてを含む既存
の文書や雛形から雛形を作成することも、白紙の文書から雛形を作成することもできる。
雛形の詳細については |Chapter10| を見ろ。雛形を作成する際は |SaveAsTemplate| を
必ず使用しろ。

.. tip::

   宗主文書雛形を作成することもできる。:ref:`writer16-anchor-master-template` を
   見ろ。

Step 3. Create the master document
----------------------------------------------------------------------

宗主と従属文書をどのような順番で作成してもかまいないし、プロジェクトを開始すると
きにすべての従属文書を同時に作成する必要もない。新しい従属文書は、必要なときにい
つでも追加することができる。

宗主文書を次の手順で作成しろ：

.. |TemplatesItem| replace:: :menuselection:`&File-->&New-->Te&mplates...`
.. |CreateMasterDocItem| replace:: :menuselection:`&File-->Sen&d-->Create Master &Document`

#. 作成した雛形から新しい文書を開く。|TemplatesItem| を選択し、作成した雛形を選
   択して雛形を作成する。この新しい文書の最初のページが、最終文書の最初のページ
   に設定したいページスタイルに設定されていることを確認する。この例では、最初の
   ページのスタイルは表題ページだ。
#. テキストや改頁が雛形からこの文書に来た場合には、そのテキストを削除する。目次、
   索引、ヘッダーとフッターのフィールドは残せる。
#. |CreateMasterDocItem| を選択する。宗主文書をプロジェクトフォルダーに保存す
   る。この宗主文書については後ほど述べる。今のところ、開いたままでも閉じてもよ
   い。

.. note::

   :menuselection:`&File-->&New-->M&aster Document` を使用すると、既定の雛形に関
   連付けられた宗主文書ファイル (.odm) が作成される。文書が自作雛形に基づく場合、
   またはそうなる場合は、上記の方法を使用しろ。

Step 4. Create subdocuments
----------------------------------------------------------------------

従属文書は他のテキスト文書と変わらない。宗主文書にリンクされ、その内側から開かれ
たときに限り従属文書となる。従属文書は独立した文書として使用することもできる。宗
主文書の設定のいくつかは従属文書のそれを上書きするが、そのようなことは宗主文書を
通して文書を表示、操作、印刷する場合に限られる。

通常の文書を作成するのと同じ方法で従属文書を作成する：

#. |TemplatesItem| を選択し、必要な雛形を選択して、プロジェクト雛形（重要）に基
   づいた白紙の文書を開く。
#. 雛形から持ってきた不要なテキストやその他の素材を削除し、最初のページを章の最
   初のページに指定したページスタイルに設定する。
#. :menuselection:`&File-->Save &As...` を選択。文書に適当な名前を付けて、このプ
   ロジェクト用のフォルダーに保存する。

すでにいくつかの章が書かれている場合、そのファイルはこのプロジェクトのために作成
した雛形に基づいていないかもしれない。既存のファイルをそのまま従属文書として使用
することはできるが、それらのファイルに添付されている雛形を変更したいかもしれな
い。その場合は、|Chapter10| で説明されている技法を使用しろ。

Step 5. Add some pages to the master document
----------------------------------------------------------------------

作業の便宜を図るべく、次のようにする：

* 段落マークが表示されていることを確認する。:kbd:`Ctrl` + :kbd:`F10` を押す。
* テキストの境界、表組の境界、区画の境界を表示する。|OptionsDlg|
  :menuselection:`LibreOffice-->Application Colors` ページで各種選択肢をオンにす
  る。

宗主文書に、表題頁、著作権ページ、目次頁など、必要な front matter が含まれていな
い場合はただちに追加しろ。この節の例では、:ref:`先述<writer16-anchor-step1>` の
ページスタイルの順序を使用する。

#. 作成した宗主文書 (.odm) を開き、表題頁の内容を入力する。ページの最後の空白段
   落に挿入点を置き、:menuselection:`Insert-->More Breaks-->Manual Break` を実行
   する。:guilabel:`Insert Break` ダイアログボックスで、

   * :guilabel:`Page Break` と
   * 二ページ目のページスタイル `Copyright Page`

   を選択し、:guilabel:`Change page number` はオフのままにする。|OK| を押す。
#. 著作権ページの内容を入力する。ページの最後の空白の段落に挿入点を置き、同じ方
   法でもう一つ手動改頁を挿入し、今度はページスタイルを `Table of Contents` に設
   定する。
#. 目次ページで、空白の段落を一つか二つ残すか、目次を挿入する。
   [#writer16-footnote2]_ 目次は従属文書を追加するまで内容がないが、灰色の印や箱
   がその位置を示す。目次のはめ込みと書式整形については |Chapter15| を参照しろ。

.. note::

   著作権および目次ページの最初の段落（通常は見出し）のスタイル定義次第では手動
   で改頁を挿入する必要がない場合がある。

.. _writer16-anchor-step6:

Step 6. Insert the subdocuments into the master document
----------------------------------------------------------------------

これで従属文書を追加する準備ができた。

.. |InsertFile| replace:: :menuselection:`&Insert-->&File`
.. |MoveUpIcon| replace:: :guilabel:`Move Up` 図像
.. |MoveDownIcon| replace:: :guilabel:`Move Down` 図像

.. tip::

   従属文書は Navigator で強調表示された項目の前に宗主文書にはめ込まれる。最後の
   従属文書を最初に挿入し、他の従属文書を最後の従属文書の前に挿入すると、一覧の
   上下に移動することなく、正しい順序で挿入される。

#. Navigator を表示する。
#. Navigator に :ref:`宗主ビューが表示されている<writer16-anchor-navigator>` こ
   とを確認する。必要に応じて、左上の |ToggleMasterViewIcon| をクリックして通常
   ビューと宗主ビューを切り替える。
#. Navigator 上で `Text` を選択し、Navigator ツールバーの
   :menuselection:`Insert-->&File` をクリックするか、右クリックメニューの
   |InsertFile| を選択する。

   標準ファイルダイアログボックスが開く。Step 4 で作成した必要なファイルを選択
   し、|InsertFile| を選択。本書の例では章を七つ使用するのだが、上の提案に従って
   第七章を最初に読み込む。

   指定したファイルは Navigator で `Text` 項目の前にはめ込まれる。
#. `Text` には表題頁やその他の資料が含まれているので、それを強調表示してお
   き、|MoveUpIcon| をクリックして一覧の先頭に移動する。今追加した項目を強調表示
   してから |MoveDownIcon| をクリックしてもよい。
#. 挿入した従属文書を強調表示し、先ほどの要領で今度は最初の従属文書、この例では
   第一章をはめ込む。第二章、第三章と、すべての従属文書が一覧に追加されるまで繰
   り返す。複数のファイルを同時にはめ込むこともできる。
#. 宗主文書を再度保存する。

.. tip::

   Navigator で従属文書の登録項目をドラッグ＆ドロップすることで、宗主文書内の従
   属文書の順序を変更することができる。

Step 7. Add table of contents, bibliography, index
----------------------------------------------------------------------

宗主文書を使って、本の目次、書誌、索引を作成することができる。これらの項目を宗主
文書のテキスト区画に挿入する必要がある。これらの文書要素については |Chapter15|
を参照しろ。

Step 5 で目次を挿入しなかった場合は、目次を挿入する最初のテキスト区画のページに
キャレットを置き、|InsertTOCItem| を選択して目次を作成する。

宗主文書の最後にテキスト区画がない場合は、最後の従属文書の前にテキスト区画をはめ
込み、最後の従属文書の後になるように下に移動する。これで、従属文書に書誌項目が含
まれている場合、この最後のテキスト区画の書誌が入るページに挿入点を置き、書誌を作
成することができる。

.. admonition:: 読者ノート

   `Text` の新規作成は右クリックメニュー :menuselection:`&Insert-->&Text` で行
   う。

従属文書に索引項目を含めている場合は、索引が入る最後のテキスト区画のページに挿入
点を置き、索引を作成する。

.. _writer16-anchor-combining:

Combining several documents into a master document
======================================================================

既存の文書が複数ある場合、宗主文書が統括する一文書にまとめることができる。

この方法は、すべての文書が同じ雛形から作成された場合に最も効果的だが、文書が異な
る雛形から作成された場合にも使用できる。この方法は、従属文書が複数の著者によって
作成または管理されている場合に特に便利だ。例えば、短編小説の選集、研究討論会の論
文集、標準的な会社の表題頁を持つ工学的試験結果一式などを作成する場合だ。

ここでは、工学的試験結果をまとめた本を例に挙げて説明する。

.. tip::

   宗主文書雛形を :ref:`作成<writer16-anchor-master-template>` し、それをこの方
   法の出発点として使用することもできる。その場合は、Step 1, 2 を飛ばして Step 3
   から始めろ。

#. 宗主文書として使用する予定の表題頁文書を開く。この文書を宗主文書に変換する際、
   従属文書が増え過ぎないように、レベル 1 の見出しを一つにしろ。それ以上ある場合
   は、一時的に低レベルの見出しに変更し、それがどれであるかを記録しておく（例え
   ば、各見出しの末尾に米印を付け、後でレベル 1 の見出しに戻す必要があることを忘
   れないようにする）。
#. |CreateMasterDocItem| を選択し、この宗主文書に:ref:`名前を付けて保存
   <how-to-do-it>` する。

   以下の手順では原文書に対して次を仮定する：

   * `FrontPage` という名前で、レベル 1 の見出しが一つある。
   * 宗主文書を作成するときに `TestFile` という名前を付けた。

   この場合、宗主文書は一つの区画だけを含む空白のファイルだ。`TestFile1` とい
   う名前の従属文書も同時に作成され、これは `FrontPage` ファイルのテキストを含む
   .odt ファイルだ。.odm ファイルを開き、|Yes| を押してすべてのリンクを更新する
   と、このファイルが宗主文書にリンクされ、原文書の中身の用意が整う。

   `FrontPage` ファイルはフォルダーにそのまま残される。
#. 宗主文書を開き、|Yes| を押してリンクを更新する。宗主文書は既定で Navigator が
   表示された状態で開く。これがわからない場合は次を見ろ：

   * :ref:`writer16-anchor-navigator`
   * :ref:`writer16-anchor-step6`

#. |InsertFile| を選択。
#. ファイル選択ダイアログボックスで検査結果ファイル (:file:`Results1.odt`,
   :file:`Results2.odt`, etc.) の場所に移動する。最初のファイル
   :file:`Results1.odt` を選択し、|Open| を押す。ファイルが既存の項目の上に挿入
   される。
#. |MoveUpIcon| をクリックして `TestFile1` テキストを `Results1` テキストの上に
   配置する。ファイル内容が宗主文書で選択されたファイルの上にはめ込まれる。
#. 必要な検査結果ぶんだけこれを繰り返す。次のファイルを挿入するときに、宗主文書
   でどのファイルが強調表示されているかは問題ではない。はめ込まれたファイルを選
   択し、|MoveUpIcon| または |MoveDownIcon| を使用して、必要に応じて配置するだけ
   だ。
#. 宗主文書を編集し、連番と依頼人名を追加するには、宗主文書で
   :file:`TestFile1.odt` を右クリックし、コンテキストメニューから |EditC| を選択
   する。開いたファイルに必要な内容を追加し、ファイルを保存して閉じる。詳細につ
   いては :ref:`writer16-anchor-edit` を見ろ。
#. |MenuBar| で |UpdateLinksM| を選択するか、Navigator で |UpdateLinksC| を選択
   し、|Yes| を押して確定する。宗主文書の編集内容がすべて表示される。

Splitting a document into master and subdocuments
======================================================================

宗主文書と複数の従属文書に分割したい既存の文書が一つある場合、Writer で文書を見
出しで自動的に分割し、アウトラインレベルを選択することができる。

この方法は素早く簡単だが、整頓作業が必要になる場合がある。

自動的に生成される従属文書のファイル名は :samp:`maindocname{X}.odt` だ。ここで
:samp:`{X}` は 1, 2, 3, ... となる。第一章の前に `Heading 1` で始まる序章やその
他の「章」がある場合、ファイル名は章番号に直接対応しない。
:ref:`writer16-anchor-rename` を参照しろ。

.. _how-to-do-it:

分割方法：

#. 現文書を開いて |CreateMasterDocItem| を選択する。
#. :guilabel:`Name and Path of Master Document` ダイアログボックスで：

   #. 宗主文書とその従属文書を保存するフォルダーに移動する。
   #. |FileNameBox| に宗主文書の名前を入力する。
   #. :guilabel:`Styles` ドロップダウンリストで、ファイルを従属文書に分割するア
      ウトラインレベルを選択する。通常、これは `Outline: Level 1` にする。アウト
      ラインレベルの詳細については |Chapter08| を参照しろ。
   #. :guilabel:`Automatic file name extension` をオンにしたまま |Save| を押す
      と、文書が従属文書に分割され、宗主文書が作成される。

`Outline: Level 1` を選択してその段落レベルが `Heading 1` 場合、従属文書それぞれ
は `Heading 1` 段落で始まる。

.. _writer16-anchor-restarting:

Restarting page numbering
======================================================================

前の節の例では連続した頁番号を持つファイルのごく基本的な集まりを示した。これは電
子書籍を含む多くの文書に便利だが、典型的な印刷書籍では頁番号の順序は次のとおりで
だ：

* 表紙や著作権ページには頁番号を付けない。
* 本文では i から始まる小文字のローマ数字。
* 本文では 1 から始まるアラビア数字。
* 頁番号は本の残りの部分を通して連番。

このような本を作るために宗主文書を設定するには、最初の章の見出しに別の段落スタイ
ルを定義し、それに二つの特別な特性を割り当てる必要がある。

.. rubric:: Example

各章は |ParagraphStyleDlg| |TextFlowTab| :guilabel:`Breaks` 区画で設定した、新し
いページから始まる `Heading 1` 段落で始めることができる。:guilabel:`Page
&number` チェックボックスはオフであるので、番号は前のページの番号から続く。

.. |HeadingNumberItem| replace:: :menuselection:`&Tools-->Heading &Numbering...`

このダイアログボックスの |Outline&ListTab| を見て、`Heading 1` がどのアウトライ
ンレベルに割り当てられているかを確認する。通常は `Level 1` だ。このレベルは
|HeadingNumberItem| で設定されているので、ここで変更することはできない。

|HeadingNumberItem| で :guilabel:`Outline Level 1` に割り当てられる段落スタイル
は一つしかない。しかし、|ParagraphStyleDlg| |Outline&ListTab| を使えばどのアウト
ラインレベルにも段落スタイルをさらに割り当てることができる。

したがって、`Heading 1` と体裁は同じだが、本質的な違いが一つある `Heading 1
Chapter 1` というスタイルを定義したい：

#. Sidebar |StylesDeck| |ParagraphStylesTab| で `Heading 1` を右クリックし、
   :menuselection:`&New...` を選択する。|ParagraphStyleDlg| |OrganizerTab|
   で新しいスタイルに名前を付け、:guilabel:`Ne&xt style` を選択し、
   :guilabel:`&Inherit from` が `Heading 1` を示していることを確認する。
#. |TextFlowTab| :guilabel:`Breaks` 区画で :guilabel:`&Insert` をオンにし、次を
   指定する：

   .. list-table::
      :align: left
      :header-rows: 0
      :stub-columns: 0
      :widths: auto

      * - :guilabel:`&Type`
        - Page
      * - :guilabel:`&Position`
        - Before
      * - :guilabel:`With page st&yle`
        - First Page
      * - :guilabel:`Page &number`
        - 1

#. |Outline&ListTab| で :guilabel:`&Outline level` を `Level 1` に設定する。これ
   により、この見出しは他の章見出しと一緒に目次に表示される。:guilabel:`Heading
   Numbering` ダイアログボックスでアウトラインレベルが割り当てられていないので、
   この見出しの :guilabel:`&List Style` は `No List` だ。
#. 新しいスタイルを第一章の最初の段落に割り当てて完了だ。

.. _writer16-anchor-edit:

Editing a master document
======================================================================

宗主文書を作成した後、その見てくれや内容を変更したい場合がある。

Changing the appearance of the master document
----------------------------------------------------------------------

プロジェクトが発展するにつれて、雛形のスタイルを変更することができる。宗主文書や
従属文書のスタイルを変更するな。変更は雛形に加えろ。

雛形の変更で宗主文書（および従属文書すべて）を更新するには、宗主文書を開け。メッ
セージが二つ表示される：一つ目は、すべてのリンクを更新するかどうかを尋ねるメッ
セージで、二つ目は変更したスタイルを適用するかどうかを尋ねるメッセージだ。これら
のメッセージの両方に |Yes| と答えろ。

Editing subdocuments
----------------------------------------------------------------------

宗主文書の中から従属文書を編集することはできない。代わりに、宗主文書の Navigator
で従属文書をダブルクリックするか、宗主文書の外から従属文書を開く必要がある。そう
すれば、他の文書と同じように編集することができる。

従属文書の編集中に宗主文書に適用されるスタイルに変更を加えたい場合は、上節を参照
しろ。

従属文書の内容を変更する場合は、宗主文書の中から目次、書誌情報、索引を手動で更新
する必要がある。

.. _writer16-anchor-rename:

Adding, deleting, or renaming subdocuments
----------------------------------------------------------------------

従属文書を追加するには :ref:`writer16-anchor-step6` に記載されている方法を使う。

従属文書を削除するには、Navigator でファイル名を右クリックし、
:menuselection:`&Delete` を選択する。

ファイル名を変更して従属文書の名前を変更した場合、次に宗主文書のリンクを更新する
と、その従属文書は壊れたリンク（赤表示）として Navigator に表示される。これを修
正するには、ファイル名を元に戻すか（リンクは次回の更新で復元される）、以下の手順
に従え：

#. Navigator で壊れたリンクを右クリックし、:menuselection:`Edit &link` を選択す
   る。
#. :guilabel:`Edit Sections` ダイアログボックスで、名前を変更したファイルを選択
   し、区画名（Navigator に表示されている名前）を編集する。
#. |OK| を押して変更を保存する。

.. _writer16-anchor-master-template:

Creating a master document template
======================================================================

宗主文書の雛形は |Chapter10| で説明する他の雛形とほぼ同じ方法で作成する：

#. この章の前の節で説明したように、|CreateMasterDocItem| を使って宗主文書を作成
   する。
#. |SaveAsTemplate| を使って雛形 (.otm) を作成し、他の雛形と一緒に
   :guilabel:`Templates` ダイアログボックスに表示される。

.. tip::

   宗主文書雛形に付ける名前には、それが普通の雛形ではないことを示す何らかの示唆
   を含めろ。

Creating one file from a master document and its subdocuments
======================================================================

宗主文書はリンクされた従属文書を含む .odm ファイルであり、.odt 形式だ。リンクさ
れたファイルは、本のような大きな文書を書いたり編集したりするときにとても便利だが、
出版社に送るときなど、本全体の写しを一つのファイルにまとめる必要がある場合もあ
る。

宗主文書を .odt ファイルにエクスポートする方法：

#. 宗主文書を開き、すべてのリンクを更新。
#. メニューの :menuselection:`&File-->Expor&t...` を選択。
#. ファイルダイアログボックスで、書き出す .odt ファイルの名前を入力し、
   |FileTypeList| で `ODF Text Document (*.odt)` を選択する。
#. |Save| を押す。各従属文書が個別の書き込み禁止区画にある .odt ファイルが作成
   される。
#. 宗主文書を閉じ、新しい .odt ファイルを開き、すべてのリンクを更新する。
#. リンクを解除し、書き込み保護を解除するには、
   :menuselection:`F&ormat-->&Sections...` と進み、区画一覧の最初の項目を選択
   し、一覧の最後の項目を :kbd:`Shift` 押しクリックしてすべての項目を選択する。
   :guilabel:`Link` 区画 :guilabel:`&Link` と :guilabel:`Write Protection` 区画
   :guilabel:`&Protect` の両方をオフにする。
#. |OK| を押す。

区画の一部または全部を削除してプレーンテキスト文書にしたい場合は、削除したい区画
を選択し、|RemoveButton| をクリックする。区画目印だけが削除される。 |OK| を押す。

Anchoring images
======================================================================

従属文書のページに繋留されている画像（図版）は宗主文書に表示されない。宗主文書が
従属文書を照合する際にページの流れ、頁番号、相互参照を再編成するため、画像は錨参
照を失い、消えてしまう。

対照的に、宗主文書のテキスト区画のページに繋留されている画像は、そのページに留
まり、従属文書の長さが変わっても移動しない。画像は従属文書の途中のページになって
しまうことがある。

.. note::

   錨 `To page` は非推奨。使用を避けろ。

画像を特定のページに正確に配置するには、次のように画像を固定する：

#. 画像を右クリックし、コンテキストメニューから :menuselection:`&Properties...`
   を選択。
#. |ImageDlg| |Pos&SizeTab| で :guilabel:`Anchor` を非推奨項目以外のいずれかに設
   定。
#. :guilabel:`Position` 区画でページに対する適切な水平方向と垂直方向の参照を選択
   する。
#. |OK| を押して変更を保存。

----

.. rubric:: 章末注

.. [#writer16-footnote1] 表題ページのスタイルは頁番号を表示しないように定義でき
   るが、それでも一ページ目として勘定される。
.. [#writer16-footnote2] |InsertTOCItem|
