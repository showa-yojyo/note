======================================================================
Writer Guide Chapter 6, Formatting Pages: Advanced ノート
======================================================================

.. include:: ./writer-inc.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

この章は次の使い方を述べている：

* 段組
* 枠
* 表組
* 区画
* 文書内で紙の向きを変える
* 境界と背景
* 印刷用ページ行間を使う

.. tip::

   |OptionsDlg| 内の次の項目をオンにしておくとページレイアウトは容易になる：

   * |ApplicationColors| 内

     * :guilabel:`Text boundaries`
     * :guilabel:`Object boundaries`
     * :guilabel:`Table boundaries`
     * :guilabel:`Section boundaries`
   * |FormattingAidsPage| 内

     * :guilabel:`Pa&ragraph end`
     * :guilabel:`Tabs`
     * :guilabel:`Brea&ks`
     * その他の項目も

.. admonition:: 読者ノート

   第六章にして気づいたが、英単語の section を節と区画のどちらに訳すか、文脈から
   判断しないとノートにならない。章の下位要素なら節、それ以外の何かの一部分を構
   成するものなら区画としておく。

Choosing a layout method
======================================================================

最善のレイアウトとは次の要因によって異なってくる：

* どのような文書に最終的にするか
* どのような情報を文書に含めるか
* 文書を印刷物や |PDF| などの固定形式で発行するか、|HTML| や |ePub| などの可変形
  式で発行するか、複数の形式で発行するか

以下に例を挙げる。挙げた技法はすべてこの章で説明している：

* 本書のように、テキストが一列、テキストのない図式がいくつか、説明がある図式がい
  くつかある本の場合、基本的レイアウトにはページスタイルを使用し、必要に応じて説
  明テキストの横に表組を使用して図式を配置する。
* 索引やその他の文書で、テキストが二段組になっており、テキストが左側の段から右側
  の段、そして次のページへと順番に続いている場合は区画（二段組以上）を用いる。文
  書の表題（最初のページ）が全ページ幅の場合は一段の区画に入れる。
* 複雑なレイアウトの新聞で、ページ内に二列や三列の段組があり、あるページから数
  ページ後のある場所まで記事が続くような場合は基本的レイアウトにページスタイルを
  使い、リンクされた枠内に記事を配置する。必要であれば画像をページの固定位置に固
  定する。

.. tip::

   |HTML| や |ePub| など、固定されていない形式で出版する文書には最小限のレイアウ
   ト技術を使え。いくつかの方法（段組、枠、幅広表組）はこれらの形式にうまくエク
   スポートできないことがありがちだ。

Using columns to define the page layout
======================================================================

`Default Page Style` など、基本的なページスタイルは文書で用いる最も一般的なレイ
アウト（単段組または複段組）で定義することを勧める。その後、異なる段数のページに
対してページスタイルを追加的に定義可能だ。

.. note::

   単一ページに異なる数の列を組み合わせたい場合は :ref:`writer06-anchor-layout`
   で述べられるように、区画を用いる必要がある。

ページスタイルの段数を定義するには：

#. |MenuBar| の :menuselection:`F&ormat-->&Page Style...` を選択（あるいは同等のUI
   操作）
#. |ColumnsTab| に移動
#. :guilabel:`Settings` 区画で次を指定：

   * :guilabel:`Col&umns`: 段数
   * :guilabel:`Width and Spacing`: 段間隔
   * :guilabel:`Separator Line`: 段間に垂直分離線を表示するかどうか

   を指定する。Writer の組み込み段組レイアウトのいずれかを用いるか、カスタマイズ
   段組レイアウトを作成しろ。
#. |OK| を押す。

Formatting column width and spacing
----------------------------------------------------------------------

:guilabel:`Width and Spacing` 区画で :guilabel:`Auto&Width` を選択すると、等しい
幅またはあらかじめ設定された幅の段が作成される。段の幅 [#columnlength]_ と間隔を
カスタマイズするには：

#. :guilabel:`Auto&Width` をオフ
#. :guilabel:`Widt&h` 欄に各列の幅を入力
#. :guilabel:`Spacing` 行でに各段間の間隔を入力

三段以上指定する場合は :guilabel:`Column` スピンボックスの矢印ボタンを使って段間
をスクロールしろ。

Formatting separator lines
----------------------------------------------------------------------

段間に必要なのは空白だけかもしれないが、分離線を作る方法はこうだ：

#. :guilabel:`St&yle` ドロップダウンリストを使用して線のスタイルを選択
#. :guilabel:`&Width` スピンボックスで線幅を 0.25 pt から 9.0 pt の範囲で指定
#. :guilabel:`H&eight` スピンボックスで必要な線の高さを段の高さ [#columnlength]_
   に対する百分率で指定
#. 100% 未満の高さの場合、:guilabel:`&Position` ドロップダウンリストを使用して区
   切り線の垂直方向の配置を選択
#. :guilabel:`&Color` ドロップダウンリストから線色を選択

.. admonition:: 読者ノート

   次の公式を暗記しておくと何かと便利だ：

      1 point = 1/12 pica = 1/72 inch = 127/360 mm = 0.3527 mm.

Distributing text across columns
----------------------------------------------------------------------

テキストが列に追加されると、テキストはある段からその次の段に流れる。

すべての段の高さ [#columnlength]_ がだいたい同じになるようにテキストを均等に分配
するには、複数段区画を用いる。:ref:`writer06-anchor-section-columns` で述べられ
る。

.. tip::

   :menuselection:`&View-->Formatting Marks` を選択すると、段落終了マーカー
   ``¶`` が表示される。多くの場合、段の予期せぬ動作は、通常は見えないが場所を
   取っている余分な段落が原因だ。

Using frames for page layout
======================================================================

枠は、新聞やその他のレイアウトを多用する文書を作成する際に便利だ。 枠には、テキ
スト、表組、複数段、画像、その他のオブジェクトを含められる。枠には次のような用途
がある：

* ロゴやページの片隅にある「速報」のニュースボックスなど。
* ある枠の内容を別の枠にリンクすることで、あるページのテキストを次のページよりも
  離れた別のページで継続できるようにする。
* 写真などのオブジェクトにテキストを回り込ませる。

LibreOffice では枠を繰り返し用いるページスタイルが使用できないため（ヘッダーまた
はフッターに固定されている場合を除く）、必要な基本的ページレイアウトのスケッチを
作成し、さまざまな枠のおおよその位置とその目的を示すことを検討しろ。設計の混乱を
避けるため、異なるページレイアウトの数はできるだけ少なくしろ。

枠の位置には特に注意しろ。枠を配置する視覚的に効果的な方法は、枠の左余白をその上
の段落の余白と揃えることだ。これを行うには、上の段落と同じスタイルの空白の段落に
枠を挿入する：

.. |InsertFrameM| replace:: :menuselection:`&Insert-->&Frame-->F&rame...`

#. |InsertFrameM| を選択
#. |FrameDlg| |Pos&SizeTab| :guilabel:`Position` 区画で :guilabel:`Hori&zontal`
   ドロップダウンリストの:guilabel:`From Left` を選択して枠を必要な位置に正確に
   配置する。

また、折り返しの種類と枠とテキストの間隔についても考えろ。枠をテキストの近くに配
置する代わりに |WrapTab| を使って両者の間に余白を入れろ。

枠を個別に整理したり、枠スタイルを定義して適用したりするには |Writer09| を参照し
ろ。

Creating a frame
----------------------------------------------------------------------

枠を作成するには、以下のいずれかの方法を用いる：

* |InsertFrameM| を選択して空の枠を作成する。|FrameDlg| が開く。この段階で枠の特
  性を設定するか、|OK| を押してカスタマイズを後回しにする。
* テキストを選択し、|InsertFrameM| と選択して |FrameDlg| を開く。枠をカスタマイ
  ズし |OK| を押す。選択テキストは通常のテキストフローから取り除かれ、枠にはま
  る。
* :menuselection:`&Insert-->&Frame-->&Frame Interactively` を選択して空の枠をす
  ばやく描く。マウスポインターの形が変わる。クリックしてドラッグすると空の枠が描
  かれる。
* :menuselection:`&Insert-->Object-->` 以下から物の種類を選択して数式または
  |OLE| 物を挿入する。アイテムが挿入され枠内に表示される。

枠に中身を追加するには、まず、ページ上のどこか空いている場所をクリックして枠の選
択を解除する。次に枠内をクリックしてキャレットを置く。メインページと同じように中
身を追加する。終わったら枠の選択を解除する。

Frame toolbar
----------------------------------------------------------------------

枠を作成または選択すると |FrameToolbar| が表示される。既定では
|FormattingToolbar| の代わりに表示される。
:menuselection:`&View-->&Toolbars-->Frame` を使用して表示することも可能。

Moving, resizing, and changing frame attributes
----------------------------------------------------------------------

オブジェクトが Writer に追加されると、あらかじめ決められた型の枠で自動的に囲まれ
る。この枠によって、オブジェクトがページ上にどのように配置されるか、また文書内の
他の要素とどのように相互作用するかが設定される。枠を編集するには、用いる枠スタイ
ルを変更するか、文書に追加するときに手動で書式を設定する。枠スタイルについては
|Writer09| で説明。

枠の寸法や位置を変更するには、枠を選択し、マウスか |FrameDlg| を使う。マウスを
使ったほうが速いが、正確さに欠ける。

.. tip::

   大まかなレイアウトにはマウスを、微調整にはダイアログボックスを使うといい。

枠の寸法を手動で変更するには、次のいずれかの方法を用いる：

* 寸法調整ハンドルをクリックし、適切になるまでドラッグする。
* 枠に中身を追加する（例えば、大きな写真を追加すると枠は自動的に大きくなる）
* |FrameDlg| に戻り、寸法やその他の特性を設定する。

マウスを使って枠の位置を変更するには、

* 辺のいずれかをドラッグ＆ドロップするか、
* 枠の辺の上にマウスポインターを置く。

ドラッグ＆ドロップで適切に移動すると、マウスポインターが四頭矢印に変わる。

枠の寸法を変更するには、寸法調整ハンドルのいずれかをドラッグする。辺のハンドルを
ドラッグすると、テキスト枠が一次元だけ拡大または縮小され、角のハンドルをドラッグ
すると、両方の次元で拡大縮小される。

これらのリサイズ操作は比率を歪める。|Shift| を押しながらハンドルをドラッグすると
枠は同じ比率を保つ。

|FrameDlg| を開くには、枠を選択して右クリックメニューから |PropertiesC| を選択す
る。

枠の境界を追加または削除するには、次のいずれかを行う：

* |FrameToolbar| の関連ボタンをクリックしていくつかの選択肢を表示する
* |FrameDlg| を開き、|BordersTab| に移動し、:guilabel:`Line Arrangement` 区画で
  :guilabel:`Pr&esets` から :guilabel:`No Borders` を選択
* 枠に無境界スタイルを割り当てる

枠スタイルについては |Writer09| を見ろ。

.. note::

   枠の境界線と |View-->| を使って表示されるテキストの境界線
   (:menuselection:`&View-->Te&xt Boundaries`) を混同するな。

Anchoring frames
----------------------------------------------------------------------

枠を繋留させるには、枠をクリックして次のいずれかを行う：

* 右クリックして :menuselection:`Anchor-->` を指す
* |FrameToolbar| の :guilabel:`Select anchor for object` 図像をクリックして錨の
  種類を選択
* |FrameDlg| を開いて |Pos&SizeTab| を開く

繋留の種類は次のとおり（読者：ラベル表記はダイアログボックス準拠にした）

:guilabel:`To &page`
   枠はページの余白に対して同じ位置を保つ。テキストを追加・削除しても枠は動かな
   い。この方法は枠を特定のテキストと視覚的に関連付ける必要がない場合に便利だ。
   新聞など、レイアウトを多用する文書を作成する場合や、テキストをページ上で縦方
   向に中央揃えする場合によく使われる。

   このオプションは非推奨だ。
:guilabel:`To paragrap&h`
   枠は段落に関連付けられ、段落とともに移動する。余白や他の場所に配置することも
   できる。また、マスター文書で使用される文書で、テキストをページの中央に配置す
   るためにも使用される（ページに繋留された枠はマスター文書から消える）。
:guilabel:`To cha&racter`
   枠は文字に関連するが、テキストの並びにはない。段落とともに移動するが、余白や
   別の場所に配置することもできる。この方法は段落への繋留と似ている。
:guilabel:`&As character`
   枠は他の文字と同様に文書内に配置されるため、テキスト行の高さや改行に影響す
   る。テキストを追加または削除すると、枠はテキストと一緒に移動する。

   * 文中に小さな図像を順番に追加するのに便利
   * 画像を空の段落に固定し、ページ内で予期せぬ動きをさせないようにするのにも最
     適

Linking frames
----------------------------------------------------------------------

文書の異なるページにある枠同士をリンクすることができる。中身は自動的に次から次へ
と流れる。この技法は記事を別のページで続ける必要があるような新聞を設計するときに
便利だ。

.. note::

   一つの枠から複数の枠に直接リンクすることは不可能。

ある枠を別の枠にリンクさせる手順：

#. リンク元の枠を選択
#. |FrameToolbar| の :guilabel:`Link Frames` 図像をクリック
#. 次の枠（空でなければならない）をクリック

リンクされている枠を選択すると既存のリンクがかすかな接続線で表示される。リンクを
解除するには |FrameToolbar| の :guilabel:`Unlink Frames` 図像をクリックする。

リンク元枠の高さは固定だ。この高さは手動で変更することも、|FrameDlg|
|Pos&SizeTab| を使って変更することもできるが、中身の寸法に自動的に合わせることは
できない。枠連鎖の最後の枠だけがその高さを中身に合わせることが可能だ。

|FrameDlg| の次のタブ群はページは、枠スタイルのそれと同じだ。詳しくは |Writer09|
を見ろ。

* :guilabel:`Wrap`
* :guilabel:`Borders`
* :guilabel:`Area`
* :guilabel:`Columns`
* :guilabel:`Transparency`
* :guilabel:`Macro`

|FrameDlg| |OptionsTab| には選択された枠と、その枠のリンク先またはリンク元の枠の
名前が表示される。この情報は :guilabel:`Sequence` 区画で変更可能。このタブでは枠
の内容、位置、寸法を保護し、 accessibility 情報を設けるオプションも選択可能。枠
に情報内容がなく、単なる装飾である場合は :guilabel:`Decorative` をオンにする。

Using tables for page layout
======================================================================

表組を使用した一般的なレイアウトを実現する方法をいくつか。データ表組の使用につい
ては |Writer13| でやる。

Positioning information in headers or footers
----------------------------------------------------------------------

タブや枠を使う代わりに、ヘッダーやフッターで表組を使い、ページ番号や文書表題、著
者などのさまざまな要素を配置することができる。これらの要素はフィールドを使って挿
入することがよくある。|Writer17| 参照。

Creating sideheads using
----------------------------------------------------------------------

側見出しや傍注は、履歴書や計算機の利用者手引などでよく使われる。本文をオフセット
して余白（通常は左側）を作り、そこに側頭や注を配置する。最初の段落は側見出しの横
に揃えられる。

.. note::

   側見出しは |Writer09| で説明されているように、`Marginalia` 枠スタイルを使って
   枠内にテキストを配置することによっても作成可能。

Example
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

側見出しで用いる表組を作成する：

#. 表組を表示したい場所にキャレットを置く
#. :menuselection:`T&able-->Insert &Table...` を選択 (or |Ctrl| + |F12|)
#. |InsertTableDlg| で見出しのない二列一行の表組を定義する。:guilabel:`Style` で
   `None` を選択し、表組の境界線をなくす。
#. 表組右クリックメニューから :menuselection:`&Table Properties...` を選択
#. |TablePropertiesDlg| |ColumnsTab| で列幅を設定
#. |TablePropertiesDlg| :guilabel:`Table` タブの :guilabel:`Spacing` 区画で
   :guilabel:`&Above` と :guilabel:`&Below` の値を、通常のテキストの段落に定義し
   た :guilabel:`Ab&ove paragraph` と:guilabel:`Below &paragraph` の間隔と同じに
   する
#. :guilabel:`Properties` 区画でこの表組に名前を付ける
#. |OK| を押す

数字認識をオフにして、Writer がプレーンテキストであるべき数字を整形しようとしな
いようにするには：

#. 表組にキャレットを置き、|MenuBar| から :menuselection:`T&able-->&Number
   Format...` を選択
#. :guilabel:`Format Number` ダイアログボックスで :guilabel:`C&ategory` が
   :guilabel:`Text` に設定されていることを確認
#. |OK| を押す

.. tip::

   この表組形式を頻繁に用いる場合は、:menuselection:`T&able-->Auto&Format
   Styles...` を使用して表組スタイルとして保存するとよい。|Writer13| 参照。

.. _`writer06-anchor-layout`:

Using sections for page layout
======================================================================

   A :dfn:`section` is a block of text that has special attributes and
   formatting.

次のように用いる：

* テキストの書き込みを保護する
* テキストを隠秘する
* 別の文書の中身を動的に挿入する
* 文書の一部に列、余白の字下げ、背景色、背景画像を追加する
* 文書の一部の脚注と注釈をカスタマイズする

Creating sections
----------------------------------------------------------------------

.. |IndentsTab| replace:: :guilabel:`Indents` タブ
.. |SectionTab| replace:: :guilabel:`Section` タブ

区画を作成する手順：

#. 文書内の、新しい区画を挿入したい箇所にキャレットを置くか、新しい区画に配置し
   たいテキストを選択する
#. |MenuBar| で :menuselection:`&Insert-->Se&ction...` を選択
#. |InsertSectionDlg| が開く
#. |Insert| を押す

|InsertSectionDlg| にはタブが五つある：

* |SectionTab| を使用して区画の属性を設定する
* |ColumnsTab| を使用して区画を列に整形する
* |IndentsTab| を使用して区画の右余白と左余白からの字下げを設定する
* |AreaTab| を使用して区画の背景に色や画像を追加する
* :guilabel:`Footnotes/Endnotes` タブを使用して区画の脚注と巻末注をカスタマイズ
  する

ダイアログボックスを閉じる前であればいつでも、|SectionTab| 以外のタブページを
|ResetButton| を押して既定設定に戻すことが可能。|SectionTab| の変更を元に戻した
い場合は手動で行う必要がある。

Naming sections
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

区画名は :guilabel:`New Section` 一覧の名前欄に自動的に入力される。名前を
変更するには、名前を選択してその上に打ち込む。この名前は Navigator ウィンドウの
:guilabel:`Sections` 品目に表示される。区画に意味のある名前を付けるとたど
るのが簡単になる。

Linking sections
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

他の文書の内容を区画に挿入し、他の文書が更新されるたびに Writer に更新させ
ることができる。

.. note::

   他の文書の一部分しかを挿入したくない場合は、当該箇所が区画として文書内
   に存在することを確認しろ。

区画を別の文書にリンクするには、次の手順に従う：

#. ダイアログボックスの :guilabel:`Link` 区画で :guilabel:`&Link` をオン
#. ファイル名欄フィールドの右にある :guilabel:`&Browse...` ボタンをクリック
#. 必要な文書を見つけて選択し :guilabel:`Insert` ボタンをクリック。選択文書の名
   前が :guilabel:`&File name` 欄に表示される。
#. 選択文書の区画だけを挿入するには、:guilabel:`&Section` ドロップダウンリ
   ストから必要な区画を選択

リンクを自動または手動で更新するには、後述の Update links を参照しろ。

Write-protecting sections
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

区画の内容を編集できないように書き込み保護するには、:guilabel:`Write Protection`
区画で :guilabel:`&Protect` をオンにする。

.. note::

   書き込み保護は区画の内容しか保護しない。属性や書式整形は保護しない。

Password-protecting sections
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. caution::

   パスワードは高度なツールを使わないと取り戻せないので忘れてはいけない。

区画の属性や書式を特に他人に編集させないように、パスワードで区画を保護する手順：

#. :guilabel:`&Protect` と :guilabel:`Wit&h password` をオン
#. :guilabel:`Enter Password` ダイアログボックスで :guilabel:`&Password` フィー
   ルドにパスワードを入力し、:guilabel:`Con&firm` フィールドに再度パスワードを入
   力する。
#. |OK| を押す。

区画の属性や書式を編集しようとする人は、パスワードの入力を求められる。

Hiding sections
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

区画を隠秘して、画面に表示したり印刷したりしないようにすることが可能だ。隠秘条件
を指定することも可能。例えば、特定の読者からしか区画を隠秘しないことができる。試
験などの文書の生徒用および教師用のコピーを含む単一の原書を作成する場合に便利だ。

.. note::

   区画がページ唯一の中身であるか、区画がヘッダー、フッター、脚注、巻末注、枠、
   表組のセル内にある場合は、区画を隠秘することはできない。

区画を隠秘するには、ダイアログボックスの :guilabel:`Hide` 区画で
:guilabel:`H&ide` オプションを選択する。

特定の条件下でのみ区画を隠秘するには :guilabel:`&With Condition` 欄に必要な条件
を入力する。条件の入力に用いる構文と演算子は、数式の入力に用いるものと同じだ。
|Writer17| に詳細がある。

区画がパスワードで書き込み保護されている場合、表示有無を切り替えるのにパスワード
を入力する必要がある。

.. _writer06-anchor-section-columns:

Formatting a section into columns
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ページの一部を一段組にし、他の部分を二段以上にすることも可能だ。例えば、三段組の
新聞記事にページ幅の見出しを付けるような場合だ。

.. tip::

   この方法では複数段組のページでテキストを選択して一段組に変更することは不可能
   だ。代わりに、一段組のページスタイルを定義してから、そのページで二段組にした
   いテキストを選択する必要がある。

|InsertSectionDlg| |ColumnsTab| を使用して区画を列に書式設定する。

区画にテキストを追加すると、テキストはある段から次の段に流れる。次に述べる方法の
いずれかで、段全体にテキストを分配させる：

:guilabel:`Evenly distribute contents to all columns`
   このオプションを選択すると、Writer はテキストの量に応じて段の長さ
   [#columnlength]_ を調整し、すべての段がほぼ同じ長さになるようにする。テキス
   トを追加または削除すると段は再調整される。

   このオプションが選択されていない場合、段は新聞スタイルで埋まる。一段ずつ、最
   初の段から。最後の段は他のものより短くなることがある。

Indenting the section from margins
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

区画の右余白と左余白から字下げを設定するには |IndentsTab| を使う。

:guilabel:`&Before section` 欄と :guilabel:`&After section` 欄に所望の左余白と右
余白の字下げをそれぞれ入力する。タブの右側にあるプレビューがある。

Changing the background of the section
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

現在の区画の背景に色や画像を追加するには |AreaTab| を使用する。このページは、段
落、枠、表組、その他のオブジェクトの |AreaTab| と似ている。
:ref:`writer06-anchor-borders` 参照。

Customizing footnotes and endnotes in a section
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|InsertSectionDlg| :guilabel:`Footnotes/Endnotes` ページを使用して現在の区画の脚
注と巻末釈をカスタマイズする。

Customizing footnotes
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

区画の脚注に文書内の他の脚注とは別の番号を付け、その番号の書式を設定する手順：

#. :guilabel:`Footnotes` 区画で :guilabel:`Collec&t at the end of text` をオン
#. :guilabel:`&Restart numbering` をオン
#. 区画の脚注を 1 以外の番号で開始するには :guilabel:`&Start at` 欄に所望の番号
   を入力する
#. ドロップダウンリストで脚注の番号付け形式を選択

選択した番号形式にテキストを追加するには、:guilabel:`Be&fore` 欄と
:guilabel:`Aft&er` 欄を用いる。

Customizing endnotes
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

区画の巻末注を文書ではなく区画の末尾に表示するには、:guilabel:`Endnotes` 区画で
:guilabel:`C&ollect at end of section` をオンにする。

現在の区画の巻末注に文書内の他の巻末注とは別の番号を付け、その番号の書式を設定す
るには、前節の手順を :guilabel:`Endnotes` 設定に適用する。

Editing and deleting sections
----------------------------------------------------------------------

区画を編集するには |MenuBar| の :menuselection:`F&ormat-->&Sections...` を選択する。
|EditSectionsDlg| で :guilabel:`Section` 一覧の名前をクリックして編集したい区画
を選択する。

Editing section attributes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

選択した区画の名前を変更するには :guilabel:`Section` 欄に入力する。

|EditSectionsDlg| では選択した区画のリンク、書き込み禁止、隠秘の属性を編集する
ことも可能。次を参照：

* Linking sections
* Write-protecting sections
* Hiding sections

Editing the format of a section
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

選択した区画の書式を編集するには :guilabel:`&Options...` ボタンをクリックする。

|OptionsDlg| にはタブが四つある：

* :guilabel:`Columns`
* :guilabel:`Indents`
* :guilabel:`Background`
* :guilabel:`Footnotes/Endnotes`

これらのタブは前述の |InsertSectionDlg| のものと同じだ。|OptionsDlg| の
|BackgroundTab| は |InsertSectionDlg| の |AreaTab| に対応している。

* タブをダイアログボックスが開いたときの状態に戻すには |ResetButton| を押す。
* オプションの設定を保存するには |OK| を押す。

Removing sections
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

選択した区画を削除するには |RemoveButton| を押す。これによって区画の内容が削除さ
れるわけではなく、その内容は文書の一部となる。中身がリンクされていた場合は埋め込
まれる。

Updating links
----------------------------------------------------------------------

Writer はリンクされた区画を自動的に更新可能だが、リンクを手動で更新することもで
きる。保護された区画を更新するには、先に保護を解除する必要がある。

リンクを自動的に更新するように Writer を設定するには、または自動更新をオフにする
手順：

#. |OptionsDlg| を開く
#. |WriterGeneralPage| を選択
#. :guilabel:`Update links when loading` 区画でいずれかのオプションを選択：

   :guilabel:`&Always`
      リンクを含む文書を開くとプロンプトなしで自動的にリンクを更新
   :guilabel:`&On request`
      リンクを更新する前にプロンプト
   :guilabel:`&Never`
      文書を開いてもリンクを更新しない
#. |OK| を押す。

リンクを手動で更新するには：

#. リンクを含む文書を開く
#. :menuselection:`&Edit-->E&xternal Links...` を選択
#. |EditLinksDlg| の一覧から更新するリンクに対応するファイルを選択
#. :guilabel:`&Update` ボタンを押す。
#. |Close| を押す。

Removing links
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ファイルへのリンクを削除し、その内容を埋め込むには、|EditLinksDlg| で削除したい
リンクに対応するファイルを選択し、:guilabel:`&Break Link` ボタンをクリックする。
この操作では、区画内のテキストは削除されない。必要であれば、テキストを手動で削除
する必要がある。

.. _writer06-anchor-borders:

Defining borders and backgrounds
======================================================================

境界と背景は、段落、ページ、枠、区画、ページスタイル、段落スタイル、文字スタイ
ル、枠スタイルなど、Writer の多くの要素に適用可能だ。境界と背景のダイアログペー
ジはそれぞれの場合で似ている。

.. tip::

   ページ背景は用紙全体を塗りつぶすことも、余白の範囲だけを塗りつぶすこともでき
   る。|Writer09| 参照。ページ境界線はヘッダーやフッターがある場合はその部分も含
   めて、余白の範囲だけを囲む。

   表組、索引、目次、書誌にも境界線と背景をつけることができるが、背景の選択肢は
   :guilabel:`Color` か :guilabel:`Image` に限られる。

Adding a border
----------------------------------------------------------------------

枠を選択して右クリックし、コンテキストメニューから |PropertiesC| を選択す
る。|BordersTab| を選択する。

境界には成分が三つある：

* 境界がどこに来るか、
* 境界がどのように見えるか、
* 境界の周りにどれだけの空間が残されるか。

オプションとして影もある。

:guilabel:`Line Arrangement`
   境界線の位置を指定する。既定で五つ用意されているが、:guilabel:`User-defined`
   領域でカスタマイズしたい線をクリックすれば思いどおりの配置にすることが可能。
   各行は個別に整形可能。
:guilabel:`Line`
   境界のスタイル、幅、色を指定する。各性質には属性がある。選択された属性はダイ
   アログボックスの左側にある :guilabel:`User-defined` サムネイルの黒い矢印で強
   調表示された境界に適用される。
:guilabel:`Padding`
   境界と要素の内容の間にどれだけの空間を設けるかを指定する。左、右、上、下に指
   定できる。四辺の間隔を同じにするには :guilabel:`&Synchronize` をオンにする。
:guilabel:`Shadow Style`
   いつでも要素全体に適用される。

   * 影の位置 :guilabel:`Position`
   * 要素からの距離 :guilabel:`Distance`
   * 色 :guilabel:`Color`

Adding a color to the background area
----------------------------------------------------------------------

まず、枠を選択して右クリックメニューから |PropertiesC| を選択する。|FrameDlg| で
|AreaTab| を選択し :guilabel:`Color` を選択する。パレットから選択するか、新しい
色を作成し、|OK| を押して背景に適用する。

.. tip::

   選択された単語やその他の文字の場合、背景は *highlighting* と呼ばれる。選択肢
   は :guilabel:`Color` か :guilabel:`None` のみ。

Adding an image to the background
----------------------------------------------------------------------

背景に画像を追加するには |AreaTab| を選択し、:guilabel:`&Image` を押す。左側の一
覧から選択するか、独自の画像を追加する。

LibreOffice から供給されている画像を使うには、サムネイル一覧からそれを選ぶ：

#. :guilabel:`Options` 領域で画像の配置を選択する：

   :guilabel:`Style`
      カスタムの位置、寸法、敷き詰め、引き伸ばし。
   :guilabel:`Size`
      幅と高さを指定する。選択した寸法に合わせて画像を伸縮させるには
      :guilabel:`Scale` を選択する。
   :guilabel:`Position`
      画像を表示する位置を選択する。
#. |OK| を押して画像を背景に適用する。

画像を追加またはインポートするには：

#. :guilabel:`Add / Import` ボタンをクリックする。:guilabel:`Import` ダイアログ
   ボックスが開く。
#. 選択した画像が、左側のサムネイル一覧と |AreaTab| 右側のプレビュー欄に表示され
   る。

Adding a gradient, pattern, or hatch to the background
----------------------------------------------------------------------

背景にグラデーション、パターン、線影を追加するには、|AreaTab| を選択し、必要な背
景型を選択する。ダイアログボックスにその型の選択肢が示され、右側にプレビューされ
る。一覧から必要な意匠を選択するか、この枠に用いる新しい意匠を作成する。|OK| を
押して背景に適用する。

グラデーション、パターン、線影の定義については *Draw Guide* を参照しろ。

Deleting a color, gradient, image, or other background
----------------------------------------------------------------------

背景を削除するには、|FrameDlg| |AreaTab| で :guilabel:`&None` ボタンを押す。

Adjusting the transparency of the background
----------------------------------------------------------------------

透明度は、透かし [#watermark]_ を作成したり、色や画像を淡くしたりするのに便利だ。
|TransparencyTab| を使って透明度の種類を定義する。選択の詳細については *Draw
Guide* を参照。

Using document themes
======================================================================

文書テーマは、さまざまな書式選択を集合にまとめ、二回のクリックで適用および変更で
きる。テーマカラーは LibreOffice 7.6 で実装された。フォントと書式の設定は後のリ
リースで実装される予定だ。本節はテーマカラーについての紹介だ。

LibreOffice にはテーマカラーの集合がいくつか用意されており、他の集合を定義するこ
ともできる (|Writer20|)。

* テーマカラーには `Dark 1`, `Light 1`, `Accent 1` などの名前がある。
* テーマカラーはスタイルで用いることも手動で適用することも可能。

テーマを用いるように文書を設定するには、通常のカラーパレットではなく、テーマカ
ラーパレットからフォント、背景、オブジェクトの色を選択する。パレットの最初の行に
はテーマカラーが含まれ、他の行には修正が含まれる。

テーマカラーを変更するには、|MenuBar| の :menuselection:`F&ormat-->Theme` を選択
し、|ThemeDlg| で別のテーマを選択する。テーマカラーとして定義された色は文書内で
変更される。スタイルを変更したり、オブジェクトを個別に変更したりする必要はない。

Using page line-spacing for printing
======================================================================

ページ行間は二ページが隣り合わせになるような印刷文書 （本やパンフレットなど）や、
複数段組のレイアウト、両面印刷を意図した文書で特に有用だ。

ページ行間を用いるには、ページスタイルと段落スタイル、または含める個々の段落のオ
プションを選択する必要がある。

To enable a page style for page line-spacing
----------------------------------------------------------------------

ページ行間に含めるページスタイルは、それぞれ個別に有効にする必要がある。

#. 以下のいずれかの方法で、選択したページスタイルの |PageStyleDlg| を開く：

   * そのスタイルを使用している任意のページで右クリックメニューから
     :menuselection:`&Page Style...` を選択
   * そのスタイルを使用している任意のページで、|MenuBar| から
     :menuselection:`F&ormat-->&Page Style...` を選択
   * |Sidebar| |StylesDeck| に移動し、上部にある |PageStylesTab| を選択
#. |PageTab| の :guilabel:`Layout Settings` 区画で :guilabel:`Use page
   li&ne-spacing` をオン
#. :guilabel:`Reference &Style` を指定
#. |OK| を押す。

.. note::

   :guilabel:`&Reference Style` では、そのスタイルで指定された行間隔を使用して、
   目に見えない垂直（組版）格子を設定する。:guilabel:`Page li&ne-spacing` が効い
   ている段落では、フォントサイズや画像の有無にかかわらず、その行間隔が使用され、
   テキスト行の下端が次の格子行に揃う。Writer は隣接する段、対向するページ、用紙
   の両面に印刷されるテキストの基準線をこの見えない格子に合わせる。

   選択された :guilabel:`&Reference Style` またはそれを継承したものを持つすべて
   の段落は自動的にページ行間が有効になる。

To enable paragraph styles for page line-spacing
----------------------------------------------------------------------

#. |Sidebar| の |StylesDeck| で有効にする段落スタイルを右クリックし |EditStyleC|
   を選択
#. |ParagraphStyleDlg| で |Indents&SpacingTab| を開く
#. :guilabel:`Activate page li&ne-spacing` をオンにして段落スタイルでページ行間
   を有効にする。オフにすると段落スタイルでページ行間が無効になる。ページスタイ
   ルでページ行間が無効になっている場合、このオプションは無効だ。

To enable paragraphs for page line-spacing
----------------------------------------------------------------------

#. 有効化したい段落をすべて選択し、|MenuBar| から :menuselection:`F&ormat-->
   P&aragraph...` を選択する
#. |ParagraphDlg| で |Indents&SpacingTab| を開く
#. 以下同様

----

.. rubric:: 章末注

.. [#columnlength] （読者注）横読みの文書なら、段の幅と高さはそれぞれ画面に対し
   て水平方向と垂直方向。
.. [#watermark] ページ背景にロゴやテキストを表示するもので、会社名や Draft など
   の文言を表示する。
