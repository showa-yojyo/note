======================================================================
Calc Guide Chapter 3, Creating Charts and Graphs ノート
======================================================================

.. include:: ./calc-inc.txt

.. contents:: 章見出し
   :depth: 2
   :local:

Introduction
======================================================================

次の入門書を読んで情報を視覚的に表現するのに効果的な方法を学ぶといい：

* Cleveland, W. S. (1994). *The Elements of Graphing Data* (2nd ed.). Hobart
  Press.
* Tufte, E. R. (2001). *The Visual Display of Quantitative Information* (2nd
  ed.). Graphics Press.

Chart Wizard
======================================================================

|ChartWizard| は統計図表のたたき台を生成するのに用いるのであって、調整などは後か
らやる。

Overview of Chart Wizard
----------------------------------------------------------------------

#. 名前、区分、ラベルなど、統計図表に含めるデータすべてを含む升目を選択する。
#. |InsertChartM| を選択。
#. |ChartWizard| で統計図表種別やその他の選択肢を決定する。
#. |Finish| を押す。

Selecting chart type
----------------------------------------------------------------------

基本的な統計図表型が十種類ある。既定の統計図表は 2D Column 型だ。ダイアログボッ
クス右側の枠内に選択された変種が強調表示される。

統計図表種別を変更する手順：

#. :guilabel:`Choose a Chart Type` 欄で統計図表種別を選択する。
#. 必要なら右枠内の変種を選択する。
#. 3D 統計図表を使うには :guilabel:`3D Look` をオンにする。

   * さらに :guilabel:`Realistic` か :guilabel:`Simple` を選択する。
   * Column, Bar, Pie, Area 統計図表に限り有効なオプションだ。
#. :guilabel:`&Next-->` を押して後述要素に変更を加える。
#. |Finish| を押す。

Selecting data range
----------------------------------------------------------------------

|ChartWizard| の二段階目で自動選択された対象範囲を手動で修正する。

#. 必要ならば :guilabel:`Data range` 欄のセル参照を変更する。
#. データ系列を行と列のどちらに並べるかを指示する。
#. 最初の行、列をラベルとして用いるかを選択する。
#. :guilabel:`&Next-->` を押して後述要素に変更を加える。
#. |Finish| を押す。

Selecting non-adjacent data
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

隣接していないセル複数からデータ範囲を作成するには、セル範囲とセル範囲をカンマや
セミコロン区切りで併記する。

.. code:: text

   $Sheet1.A1:A5,$Sheet1.D1:D5

区切り文字は次の設定ダイアログボックスオプションから設定、確認する：

* |LanguagesPage| :guilabel:`Locale setting`
* |FormulaPage| :guilabel:`Array co&lumn`

Linking to external data
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

外的データ源にリンクする機能がある。これにより、外部データが変更されると、統計図
表が自動的に更新する。

リンクできるファイルの種類は：

* HTML
* Calc
* Base
* CSV
* Excel
* 登録済みのデータ源

|Calc11| 参照。

Selecting data series
----------------------------------------------------------------------

|ChartWizard| の三段階目でデータを微調整する。各データ系列は共通データ集合が含ま
れる。この段階では各データ系列の入力範囲を変更し、統計図表でのデータ表現方法を整
理する。不要なデータ削除や軸に沿うデータのプロット方法の指定を含む。

Organizing data series
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

統計図表が期待どおりに描かれていない場合、最初に確認することは：

* データ系列すべてが正しく定義されている。
* データが行か列か。
* 最初の行か列をラベルとみなしている。

データ系列それぞれの名前は :guilabel:`Data &series` 一覧に表示される。これを整理
するには、項目を指定し、次の操作を一つ以上行う：

* データ系列の名前を変更する。右側の :guilabel:`&Data ranges` 内
  :guilabel:`Name` を選択して :guilabel:`Ran&ge for Name` 欄でセル参照を編集。
* データ系列区分のセル参照を変更する。:guilabel:`&Categories` 欄でセル参照を編
  集。
* データ系列を追加する。:guilabel:`&Add` ボタンを押して、それから新規データ系列
  のデータ範囲を定義する。
* データ系列を削除する。対象データ系列を選択後 :guilabel:`&Remove` ボタンを押
  す。
* データ系列の順序を入れ替える。:guilabel:`↑` または :guilabel:`↓` を押す。

異なるデータ系列は個別の列または行でなければならない。

Setting data series ranges
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

本文では最初のパラグラフで値と区分の区別を理解しろとある。

* 統計図表のほとんどは値データと区分データの両方を必要とする。
* 区分と値はそれぞれ X 軸と Y 軸に沿ってプロットされる。
* 散布図と泡図では例外的に両軸に値データを使用する。

特定の統計図表型に定義することができるデータ範囲は :guilabel:`&Data ranges` 欄に
表示される。

:guilabel:`Border Color` および :guilabel:`Fill Color` は空欄にすると既定の色が
採用される。明示的に RGBA 値を指定しても条件付き書式を用いてもよい。

前ページで :guilabel:`Data series in &columns` と :guilabel:`&First row as
label` がオンの場合、選択データの列ラベルがデータ系列名であるとみなされる。同様
に、:guilabel:`Data series in &rows` と :guilabel:`F&irst column as label` がオ
ンの場合、選択データの行ラベルがデータ系列名であるとみなされる。

先述のように、:guilabel:`Name` ではデータ系列名を変更する。

:guilabel:`Y-Values` は数値であり、縦軸に沿ってプロットされがちだが、必ずしもそ
うとは限らない。

:guilabel:`Categories` は区分データ範囲を定義する。

統計図表の種類によっては標準以外にもデータ範囲を定義する場合がある。

Selecting chart elements
----------------------------------------------------------------------

四段階目は統計図表要素ページだ。見出し、副見出し、軸名、格子を追加または変更する。

|Finish| を押すとウィザードは終了するが、統計図表は灰色の枠で示された編集モード
のままであり、まだ修正することがかなう。編集モードを終了するには図式の外側のセル
をクリックしろ。

Using the Sidebar to change chart settings
======================================================================

統計図表の性質を |Sidebar| で調整可能だ。開き方は：

* :menuselection:`&View-->Sidebar` 実行
* |Ctrl| + :kbd:`F5` 押し

|Sidebar| の内容は統計図表が選択されているか、編集モードであるかによって異なる。

* 選択時は |PropertiesDeck| は :guilabel:`Area` から始まる。
* 編集モードでは |PropertiesDeck| は :guilabel:`Chart Type` から始まる。

Modifying charts
======================================================================

統計図表の容貌を調整するための方法を見ていく。変更内容に応じて次のいずれかの方法
で修正する：

* 統計図表をクリックしてそのオブジェクト性質を編集する。寸法、シート内での位置、
  整列、枠、等。
* 編集モード。データ選択、統計図表種、軸、見出し、データ系列、ラベル等々を変更す
  る。

Overview of using edit mode
----------------------------------------------------------------------

* 統計図表にない要素を追加するには :menuselection:`&Insert-->` 以下のコマンドを
  実行する。
* 見出し、軸名、壁（背景）、凡例の位置や寸法を変更するにはまず対象をクリックす
  る。マウスポインターの絵が変わったらドラッグする。
* ダイアログボックスや |MenuBar| などの基本的な方法で要素を修正する。
* 見出しと軸名はダブルクリックで文言を修正。その他の項目テキストはシート上のデー
  タ内のテキストを修正。
* 列や棒などをクリックして関連データ系列を選択、編集する。

Entering edit mode
----------------------------------------------------------------------

統計図表を編集するにはダブルクリック、または右クリックメニューから
:menuselection:`&Edit` を選択する。

* 統計図表に灰色枠が現れる。
* 統計図表編集モードに入ると、|MenuBar| と |FormattingToolbar| が変化する。

以降の当分の間は統計図表編集モードにおける挙動が記されている。

Insert menu
----------------------------------------------------------------------

Wizard で指定したことがある項目とそうでない項目がある。そうでないものを記すと、

* :menuselection:`-->&Grids...`: 各軸の大格子と小格子の表示切り替えオプション
* :menuselection:`-->Tre&nd Line...`: 回帰線指定
* :menuselection:`-->Mean &Value Lines`: データ系列に対する平均値線を表示
* :menuselection:`-->X Error &Bars`, :menuselection:`-->Y Error &Bars`: 後述す
  る。

Format menu
----------------------------------------------------------------------

* テキスト系の要素に対するコマンドを実行すると、それ用の書式設定ダイアログボック
  スが開く。
* 曲線系の要素に対するコマンドを実行すると、|LineTab| のみを有するダイアログボッ
  クスが開く。
* :menuselection:`-->Chart Wall...` 系コマンドを実行すると、その枠、内部、透明度
  を指定するダイアログボックスが開く。
* :menuselection:`-->Chart T&ype...`: 統計図表種別を変更する。2D でも 3D でも。
* :menuselection:`-->&3D View...`: 3D 統計図表専用コマンド。
* :menuselection:`-->Format &Selection...`: 選択要素に対応する設定ダイアログ
  ボックスが開く。塗りつぶし、枠、位置、透明度、フォント、ラベル、尺度……。
* :menuselection:`-->Arrange&ment-->`: Z-order 昇降操作。

Formatting toolbar
----------------------------------------------------------------------

:guilabel:`Select Chart Element` ドロップダウンリストは当ツールバー固有の |UI|
であって、これを用いると統計図表要素を簡単に選択可能だ。

Selecting and moving chart elements
======================================================================

Selecting chart elements
----------------------------------------------------------------------

編集モード中、マウスで統計図表中の要素をピックするのにはコツがいる。

Moving chart elements
----------------------------------------------------------------------

* 点やデータ系列を個別に移動させることは不可能だが、円グラフは例外で可能だ。
* 一部の要素は矢印キーで微小距離だけ移動させることが可能。
* 3D 統計図表要素を選択すると丸いハンドルが表示されることがある。角度を制御。さ
  らにクリックすると、四角いハンドルになり、寸法や位置を制御。

Changing chart type
======================================================================

先述のように |FormatChartTypeM| を実行しろ。

Titles, subtitles, and axis names
======================================================================

* 統計図表の題名、副題、軸ラベルを設定するには |InsertTitlesM| でダイアログを開
  く

Creating or changing text
----------------------------------------------------------------------

見出し、副見出し、軸名のテキストを変える方法はこれまで見てきたとおりだ。

統計図表作成時になかったものを作成したい場合には、

#. 編集モードに入って
#. |InsertTitlesM| を実行し
#. :guilabel:`Titles` ダイアログボックスで対応する空欄を埋めて
#. |OK| を押す。

Formatting text
----------------------------------------------------------------------

見出し、副見出し、軸名のテキストの書式設定手順：

#. 編集モードに入って
#. :menuselection:`F&ormat-->&Title-->` のいずれかのコマンドを実行
#. 開いたダイアログボックスで書式設定項目を指定
#. |OK| を押す。

Legends
======================================================================

凡例が表示されると、データ系列名と棒、線、点などの視覚表現が表示される。回帰直線
と平均線がオンになっている場合は、凡例内にも表示される。

Positioning, inserting, or deleting legends
----------------------------------------------------------------------

* |Sidebar| :menuselection:`Elements-->Legend` 区画
* 統計図表編集モード |MenuBar| |InsertLegendM|

Inserting or deleting only
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

編集モードに入って次のいずれかを実行しろ：

* |FormattingToolbar| :guilabel:`Legend On/Off` ボタンを押す
* 統計図表右クリックメニュー :menuselection:`Insert &Legend` または
  :menuselection:`Delete &Legend` を実行

Positioning, inserting, and deleting
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ダイアログボックスを使って凡例を配置し、挿入や削除を行う：

#. 編集モードに入る
#. |InsertLegendM|
#. :guilabel:`&Display Legend` オンオフ
#. オンの場合はラジオボタンの項目を選択する
#. |OK|

より精密な配置には先述の数値入力ダイアログボックスを利用しろ。

Formatting legends
----------------------------------------------------------------------

#. 編集モードに入る
#. :menuselection:`F&ormat-->&Legend...`
#. :guilabel:`Legend` ダイアログボックスで項目指定
#. |OK|

Formatting chart backgrounds
======================================================================

統計図表の背景は次の三つに分類される：

* chart area
* chart wall
* chart floor

これらに対する枠、領域、透明度オプションを設定する手順（領域の場合で記すが、残り
も同様）：

#. 編集モードに入る
#. :menuselection:`F&ormat-->Chart &Area...` を実行
#. |BordersTab|, |AreaTab|, |TransparencyTab| それぞれから所望の設定を選択
#. |OK|

Data range and series
======================================================================

データ範囲の定義と変更、二次 Y 軸へのデータ整列、データ系列の見てくれの書式設定
など。

Changing data ranges
----------------------------------------------------------------------

スプレッドシートで（データそのものではなく）データ範囲が変化した場合、その変更を
反映するように統計図表設定を変更しろ。

Replacing data by dragging
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

データセットを別のものに手動で置き換える方法：

#. マウスで新規データすべてを選択
#. データを統計図表上にドラッグ＆ドロップ
#. 開いた :guilabel:`Change Source Data Range` ダイアログボックスで最初の列また
   は行にラベルを含むかどうかを指定
#. |OK|

Modifying the data range and data series
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 編集モードに入る
#. :guilabel:`F&ormat-->Data Ranges...` 実行でダイアログボックスを開く
#. :guilabel:`Data Range` タブでデータ範囲を指定し直す
#. |DataSeriesTab| でデータ系列を指定し直す
#. |OK|

Opening the Data Series dialog
----------------------------------------------------------------------

#. 編集モードに入る
#. 統計図表中のデータ系列をクリックするか、|FormattingToolbar| の
   :guilabel:`Select Chart Element` ドロップダウンリストからデータ系列を選択する
#. |FormatSelectionM|

これで |DataSeriesDlg| が開く。|UI| は統計図表種別によって変わる。

Alignment, spacing, and plot options
----------------------------------------------------------------------

.. _calc03-anchor-aligning:

Aligning data to secondary Y axis
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* データ単位や尺度が異なる場合には二次 Y 軸が使えることがある。
* 円グラフとネット図ではデータ系列を二次 Y 軸に揃えることは不可。

データ系列を二次 Y 軸に揃える手順：

#. 対象データ系列を |DataSeriesDlg| で開く
#. |OptionsTab| で :guilabel:`Secondary Y axis` をオン
#. |OK|

Spacing and plot options
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|DataSeriesDlg| |OptionsTab| が含む統計図表種別に応じた追加設定：

:guilabel:`&Spacing`
   時間などの区分設定間の柱または棒の間隔を設定する。100% 以上の値は間隔を広げ、
   100% 以下の値は間隔を狭める。最大間隔は 600% だ。
:guilabel:`&Overlap`
   特定の時間など、同じ区分設定内の列や棒の重なりを設定する。百分率が大きいほど
   重なりは大きくなる。負の百分率は分離を増加させる。
:guilabel:`Show &bars side by side`
   オンにすると区分間の間隔に柱や棒の隙間を見えなくする。このオプションをオンに
   しないと、二次 Y 軸に整列されたデータが他のデータを隠すことがある。これを防ぐ
   ためにこのオプションを有効にする。
:guilabel:`Connec&tion lines`
   積み上げ柱および百分率柱（縦棒グラフ）の場合、これをオンにして柱レイヤーを線
   で結ぶ。
:guilabel:`Plot missing values`
   統計図表の種類に応じた選択肢で、欠損値の取り扱いを指定する。
:guilabel:`Include &values from hidden cells`
   隠れ升目のデータを含めるかどうかを設定できるようにする。
:guilabel:`&Hide legend entry`
   選択データ系列の名前と凡例との出し入れをできるようにする。

円グラフやドーナツ図の場合、隠し升目の値を含めるオプションに加えて、さらに二つの
オプションが利用できる：

:guilabel:`Orientation`
   扇形（データ点）の順序を時計回りまたは反時計回りに指定する。
:guilabel:`Starting Angle`
   最初の扇形（データ点）の開始角度を 0 度から 359 度の範囲で指定する。円周上の
   小さな点をドラッグするか、度数を入力する。最初の扇形を 3 時の位置から開始する
   には 0 度、12 時の位置から開始するには 90 度を指定する。

.. admonition:: 読者ノート

   これを検証するには、いったん作成した統計図表の型を柱状重やドーナツに変更して
   ダイアログボックスの |OptionsTab| を確認する。

Area, transparency, and borders
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

整形用タブは見ればわかるから割愛。

Lines, areas, and data point icons
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

折れ線図や散布図などでは |OptionsTab| と |LineTab| しかない。

.. admonition:: 利用者ノート

   折れ線プロットで点線や破線を使うのはおそらく悪手だ。見せられたものではない。

Assigning colors
----------------------------------------------------------------------

データ系列の表示色は次の三つの方法で指定する：

* 既定の配色を変更する
* |DataSeriesDlg| を使用する
* データ範囲を使って枠線と塗りつぶしの色を設定する

Changing default color scheme
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

オプション設定 :menuselection:`Charts-->Default Colors` で各データ系列色を指定す
る。ここでの設定色が以降に作成する統計図表の既定色を決定する。

Using Data Series dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

先述のように |DataSeriesDlg| で線、領域、境界線に色を割り当てる。

Using data ranges to assign colors
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

``COLOR`` 関数というものがあり、|DataSeriesTab| で境界線と塗りつぶし色のデータ範
囲に対して数値を割り当てる。

色を直接割り当てるというより、条件付き書式を使用して、特定の色を使用する際の基準
を定義するほうが色指定としての関数の使い方として自然か。

.. code:: text

   =IF(B2>100,COLOR(240,240,0,20),COLOR(150,0,150,20))

Formatting data points
----------------------------------------------------------------------

列や棒などの見てくれを調整するには :guilabel:`Data Point` ダイアログボックスを使
え。

#. 編集モードに入る
#. 対象データポイントをゆっくりと二度クリックする。四角いハンドルが示される。
#. |FormatSelectionM|
#. 所望オプションを適用
#. |OK|

統計図表内のデータ点にマウスポインターがホバーすると、当該点番号、系列番号、デー
タ点の X 値と Y 値がツールチップで示される。

Axes
======================================================================

Add or remove axis labels
----------------------------------------------------------------------

値や区分の軸ラベルを追加削除するには |AxesDlg| を用いる。

#. 編集モードに入る
#. :menuselection:`&Insert-->&Axes...`
#. チェックボックスを操作
#. |OK|

このダイアログボックスで Secondary 項目各種を選択すると、プロットの反対側に同一
内容のラベルが示される。これらに対して異なる単位や間隔を指定する方法は後述。

データ系列を二次 Y 軸揃えにすることも可能。

Edit and format axes
----------------------------------------------------------------------

|AxesDlg| はより広範なオプションを有する。選択軸、統計図表種別、2D/3D によってオ
プション集合が決まる。

#. 編集モードに入る
#. :menuselection:`F&ormat-->A&xis-->` のいずれかを実行
#. 適当なタブをクリックして必要な変更を行う
#. |OK|

以下、各ページのオプション説明。

Defining scales
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|ScaleTab| では一次軸に対して自動生成された尺度を修正したり、二次軸に対して一次
軸とは異なる尺度を与えたりする。このタブの内容も統計図表種別により変化する。

:guilabel:`&Reverse direction`
   軸に沿って低い値と高い値の順序を定義する。選択されていない場合、X 軸は低い値
   を左に、Y 軸は低い値を下に表示する。
:guilabel:`&Logarithmic scale`
   軸を対数的に細分化する。対数尺度では軸の格子線は互いに等距離になるが、線間の
   値は等しくない。互いに大きく異なる値を扱う場合に用いる選択肢だ。
:guilabel:`&Minimum` / :guilabel:`Ma&ximum`
   軸の最初 / 最後の値を設定する。このオプションを手動で設定するには
   :guilabel:`&Automatic` をオフにする必要がある。
:guilabel:`Ma&jor interval`
   軸の主要分割間の間隔を定義する。間隔目印 [#todo1]_ と格子線に使用される。この
   オプションを手動で設定するには :guilabel:`Au&tomatic` をオフにする必要がある。
:guilabel:`Minor inter&val count`
   主要区間を細分する区間数を定義する。手動で設定するには :guilabel:`Aut&omatic`
   をオフにする必要がある。

統計図表の種類によっては、追加オプションが利用できる場合もある：

:guilabel:`T&ype`
   ラベルをテキストにするか、日付にするか、自動的に検出するかを指定する。
:guilabel:`R&esolution`
   日付の場合、間隔を日、月、年のいずれかに指定する。

.. tip::

   X 軸が期待通りに時間を表示しない場合は、|ScaleTab| で最小時刻と最大時刻を手動
   で入力すると問題が解決することがある。

Positioning axis, labels, and interval marks
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|PositioningTab| は軸ラベルと間隔印の位置を制御する。

:guilabel:`Axis Line`
   横軸が縦軸と交差する場所を設定する。選択肢は `Start`, `End`, `Value`
   だ。`Value` が選択されると、さらにドロップダウンメニューが表示され、必要な値
   を選択できる。
:guilabel:`Labels`
   :guilabel:`&Place labels` ドロップダウンリストを使用して軸ラベルを配置する場
   所を設定する。`Outside start` および `Outside end` は負数の軸にラベルを配置す
   るのに便利だ。
:guilabel:`Interval Marks`
   * :guilabel:`Major` / :guilabel:`Minor` は大小間隔目盛を表示するかどうかを指
     定する。これらの間隔は前述の |ScaleTab| で定義する。
   * :guilabel:`Inner` / :guilabel:`Outer` は間隔目盛を軸の内側と外側のどちらに
     配置するかを指定する。両側にも置ける。
   * :guilabel:`Place &marks` は目盛をどこに配置するかを指定する。

.. admonition:: 読者ノート

   :guilabel:`Place &marks` ドロップダウンリストは `Outside end` モードでないと
   活動しない？

Line tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|LineTab| は |DataSeriesDlg| のそれと同じ内容だ。ただし :guilabel:`Icon` 区画が
ない。

Label tab
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:guilabel:`Label` タブはラベル表示の切り替えと、ラベルが統計図表内に収まらない場
合の処理を指定する。

:guilabel:`Sho&w labels`
   軸ラベルを見せるかどうかを設定する。
:guilabel:`Order`
   X 軸または Y 軸上のラベルの水平または垂直方向の配置を定義する。これらのオプ
   ションは 2D 統計図表に限り利用可能。

   * :guilabel:`&Tile` は軸上のラベルを並べて配置する。
   * :guilabel:`St&agger odd` は偶数が奇数より下になるようにする（縦軸では偶数が
     左）。
   * :guilabel:`Stagger &even` は奇数が偶数より下になるようにラベルをずらす（縦
     軸では奇数が左）。
   * :guilabel:`A&utomatic` は自動的に軸上にラベルを配置する。

   .. note::

      図が小さ過ぎてラベルの表示に問題が生じることがある。図を大きくするか、フォ
      ントを小さくするかして、これを避けろ。

:guilabel:`Text flow`
   軸ラベルでテキストがどのように流れるかを決定する。

   * :guilabel:`O&verlap` は軸ラベルの重なりを許可する。
   * :guilabel:`&Break` はテキストを改行し、使用可能な空白でテキストを改行できる
     ようにする。
:guilabel:`Text Orientation`
   ラベルテキストの方向と向きを定義する。

   * :guilabel:`Ve&rtically stacked`: テキストが上から下に読まれるように、文
     字を垂直に積み重ねる。
   * ABCD 車輪の指示器をクリックしてドラッグすることで、テキストの向きを定義す
     る。文字列 `ABCD` の向きが新しい設定に対応する。
   * :guilabel:`&Degrees`: ABCD 車輪によって決定された、またはスピンボックスに度
     数を手動で入力したテキストの方向角度を表示する。
   * :guilabel:`Te&xt direction`: |CTL| を使用するテキストの方向を指定する。[#todo2]_

Numbers
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:guilabel:`Numebrs` タブは軸で用いられる数値の属性を指定する。スプレッドシートで
の書式どおりでよい場合と、ここで独自に書式設定したものを採用したい場合がある。前
者ならば :guilabel:`So&urce format` をオンにする。

|UI| は |Calc04| で習ったものと同様。

Font and Font effects
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

こちらも |Calc04| と同様。

Asian Typography
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

こちらも |Calc04| と同様。

Hierarchical axis labels
----------------------------------------------------------------------

複数階層区分を統計図表軸に沿って階層的に表示することが可能。階層軸ラベルは初期指
定が適切ならば自動生成される。

.. admonition:: 利用者ノート

   本書のデータ表を再現して統計図表を Wizard で作成するといい。最上位階層に空白
   升目を置く必要があるのが気になる。

Data labels
======================================================================

データラベルは統計図表内のデータ点の側に情報を表示するものだ。詳細な情報を表示す
るときに特定のデータを強調するのに便利なものだ。

Adding and formatting data labels for a data series
----------------------------------------------------------------------

#. 編集モードに入る
#. データ系列を選択する（クリックか :guilabel:`Select Chart Element` ドロップダ
   ウンリスト）
#. 例えば |MenuBar| |InsertDataLabelsM| で |DataLabelsDlg| を開く
#. オプション（後述）を選択する
#. :guilabel:`&OK...`

|DataLabelsDlg| のほとんどのタブは既出のものと同じだが、:guilabel:`Data Labels`
タブはこの機能専用のものだ。

:guilabel:`&Category` をオンにすると、冒頭の機能を実現できることがわかる。

Data labels for individual data point
----------------------------------------------------------------------

すべてのデータ点ではなく、特定のものにデータラベルを貼ることが適切なことがある。
乱雑さを抑え、重要なデータを強調したい。

Adding a single data label
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 編集モードに入る
#. データ点をクリックし、もう一度ゆっくりクリックする
#. 右クリックメニュー :menuselection:`&Insert Single Data Label`

Formatting the label for a single data point
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

同じような操作で右クリックメニュー :menuselection:`Format &Single Data Label...`
を実行する。UI は前述のもの。

Removing data labels
----------------------------------------------------------------------

本節の操作は統計図表編集モードであることを必要とする。

Removing all data labels from a single data series
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

データ系列のどこかを右クリックして :menuselection:`Delete Data Label&s` を実行す
る。

Removing a data label from a single data point
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 上述のようにデータ点をクリック
#. 右クリックメニュー :menuselection:`Delete Single Data &Label`

Removing all data labels
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. データラベルやデータ系列が選択されていないことを確認
#. |MenuBar| |InsertDataLabelsM| を選択
#. ダイアログボックスで削除するデータラベルのオプションをすべてオフにする
#. |OK| を押す

Chart Data Tables
======================================================================

統計図表が表現する基礎データをその下に自動的に表形式で配置、表示するという機能
だ。このデータ表が統計図表 X 軸ラベルの代わりになる。網図と円グラフ以外で使用可
能。

Inserting a chart data table
----------------------------------------------------------------------

#. 編集モードに入る
#. :menuselection:`&Insert-->Data Tabl&e...`
#. :guilabel:`Show data tabl&e...` をオン
#. |OK|

Removing a chart data table
----------------------------------------------------------------------

:guilabel:`Show data tabl&e...` をオフにするか、統計図表内のデータ表右クリックメ
ニューから :menuselection:`Delete Data &Table` を実行。

Modifying the properties of a chart data table
----------------------------------------------------------------------

:guilabel:`Data Table` ダイアログボックスの説明。割愛。

データ表に対して |FormatSelectionM| を実行可能。

Grids
======================================================================

方眼紙の設定。軸に沿って区間を分割する。円グラフ以外で有効。

* 数字の付いた濃い線が太線。
* その間の薄い線が細線。

Adding/removing grid lines
----------------------------------------------------------------------

#. 編集モードに入る
#. :menuselection:`&Insert-->&Grids...`
#. :guilabel:`Major Grids` と :guilabel:`Minor Grids` の各オプションをオンまたは
   オフ
#. |OK| を押す

または |FormattingToolbar| の :guilabel:`Horizontal Grids` または
:guilabel:`Vertical Grids` をオンオフ。

水平、垂直という言葉は統計図表種別によっては紛らわしいかもしれない。

Formatting grids
----------------------------------------------------------------------

関連ダイアログボックスがもう一つある：

#. 編集モードに入る
#. :menuselection:`F&ormat-->&Grid-->` 各種コマンド
#. 書式オプションを設定する
#. |OK| を押す

3D charts
======================================================================

.. admonition:: 利用者ノート

   本章最後に残す。

Setting 3D look
----------------------------------------------------------------------

柱グラフ、棒グラフ、円グラフ、面グラフを 3D 統計図表として表示することができる。
図表を 3D にする設定は |ChartWizard| の最初のページにある。図表が作成されている
場合は次の操作で 3D にすることが可能だ：

#. 編集モードに入る
#. 以下のいずれかを行う：

   * |FormatChartTypeM| に進む
   * |FormattingToolbar| :guilabel:`Chart Type` 図像をクリック
   * 図表内で右クリックメニューから :menuselection:`Chart T&ype...` を選択
#. |ChartTypeDlg| で :guilabel:`&3D Look` を選択する。
#. 隣接するドロップダウンリストから `Simple` または `Realistic` を選択する。
#. 柱グラフと棒グラフの場合は、:guilabel:`Shape` を `Bar`, `Cylinder`, `Cone`,
   `Pyramid` から選択する。
#. |OK| を押して閉じる。
#. 必要であれば、図表の外側をクリックして編集モードを終了する。

Formatting 3D view
----------------------------------------------------------------------


3D 統計図表に変更を加えるには |3DViewDlg| を使う。ここでは透視図法、見てくれ、照
明などの 3D 設定を変更する。図表が 3D 表示に設定されている必要がある。
|3DViewDlg| を開くには：

#. 編集モードに入る
#. 以下のいずれかを行う：

   * :menuselection:`F&ormat-->&3D View...` に進む
   * |FormattingToolbar| :guilabel:`3D View` 図像をクリック
   * 図表内で右クリックメニューから :menuselection:`&3D View...` を選択
#. 必要な変更を加える。
#. |OK| を押して閉じる。
#. 必要であれば、図表の外側をクリックして編集モードを終了する。

このダイアログボックスにはタブが三つある。次に説明する。

Rotation and perspective
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|PerspectiveTab| を用いた、3D 図表を回転させたり、透視図法を変更したりすることに
ついてのヒント：

* すべての角度を 0 にして図表を正面から見る。円グラフとドーナツ図は円で描かれる。
* :guilabel:`&Right-angled axes` をオンにすると、図表は X, Y 方向にしか回転しな
  くなる。

* X を 90 度、Y と Z を 0 度に設定すると、図表上部からの眺めとなる。X を -90 度
  に設定すると図表の下からの眺めになる。
* 回転は X, Y, Z の順番に適用される。
* 陰影処理が有効な場合（下記参照）、図表が回転すると光がそこに固定されているかの
  ように回転する。
* 回転軸は図表の軸ではなく、ページに常に相対する。これは他のいくつかの図表プログ
  ラムとは異なる。
* 平行投影を使用するのとは対照的に、カメラレンズを通してのような中心遠近法で図表
  を眺めるには :guilabel:`&Perspective` をオンにする。スピンボックスで焦点距離を
  設定するか、数値を直接打ち込む。100% の設定では図表の遠端は近端の約半分の大き
  さに見える。

.. admonition:: 読者ノート

   座標軸周りに数珠つなぎに回転を指定する方式なので、ベクトル指定にしか馴染みが
   ない使用者には厳しいものがある。

Rotating 3D charts interactively
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|3DViewDlg| |PerspectiveTab| を使うほかに、次の手順で 3D 統計図表を対話的に回転
させることができる：

#. 編集モードに入る
#. 図表壁面を一度クリックして選択し、丸い選択ハンドルを表示させる。ポインターが
   回転図像に変わる。
#. マウスボタンを押したまま、希望の方向にドラッグする。図表輪郭が破線で表示され、
   結果が想像しやすくなる。
#. |OK| を押して閉じる。
#. 必要であれば、図表の外側をクリックして編集モードを終了する。

.. admonition:: 読者ノート

   モデリングソフト風で良い。

Appearance
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|3DViewDlg| の :guilabel:`Appearance` タブを使用して、3D 図表のデータの見てくれ
を一部変更する。

まず、:guilabel:`Sche&me` ドロップダウンリストからレンダリングスキームを
`Realistic` または `Simple` から選ぶ。選択スキームによって選択肢と光源が設定され
る。選択スキームによっては、選択肢がすべては使用できない場合がある。自作スキーム
を作成するには :guilabel:`&Shading`, :guilabel:`&Object borders`,
:guilabel:`&Rounded edges` の組み合わせをオンまたはオフにする。

ヒント：

* 曲面のレンダリングに Gouraud 法を使用するには :guilabel:`&Shading` をオンにす
  る。オフならば各ポリゴンに単一の色と明るさが適用される。辺は見えるが、ソフトグ
  ラデーションやスポットライトは不能だ。陰影処理の使い方については |Draw| を見
  ろ。
* :guilabel:`&Object borders` をオンにすると辺に沿って線が描かれる。
* :guilabel:`&Rounded edges` をオンにすると箱形状の辺が滑らかになる。

Illumination
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

3D ビューの光源を制御するには |3DViewDlg| :guilabel:`Illumination` タブを用いる。

その選択肢とヒント：

* 光源ボタン八個のいずれかを押して指向性のある光源のオンオフを切り替える。
* 最初の光源はハイライトのある鏡面光を差す。
* 既定では二番目の光源がオンになっている。これは七つある通常の一様な光源の最初の
  ものだ。他の光源を有効にするには、それぞれのボタンを二度押す。
* 選択した光源について、光源ボタン群の下にある最初のドロップダウンリストから色を
  選択する。または、隣のボタンを押して |PickColorDlg| を使って色を選択する。すべ
  ての光の輝度値が加算されることに気をつけろ。複数の光を有効にする場合は暗い色を
  使え。
* プレビューは光源の再配置の効果を示す。
* 選択された各光源は指定された色の小さな球体として現れる。光源が積極的に選択され
  ている場合、球は大きくなる。
* 各光源は最初は物体の中央を指す。垂直スライダーを動かして照明の角度を調整しろ。
  水平スライダーは物体を中心に光を回転させる。さらに、光源をクリックし希望の場所
  にドラッグしろ。
* プレビューの右下隅にあるボタンを押して、内部照明モデルを球体と立方体の間で切り
  替えろ。
* :guilabel:`Ambient` ドロップダウンリストを使用してすべての方向から均一な強度で
  輝く環境光を定義する。または、隣のボタンを押し、|PickColorDlg| を使って色を選
  択する。

照明の設定については |Draw| を見ろ。

Trend and mean value lines
======================================================================

* Calc には、直線、対数、指数、累乗、多項式、移動平均など、回帰の種類が豊富に用
  意されている。
* 回帰線は円グラフ、網グラフ、泡グラフ、株価図を除くすべての 2D 統計図表に追加可
  能。
* 凡例には回帰線が自動的に含まれる。

回帰線が意味を持つ統計図表で利用するのが自然だ。

Adding and modifying trend lines
----------------------------------------------------------------------

回帰線は一度に一つのデータ系列に追加する。

#. 編集モードに入る
#. データ系列を選択する（先述）
#. :menuselection:`&Insert-->Tre&nd Line...` でダイアログボックスを開く
#. 回帰種別と必要なオプションを選択（後述）
#. |OK|

Regression types
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

横軸変数と縦軸変数に ``x`` と ``f(x)`` がそれぞれ既定で使われている。回帰線ダイ
アログの :guilabel:`X Variable Name` および :guilabel:`Y Variable Name` を変え
ろ。

関数の概形は :guilabel:`Moving Average` 以外ならば名前からわかる。

データ系列一つに対して複数の回帰線を追加することが可能。

Trend line options
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. |Rsup2| replace:: R:sup:`2`

:guilabel:`Trendline &Name`
   凡例で数式を表示する際に使用する名前を指定する。
:guilabel:`Extrapolate &Forward` / :guilabel:`Extrapolate &Backward`
   回帰線を前進または後退させる単位数を指定する。これは X 軸に区分ではなく数値を
   持つ図表にしか機能しない。
:guilabel:`Force &Intercept`
   線が指定された値で Y 切片になるように強制する。
:guilabel:`Show E&quation`
   方程式を図表内に示す。
:guilabel:`Show &Coefficient of Determination |Rsup2|`
   決定係数を図表内に示す。多項式で表示。
:guilabel:`&X Variable Names` / :guilabel:`&Y Variable Names`
   図表内に方程式を表示するための X または Y 変数の名前を変更できるようにする。
   これらを有効にするには :guilabel:`Show E&quation` をオンにする必要がある。

回帰線を選択すると情報が |StatusBar| に表示される。

Formatting trend lines
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* 回帰線の色は最初に挿入されたときは対応するデータ系列と同じだ。
* 回帰線のスタイルを変更するには、|TrendLineDlg| の |LineTab| を用いる。オプショ
  ンは容易に理解可能。

Formatting trend line equations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|TrendLineDlg| |TypeTab| で :guilabel:`Show E&quation` をオンにすれば統計図表内
に回帰線方程式が示される。

回帰線方程式を整形する手順：

#. 統計図表をダブルクリックして選択し、編集モードに入る。統計図表は灰色枠で囲ま
   れる。
#. 次のいずれかの操作を行って :guilabel:`Equation` ダイアログを開く：

    * :guilabel:`Select Chart Element` ドロップダウンリストで方程式を選択し、
      |FormattingToolbar| の :guilabel:`Format Selection` 図像をクリックするか、
      |MenuBar| の |FormatSelectionM| を選択する。
    * 方程式を右クリックし、:menuselection:`&Format Trend Line...` を選択する。
#. ダイアログで必要なオプションを選択する。オプションは自明であるか、簡単に調べ
   られる。:guilabel:`Numbers` タブには |AxesDlg| のそれと同じオプションがある。
#. |OK| を押してダイアログを閉じる。
#. 必要であれば、統計図表の外側をクリックして編集モードを終了する。

Deleting trend lines
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 編集モードに入る
#. 回帰線をクリックして |Del| キーを押すか、右クリックメニュー
   :menuselection:`Delete Tre&nd Line` を実行
#. |OK|

Mean value lines
----------------------------------------------------------------------

平均値線は回帰線の特殊型だ。データ系列の平均値の水平線が統計図表内に引かれる。

Inserting mean value lines
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

データ系列すべてに対して平均値線を引く手順：

#. 編集モードに入る
#. |InsertMeanM| 実行

単一データ系列に対して平均値線を引く手順：

#. 編集モードに入る
#. データ系列を一つ選択する（先述の方法による）
#. |InsertMeanM| か右クリックメニュー :menuselection:`Insert Mean &Value Line`
   を選択

Modifying mean value lines
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

平均値線は作成時点では対応するデータ系列と同じ色だ。スタイル変更方法は：

#. 編集モードに入る
#. :guilabel:`Mean Value Line` ダイアログボックス開く。方法は：

   * 右クリックメニュー :menuselection:`&Format Mean Value Line...`
   * 平均値線をピックして |FormatSelectionM|

#. 所望の変更を与える
#. |OK|

UI の意味は回帰線のものと同じだ。

Deleting mean value lines
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 編集モードに入る
#. データ系列を一つ選択する（先述の方法による）
#. |Del| を押すか右クリックメニュー :menuselection:`Delete Mean &Value Line` 実
   行

Error bars
======================================================================

誤差棒は 2D 統計図表のみに作成できる。

Inserting error bars
----------------------------------------------------------------------

データ系列が選択されていない場合は、データ系列すべてに X または Y の誤差棒が挿入
される。

#. 編集モードに入る
#. |InsertXErrorsM| か |InsertYErrorsM| を選択
#. ダイアログでオプション（後述）を指定
#. |OK| を押す

単一データ系列に対して誤差棒を示すには、それを選択状態にしてから上述の手順をとれ
ばいい。

Error Bars dialog options
----------------------------------------------------------------------

:guilabel:`Error Category` では選択肢を一つ選ぶ。

* :guilabel:`&None` は削除コマンド用項目（後述）
* :guilabel:`&Constant Value` は誤差を正負の定数で表示する。これらの値は
  :guilabel:`Parameters` 区画で指定する。
* :guilabel:`&Percentage` は誤差をデータ点に対する百分率で示す。これも
  :guilabel:`Parameters` 区画で指定する。
* ラジオボタンの第三項目はドロップダウンリストになっている。

  * :guilabel:`Standard Error`
  * :guilabel:`Standard Deviation`
  * :guilabel:`Variance`
  * :guilabel:`Error Margin` は :guilabel:`Parameters` 区画で指定する許容範囲を
    用いる。
* :guilabel:`Cell &Range` はあるセル範囲で定義された誤差値を用いる。セル範囲は
  :guilabel:`Parameters` 区画で指定する。
* :guilabel:`Error Indicator` では誤差の絵が正負両方を示すのか、どちらか一方しか
  示さないかを選択する。

Modifying error bars
----------------------------------------------------------------------

誤差棒の変更は一度に一系列だけ、:guilabel:`Error Bars` ダイアログボックスで行う。

#. 編集モードに入る
#. データ系列を選択（先述）して |FormatSelectionM|
#. 所望の選択肢を指定
#. |OK| を押す

Deleting error bars
----------------------------------------------------------------------

データ系列すべてに対しての誤差棒一括削除手順：

#. 編集モードに入る
#. どのデータ系列選択されていないようにする
#. |InsertXErrorsM| か |InsertYErrorsM| を実行してダイアログボックスを開く
#. :guilabel:`&None` を選択
#. |OK| を押す

単一データ系列に対する誤差棒削除は右クリックメニュー :menuselection:`Delete X
Error &Bars` か :menuselection:`Delete Y Error &Bars` を実行

Adding drawing objects to charts
======================================================================

|DrawingToolbar| の記述。|Calc06| を読めばいい。

統計図表に図面オブジェクトを配置するには、編集モードであることが必要。そうしない
と、図面オブジェクトが統計図表ではなくシートの方にリンクする。

Resizing, moving, and positioning charts
======================================================================

統計図表の幾何を変更するには、まずは選択モードでそれをクリックする。次にマウスや
キーボードを使って操作するか、専用ダイアログボックスで変更を指示する。求められる
精度によって使い分けたり併用したりするのが良い。

Changing interactively
----------------------------------------------------------------------

Resizing
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 統計図表をクリックして正方形ハンドルを境界に現す。
#. ハンドルのいずれかをドラッグする。

   * マウスポインターは統計図表寸法を拡縮する方向を示す。
   * 角のハンドルをドラッグすると縦横比が維持される。
#. 統計図表の外側をクリックして選択モードから脱する。

Moving
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

移動量に応じた手順がある。微小距離の移動方法は：

#. 統計図表をクリックして正方形ハンドルを境界に現す。
#. 矢印キーを押して一度に二、三ドット動かす。|Alt| を押しながら矢印キーを押せば
   一度に一ドット動かす。
#. 統計図表の外側をクリックして選択モードから脱する。

一気に動すにはキーボードの代わりにマウスでドラッグ＆ドロップする。

Position and Size dialog
----------------------------------------------------------------------

#. 統計図表右クリックメニュー :menuselection:`Position and Si&ze...` を実行
#. |Position&SizeDlg| のタブを一つ選択して選択肢を指定
#. |OK| を押す

幾何変更時は統計図表の幾何の固定に使用する点に対応する :guilabel:`&Base point`
ラジオボタンのいずれかをクリックしろ。

幾何のいずれかを :guilabel:`Protect` 区画の適切なチェックボックスをオンにして不
意の変更から保護することが可能。採用した選択肢はダイアログボックスを閉じた後も有
効だ。ダイアログボックスを閉じた後、基点は既定位置にリセットされる。

Position and Size
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:guilabel:`Position` と :guilabel:`Size` 各区画はこれまでの記述で理解しろ。
:guilabel:`Protect` 区画についてはすぐ上で述べられている。:guilabel:`Adapt` 区画
は無視しろ。

Rotation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

さっきもそうだったかもしれないが :guilabel:`Pivot Point` 区画のスピンボックス二
つとラジオボタンが中途半端に連動している？

Slant & Corner Radius
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:guilabel:`Corner Radius` と :guilabel:`Control Point 1` などは無視しろ。

:guilabel:`Slant` は軸に沿って統計図表を傾ける。その軸の角度を -89 から 90 の範
囲で指定する。

Selecting multiple charts
======================================================================

複数の統計図表を選択するには、|Shift| を押しながらクリックしていけばいい。する
と、統計図表全部をカバーする位置に操作ハンドルが描画される。これにより、選択統計
図表が一体化したかのように操作可能。有効な操作は：

* |EditCutM| と |EditPasteM|
* |Position&SizeDlg| 使用
* |DrawingObjPropToolbar| 使用

Changing overall appearance of charts
----------------------------------------------------------------------

|Calc06| と |Draw| を参照。

Copying, exporting, and deleting charts
======================================================================

Copying charts in the same spreadsheet document
----------------------------------------------------------------------

コピー統計図表に対しても原データに加えられた変更が反映される。

Copying to another LibreOffice document
----------------------------------------------------------------------

統計図表をコピーして別の LibreOffice 文書に貼り付けると、原データとのリンクが失
われる。データは統計図表とともに保持され、データ範囲ではなくデータ表と呼ばれる。

|Calc11| も参照。

Keeping original data
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

元のデータを統計図表に使用することを目的とする場合は、普通に上記と同じ手順で統計
図表をコピーし別の文書に貼り付ける。

Modifying original data
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

反対に、元データを修正する場合は次のようにする：

#. 編集モードに入る
#. 統計図表右クリックメニュー :menuselection:`&Data Table...` を実行
#. 開いたダイアログボックスでデータを編集する。
#. |Close| を押す

.. admonition:: 利用者ノート

   試すときは Calc 以外の、例えば Writer の新規文書に貼り付けて編集を試みると印
   象が強くて良い。

Dragging replacement data
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

統計図表が Calc にあるままで、置換データが同一スプレッドシートにある場合は、新し
いデータを選択し統計図表上にドラッグする。

Exporting chart images
----------------------------------------------------------------------

LibreOffice 以外のアプリケーションでも使えるように、統計図表をよく使う画像形式で
エクスポート可能だ。

#. 右クリックメニュー :menuselection:`Export as &Image`
#. |SaveAsDlg| で |FileTypeList| を選択して保存先パスを指定
#. |Save| を押す

Deleting charts
----------------------------------------------------------------------

統計図表を選択して枠にハンドルが示されたら |Del| を押せ。

Gallery of chart types
======================================================================

どの統計図表型を採用するかはメッセージに集中しろとある。

Column charts
----------------------------------------------------------------------

* 棒の高さは値に比例する。
* X 軸と Y 軸は区分と値をそれぞれ現す。
* 経時的な傾向を示すデータを説明するのに用いられる。
* 比較的少数のデータ点に向いている。

  * より大きな時系列には line chart がより適切と考えられる。

Bar charts
----------------------------------------------------------------------

* 棒を横に表示するのが column chart との違い。他の統計図表とは異なり Y 軸が水平
  だ。
* 時間が重要な要素でないときに使いやすい。
* 区分名が長かったり、区分が多い場合には column chart よりも好まれることがある。

Pie charts
----------------------------------------------------------------------

* 各値を同一円に収まる扇形として示し、各扇形の面積が値に比例するという統計図表だ。
* 部門別の支出を比較するなど、比率を比較するのに適した統計図表だ。
* データ区分が少ない場合に効果的な統計図表だ。
* ドーナツ型は二組の関連情報を表現するのに使われる。内周がどうしても小さくなるの
  でデータによっては注意が要る。

Area charts
----------------------------------------------------------------------

* ある区分から次の区分への変化の量を強調するのに使いたい統計図表。
* 折れ線プロットよりも視覚的印象を強く与える。

Normal area charts
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Normal ではこういう見てくれの統計図表であるので、透明度の値を指定して使い物にな
る。データが重なり合うので、最初のデータ系列の背面にデータの一部が欠けるようなこ
とが起こる。

Stacked area charts
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* データ系列の各点を他のデータ系列に加え、合計面積を表現するような変種と、
* 系列の各値を全体に対する百分率で表現する

変種がある。

Line charts
----------------------------------------------------------------------

* 連続性を強調したいときに傾向、経時変化を示すのに使える。
* 値は Y 軸上の点に、X 軸は区分（多くの場合は時系列）を示す。
* 各データ系列の Y 値は線で結ぶことがある。

:guilabel:`&Stack series` をオンにすると、Y 値の累積値が互いの上に示される。

:guilabel:`Line type` ドロップダウンリストではデータ点の接続様式を指定する。面白
いのは :guilabel:`Smooth` だ。ダイアログが開いて補間方式を次から指定する：

* :guilabel:`Cubic spline`
* :guilabel:`B-spline`

線スタイルで 3D にすると読者を惑わせるかもしれないので、単に線を太くしろ。

Scatter or XY charts
----------------------------------------------------------------------

両軸に値を含む統計図表で、特に精密かつ複雑なデータ同士の関係を理解するのに有用だ。
量的変数間の統計的関連を調べるのに使われがちだ。複数データ系列を含められる。

慣例上、変数の一つが試験者によって制御されるか、変化に一貫性がある（時間変化な
ど）場合、それを独立変数とみなして X 軸にプロットする。

XY chart variants
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* :guilabel:`Points Only`: データ点のみを示す（記号で点を表現）
* :guilabel:`Points and Lines`: データ点と折れ線を両方示す。
* :guilabel:`Lines Only`: データ点同士の間の折れ線のみ示す。描画順序に注意。
* :guilabel:`3D Lines`: 線のみれくれが帯のようになる。データ点描画なし。

:guilabel:`&Sort by X values` で X 値の順序に線を描くように指定可能。データ系列
が元データでバラバラのときに使える。

:guilabel:`Line type` は先述のものと同じ（はず）。

Examples of XY or scatter charts
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

実習節。データ系列を行にとって月名ヘッダーを無視すればいい。

.. code:: text

   Apr	May	Jun	Jul	Aug	Sep	Oct	Nov
   Yen	102	105	178	165	122	98	134	97
   Dollar	56	57	67	90	64	56	78	34
   Rupee	209	230	256	231	201	199	230	223
   Yuan	69	78	75	76	69	95	69	70

Bubble charts
----------------------------------------------------------------------

泡図は三変数を二次元で表現できる散布図の変種だ。

* データ点を泡で表現する。
* 変数二つは X 軸と Y 軸に沿ってプロットされ、第三変数は泡の相対的な大きさで表現
  される。
* データ系列はいくつでも含められる。

泡図は金融データや社会的人口統計学的データを表現するのによく使われる。

バブル統計図表のデータ系列ダイアログには、バブルの大きさを決定するデータ範囲を定
|ChartWizard| のデータ系列ページで、バブル統計図表を手動で作成する必要があるかも
しれない。

Net charts
----------------------------------------------------------------------

* データ値を放射状の輻上の点として表示し、各輻（他の統計図表の Y 軸相当）が変数
  を表す。
* 時系列ではないが、科学実験の変数のように異なる状況を示すデータを比較する。特に
  群れや外れ値を表示するのに便利だ。
* 一般に、三軸から八軸の間が最善で、それを超えると統計図表が混乱する。
* この統計図表で見える面積に惑わされてはいけない。

Stock charts
----------------------------------------------------------------------

株価図は、始値、終値、底値、上値、終値を表示することで、株価や株式の市場動向を示
す。取引量も表示でき、X 軸は通常時系列を表す。

|ChartWizard| で株価図を設定する場合、データ配置が所定のものである必要がある。ど
の列を株価の始値、安値、高値、終値、取引高とするかを指定する。別途、手動での調整
が必要な場合もある。

.. admonition:: 利用者ノート

   個人的に利用することがない統計図表だから、作成オプションの細かい点は割愛。

Stock chart variants
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|ChartWizard| には株価図表が四種類用意されている。中にはデータ列をすべては使用し
ないものもある。

Stock Chart 1
   安値列と高値列のデータのみに基づいている場合、底値（安値）と上値（高値）の間
   の距離を縦線で示す。終値列も含まれる場合、終値の水平マークが追加表示される。
Stock Chart 2
   始値、安値、高値、終値の列に基づき、この変種は伝統的なろうそく足図表を生成す
   る）。下値と上値の間に垂直線が表示され、始値と終値の間の幅を示す長方形が前面
   に加わる。上昇（始値が終値より低い）の場合、塗りつぶしの色は白だ。下降値の場
   合、塗りつぶしの色は黒だ。
Stock Chart 3
   安値、高値、終値の列を使用して、Stock Chart 1 と同様の株価図式を描画するが、
   取引数量の列が追加される。二次 Y 軸によって、取引量と価格の両方を縦軸に表示す
   ることができる。

   .. note::

      変種 3 と 4 は、データを二次 Y 軸に自動的に整列する。二次 Y 軸の詳細は
      :ref:`calc03-anchor-aligning` を見ろ。

Stock Chart 4
   出来高、始値、安値、高値、終値すべてに基づき、Stock Chart 2 と出来高の柱状図
   を組み合わせたものだ。

Column and line charts
----------------------------------------------------------------------

経時的な売上高（柱）と利益率の回帰（折れ線）のような、異なるが関連するデータ系列
二つを表示するのに使える。医療検査や品質管理で使用されるような、一定の最小線と最
大線を表示することも可能。

|ChartTypeDlg| で線の本数を指定する。データの最初の列または行が区分で、データの
最後の列または行が線になる。

* :guilabel:`Columns and Lines` は柱を並べて描き、それぞれの値を簡単に比較できる
  ようにする。
* :guilabel:`Stacked Columns and Lines` では柱を互いに上に積み重ね、柱一つの高さ
  はデータ値の合計を示す。
* 柱と線の色を一致させるように書式設定しろ。
* 二次 Y 軸を使え。

Pivot charts
----------------------------------------------------------------------

ピボット表に対して |InsertChartM| で作成される統計図表だ。
この統計図表は本章で記述されている他の統計図表の多くの性質があるものの、固有の性
質も有する。|Calc09| 参照。

Create box plots with whiskers in Calc
======================================================================

箱ヒゲ図を手動で作図する手順が記述されている：データ系列を行に並べ、凡例のない
stacked column 図の最小値、第一四分位値、中央値、第三四分位値、最大値を、箱ヒゲ
図に変換することで表現する。

第一四分位値と第三四分位値の差を計算する場合、データ系列が偶数データ量か奇数デー
タ量かが急所だ。データ量が偶数、奇数の場合は関数 ``QUARTILE.EXC``,
``QUARTILE.INC`` をそれぞれ用いる。

``MIN``, ``MEDIAN``, ``MAX`` 各関数を最小値、中央値、最大値をそれぞれ計算するた
めに使用可能。

Converting the column chart to box plot
----------------------------------------------------------------------

箱ヒゲ図を stacked column 図から手動で変換作図する手順：

.. todo::

   実習終了後に記載

`How to create boxplot with whiskers - The Document Foundation Wiki
<https://wiki.documentfoundation.org/Documentation/HowTo/Calc/BoxplotWithWhiskers>`__
参照。

Sparklines
======================================================================

   Sparklines are small, simple, cell-sized charts that convey the general shape
   of data variation within a dataset.

* 経時変化を示すために用いられ、軸や座標抜きで描かれるのが通常だ。
* MS Excel の閃光線と互換性がある。

Creating a sparkline
----------------------------------------------------------------------

閃光線を作成する手順：

#. 原データ行または列を選択
#. |InsertSparklineM| を実行して |SparklinePropDlg| を開く
#. :guilabel:`Output range` 欄に出力先セルを指定
#. オプションを適宜埋める
#. :guilabel:`&OK...`

|SparklinePropDlg| に設けられている欄：

.. admonition:: 読者ノート

   現存しない Data 区画を割愛。

.. rubric:: Properties

:guilabel:`&Type`
   閃光線の型を選択する。選択肢については :ref:`calc03-anchor-types` を見ろ。
:guilabel:`&Line thickness`
   `Line` 型閃光線の線幅を設定する。
:guilabel:`&Display empty cells as`
   `Gap` は欠損データを抜かし、並びに隙間を表示
   `Zero`: 欠損データをゼロとして表示
   `Span`: 欠損データを抜かし、次の値まで線を引く
:guilabel:`Displa&y hidden`
   オンにすると選択入力範囲データすべてが閃光線に示される。オフにすると隠れデー
   タを無視させる。
:guilabel:`Right-to-le&ft`
   既定では閃光線は行を左から右に、列を上から下にデータを表示する。これをオンに
   すると、表示順序が逆になる。

.. rubric:: Colors

一連の値の主要色を設定し、閃光線に表示するさまざまな値タイプの色を指定選択する。
:guilabel:`&Marker` は閃光線のデータ点のみに既定色を設定する。

.. rubric:: Axes

:guilabel:`Display& X axis`
   閃光線に X 軸を表示するかどうか。
:guilabel:`&Vertical minimum`, :guilabel:`Vertical maxim&um`
   Y 軸の最小値と最大値を `Individual`, `Group` (see
   :ref:`calc03-anchor-multiple`), `Custom` で設定する。隣接する数値入力欄は、対
   応メニューでCustom オプションが選択されている場合に限り使用可能。

.. note::

   閃光線は升目一つに限られる。閃光線の規模を大きくするには、升目を大きくする。
   閃光線の升目が他の升目に融合した場合、閃光線は元の升目と同じ大きさのままだが、
   閃光線の書式を変更する選択肢は升目の融合が解除されるまで失われる。

.. _calc03-anchor-types:

Types of sparkline
----------------------------------------------------------------------

閃光線の種類は三つ：

* Line: データ値を接続する折れ線
* Column: 各データ値を現す縦棒
* Stacked: 正または負の値に対して、上または下に等しい大きさの縦棒

.. _calc03-anchor-multiple:

Creating multiple sparklines
----------------------------------------------------------------------

一度に複数の閃光線を作成する方法がある：

#. 原データの複数行や複数列を選択
#. |MenuBar| |InsertSparklineM| を選択
#. :guilabel:`&Input range` の行または列と同じ数のセルを :guilabel:`Output
   &range` に選択
#. ダイアログボックスでオプション値を設定
#. |OK| を押す

新規閃光線は入力範囲と同じ順序で出力範囲に描画される。これらはグループを形成す
る。

:guilabel:`&Vertical minimum` または :guilabel:`Vertical maxim&um` を
:guilabel:`Group` に設定すると、関連する各閃光線の Y 軸は、閃光線すべてのデータ
からの最小値または最大値を含むように拡大される。

Modifying a sparkline
----------------------------------------------------------------------

Updating a sparkline's data range
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. 閃光線右クリックメニュー :menuselection:`Spar&klines-->Edi&t Sparkline...`
#. :guilabel:`Sparkline Data Range` ダイアログボックス :guilabel:`&Data range`
   を更新する
#. |OK|

Updating a sparkline's formatting properties
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

閃光線の書式設定を更新する手順：

#. 閃光線右クリックメニュー :menuselection:`Spar&klines-->&Sparkline...`
#. |SparklinePropDlg| で必要に応じてオプションを変更する
#. |OK|

Sparkline groups
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

閃光線はセル一つに対して定義されるものだが、複数の閃光線をグループにまとめること
が可能だ。

* 閃光線グループは描画書式を共有するものだ。
* 複数の閃光線が一度に作成されると、それらはまず同じ閃光線グループを共有する。
  このグループの描画書式を変更すると、所属する閃光線すべてに影響する。
* 閃光線を選択すると、同じグループ内の閃光線すべてが強調表示される。

Modifying the formatting properties of a sparkline group
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

閃光線グループの描画書式を更新する手順：

#. グループ内の閃光線一つから右クリックメニュー :menuselection:`Spar&klines-->
   &Edit Sparkline Group...`
#. |SparklinePropDlg| で必要に応じてオプションを変更する
#. |OK|

Grouping and ungrouping sparklines
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

グループ化手順：

#. 所望の書式を有する閃光線をまず選択
#. それ以外の閃光線を追加的に選択
#. 右クリックメニュー :menuselection:`Spar&klines-->Gr&oup Sparklines`

閃光線をグループから外し、個別に書式設定可能にするには、対象閃光線を選択し、以下
のいずれかを実行：

* 右クリックメニュー :menuselection:`Spar&klines-->&Ungroup Sparklines`
* |MenuBar| :menuselection:`F&ormat-->Spar&klines-->&Ungroup Sparklines`

Deleting sparklines
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

単一閃光線を削除するには、それを選択して次のいずれかを実行：

* |Del| を押す
* 右クリックメニュー :menuselection:`Spar&klines-->&Delete Sparkline`
* |MenuBar| :menuselection:`F&ormat-->Spar&klines-->&Delete Sparkline`

グループ内の閃光線すべてを削除するには、まず閃光線一つを選択して次のいずれかを実
行：

* 右クリックメニュー :menuselection:`Spar&klines-->Delete &Sparkline Group`
* |MenuBar| :menuselection:`F&ormat-->Spar&klines-->Delete Sparkline &Group`

----

.. rubric:: 章末注

.. [#todo1] |AxesDlg| の |PositioningTab| で指定
.. [#todo2] |CTL| は |OptionsDlg| |LanguagesPage| の対応オプションが有効になって
   いる場合にのみ使用可。
