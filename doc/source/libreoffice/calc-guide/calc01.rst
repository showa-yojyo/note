======================================================================
Calc Guide Chapter 1, Introduction ノート
======================================================================

.. include:: ./calc-inc.txt

.. contents:: 章見出し
   :depth: 3
   :local:

What is Calc?
======================================================================

Calc は LibreOffice の表計算部品。スプレッドシートに数値などのデータを入力し、そ
のデータを操作して特定の結果を得ることが可能だ。

Spreadsheets, sheets, and cells
======================================================================

Calc はスプレッドシートと呼ばれる文書を扱うアプリケーションだ。

* スプレッドシートは複数のシートで構成される
* 各シートには行と列に並べられたセルが含まれる。
* セルには、テキスト、数値、数式など、表示したり操作したりするデータを構成する要
  素が格納される。

Calc main window
======================================================================

Calc を起動したときにデスクトップに現れるウィンドウの構成を述べている。

* 本章の記述は |MenuBar| とツールバー主体の GUI についてで、Calc にはこの他にも
  GUIの変種が搭載されている。|Calc16| 参照。
* 本書のスクリーンショットのようにウィンドウの各部品が描画されていない場合、
  |MenuBar| |View-->| 以下の項目を確認しろ。

Title bar
----------------------------------------------------------------------

* タイトルバーはメインウィンドウ最上部にある横長の部分だ。
* タイトルバーには、現在のスプレッドシートの名前が表示される。
* スプレッドシートが新規に作成された場合、その名前は `Untitled 1` のようになる。

Menu bar
----------------------------------------------------------------------

タイトルバーの下にあるメニューを本書では |MenuBar| と呼称している。

メニューコマンドをすばやく見つけて実行する方法がある。次のいずれかを実行すると見
出しのない検索ウィンドウが開く。コマンド名をタイプすると、合致する名前を持つコマ
ンドが列挙され、そのうちのいずれかを選択すると当該コマンドが実行する：

* :menuselection:`&Help-->Search Co&mmands...`
* |Shift| + |Esc|

Toolbars
----------------------------------------------------------------------

初期設定では |StandardToolbar| および |FormattingToolbar| が作業場所の上部に繋留
されている。

表示中、ツールバーは繋留状態か浮遊状態のどちらかを取る。初期設定では前者を取る。

* 繋留から浮遊させるには、ツールバー左端のハンドルをドラッグする。
* :menuselection:`&View-->&Toolbars-->&Lock Toolbars` で一括施錠（解錠）する。

:menuselection:`&View-->User &Interface...` で :guilabel:`Sin&gle Toolbar` を採
用すると、ツールバーが単一行になる。

図像、テキスト欄、メニューコマンドの上にマウスポインターを置くと、ツールチップが
表示され、その項目の機能名が示される。さらに詳細な記述を見るには、次のいずれかを
実行：

* |Shift| + |F1| で踏み込んだ記述になる。
* メニューでそうするには :menuselection:`&Help-->What's This?` を実行して、マ
  ウスポインターを図像の上に置く。
* 拡張コツ表示を切り替えるには |MenuBar| |OptionsDlg| の
  |LibreOfficeGeneralPage| から :guilabel:`&Extended tips` オンオフを決める。

.. admonition:: 利用者ノート

   このうちの三番目の操作でオンにしておくのが良いようだ。

|FormulaBar|
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|FormulaBar| は表示されている場合には作業場所の上部につねに繋留されている。表示
切替は可能で :menuselection:`&View-->&|FormulaBar|` のチェックをオンオフだ。

:guilabel:`Name Box` は現在セル参照を示す。

* アルファベットと数字は現在セルの列と行をそれぞれ示す。
* 名前付き範囲であるセル範囲を選択した場合、ここにはその名前が示される。
* セル参照を入力すると参照先セルにジャンプする。
* 名前付き範囲の名前を入力するとその範囲が選択状態になる。

:guilabel:`Function Wizard` は利用可能な関数や数式の一覧から検索することができる
ダイアログボックスが開く。

:guilabel:`Select Function` は選択セルの上にあるセルの数値を計算し、その結果をセ
ルに出力する。選択セルの上に数値がない場合、計算は左側のセルに対して行われる。

* 実行される計算は `Sum`, `Average`, `Min`, `Max`, `Count`, `CountA`, `Product`,
  `Stdev`, `StdevP`, `Var`, `VarP` を含むメニューから選択。
* キーバインド |Alt| + :kbd:`=` は :guilabel:`Select Function` をクリックして
  `Sum` を選択するのと同じだ。

  .. admonition:: 利用者ノート

     このキーバインドが働かない。

:guilabel:`Formula` は選択セルと :guilabel:`Input line` に等号を挿入し、数式を入
力できるようにする。

:guilabel:`Input line` は選択セルの内容が表示されたり、内容を編集する場所だ。テ
キストボックスを複数行にすることが可能。右側の :guilabel:`Expand |FormulaBar|` を
押すなどすればいい。

この GUI を使って数式を入力してもいいが、セル内を直接編集して数式を入力してもい
い。セルに新しいデータを入力すると、:guilabel:`Select Function` と
:guilabel:`Formula` 図像が :guilabel:`Cancel` と :guilabel:`Accept` 図像にそれぞ
れ変化する。

関数との関係については |Calc08| 参照。

|StatusBar|
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

作業場所の下部にある |StatusBar| にはスプレッドシートに関する情報が主に表示され
る。また、いくつかの機能をすばやく変更する手段が搭載されている。

構成は左から順に：

シート数
   * ``Sheet 3 of 3`` のような情報を表示する欄。
   * ダブルクリックすると Navigator ウィンドウ表示を切り替える。
セル選択情報
   * ``Selected: 6 rows, 1 column`` のような情報を表示する欄。
   * 選択が矩形ブロックを形成していない場合は空欄。
ページ様式
   * 現在シートのページ様式表示欄 e.g. `Default`
   * ページ様式を編集するには、ここをダブルクリックすると |PageStyleDlg| が開
     く。
言語
   * |OptionsDlg| における |LanguagesPage| で選択されている言語情報欄。
   * クリックすると言語選択用のメニューが現れる。
挿入上書きモード
   * テキストエディターやワープロソフトでよく見かける表示器と同じ。
   * 上書きモードの場合に限り、この欄に :guilabel:`Overrite` と示される。
   * これらのモードを切り替えるには |Ins| を押すほかにも、この欄をクリックしても
     いい。
選択モード
   クリックすると次のコンテキストメニューが開く：

   * :menuselection:`&Standard selection`
   * :menuselection:`&Extending selection`
   * :menuselection:`&Adding selection`

   この欄にはこれらのモードに対応する記号が示される。
署名
   * 文書が署名 (|Calc07|) されている場合、図像が表示される。
   * 図像をクリックすると証明書を表示する。
セル情報かオブジェクト情報
   * カーソル位置またはスプレッドシートの選択要素に関連する情報を表示する。
   * セルグループを選択すると、内容の平均と合計が表示される。
   * 右クリックすると、最大値、最小値、選択項目数など、他の機能を選択可能。
ズームスライダー
   スライダーコントロールを操作すると、シートの表示倍率が変化する。
ズーム率
   * 文書の描画尺度を百分率で示す。
   * 百分率を右クリックすると尺度のリストが表示される。
   * 百分率をクリックすると |Zoom&ViewLayoutDlg| が開く。

.. admonition:: 利用者ノート

   セル情報欄の表示内容はカスタマイズしておいたほうがいい。平均は要らないから項
   目数を入れる、等。

Sidebar
----------------------------------------------------------------------

|Sidebar| はツールバーとダイアログボックスを混ぜたようなものだ。開き方は：

* :menuselection:`&View-->Sid&ebar`
* |Ctrl| + |F5|

セルにデータを入力、編集する際には |Sidebar| は以下の甲板で構成される：

* |PropertiesDeck|
* |StylesDeck|
* |GalleryDeck|
* |NavigatorDeck|
* |FunctionsDeck|

|Sidebar| は状況に応じた変化をする。画像や図式などのオブジェクトを選択すれば、甲板
の数や内容が変化する場合がある。

|PropertiesDeck|
   ここにはパネルが五つある。パネルそれぞれに追加オプションを設けている
   :guilabel:`More Options...` ボタンがある。押すとダイアログボックスが modal で
   開く。
|StylesDeck|
   既存のスタイルの適用、変更、新しいスタイルの作成を行う。次のいずれかで開く：

   * |MenuBar| :menuselection:`St&yles-->Manage St&yles...`
   * |MenuBar| :menuselection:`&View-->St&yles`
   * キーバインド |F11|
|GalleryDeck|
   * Gallery テーマで利用可能な画像、図式、その他を追加することが可能。
   * :menuselection:`&View-->&Gallery` でも開く。
|NavigatorDeck|
   詳細は別途述べる。次のいずれかで開く：

   * |MenuBar| :menuselection:`&View-->&Navigator`
   * キーバインド |F5|
|FunctionsDeck|
   この甲板は |FunctionWizard| の簡略版だ。次のいずれかで開く：

   * |MenuBar| :menuselection:`&Insert-->&Function...`
   * キーバインド |Ctrl| + |F2|

* 開いている甲板のタイトルバー右側のバツボタンは :guilabel:`Close Sidebar Deck`
  であり、甲板を閉じて |Sidebar| のタブバーだけを開く。
* タブバーのどのボタンをクリックしても、対応する甲板の表示が切り替わる。
* |Sidebar| 全体の表示切替には、左端の細長いボタン？をクリックする。
* 甲板の幅を調整するには |Sidebar| の左端をドラッグする。

Spreadsheet layout
----------------------------------------------------------------------

Individual cells
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

列の上部と行の左端には、文字と数字を含む一連のヘッダーボックスがある。

* 列のヘッダーには A から始まり右に増えていくアルファベットが使われている。
* 行のヘッダーには 1 から始まり下に増えていく数字が使われている。

列と行のヘッダーは |FormulaBar| の :guilabel:`Name Box` に表示されるセル参照とな
る。

スプレッドシートでヘッダーが表示されない場合は、|MenuBar| :menuselection:`&View
-->Vie&w Headers` を確認しろ。

マウスポインターがセルの格子上にあるときのポインターの図像については |Calc15| を
参照しろ。

Sheet tabs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スプレッドシートのセル格子の下部にシートタブがある。各タブはスプレッドシートの
シートを表す。

シートタブの左側にあるプラス記号をクリックするか、シートタブの右側にある空白をク
リックすると、新規シートが生じる。

タブをクリックすると対応シートが活性を呈する。複数のシートを選択するには |Ctrl|
を押しながらシートタブをクリックする。

シート名を変更するには：

#. シートタブ右クリックメニュー |RenameSheetC| でダイアログボックスを開く。
#. :guilabel:`&Name` 欄にシート名を入力
#. |OK| を押す

シートタブの色を変更することが可能。方法は割愛。

Creating, opening, and saving spreadsheets
======================================================================

Creating and opening
----------------------------------------------------------------------

スプレッドシート自体を作成したりする方法は他の LibreOffice プログラムと同じだ。
|Guide| を参照しろ。

Using templates
----------------------------------------------------------------------

Calc 文書はテンプレートから作成することも可能。|Calc05| 参照。

Opening a CSV file
----------------------------------------------------------------------

#. |OpenFileDlg| を次のいずれかで開く：

   * |MenuBar| :menuselection:`&File-->&Open...`
   * |StandardToolbar| :guilabel:`Open` ボタン
   * キーバインド |Ctrl| + :kbd:`O`
#. 対象 |CSV| ファイルを選択して |Open| を押す
#. :guilabel:`Text Import` ダイアログボックスでオプションを選択
#. |OK|

オプション：

* :guilabel:`Ch&aracter set` を適当に変えてプレビューの文字化けを解消しろ。
* :guilabel:`&Locale` の値は数値文字列のインポートに影響する。
* :guilabel:`Merge &delimiters` オンで連続する区切り文字を結合消去する。空欄デー
  タも消える。
* :guilabel:`Tr&im spaces` は行前後の空白を消去する。
* :guilabel:`Strin&g delimiter` は引用符を指示する。

:guilabel:`Other Options` 区画の選択肢群は難しいのですべてオフで行く。

:guilabel:`Fields` はプレビューのように使う。コンボボックスで各列のデータ型をテ
キストや日付に指定することも可能。

Saving spreadsheets
----------------------------------------------------------------------

スプレッドシートをさまざまな形式で保存したり、|PDF| や |XHTML| ファイル形式にエ
クスポートしたり可能。|Calc07| で述べる。

Saving in other formats
----------------------------------------------------------------------

既定の形式 (.ods) のスプレッドシートファイルを扱えない人にファイルを渡す必要があ
る場合は、別の形式に変換してスプレッドシートを保存する。

#. |SaveAsDlg| を開く

   * |MenuBar| :menuselection:`&File-->&Save As...`
   * |StandardToolbar| :guilabel:`Save` ドロップダウンメニューから
     |SaveAsM|
   * キーバインド |Ctrl+Shift| + :kbd:`S`
#. |FileNameBox| にスプレッドシートの新しい名前を入力
#. ファイルを保存するフォルダーを選択
#. |FileTypeList| でドロップダウンメニューから使用するスプレッドシート形式の種類
   を選択

   * :guilabel:`Automatic file name extension` をオンにすると選択したスプレッド
     シート形式に適したファイル拡張子がファイル名末尾に追加される
#. |Save| を押す

ファイルが Calc 生粋の形式以外で保存されるたびに :guilabel:`Confirm File Format`
ダイアログボックスが開く。これが煩わしい場合、|OptionsDlg| から振る舞いを変更で
きる。

#. |LoadSaveGeneralPage|
#. :guilabel:`Warn when not saving in ODF or default format` をオフにする

:guilabel:`Text CSV format (*.csv)` を選択すると :guilabel:`Export Text File` ダ
イアログボックスが開く。ここで |CSV| ファイルに使用する文字セット、列区切り文
字、文字列区切り文字（引用符）などを指定可能。

Save As で特定の形式で常に保存するように挙動を変更することが可能。旧版 MS Excel
しか使っていない人を一定期間相手にするときなどに出番があるか。

Password protection
======================================================================

|Guide| を参照しろ。パスワード保護機能はすべての LibreOffice プログラムで共通
だ。

Navigating within spreadsheets
======================================================================

セルからセルへ、シートからシートへと、スプレッドシート内を移動するためのさまざま
な方法が用意されている。

Cell navigation
----------------------------------------------------------------------

* セルが選択されているかフォーカスが当たっているときは、セルの境界が強調される。
* セルグループが選択されると、セル領域は着色される。
* セル境界線の強調色と選択セルグループの色は OS 依存。システムの強調色に等しい。

移動方法各種：

* マウスクリック
* |FormulaBar| :guilabel:`Name Box` を使う

  * 既存のセル参照を選択
  * 既存のセル参照を削除
  * 移動先セル参照を入力して |Enter| を押す
* Navigator を使う

  * 開き方は |F5| 押しがいちばん早い
  * :guilabel:`&Column` 欄と :guilabel:`&Row` 欄にセル参照を入力して |Enter|
* |Enter| を押す

  * セルのフォーカスが一つ下に移る。
  * カスタマイズ機能あり。
* |Shift| + |Enter| を押す。フォーカスが |Enter| キーと逆方向に移る。
* |Tab| を押すとセルフォーカスを右に一つ移す。|Shift| + |Tab| を押すと左に一つ移
  す。
* 矢印キーを使う。押した矢印の方向にセルフォーカスが移る。
* |Home|

  * セルフォーカスを行の先頭に移す。
  * |Ctrl| + |Home| はセルのフォーカスをシートの最初 (A1) に移す。
* |End|

  * シートの中でデータを含むセルのうち、もっとも右にあるものの列番号を Cmax,
    もっとも下にあるものを Rmax とすると、|End| 押しはセルフォーカスを同じ行の
    Cmax 列目に移す。
  * |Ctrl| + |End| はセルフォーカスをセル (Rmax, Cmax) に移す。
* |PgUp| を押すとセルフォーカスを画面一つ分下に移す。
* |PgDn| を押すとセルフォーカスを画面一つ分上に移す。

Sheet navigation
----------------------------------------------------------------------

スプレッドシートの異なるシート間を移動する方法がある。

* Navigator を使う。列挙されたシートのいずれかをダブルクリックすると、そのシート
  が選択される。
* キーボードを使う。

  * |Ctrl| + |PgDn| を押すとシートを右に一つ移す。
  * |Ctrl| + |PgUp| を押すとシートを左に一つ移す。
* マウスを使う。シートタブの一つをクリックすると、そのシートを選択する。
* |MenuBar| を使う。

  * :menuselection:`&Sheet-->Na&vigate-->&To Previous Sheet`
  * :menuselection:`&Sheet-->Na&vigate-->To &Next Sheet`
  * :menuselection:`&Sheet-->Na&vigate-->&Go to Sheet...`: シートを選択したり、
    名前で検索したりするダイアログボックスが開く。

シート数が多い場合、シートタブの一部が隠れていることがある。その場合はシートタブ
の左側にあるボタン四つを使って、タブが見えるまで移動する。これらのボタンはシート
数が少ないと無効化されている。

Keyboard navigation
----------------------------------------------------------------------

シート上のセル移動キーバインドは必修。

* 矢印キー単品はセルフォーカスを一マス移動
* |Ctrl| + 矢印キーはデータの埋まり具合によって移動先が決まる
* |Ctrl| + |Home| や |Ctrl| + |End| は先述
* |Alt| + |PgUp| と |Alt| + |PgDn| は画面一つ分横移動
* |Ctrl| + |PgUp| と |Ctrl| + |PgDn| はシート前後移動
* |Tab| と |Shift| + |Tab| はセルフォーカスを横一マス移動
* |Enter| と |Shift| + |Enter| はセルフォーカスを縦一マス移動

Customizing the Enter key
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|OptionsDlg| |CalcGeneralPage| の `Press Enter to` から始まるチェックボックスを用
いて |Enter| キーの動作をカスタマイズ可能だ。

.. admonition:: 利用者ノート

   クリップボード貼り付け＆消去を無効にするため、:guilabel:`Press Enter to
   &paste and clear clipboard` をオフにするかどうかで悩む。

Selecting items in a spreadsheet
======================================================================

Selecting cells
----------------------------------------------------------------------

Single cell
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

セルをクリックする。|FormulaBar| の :guilabel:`Name Box` を確認する。

Range of contiguous cells
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

セルの範囲一つを選択するのはキーボードかマウスを使えばよい。マウスの場合は：

#. セルを一つクリック
#. マウスボタンを押し続ける
#. マウスを動かして目的のセル塊を強調表示し、ボタンを離す

ドラッグしないでセルの範囲一つを選択する方法：

#. セルの範囲の角となるセルをクリック
#. マウスをセルの範囲の反対側の角に移す
#. |Shift| を押しながらクリック

Extending 選択モードを使ってセルの範囲を選択する方法：

#. セルの範囲の角となるセルをクリック
#. |StatusBar| の選択モード欄をクリックし、:menuselection:`&Extending selection`
   を選択
#. セルの範囲の反対側の角をクリック

マウスを使わずにセルの範囲を選択する方法：

#. セルの範囲の角となるセルを選択
#. |Shift| を押しながら、矢印キーで残りの範囲を選択

:guilabel:`Name Box` を使ってセルの範囲を選択する方法：

#. |FormulaBar| の :guilabel:`Name Box` をクリック
#. 例えば A3 から C6 までの範囲を選択するには ``A3:C6`` と入力して |Enter| を押
   す

Range of non-contiguous cells
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

マウスを使って連続しないセルの範囲を選択する：

#. 最初のセルまたはセル範囲を選択
#. マウスポインターを次の範囲の開始点または単一セルに移動
#. |Ctrl| を押しながらクリックするか、クリック＆ドラッグして最初の範囲に追加する
   別のセル範囲を選択
#. 必要なだけこれを繰り返す

追加選択モードを使ってセル範囲を選択する：

#. |StatusBar| の選択モード欄をクリックし、:menuselection:`&Addition selection`
   を選択
#. 選択範囲に追加するセルの範囲をクリックまたはクリックアンドドラッグで選択す
   る。

Selecting columns and rows
----------------------------------------------------------------------

Single column or row
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

単一の列や行を選択するには列ヘッダーや行ヘッダーをクリックしろ。

Multiple columns or rows
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

連続する複数列や複数行を選択する方法：

#. グループの最初の列または行をクリック
#. |Shift| を押しながら
#. グループの最後の列または行をクリック

連続しない複数の列または行を選択する方法：

#. グループの最初の列または行をクリック
#. |Ctrl| を押しながら
#. それに続くすべての列または行をクリック

.. tip::

   |MenuBar| :menuselection:`&Edit-->Selec&t-->` 以下のコマンドを使って行や列を
   選択することもできる。

Entire sheet
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

シート全体を選択する方法は複数ある：

* 列見出しと行見出しの間にある何もない部分をクリック
* |Ctrl| + :kbd:`A`
* |Ctrl+Shift| + |Space|
* |MenuBar| |EditSelectAllM|

Selecting sheets
----------------------------------------------------------------------

シートにも選択操作がある。特に、一度に多くのシートに変更を加えたい場合は、複数の
シートを選択した方がよい。

Single sheet
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

対応するシートタブをクリックしろ。選択シートのタブは強調表示される。

Multiple contiguous sheets
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

連続する複数のシートを選択する方法：

#. 最初に選択したいシートのシートタブをクリック
#. |Shift| を押しながら最後に選択したいシートのシートタブをクリック
#. この両者の間のタブすべてが強調される

以後、どのような操作をしても、強調されたシートすべてに影響する。

Multiple non-contiguous sheets
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

連続しない複数のシートを選択する方法：

#. 最初に選択したいシートのシートタブをクリック
#. |Ctrl| を押しながら他のシートのシートタブをクリック
#. 選択されたタブが順次強調される

All sheets
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

全シート選択方法は複数ある：

* シートタブを右クリックし、|MenuBar| から :menuselection:`Select &All Sheets`
* |MenuBar| :menuselection:`&Edit-->Select &All Sheets`
* |MenuBar| |SelectSheetsM| から |SelectSheetsDlg| を使ってシートを選択する

Working with columns and rows
======================================================================

Inserting columns and rows
----------------------------------------------------------------------

列や行を挿入すると、新しいセルの書式は挿入位置基準のセルのものを受け継ぐ。

Single column or row
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

シートメニューと右クリックメニューを使う方法がある。

#. 新しい列や行を挿入したい位置にあるセル、列、行を選択
#. |MenuBar| から対応コマンドを実行：

   * :menuselection:`&Sheet-->Insert Co&lumns-->`
   * :menuselection:`&Sheet-->Insert &Rows-->`

   あるいは列ヘッダーや行ヘッダーの右クリックメニューからコマンドを実行

Multiple columns or rows
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

複数の列や行を一度に挿入することも可能。

#. 例えば五行挿入したい場合、対象位置にある行ヘッダーから五個連続してヘッダーを
   選択する
#. 上述の一行挿入と同様に操作する

強調された行数ぶん、直前か直後に、新規行が追加される。

Hiding columns and rows
----------------------------------------------------------------------

列や行を隠すには、

#. 隠す列や行を選択
#. 以下のいずれかの操作を行う：

   * 選択した列または行のヘッダーを右クリックし、:menuselection:`H&ide Columns`
     または :menuselection:`H&ide Rows` を実行
   * |MenuBar| から :menuselection:`F&ormat-->Colu&mns-->H&ide` または
     :menuselection:`F&ormat-->Ro&ws-->&Hide` を実行

隠れた行や列を目に見える形で表示するには、|MenuBar|
:menuselection:`&View-->Hidden Row` や :menuselection:`&View-->Hidden
&Row/Column Indicator` をオンにしろ。

隠れた列や行を露わにするには、

#. シート全体、または隠れた列や行の周囲の列や行を選択
#. 次のいずれかの操作を行う：

   * 選択した列または行のヘッダーを右クリックし、:menuselection:`S&how Columns`
     または :menuselection:`Sho&w Rows` を実行
   * |MenuBar| から :menuselection:`F&ormat-->Colu&mns-->&Show` または
     :menuselection:`F&ormat-->Ro&ws-->&Show` を実行

Deleting columns and rows
----------------------------------------------------------------------

Single column or row
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

削除したい列や行にあるセルを一つ選択し、

* |MenuBar| から :menuselection:`&Sheet-->Delete C&ells...` を実行
* キーバインド |Ctrl| + :kbd:`-` を押す

ことで |DeleteCellsDlg| を開く。そこで

* :guilabel:`Delete entire &column(s)` や
* :guilabel:`Delete entire &row(s)`

をオンにして |OK| を押す。

----

削除したい列や行にあるセルを一つ選択し、次の|MenuBar| コマンドを実行する：

* :menuselection:`&Sheet-->Delete &Columns`
* :menuselection:`&Sheet-->Delete R&ows`

----

削除したい列または行のヘッダーを右クリックし、右クリックメニューから次のコマンド
を実行する：

* :menuselection:`Delete &Columns`
* :menuselection:`&Delete Rows`

Multiple columns or rows
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

複数列や複数行の場合も同様。最初にセル範囲を選択したり、ヘッダーを複数選択してか
ら |MenuBar| コマンドを実行したりすればいい。

Deleting cells
----------------------------------------------------------------------

#. 削除したいセルを選択
#. 上述の方法で |DeleteCellsDlg| を開く
#. 必要な選択肢を指定
#. |OK|

Working with sheets
======================================================================

Inserting new sheets
----------------------------------------------------------------------

シートタブの横にある :guilabel:`+` をクリックすると、|InsertSheetDlg| を開かずに、
最後のシートの後に新規シートを挿入する。

以下の方法では、ダイアログボックスを開き、位置、複数作成、名前、既存ファイル内
シートの選択を行うことが可能だ：

* 挿入したい位置のシートを選択し、|MenuBar| |InsertSheetM| を実行
* 挿入したい位置のシートタブを右クリックして |InsertSheetC| を実行
* シートタブの末尾の空白部分を右クリックして |InsertSheetC| を実行

Moving and copying sheets
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

同じスプレッドシート内でシートを移動またはコピーするには、ドラッグ＆ドロップする
か、|MoveCopySheetDlg| を使用する。異なるスプレッドシートへの移動またはコピー操
作でも同じだ。

Dragging and dropping
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

同じスプレッドシート内でシートを別の位置に移動するには、

#. シートタブをクリックし
#. 新しい位置までドラッグして
#. マウスボタンを離す

同じスプレッドシート内でシートをコピーするには、|Ctrl| を押しながら上記手順を行
う。Windows の場合はマウスポインターにプラス記号が追加的に示される。

Using Move/Copy Sheet dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|MoveCopySheetDlg| ではシート移動やコピー操作を明示的に行う。

#. 移動またはコピーしたいシートで、次のいずれかを実行：

   * シートタブを右クリック |MoveCopySheetC|
   * |MenuBar| から |MoveCopySheetM|
#. ダイアログボックスが開く
#. :guilabel:`&Move` や :guilabel:`&Copy` を選択するとシートが移動したりコピーさ
   れたりする。
#. :guilabel:`To &document` ドロップダウンリストからシートを置くスプレッドシート
   を選択
#. シートを配置する位置を :guilabel:`&Insert before` 一覧で選択
#. 移動またはコピー時にシートの名前を変更する場合は、:guilabel:`New &name` 欄に
   名前を入力
#. :guilabel:`&Move` や :guilabel:`&Copy` をクリックしてダイアログボックスを閉じ
   る

Deleting sheets
----------------------------------------------------------------------

単一シートを削除する方法は次のいずれか：

* シートタブの右クリックメニューから |DeleteSheetC| を実行
* |MenuBar| |DeleteSheetM| を実行

シートが空でない場合、確認ダイアログボックスが開く。

複数シートを削除する方法：

#. 対象シートを前述の方法により選択
#. 上記手順に合流

選択シートのいずれかが空でない場合、削除するシートの数を示す確認ダイアログボック
スが開く。

Hiding and showing sheets
----------------------------------------------------------------------

シートを隠すには：

#. 上記のようにして対象シートを選択
#. シートタブ右クリックメニュー :menuselection:`&Hide Sheet`

隠れているシートを表示するには：

#. 任意のシートタブ右クリックメニュー :menuselection:`&Show Sheet...`
#. :guilabel:`Show Sheet` ダイアログボックスで対象シートを選択
#. |OK| を押す

Renaming sheets
----------------------------------------------------------------------

既定の新規追加シート名は :samp:`Sheet{X}` で、シートが数枚しかないならばこれでも
いいが、枚数が多くなると識別するのが困難になる。次のいずれかの方法で、シート名を
変更する：

* シートタブ右クリックメニュー |RenameSheetC| を実行
* |MenuBar| :menuselection:`&Sheet-->Rename &Sheet...` を実行
* シートタブダブルクリック

|RenameSheetDlg| が開くので、名前を入力して |OK| を押せ。

Viewing a spreadsheet
======================================================================

Changing document view
----------------------------------------------------------------------

スプレッドシートで作業しているときに、ウィンドウ内のセルを多く表示したり少なく表
示したりするにはズーム機能を使え。

Freezing rows and columns
----------------------------------------------------------------------

凍結はスプレッドシートの上部の行や左側の列を固定表示するもので、シート内を移動し
ても凍結された行や列のセルは常に表示されたままになる。

#. 凍結させたい行の下にある行ヘッダーか、フリーズさせたい列の右にある列ヘッダー
   をクリックしろ。行と列の両方を凍結するには、両者が交差するセルの右下セルを選
   択しろ。
#. |MenuBar| :menuselection:`&View-->Freeze Rows &and Columns` を実行

凍結した場所を示す太い線が行または列の間に表示される。

Unfreezing
----------------------------------------------------------------------

行または列の凍結を解除するには、|MenuBar| :menuselection:`&View-->Freeze Rows
&and Columns` を実行してオンをオフに切り替える。凍結を示す太い線が消える。

Splitting the screen
----------------------------------------------------------------------

画面は水平か垂直、またはその両方に分割可能だ。スプレッドシートの部分を同時に最大
四つ表示できる。灰色の細いウィンドウ枠で分割を示す。

この技法を利用して、数値を含むセルをビューの区画の一つに配置し、それを参照する数
式を含むセルを他の区画で見ることができる。これにより、あるセルの数値を変更する
と、それぞれの数式にどのような影響があるかを簡単に見るというような使い方もある。

Splitting horizontally or vertically
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

水平も垂直も似た操作なので、水平だけ記す。

#. 画面を水平に分割したい行の下にある行ヘッダーをクリック
#. 次のいずれかでコマンドを実行：

   * |MenuBar| |ViewSplitWindowM|
   * 右クリックメニュー |SplitWindowC|

あるいは、専用 GUI を用いる操作もある。

#. 垂直スクロールバーの上部にある太い黒い線をクリック
#. 分割枠を上下にドラッグできるようになるので、それを水平分割したい行の下に持っ
   てくる

Splitting both horizontally and vertically
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* 専用 GUI を水平方向と垂直方向で二度使うか、
* 分割交差点の右下に来るセル上で |ViewSplitWindowM| を実行
  しろ。

Removing split views
----------------------------------------------------------------------

分割解除方法は複数ある：

* 分割枠を順次ダブルクリック
* 分割枠をクリックし、スクロールバーの端までドラッグして元の位置に戻す
* |MenuBar| |ViewSplitWindowM| をオフにする
* 列見出しまたは行見出し右クリックメニュー |SplitWindowC| をオフにする

Using the Navigator
======================================================================

Navigator は LibreOffice プログラムすべてにおいて利用できる UI だ。Calc ではスプ
レッドシートの中をすばやく移動し、特定の項目を見出すための方法を備えている。

Navigator はスプレッドシートのオブジェクトを品目に分類して同類にまとめる。クリッ
クするとその物にすばやく飛べる。

.. admonition:: 利用者ノート

   おそらく高々二階層の木構造をとる。上位ノードのほうを category と言っている。

品目の横に正符号が表示されている場合は、この品目内に物が少なくとも一つ存在す
る。

品目内項目一覧を見るには正符号をクリックする。

品目内に物一覧が表示されているときに、物をダブルクリックすると、スプレッドシート
内の居場所に直接飛ぶ。

Navigator の開き方は次のいずれかを行う：

* |F5| を押す（利用者推奨）
* |MenuBar| :menuselection:`&View-->Na&vigator` をオン
* |Sidebar| :guilabel:`Navigator` 図像をクリック

Navigator UI 要素概略：

:guilabel:`&Column`, :guilabel:`&Row`
   列文字や行番号を入力して |Enter| を押すとシート内の対応セルに飛ぶ。
:guilabel:`Data Range`
   現在カーソルがあるセルを含むデータ範囲を強調表示する。データ範囲は隣接セルの
   内容から決定される。隣接セルにデータがない場合、データ範囲は単一セルで構成さ
   れる。
:guilabel:`Start`, :guilabel:`End`
   現在のデータ範囲の先頭セルや末尾セルに飛ぶ。ここで :guilabel:`Data Range` を
   使うと範囲が強調表示される。
:guilabel:`Contents`
   Navigator ウィンドウの下部内容表示を切り替える。|Sidebar| の |NavigatorDeck|
   には同等のものがない。
:guilabel:`Toggle`
   内容表示を切り替える。選択された品目とその項目しか表示されない。もう一度ク
   リックすると、内容がすべて表示される。
:guilabel:`Senarios`
   利用可能なシナリオすべてを表示する。|Calc10| を参照しろ。

   シナリオ名をダブルクリックすると、そのシナリオが適用され、結果がシートに表示
   される。Navigator にシナリオが表示されている場合、シナリオ項目から右クリック
   メニューが開く。

   * :menuselection:`&Delete` は選択シナリオを削除する
   * |PropertiesC| は :guilabel:`Edit Scenario` ダイアログボックスを開く。そこで
     は選択シナリオを編集する。
:guilabel:`Drag Mode`
   Navigator から文書にオブジェクトをドラッグアンドドロップすると実行される動作
   を選択するためのメニューが開く。選択モードに応じて図像が変わる。

   * :menuselection:`&Insert as Hyperlink` は項目全体をハイパーリンクする。
   * :menuselection:`Insert &as Link` はコピー項目を元項目にリンクさせ、元項目が
     変化すると、それを現在の文書に反映させる。
   * :menuselection:`Insert as &Copy` は選択項目のコピーを入れる。

Using document properties
======================================================================

文書に関する |PropertiesDlg| を開くには、|MenuBar| |FilePropertiesM| を実行す
る。

General
----------------------------------------------------------------------

現在のファイルに関する基本情報を含むタブだ。

* :guilabel:`Change &Password` を押すとパスワード変更ダイアログボックスが開く。
  このボタンはファイルにパスワードが施されている場合に限り押せる。
* :guilabel:`&Apply user data` をオンにすると、ファイルに著者の完全名を保存する
  ようになる。名前は |OptionsDlg| |UserDataPage| で編集可能だ。
* :guilabel:`Save preview &image with this document` をオンにすると、文書内にサ
  ムネイル画像 :file:`thumbnail.png` を保存するようになる。このような画像は
  Windows Explorer などのファイル管理ソフトが利用する場合がある。
* :guilabel:`Preferred resolution &for images` をオンにすると、画像を挿入すると
  きにこの ppi 値が使用されリサイズされる。
* :guilabel:`Reset Propertie` を押すと編集時間をゼロに、作成日時を現在の日時に、
  バージョン番号を 1 にそれぞれリセットする。

Description
----------------------------------------------------------------------

スプレッドシートに関する編集可能な記述的情報を記載する。

* :guilabel:`&Title` にはスプレッドシートの表題を入力する。
* :guilabel:`&Subject` にはスプレットシートの主題を入力する。これを使用すると類
  似文書をまとめることが可能になる。
* :guilabel:`&Keywords` にはスプレッドシートの内容を索引を付けるべく、使用単語を
  入力する。キーワードは ``,`` で区切る必要がある。
* :guilabel:`&Comments` にはスプレッドシートを鑑定するためのコメントを入力する。

.. admonition:: 利用者ノート

   Title, Subject, Keywords が似た者同士になりがちだがどうするか。

Custom Properties
----------------------------------------------------------------------

このページを使用してカスタム情報フィールドをスプレッドシートに割り当てる。

* 新規スプレッドシートではこのページは空白であることがある。
* テンプレートから生成したスプレッドシートでは何らかのフィールドが記載されている
  ことがある。
* 各行の名前、タイプ、内容を変更可能。
* フィールド情報は他のファイル形式にエクスポートされる際にそのメタデータとなる。

新規カスタムプロパティーを追加するには、:guilabel:`Add &Property` を押す。削除す
るには、エントリーの最後にあるバツボタンを押す。

CMIS Properties
----------------------------------------------------------------------

リモートサーバーに保存されているスプレッドシートのみに関連する。割愛。

Security
----------------------------------------------------------------------

パスワードで保護された保安選択肢を有効にする。

:guilabel:`&Open file read-only` をオンにすると、この文書を読み取り専用でしか開
くことができなくなる。文書のコピーを編集し、それを元ファイルと同じ名前で保存する
ことは可能。

:guilabel:`Record &changes` をオンにすると、すべての変更を記録することを要求す
る。記録状態をパスワードで保護するには、:guilabel:`&Protect...` からパスワードを
入力する。

* |MenuBar| |EditTrackRecordM| と同様だ。
* この文書の他の利用者は変更を適用可能だが、パスワードを知らない限り、変更の記録
  を無効にすることは不可能だ。

:guilabel:`&Protect...` ボタンを押すと変更記録の状態をパスワードで保護する。現在
文書で変更記録が保護されている場合、ボタンの名前は :guilabel:`&Unprotect...` と
なる。クリックすると保護を無効にする。

Font
----------------------------------------------------------------------

:guilabel:`&Embed fonts in the document` をオンにするとスプレッドシートで使用し
たフォントが保存時に文書に埋め込まれる。|PDF| を作成する際に他の計算機システムで
の見栄えを制御したいならば使え。

:guilabel:`&Only embed fonts that are used in documents` をオンにすると、スプ
レッドシート用に（テンプレートなどで）フォントが定義されているが実際には使用され
ていない場合に、フォントを埋め込むのをやめる。

:guilabel:`Font scripts to embed` では埋め込むフォントの種類を、欧文、アジア、複
合から選択可能。詳細は |Guide| に記述がある。

Statistics
----------------------------------------------------------------------

現在のファイルシート数、セル数、ページ数、数式グループ数を表示する。
