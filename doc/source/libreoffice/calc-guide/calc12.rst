======================================================================
Calc Guide Chapter 12 Sharing and Reviewing Spreadsheets ノート
======================================================================

.. contents::
   :local:

Introduction
======================================================================

スプレッドシートの共有と査読による共同作業の方法について述べられる。その方法とは
次だ：

* 同時編集
* 変更の記録
* コメントの追加
* 変更の査読
* 文書のマージと比較
* 保存
* 版の使用

共有または変更の追跡が active である場合、コマンドの一部は使用不能だ。

Sharing spreadsheets
======================================================================

スプレッドシートを共有するとは、複数の著者が同一ファイルを開いて同時に編集するこ
とを含む。

* 共有中、スプレッドシートは共有ドライブ、サーバー、Web サイトなどにある必要があ
  る。
* 利用者権限管理のある OS では、次の条件を満たす必要がある：

  * 共有ファイルは共同著者すべてがアクセス可能な場所に存在する。
  * 共同著者すべてがファイルを作成、削除、変更可能であるように、当該文書ファイル
    およびそのロックファイルの双方に対して適当なファイル権限を設定されている。

共同編集をまともにするためには、オプション設定の :menuselection:`LibreOffice -->
User Data` 画面の各項目を埋めておけ。

Setting up a spreadsheet for sharing
----------------------------------------------------------------------

スプレッドシートを開いた状態で、メニューから :menuselection:`&Tools --> S&hare
Spreadsheet...` を実行して、:guilabel:`&Share this spreadsheet with other users`
で共有状態の有効性を設定しろ。

* 共有を有効にする際、保存済みである文書である必要があるらしく、そうでないファイ
  ルについては :guilabel:`Save` ダイアログボックスが開く。保存しろ。
* 現在の文書が共有中であるかどうかは、ウィンドウのタイトルバーを確認しろ。

このコマンドで共有を取り消すことも可能だが、他の共同著者が編集できなくなる。取り
消すのではなく、スプレッドシートをコピーして保存し、そちらの共有を取り消すのがよ
いと考えられる。

Opening a shared spreadsheet
----------------------------------------------------------------------

本文にあるように、共有モードではコマンドの一部が使用不能になる。

Saving a shared spreadsheet
----------------------------------------------------------------------

共有スプレッドシートを保存する際、そのファイルを開いてから他の共同著者によって変
更、保存されていなければ、通常通り保存される。

スプレッドシートを開いてから他の共同著者が変更、保存した場合、以下のいずれかが発
生する：

* 互いの編集内容が衝突しない場合、文書は保存される。メッセージ «Your spreadsheet
  has been updated with changes saved by other users» が示され、他の共同著者が変
  更したセルが赤枠で描かれる。
* 編集内容が衝突した場合、:guilabel:`Resolve Conflicts` ダイアログボックスが開く。
  バージョン管理ツールの要領でどちらの版を採るかを決めろ。

  * 衝突がすべて解決されれば文書が保存される。
  * 衝突解消中は他の共同著者は共有文書を保存することが不可能だ。

    * 他の共同著者からは、マージ中のためにファイルがロックされているというメッ
      セージを見ることになる。保存を取り消して後ほど改めて保存を試みることにな
      る。

共有スプレッドシートの保存に成功すると、共同著者すべてが保存した変更すべての最新
版が表示される。

Reviewing documents
======================================================================

各査読者は別々の文書コピーで作業する。

* 変更マークを使って、加除修正資料を表示することが可能。後で誰かが文書を査読し、
  各変更を受理するか拒否する。
* 文書のコピーに変更を加えた後、Calc を使用してファイルを比較し、変更点を表示す
  ることが可能。
* 元ファイルの一部として格納されている版を保存することが可能。

査読者は文書にコメントを残すことが可能。特定の変更点に添付することも、コメント単
品で残すことも可能。

Preparing a document for review (optional)
----------------------------------------------------------------------

スプレッドシートを編集者や査読者に送る前に、彼らが改訂マークをオンにする必要がな
いように設定しておくとよい。

改訂マークを有効にした後、スプレッドシートをパスワードで保護し、正しいパスワード
を入力しなければ変更を許可または拒否できないようにすることも可能だ。

#. :menuselection:`&Edit --> Track Chan&ges --> &Record` を実行
#. :menuselection:`&Edit --> Track Chan&ges --> &Protect...` を実行
#. :guilabel:`Protect Records` ダイアログボックスでパスワードを入浴

Recording changes
----------------------------------------------------------------------

変更記録が有効ならば :menuselection:`&Edit --> Track Chan&ges --> &Record` 項目
に印がつく。

* セルが変更されると左上隅に点のある色つき枠線がセルを囲むように表示される。
* 削除された列や行は太い色の棒で示される。

変更情報を見るにはマウスポインターを対象セルの上に持って行く。

Adding comments to changes
----------------------------------------------------------------------

記録された変更に、何が変更されたかを説明するコメントは自動的に追加される。査読者
や著者は、変更の理由を述べたり、有用な洞察を提示するために、コメントを独自に追加
可能だ。

#. セルに変更を加える
#. 変更のあるセルを選択する
#. :menuselection:`&Edit --> Track Chan&ges --> &Comment...` を実行

コメントは変更を受理したり却下したりするときにも :menuselection:`Manage Changes`
ダイアログボックスに表示される。

Editing comments on changes
----------------------------------------------------------------------

変更コメントのあるセルを選択してから上述のコマンドを実行しろ。

* Calc によって自動的に追加されたコメントは編集不能。

Adding other (general) comments
----------------------------------------------------------------------

普通のコメント (:kbd:`Ctrl` + :kbd:`Alt` + :kbd:`C`) について。

Editing general comments
----------------------------------------------------------------------

ここも省略。

Formatting general comments
----------------------------------------------------------------------

コメントの背景色、枠、透明性、その他特性を変更可能。コメント自身をクリックすると
:guilabel:`Formatting` ツールバーが有効になるので、Chapter 6 で述べたように設定
可能となる。

#. コメント印を含むセルから右クリックメニューで :menuselection:`Sho&w Comment`
   を実行する。
#. コメントをクリックして上述したツールバーを用いるか、コメント右クリックメ
   ニューを用いてコメント欄書式を設定する。
#. 設定が終わったらコメント欄の外側をクリックする。
#. コメント印を含むセルから右クリックメニューで :menuselection:`&Hide Comment`
   を実行する。

Finding general comments
----------------------------------------------------------------------

:menuselection:`&View > C&omments` を実行してシート内の通常コメントを一括表示
する方法がある。

:guilabel:`Navigator` ウィンドウ (:kbd:`F5`) を使って、目的のコメントを含むセル
にジャンプするのもいい。

Accepting or rejecting changes
----------------------------------------------------------------------

変更が加えられた文書を受け取ったら、各変更を順を追って確認し、どのように処理を進
めるかを決定する。

#. 文書を開く。
#. :menuselection:`&Edit --> Track Chan&ges --> &Manage...` を実行してダイアログ
   ボックスを開く。
#. 変更を一つずつ確認し、その都度、変更を受理するか却下するかを選択する。また
   は、すべての変更を一度に受理または却下する。

Merging documents
======================================================================

査読者が複数いて、すべての変更版を一度に確認したい場合がある。こういうときにマー
ジを行う。

* 文書をマージするには、受け取った版のすべてが変更記録されていることが必要。

手順：

#. 元文書を開く。
#. メニューから :menuselection:`&Edit --> Track Chan&ges --> Merge Documen&t...`
   を実行。
#. ファイル選択ダイアログボックスが開く。マージしたいものを選ぶ。
#. マージ後に :guilabel:`Manage Changes` ダイアログボックスが開く。
#. 査読版の数だけファイル選択からマージまでの操作を反復する。

こうすると、すべての変更が一つの文書にまとめられ、変更を受理するか却下することが
可能になる。

* 異なる著者による変更は、異なる色でアウトライン化されたセルに表示される。

Comparing documents
======================================================================

元文書と更新版が手許にあるとき、両者を比較する手順：

#. 元文書と比較したい更新版を開く
#. :menuselection:`&Edit --> Track Chan&ges --> Co&mpare Document...` を実行
#. ファイルダイアログボックスから元文書を開く。

これで :menuselection:`Manage Changes` ダイアログボックスが開く。

Calc は次のように差分箇所を識別する：

* 更新版に存在し、元文書に存在しないデータはすべて A
* 元文書に存在し、更新版に存在しないデータはすべて D
* 変更されたデータはすべて M

これ以降に変更の受理および却下を行うことが可能。

Saving versions
======================================================================

スプレッドシートの新版を保存する必要がある場合がある。これを行うには、改訂のたび
にスプレッドシートのコピーを別の名前で保存するか、Calc のバージョン機能を利用す
る。

:menuselection:`&File -> Save &As...` による保存の場合、（それまで格納されてい
た）旧版は格納されなくなる。

バージョン管理コマンドは :menuselection:`&File --> Versions...` を実行する。ダイ
アログボックスが開く。このファイルに格納されている既存のバージョン一覧が示され
る。新しいバージョンを保存するには、

#. :guilabel:`Save New Version` を押す
#. コメントダイアログが開くので、この版に関するコメントを入力する
#. :guilabel:`&OK` を押す
#. ファイルを保存する

完了後、以下の動作が可能になる：

* 旧版を閲覧する
* すべての版を比較する
* 版コメントを見直す
* 版を削除する
