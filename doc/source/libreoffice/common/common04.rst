======================================================================
Chapter 4, Working with Styles, Templates, and Hyperlinks ノート
======================================================================

.. include:: ./common-inc.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

雛形やスタイルの存在理由は LibreOffice 文書の書式の一貫性を確保することにある。
執筆者はこれらと手動書式設定を使って文書を完成に近づける。

スタイル
   LibreOffice においてスタイルという場合、テキストなどの物に適用できる書式属性
   の集まりだ。テキストや物が LibreOffice でスタイルを共有している場合、実際には
   そのスタイルの選択された属性を共有する。たとえば、段落スタイルには、フォント
   の種類や大きさ、字下げ、行間、ページ上の配置などの設定を含める。

   LibreOffice アプリケーションすべてに削除不可既定スタイルセットが共有されてい
   るが、使用者の書式設定要件に合わせて変更することが可能だ。また、新しいスタイ
   ルを作成したり、削除することも可能だ。
雛形
   雛形は文書であり、既存の内容と特定の書式スタイル、グラフィック、表、物などか
   らなる集合を持つ新規文書を生成できるようにするものだ。雛形は会社の文書や使用
   者手引のために、類似した文書を作成するためのたたき台として用いられる。たとえ
   ば、文書で段落スタイルと文字スタイルを定義し、その文書を雛形として保
   存する。その後、|FileNewTemplatesM| コマンドを使えば、その雛形と同じ見てくれ
   の新規文書を作成可能だ。

   LibreOffice で新規作成する文書には、ソフトウェアにハードコードされた既定テン
   プレートが用いられる。この既定雛形は使用者の要件に合わせて変更することが可能
   だ。

   LibreOffice をインストールした時点で、雛形各種がインストールされる。
手動書式設定
   選択したテキストなどに直接、つまり手動で書式を適用する。たとえば、単語を選択
   し、|FormattingToolbar| や |Sidebar| のツールをクリックするなどして、テキスト
   を太字や斜体に変える。この手法を適用すると書式属性が整合しない文書が作成され
   ることがある。

Styles
======================================================================

Working with styles
----------------------------------------------------------------------

スタイルを使用すると選択した要素（ページ、テキスト、枠、升目、画像等）の書式や外
観をすばやく変更できる。スタイルは Body Text や Document Title などのような名前
で識別される。複数の例えばテキストに対して、共通の書式を与えるというのが本質だ。

LibreOffice はスタイルの使用を推奨している。作業負荷を軽減し、優れた文書を作成す
る精度を高める。

.. note::

   手動書式設定は、適用されているスタイルよりも優先され、一度手動で書式設定され
   た要素は、スタイルによって変更することは不可能になる。直接書式を削除するには
   Clear Direct Formatting コマンドをそのような要素に対して実行する。

   * 右クリックメニュー :menuselection:`Clear &Direct Formatting`
   * |MenuBar| :menuselection:`F&ormat-->Clear &Direct Formatting`
   * キーバインド |Ctrl+M|

   個人的には URL 文字列のホットリンクを削除するのによく使う。

Style categories
----------------------------------------------------------------------

LibreOffice アプリケーションによって存在するスタイルの区分が異なる。

.. csv-table::
   :delim: @
   :header-rows: 1
   :widths: auto

   Application @ Style Categories
   Writer @ Page, Paragraph, Character, Frame, List, Table
   Calc @ Page, Cell, Drawing
   Draw @ Drawing
   Impress @ Presentation, Drawing

.. admonition:: 読者ノート

   Calc には Drawing 区分もあると思うが、本マニュアルには記載されていない。漏れ
   か？

.. _common04-anchor-A:

Style types
----------------------------------------------------------------------

想像するに |StylesDeck| 下部にあるドロップダウンリストが項目一覧の表示フィルター
になっている。重要なスタイル種別を知っておく：

Hierarchical
   スタイルがおそらく継承関係に基づいて木表示される。見通しが良い。
All Styles
   選択したスタイル区分のスタイルすべてを一覧表示する。
Hidden Styles
   文書では隠されているスタイルを一覧表示する。
Applied Styles
   選択したスタイル区分の、現在の文書に適用されているものすべてを一覧表示する。
Custom Styles
   選択したスタイル区分の、使用者定義スタイルすべてを一覧表示する。
Automatic
   現在の文脈に適したスタイルを一覧表示する。

Applying styles
----------------------------------------------------------------------

スタイルを選択、適用する手段はさまざまだ：

* |Sidebar| |StylesDeck| を選択する
* |MenuBar| :menuselection:`&View-->St&yles...` を実行する
* (Writer, Calc) |MenuBar| |StylesM| から選択する
* (Writer) |FormattingToolbar| |SetParStyleList| で選択
* (Calc) |FormattingToolbar| |ApplyStyleList| で選択
* (Writer) 右クリックメニュー :menuselection:`C&haracter-->`,
  :menuselection:`P&aragraph-->`, :menuselection:`&List-->` から選択する
* (Calc) 右クリックメニュー |StylesC| から選択する
* キーバインドを使う

Styles deck on Sidebar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|StylesDeck| を使用すると文書で使用可能なスタイルをすべて表示可能だ。

表示切替にはキーバインド |F11| がいちばん早い。

スタイルのプレビューを表示するには、甲板下部にある :guilabel:`Show previews` を
オンにする。

スタイル区分（前述）を選択するには、甲板上部にある図像のいずれかをクリックする。
選択した区分で利用可能なスタイルが表示される。

スタイル型を選択するには、ドロップダウンリストをクリックして開き、必要な項目を選
択する。使用できるスタイル型は開いている LibreOffice アプリケーションと編集する
文書の種類によって異なる。前者については :ref:`common04-anchor-A` を見ろ。

対象にスタイルを適用するには、文書内のテキストにキャレットを置くか、対象物を選択
し、|Sidebar| |StylesDeck| で必要なスタイルをダブルクリックする。

Splotlighting styles
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|StylesDeck| には段落スタイルと文字スタイル、および文書に存在する直接書式にス
ポットライトを当てる道具もある。Spotlight ツールは使用中のスタイルと直接書式設定
に関して、文書の浄書を支援する。

この機能を有効にするには、|StylesDeck| 下部の :guilabel:`Spotlight` をオンにする。

段落のスポットライト表示は左余白に表示される数字と色で符号化される。これらは
|StylesDeck| 表示されている数字と色に対応している。

文字スポットライト表示は吹き出しに表示される数字と色で符号化される。

手動書式設定された段落は余白のスポットライト色の指示部にハッチパターンで示され
る。

手動書式設定された文字はテキストの横に ``df`` という文字列の吹き出しで示される。

.. note::

   |MenuBar| :menuselection:`F&ormat-->Sp&otlight-->&Charater Direct Formatting`
   の選択が必要になる場合がある。

.. admonition:: 利用者ノート

   これはいい機能を知った。自作の職務経歴書で使うと己のスタイル操作能力がよくわ
   かった。

Styles menu
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|StylesM| は Writer および Calc で利用可能だ。ここにあるスタイルは工場出荷時に設
定済みだ。

Applying styles with the context menu
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writer のコンテキストメニューでは選択テキストにスタイルを適用することが可能だ。
す。|StylesC| から :menuselection:`C&haracter-->`,
:menuselection:`P&aragraph-->`, :menuselection:`&List-->` のいずれかを選択し、サ
ブメニューから適切なスタイルを選択する。

Calc では升目を選択し、右クリックメニューを表示し、|StylesC| を選択して升目に対
してスタイルを適用する。

Formatting toolbar
----------------------------------------------------------------------

.. rubric:: Writer

段落スタイルが作成され、テキストに適用されている場合、|FormattingToolbar| の左端
にある |SetParStyleList| にスタイル名が示される。

.. rubric:: Calc

Calc でスタイルを作成し、升目に適用すると、|FormattingToolbar| の左端にある
|ApplyStyleList| にスタイル名が表示される。

Fill Format Mode
----------------------------------------------------------------------

|StylesDeck| でのスタイル項目ダブルクリックを使用せずに、Writer および Calc の複
数要素にスタイルを適用する必要がある場合は、Fill Format Mode を利用するといい。

#. |StylesDeck| で所望のスタイルを選択する。
#. 甲板上部にある :guilabel:`Fill Format Mode` 図像をクリックすると、マウスカー
   ソルの形が専用形状に変化する。
#. マウスカーソルを適用要素に置く。
#. クリックすると、選択した要素にスタイルが適用される。

Keyboard shortcuts
----------------------------------------------------------------------

Writer ではキーバインドを使って選択段落に段落スタイルを適用したり、スタイル編集
を行うことが可能だ。主要なキーバインドは表にまとめられている。

* |Ctrl| と数字キーのキーバインドは本文と見出しのスタイル
* |Alt| + :kbd:`P` はスタイル編集ダイアログボックスが一発で表示されて便利
* |F11| で |StylesDeck| の表示切替

Creating new styles
----------------------------------------------------------------------

Using a styles dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|StylesDeck| からスタイルを作成することが可能。詳細はアプリケーション個別のガイ
ド本を参照しろ。

#. |StylesDeck| 上部にある所望のスタイル区分をクリックし、その区分のスタイル一覧
   を開く。
#. 一覧にあるスタイル項目を右クリックし、コンテキストメニューから |NewC| を選択
   する。区分に対応するスタイルダイアログが開く。例：段落なら段落用。
#. |OrganizerTab| を開く。名前などを入力する。
#. 他のプロパティーページで利用可能な選択肢を使用して、新しいスタイルを要件に合
   わせて書式設定する。プレビューがある場合は活用するといい。
#. すべて指定したら |OK| を押して新しいスタイルを保存し、設定を終わる。

.. note::

   :guilabel:`&Inherit from` にスタイルを指定した場合、この基底スタイルに対する
   書式変更が作成された新しいスタイルにも適用される。

Creating new style from a selection
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

選択したテキストまたはセルの書式を使用してスタイルを新規作成可能だ。この方法で作
成したスタイルは当該ドキュメントに限り使用可能だ。

#. |StylesDeck| 上部にある所望のスタイル区分をクリックし、その区分のスタイル一覧
   を開く。
#. 新規スタイルの基として使用する要素を文書から選択する。
#. 次のいずれかの手順で新規スタイルを作成し、|NewStyleFromSelectionDlg| を開く：

   * (Writer) :guilabel:`Styles actions` ドロップダウンメニューから
     :menuselection:`&New Style from Selection` を選択する。
   * (Calc, Draw, Impress) 甲板上部の :guilabel:`&New Style from Selection` 図像
     を選択する。

#. |NewStyleFromSelectionDlg| で新規スタイルの名前を入力する。
#. |OK| を押すと、選択した書式オプションを使用して選択したスタイル区分にスタイル
   が新規作成される。

.. note::

   |NewStyleFromSelectionDlg| には文書で使用可能なカスタムスタイル一覧が表示され
   る。選択範囲から作成された新しいスタイルはカスタムスタイルに既定で配置される。

Dragging and dropping
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writer および Calcでは、選択した要素を |Sidebar| |StylesDeck| にドラッグ＆ドロッ
プすることでスタイルを新規作成可能だ。新規スタイルは選択対象の書式設定に基づいて
作成される。この方法を使用する手順は次のとおり：

#. |StylesDeck| 上部にある所望のスタイル区分をクリックし、その区分のスタイル一覧
   を開く。
#. 文書からテキストまたはセルを選択し、その選択対象を甲板にドラッグ＆ドロップす
   る。
#. |NewStyleFromSelectionDlg| で新規スタイルの名前を入力する。
#. |OK| を押す。新規スタイルは :guilabel:`Custom Styles` に配置される。

.. admonition:: 利用者ノート

   いきなりドラッグ＆ドロップはダメだ。対象物に適合する一覧を甲板に先に出さない
   といけない。

Editing styles
----------------------------------------------------------------------

LibreOffice インストールによる既定のスタイルセットにあるスタイルは削除不能だが、
編集は可能だ。使用者が作成したスタイルはすべて編集・削除が可能だ。

スタイルは次の方法のいずれかで編集可能だ：

* |Sidebar| |StylesDeck| に書式設定済み要素をドラッグ＆ドロップ
* 書式設定済み要素を選択し、そのスタイルを編集する。
* :ref:`AutoUpdate<common04-anchor-B>` を使用してスタイルを編集する（段落と枠に
  限る）。
* 他の文書や雛形から文書にスタイルを追加する。

.. note::

   スタイルの編集や変更は、現在の文書に限り有効だ。複数の文書でスタイルを編集ま
   たは変更するには、雛形を変更するか、別の文書からスタイルを読み込む必要があ
   る。

Using a styles dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スタイル自身の編集を行う手順は作成手順とよく似ている：

#. |StylesDeck| 上部にある所望のスタイル区分をクリックし、その区分のスタイル一覧
   を開く。
#. 一覧にあるスタイル項目を右クリックし、コンテキストメニューから |EditStyleC|
   を選択する。区分に対応するスタイルダイアログが開く。
#. 後は作成時と同様にする。

Set Paragraph Style or Apply Style
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writer と Calc に搭載されている |FormattingToolbar| の先頭にある（既定）ドロップ
ダウンリストからもまたスタイルを編集することが可能だ。

#. 段落 (Writer) や升目 (Calc) を選択する。
#. |FormattingToolbar| の :guilabel:`Set Paragraph Style` (Writer) または
   :guilabel:`Apply Style` (Calc) ドロップダウンリストをクリックする。
#. 一覧項目を選択しようとすると、項目右側に ▼ が現れるので、それをクリックし、ド
   ロップダウンメニューから |EditStyleC| を選択する。以下、スタイル編集手順に合
   流。

.. admonition:: 利用者ノート

   意外に重要かもしれない。例えばスプレッドシートの通常升目のフォントが何か変だ
   と思ったらこの手順で Default 升目スタイルのフォントを確認するといい。

Updating styles from selection
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. |StylesDeck| を開く。
#. 所望のスタイルの属性が設定されている要素（段落や升目）を文書から選択する。
#. |StylesDeck| にて選択範囲から更新するスタイルを選択する。
#. 次のいずれかの方法でスタイルを更新する：

   * |Sidebar| 上部右側図像から :menuselection:`&Update Selected Style` を選択
   * (Writer, Calc) |FormattingToolbar| の例のドロップダウンリストを使って、選択
     スタイル項目の ▼ ドロップダウンメニューから :menuselection:`&Update to
     Match Selection` を選択
   * (Writer, Calc) |MenuBar| :menuselection:`St&yles-->&Update Selected Style`
     を選択
   * キーバインド |Ctrl+Shift| + |F11| を押す

.. _common04-anchor-B:

Using AutoUpdate
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|OrganizerTab| に AutoUpdate があり、それがオンである場合、そのスタイルに含まれ
る段落や枠を直接書式設定するたびにスタイルが更新される。Writer では AutoUpdate
は段落スタイルと枠スタイルにしか適用されない。詳しくは |Writer| を見ろ。

Renaming styles
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スタイルの名前を変更することが可能なのはカスタムスタイルのみ。スタイル編集時に
|OrganizerTab| を使う。

Deleting styles
----------------------------------------------------------------------

削除可能であるスタイルはカスタムスタイルに限る。

#. |StylesDeck| 下部のスタイル区分ドロップダウンリストで :guilabel:`Custom
   Styles` を選択する。
#. 一覧から削除するカスタムスタイルを選択する。|Ctrl| キーを使えば複数選択可。
#. 右クリックメニューから :menuselection:`&Delete...` を選択する。

.. note::

   使用中のスタイルが削除されると、そのスタイルを使用していたすべての要素は既定
   スタイルに変化する。

Page styles
----------------------------------------------------------------------

ページスタイルは |Writer| または |Calc| で作成可能だ。前者のそれは重要度が高い気
がする。

Templates
======================================================================

雛形とは文書であって、基本的には使用者が指定した書式スタイル、画像、表組、物体、
その他の情報を含むものを言う。LibreOffice では、雛形を使用して、共通の内容、書式
を持つ文書を新規に生成可能だ。

LibreOffice の文書はすべて雛形に基づく。定義済みの雛形が多数用意されている。雛形
は要件に合わせて作成可能。雛形を <https://extensions.libreoffice.org> からダウン
ロードして利用することも可能。

LibreOffice で白紙の文書を作成する場合、ソフトウェアは適切な LibreOffice 既定雛
形を用いる。必要であれば、この既定雛形を使用者要件に合ったカスタム雛形に置き換え
ることが可能だ。:ref:`common04-anchor-C` を見ろ。

Custom LibreOffice templates
----------------------------------------------------------------------

使用者が作成した雛形は My Templates フォルダーに保存され、次回の LibreOffice を
起動からそれらの雛形が LibreOffice 起動ウィンドウと |TemplatesDlg| に現れる。

Creating new documents from a template
----------------------------------------------------------------------

.. |FilterDDL| replace:: :guilabel:`Filter` ドロップダウンリスト

|TemplatesDlg| では以下の手順で文書を新規作成する：

#. |TemplatesDlg| を開く。次のどの方法でもよい：

   * |MenuBar| から |FileNewTemplatesM| を選択する
   * |MenuBar| から |ManageTemplatesM| を選択する
   * キーバインド |Ctrl+Shift| + :kbd:`N` を押す
   * |StandardToolbar| 上の :guilabel:`New` 図像脇 ▼ をクリックしてドロップダウ
     ンメニューから :menuselection:`Te&mplates...` を選択する
   * LibreOffice Start Center にある :guilabel:`T&emplates` を押す

#. 雛形を表示する場所を決定し、|FilterDDL| で LibreOffice アプリケーションと雛形
   区分を選択する。
#. 以下のいずれかの方法で、その雛形で文書を生成する：

   * 選択した雛形をダブルクリックする
   * 雛形を右クリックして |OpenC| を選択
   * |TemplatesDlg| 下部の |OpenB| を押す。

Creating a template
----------------------------------------------------------------------

雛形には文書内のあらゆる書式要素を保存することが可能だ。例えば、印刷機設定、ファ
イルパス、テキストや物体の色などだ。また、定義済みのテキストや図版を雛形に追加す
ることも可能だ。

#. 既存の文書を開くか、雛形に必要な種別の文書を新規作成する。
#. 例えば、会社のロゴタイプや著作権声明などの必要な内容を新しい雛形に追加する。
#. 雛形要件に追加された内容をフォーマットする。
#. 新しい雛形に必要なスタイルを作成または修正する。
#. |MenuBar| の |SaveAsTemplateM| を選択して |SaveAsTemplateDlg| を開く。
#. :guilabel:`Enter Template &Name` 欄に新しい雛形の名前を入力する。
#. :guilabel:`Select Template &Category` で利用可能な区分から雛形区分を選択する。
#. 必要であれば、:guilabel:`&Set as default template` をオンにして、必要な文書種
   別の既定雛形を変更する。
#. |SaveB| を押して雛形を保存し、ダイアログボックスを閉じる。

Template wizard
----------------------------------------------------------------------

Writer には雛形作成プロセスを高速化する Template Wizard がある。その詳細について
は |Writer| を見ろ。

.. _common04-anchor-C:

Setting default template
----------------------------------------------------------------------

特定の雛形を既定文書として指定可能だ。その雛形は LibreOffice が見つけられるよう
に |SaveAsTemplateDlg| で表示される場所に配置されている必要がある。

Changing default template
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. |MenuBar| から |FileNewTemplatesM| または |ManageTemplatesM| を実行して
   |TemplatesDlg| を開く。
#. |FilterDDL| から文書の種類を選択する。
#. 選択した文書種別の既定雛形として使用する雛形を選択する。
#. 選択した雛形を右クリックし、:menuselection:`Set as De&fault` を選択する。
#. |OpenC| を選択すると新規文書が新しい既定雛形を使って開く。次に別の雛形を選択
   せずに新規文書を作成すると、その文書は新しい既定雛形を用いる。

Resetting default template
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. |MenuBar| から |FileNewTemplatesM| または |ManageTemplatesM| を実行して
   |TemplatesDlg| を開く。
#. 現在の既定雛形を選択する（サムネイル左上のチェックアイコンの有無でわかる）。
#. 右クリックメニューから :menuselection:`Reset De&fault` を選択する。
#. |Close| を押して |TemplatesDlg| を閉じる。次回文書新規作成時から有効。

Editing templates
----------------------------------------------------------------------

既定 LibreOffice 雛形は編集不可。作成されたかインポートされたものしか編集不可。

#. |TemplatesDlg| を開く。
#. 編集する雛形を右クリックし、|EditC| を選択すると、関連する LibreOffice アプリ
   ケーションで雛形が開く。
#. 選択した雛形のスタイル、テキスト、物を編集して更新する。
#. 通常の手段 (e.g. |Ctrl+S|) で変更を保存する。
#. 雛形を閉じるか、文書を作成することで編集した雛形を使用する。

.. note::

   編集前に雛形から作成された文書は、次にその文書を開いたときに変更された雛形設
   定を表示するように更新することが可能だ。更新されたスタイルを使用するか、古い
   スタイルを維持するかを確認される。後者にする場合、確認なしに古いスタイルを継
   続する。

Organizing templates
----------------------------------------------------------------------

LibreOffice 雛形は特定のフォルダーに配置する必要がある。新しい LibreOffice 雛形
区分を新規に設けて LibreOffice 雛形の整理が可能だ。たとえば、プロジェクトや顧客
ごとに雛形区分を分けることが可能だ。雛形をインポートおよびエクスポートすること
も可能だ。

.. tip::

   そのパスは |OptionsDlg| の |PathsPage| で確認する。

Creating custom categories
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. |ManageDDM| replace:: :menuselection:`&Manage-->` ドロップダウンメニュー

|TemplatesDlg| 右上の |ManageDDM| から :menuselection:`&New Category` を選択する。
後はわかるだろう。

新規雛形区分は |FilterDDL| で確認できる。

Deleting custom categories
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|TemplatesDlg| |FilterDDL| で削除したい雛形区分を先に選択する。右上の
|ManageDDM| から :menuselection:`&Delete Category` を選択する。後はわかるだろう。

.. note::

   LibreOffice の既定区分や Extension Manager を使用した区分は削除不能。

Moving templates
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

雛形の区分を変更する処理だ。

#. |TemplatesDlg| を開く。
#. 移動する雛形を右クリックし、|MoveC| を選択する。
#. :guilabel:`Select Category` ダイアログボックスで、表示された区分一覧から区分
   を選択するか、:guilabel:`Create &a New Category` 欄に名前を入力して雛形の区分
   を新規に作成する。

あとは分かるだろう。

Deleting templates
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|TemplatesDlg| の雛形一覧から右クリックメニューを開いて |DeleteC| を選択する。あ
とは分かるだろう。

.. note::

   LibreOffice に付属の雛形、または Extension Manager を使用してインストールされ
   た雛形は削除不能。削除できるのは、LibreOffice で作成したものか、他の雛形供給
   源からインポートしたものに限る。

Renaming templates
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|TemplatesDlg| の雛形一覧から右クリックメニューを開いて |RenameC| を選択する。あ
とは分かるだろう。

.. note::

   削除の場合と同じ注意が当てはまる。

Importing templates
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* 雛形の供給源を指すときに保管庫という術語を用いることにする。
* <https://extensions.libreoffice.org/> には LibreOffice 用雛形保管庫がある。
* 雛形が計算機上の別の場所にある場合、LibreOffice がその雛形を認識するには、それ
  を LibreOffice 区分にインポートする必要がある。

インポート手順を記す：

#. <https://extensions.libreoffice.org/> などから必要な雛形を計算機にダウンロー
   ドする。
#. |TemplatesDlg| を開く。
#. |FilterDDL| を当たって必要な文書種別と雛形区分を選択する。
#. |ManageDDM| から :menuselection:`&Import` を選択。
#. |OpenFileDlg| を使って雛形があるフォルダーを探す。
#. |FileTypeList| で `Templates` を選択して、利用可能な雛形を表示する。
#. 雛形を選択し、|Open| を押して選択した区分に雛形をインポートする。

Exporting templates
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. |TemplatesDlg| を開く。
#. エクスポートする雛形を右クリックして :menuselection:`E&xport` を選択する。
#. 雛形をエクスポートするフォルダーに移動し、|OK| を押す。

Hyperlinks
======================================================================

Absolute and relative hyperlinks
----------------------------------------------------------------------

ハイパーリンクには絶対リンクと相対リンクの二種類がある。

絶対ハイパーリンクは、現在のドメインまたはファイルの場所の外にある Web ページに
リンクする。絶対ハイパーリンクには、``https://libreoffice.org`` のように、対象の
ファイルまたは Web サイトの完全なアドレスを含める必要がある。絶対ハイパーリンク
は対象がインターネット内の新しい場所に移動すると機能しなくなる（リンク切れ）。

相対ハイパーリンクは文書の現在のファイルパスからの相対アドレスを部分として含む。
相対ハイパーリンクは文書が現在の場所から削除されると機能しなくなる。

Inserting hyperlinks
----------------------------------------------------------------------

#. ハイパーリンクを入れる場所を選択する。
#. |MenuBar| から |InsertHyperlinkM| を選択するか、キーバインド |Ctrl+K| を押し
   て |HyperlinkDlg| を開く。
#. ハイパーリンクを絶対リンクにするか相対リンクにするかを決める。
#. |ApplyButton| を押して文書にハイパーリンクを入れる。
#. ダイアログボックスを閉じる。

.. tip::

   LibreOffice は Web サイトの URL をハイパーリンクに自動変換する。この機能をオ
   フにするには |OptionsDlg| AutoCorrect 周りをいじる。

.. note::

   Writer および Calc では Navigator を使用してハイパーリンクを入れられる。詳細
   については |Writer| および |Calc| を見ろ。

Hyperlink types
----------------------------------------------------------------------

|HyperlinkDlg| 左柱を見ろ。

.. rubric:: Internet

Web または FTP プロトコルのいずれかを選択する。:guilabel:`&URL` 欄に必要なアドレ
スを、:guilabel:`Te&xt` 欄にハイパーリンクの名前を入力する。

.. rubric:: Mail

:guilabel:`Re&cipient` に電子メールの詳細を入力し、:guilabel:`&Subject` にリンク
の件名を入力する。

.. rubric:: Document

別の文書や文書内の別の場所へのリンク。一般にブックマークと呼ばれる。

:guilabel:`P&ath` 欄に直接入力するか、右のフォルダーボタンを押して |OpenFileDlg|
を開く。リンク先が同じ文書内のどこかである場合は空白のままにする。

リンク先をオプションで指定する。標的ボタンを押すとリンク先指定専用ダイアログボッ
クスが開く。リンク先の名前がわかっている場合は :guilabel:`Targ&et` 欄に直接入力
する。

.. rubric:: New Document

新規文書をリンクする。使わないので割愛。

.. rubric:: Further Settings

これらの設定は、すべてのハイパーリンク型に共通だが、選択肢のいくつかはリンクの型
により関連性がある。

:guilabel:`Fr&ame`
   ハイパーリンクの開き方を決定する値を設定する。Web ブラウザーで開く文書に適用
   される。
:guilabel:`F&orm`
   リンクをテキストとして表示するか、ボタンとして表示するかを指定する。
:guilabel:`Te&xt`
   使用者に見えるテキストを指定する。
:guilabel:`N&ame`
   |HTML| 文書に適用される。ハイパーリンクの後ろにある |HTML| コードの ``NAME``
   属性として追加されるテキストを指定する。

Editing hyperlinks
----------------------------------------------------------------------

#. 以下のいずれかの方法でハイパーリンクを選択する。アプリケーションによって異な
   る：

   * ハイパーリンクテキスト内のどこかをクリックする。
   * 選択範囲線をクリックしてハイパーリンクテキスト上にドラッグする。テキスト
     ボックス境界線と選択ハンドルが表示される。
   * ハイパーリンクをダブルクリックする。編集ボックスが開く。
#. 編集モードを選択し、|HyperlinkDlg| を開く。
#. |HyperlinkDlg| でリンクを変更し、|ApplyButton| を押して変更を保存する。ダイア
   ログボックスはまだ開いている。
#. ハイパーリンクの編集が終わったら |OK| を押す。

Removing hyperlinks
----------------------------------------------------------------------

ハイパーリンクをプレーンテキストにするには、リンクを右クリックし
:menuselection:`Remove Hyperlink` を選択する。ハイパーリンクを削除するには、ハイ
パーリンクを選択し、|Del| または |BackSpace| を押す。
