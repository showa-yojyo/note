======================================================================
Chapter 4, Working with Styles, Templates, and Hyperlinks ノート
======================================================================

.. include:: ./common-inc.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

テンプレートやスタイルの存在理由は LibreOffice 文書の書式の一貫性を確保すること
にある。執筆者はこれらと手動書式設定を使って文書を完成に近づける。

スタイル
   LibreOffice においてスタイルという場合、テキストなどの物に適用できる書式属性
   の集まりだ。テキストや物が LibreOffice でスタイルを共有している場合、実際には
   そのスタイルの選択された属性を共有する。たとえば、段落スタイルには、フォント
   の種類や大きさ、字下げ、行間、ページ上の配置などの設定を含める。

   LibreOffice アプリケーションすべてに削除不可既定スタイルセットが共有されてい
   るが、使用者の書式設定要件に合わせて変更することが可能だ。また、新しいスタイ
   ルを作成したり、削除することも可能だ。
テンプレート
   テンプレートは文書であり、既存の内容と特定の書式スタイル、グラフィック、表、
   物などからなる集合を持つ新規文書を生成できるようにするものだ。テンプレートは
   会社の文書や使用者手引のために、類似した文書を作成するためのたたき台として用
   いられる。たとえば、文書で段落スタイルと文字スタイルを定義し、その文書をテン
   プレートとして保存する。その後、:menuselection:`&File-->&New-->Te&mplates...`
   コマンドを使えば、そのテンプレートと同じ見てくれの新規文書を作成可能だ。

   LibreOffice で新規作成する文書には、ソフトウェアにハードコードされた既定テン
   プレートが用いられる。この既定テンプレートは使用者の要件に合わせて変更するこ
   とが可能だ。

   LibreOffice をインストールした時点で、テンプレート各種がインストールされる。
手動書式設定
   選択したテキストなどに直接、つまり手動で書式を適用する。たとえば、単語を選択
   し、|FormattingToolbar| や |Sidebar| のツールをクリックするなどして、テキスト
   を太字や斜体に変える。この手法を適用すると書式属性が整合しない文書が作成され
   ることがある。

Styles
======================================================================

Working with styles
----------------------------------------------------------------------

スタイルを使用すると選択した要素（ページ、テキスト、枠、升目、画像等）の書式や外
観をすばやく変更できる。スタイルは Body Text や Document Title などのような名前
で識別される。複数の例えばテキストに対して、共通の書式を与えるというのが本質だ。

LibreOffice はスタイルの使用を推奨している。作業負荷を軽減し、優れた文書を作成す
る精度を高める。

.. note::

   手動書式設定は、適用されているスタイルよりも優先され、一度手動で書式設定され
   た要素は、スタイルによって変更することは不可能になる。直接書式を削除するには
   Clear Direct Formatting コマンドをそのような要素に対して実行する。

   * 右クリックメニュー :menuselection:`Clear &Direct Formatting`
   * |MenuBar| :menuselection:`F&ormat-->Clear &Direct Formatting`
   * キーバインド |Ctrl+M|

   個人的には URL 文字列のホットリンクを削除するのによく使う。

Style categories
----------------------------------------------------------------------

LibreOffice アプリケーションによって存在するスタイルの区分が異なる。

.. csv-table::
   :delim: @
   :header-rows: 1
   :widths: auto

   Application @ Style Categories
   Writer @ Page, Paragraph, Character, Frame, List, Table
   Calc @ Page, Cell, Drawing
   Draw @ Drawing
   Impress @ Presentation, Drawing

.. admonition:: 読者ノート

   Calc には Drawing 区分もあると思うが、本マニュアルには記載されていない。漏れ
   か？

.. _common04-anchor-A:

Style types
----------------------------------------------------------------------

想像するに |StylesDeck| 下部にあるドロップダウンリストが項目一覧の表示フィルター
になっている。重要なスタイル種別を知っておく：

Hierarchical
   スタイルがおそらく継承関係に基づいて木表示される。見通しが良い。
All Styles
   選択したスタイル区分のスタイルすべてを一覧表示する。
Hidden Styles
   文書では隠されているスタイルを一覧表示する。
Applied Styles
   選択したスタイル区分の、現在の文書に適用されているものすべてを一覧表示する。
Custom Styles
   選択したスタイル区分の、使用者定義スタイルすべてを一覧表示する。
Automatic
   現在の文脈に適したスタイルを一覧表示する。

Applying styles
----------------------------------------------------------------------

スタイルを選択、適用する手段はさまざまだ：

* |Sidebar| |StylesDeck| を選択する
* |MenuBar| :menuselection:`&View-->St&yles...` を実行する
* (Writer, Calc) |MenuBar| |StylesM| から選択する
* (Writer) |FormattingToolbar| |SetParStyleList| で選択
* (Calc) |FormattingToolbar| |ApplyStyleList| で選択
* (Writer) 右クリックメニュー :menuselection:`C&haracter-->`,
  :menuselection:`P&aragraph-->`, :menuselection:`&List-->` から選択する
* (Calc) 右クリックメニュー |StylesC| から選択する
* キーバインドを使う

Styles deck on Sidebar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|StylesDeck| を使用すると文書で使用可能なスタイルをすべて表示可能だ。

表示切替にはキーバインド |F11| がいちばん早い。

スタイルのプレビューを表示するには、甲板下部にある :guilabel:`Show previews` を
オンにする。

スタイル区分（前述）を選択するには、甲板上部にある図像のいずれかをクリックする。
選択した区分で利用可能なスタイルが表示される。

スタイル型を選択するには、ドロップダウンリストをクリックして開き、必要な項目を選
択する。使用できるスタイル型は開いている LibreOffice アプリケーションと編集する
文書の種類によって異なる。前者については :ref:`common04-anchor-A` を見ろ。

対象にスタイルを適用するには、文書内のテキストにキャレットを置くか、対象物を選択
し、|Sidebar| |StylesDeck| で必要なスタイルをダブルクリックする。

Splotlighting styles
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|StylesDeck| には段落スタイルと文字スタイル、および文書に存在する直接書式にス
ポットライトを当てる道具もある。Spotlight ツールは使用中のスタイルと直接書式設定
に関して、文書の浄書を支援する。

この機能を有効にするには、|StylesDeck| 下部の :guilabel:`Spotlight` をオンにする。

段落のスポットライト表示は左余白に表示される数字と色で符号化される。これらは
|StylesDeck| 表示されている数字と色に対応している。

文字スポットライト表示は吹き出しに表示される数字と色で符号化される。

手動書式設定された段落は余白のスポットライト色の指示部にハッチパターンで示され
る。

手動書式設定された文字はテキストの横に ``df`` という文字列の吹き出しで示される。

.. note::

   |MenuBar| :menuselection:`F&ormat-->Sp&otlight-->&Charater Direct Formatting`
   の選択が必要になる場合がある。

.. admonition:: 利用者ノート

   これはいい機能を知った。自作の職務経歴書で使うと己のスタイル操作能力がよくわ
   かった。

Styles menu
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|StylesM| は Writer および Calc で利用可能だ。ここにあるスタイルは工場出荷時に設
定済みだ。

Applying styles with the context menu
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writer のコンテキストメニューでは選択テキストにスタイルを適用することが可能だ。
す。|StylesC| から :menuselection:`C&haracter-->`,
:menuselection:`P&aragraph-->`, :menuselection:`&List-->` のいずれかを選択し、サ
ブメニューから適切なスタイルを選択する。

Calc では升目を選択し、右クリックメニューを表示し、|StylesC| を選択して升目に対
してスタイルを適用する。

Formatting toolbar
----------------------------------------------------------------------

.. rubric:: Writer

段落スタイルが作成され、テキストに適用されている場合、|FormattingToolbar| の左端
にある |SetParStyleList| にスタイル名が示される。

.. rubric:: Calc

Calc でスタイルを作成し、升目に適用すると、|FormattingToolbar| の左端にある
|ApplyStyleList| にスタイル名が表示される。

Fill Format Mode
----------------------------------------------------------------------

|StylesDeck| でのスタイル項目ダブルクリックを使用せずに、Writer および Calc の複
数要素にスタイルを適用する必要がある場合は、Fill Format Mode を利用するといい。

#. |StylesDeck| で所望のスタイルを選択する。
#. 甲板上部にある :guilabel:`Fill Format Mode` 図像をクリックすると、マウスカー
   ソルの形が専用形状に変化する。
#. マウスカーソルを適用要素に置く。
#. クリックすると、選択した要素にスタイルが適用される。

Keyboard shortcuts
----------------------------------------------------------------------

Writer ではキーバインドを使って選択段落に段落スタイルを適用したり、スタイル編集
を行うことが可能だ。主要なキーバインドは表にまとめられている。

* |Ctrl| と数字キーのキーバインドは本文と見出しのスタイル
* |Alt| + :kbd:`P` はスタイル編集ダイアログボックスが一発で表示されて便利
* |F11| で |StylesDeck| の表示切替

Creating new styles
----------------------------------------------------------------------

Using a styles dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|StylesDeck| からスタイルを作成することが可能。詳細はアプリケーション個別のガイ
ド本を参照しろ。

#. |StylesDeck| 上部にある所望のスタイル区分をクリックし、その区分のスタイル一覧
   を開く。
#. 一覧にあるスタイル項目を右クリックし、コンテキストメニューから |NewC| を選択
   する。区分に対応するスタイルダイアログが開く。例：段落なら段落用。
#. |OrganizerTab| を開く。名前などを入力する。
#. 他のプロパティーページで利用可能な選択肢を使用して、新しいスタイルを要件に合
   わせて書式設定する。プレビューがある場合は活用するといい。
#. すべて指定したら |OK| を押して新しいスタイルを保存し、設定を終わる。

.. note::

   :guilabel:`&Inherit from` にスタイルを指定した場合、この基底スタイルに対する
   書式変更が作成された新しいスタイルにも適用される。

Creating new style from a selection
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

選択したテキストまたはセルの書式を使用してスタイルを新規作成可能だ。この方法で作
成したスタイルは当該ドキュメントに限り使用可能だ。

#. |StylesDeck| 上部にある所望のスタイル区分をクリックし、その区分のスタイル一覧
   を開く。
#. 新規スタイルの基として使用する要素を文書から選択する。
#. 次のいずれかの手順で新規スタイルを作成し、|NewStyleFromSelectionDlg| を開く：

   * (Writer) :guilabel:`Styles actions` ドロップダウンメニューから
     :menuselection:`&New Style from Selection` を選択する。
   * (Calc, Draw, Impress) 甲板上部の :guilabel:`&New Style from Selection` 図像
     を選択する。

#. |NewStyleFromSelectionDlg| で新規スタイルの名前を入力する。
#. |OK| を押すと、選択した書式オプションを使用して選択したスタイル区分にスタイル
   が新規作成される。

.. note::

   |NewStyleFromSelectionDlg| には文書で使用可能なカスタムスタイル一覧が表示され
   る。選択範囲から作成された新しいスタイルはカスタムスタイルに既定で配置される。

Dragging and dropping
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writer および Calcでは、選択した要素を |Sidebar| |StylesDeck| にドラッグ＆ドロッ
プすることでスタイルを新規作成可能だ。新規スタイルは選択対象の書式設定に基づいて
作成される。この方法を使用する手順は次のとおり：

#. |StylesDeck| 上部にある所望のスタイル区分をクリックし、その区分のスタイル一覧
   を開く。
#. 文書からテキストまたはセルを選択し、その選択対象を甲板にドラッグ＆ドロップす
   る。
#. |NewStyleFromSelectionDlg| で新規スタイルの名前を入力する。
#. |OK| を押す。新規スタイルは :guilabel:`Custom Styles` に配置される。

.. admonition:: 利用者ノート

   いきなりドラッグ＆ドロップはダメだ。対象物に適合する一覧を甲板に先に出さない
   といけない。

Editing styles
----------------------------------------------------------------------

LibreOffice インストールによる既定のスタイルセットにあるスタイルは削除不能だが、
編集は可能だ。使用者が作成したスタイルはすべて編集・削除が可能だ。

スタイルは次の方法のいずれかで編集可能だ：

* |Sidebar| |StylesDeck| に書式設定済み要素をドラッグ＆ドロップ
* 書式設定済み要素を選択し、そのスタイルを編集する。
* :ref:`AutoUpdate<common-04-anchor-B>` を使用してスタイルを編集する（段落と枠に
  限る）。
* 他の文書やテンプレートから文書にスタイルを追加する。

.. note::

   スタイルの編集や変更は、現在の文書に限り有効だ。複数の文書でスタイルを編集ま
   たは変更するには、テンプレートを変更するか、別の文書からスタイルを読み込む必
   要がある。

Using a styles dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スタイル自身の編集を行う手順は作成手順とよく似ている：

#. |StylesDeck| 上部にある所望のスタイル区分をクリックし、その区分のスタイル一覧
   を開く。
#. 一覧にあるスタイル項目を右クリックし、コンテキストメニューから |EditStyleC|
   を選択する。区分に対応するスタイルダイアログが開く。
#. 後は作成時と同様にする。

Set Paragraph Style or Apply Style
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writer と Calc に搭載されている |FormattingToolbar| の先頭にある（既定）ドロップ
ダウンリストからもまたスタイルを編集することが可能だ。

#. 段落 (Writer) や升目 (Calc) を選択する。
#. |FormattingToolbar| の :guilabel:`Set Paragraph Style` (Writer) または
   :guilabel:`Apply Style` (Calc) ドロップダウンリストをクリックする。
#. 一覧項目を選択しようとすると、項目右側に ▼ が現れるので、それをクリックし、ド
   ロップダウンメニューから |EditStyleC| を選択する。以下、スタイル編集手順に合
   流。

.. admonition:: 利用者ノート

   意外に重要かもしれない。例えばスプレッドシートの通常升目のフォントが何か変だ
   と思ったらこの手順で Default 升目スタイルのフォントを確認するといい。

Updating styles from selection
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. |StylesDeck| を開く。
#. 所望のスタイルの属性が設定されている要素（段落や升目）を文書から選択する。
#. |StylesDeck| にて選択範囲から更新するスタイルを選択する。
#. 次のいずれかの方法でスタイルを更新する：

   * |Sidebar| 上部右側図像から :menuselection:`&Update Selected Style` を選択
   * (Writer, Calc) |FormattingToolbar| の例のドロップダウンリストを使って、選択
     スタイル項目の ▼ ドロップダウンメニューから :menuselection:`&Update to
     Match Selection` を選択
   * (Writer, Calc) |MenuBar| :menuselection:`St&yles-->&Update Selected Style`
     を選択
   * キーバインド |Ctrl+Shift| + |F11| を押す

.. _common-04-anchor-B:

Using AutoUpdate
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|OrganizerTab| に AutoUpdate があり、それがオンである場合、そのスタイルに含まれ
る段落や枠を直接書式設定するたびにスタイルが更新される。Writer では AutoUpdate
は段落スタイルと枠スタイルにしか適用されない。詳しくは |Writer| を見ろ。

Renaming styles
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

スタイルの名前を変更することが可能なのはカスタムスタイルのみ。スタイル編集時に
|OrganizerTab| を使う。

Deleting styles
----------------------------------------------------------------------

削除可能であるスタイルはカスタムスタイルに限る。

#. |StylesDeck| 下部のスタイル区分ドロップダウンリストで :guilabel:`Custom
   Styles` を選択する。
#. 一覧から削除するカスタムスタイルを選択する。|Ctrl| キーを使えば複数選択可。
#. 右クリックメニューから :menuselection:`&Delete...` を選択する。

.. note::

   使用中のスタイルが削除されると、そのスタイルを使用していたすべての要素は既定
   スタイルに変化する。

Page styles
----------------------------------------------------------------------

ページスタイルは |Writer| または |Calc| で作成可能だ。前者のそれは重要度が高い気
がする。

----

.. rubric:: 章末注
