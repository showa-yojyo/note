======================================================================
Chapter 1, LibreOffice Basics ノート
======================================================================

.. include:: ./common-inc.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Installation and starting LibreOffice
======================================================================

Installation
----------------------------------------------------------------------

Windows では LibreOffice インストール時にショートカットアイコンがデスクトップに
生じるとある。個人的に邪魔なのでこれを削除する。

Starting
----------------------------------------------------------------------

LibreOffice Start Center の使用法について。いちおう確認。

* Start Center に表示されているファイルアイコンを選択すれば、それに対応するアプ
  リケーションが起動することで当該ファイルが開く。
* Start Center で :guilabel:`Templates` を選択し、新規ファイルのテンプレートを選
  択すると、そのテンプレートに関連するアプリケーションが開く。
* :guilabel:`Open File` を選択するとファイルダイアログボックスが開く。そこでファ
  イルを選択し、「開く」ボタンを押すと対応アプリケーションが起動して選択ファイル
  が開く。
* :guilabel:`Remote Files` は選択ファイルがリモートにある場合の方法。

:guilabel:`Filter` ドロップダウンリストに注意。

.. tip::

   Start Center 内にファイルをピン留めすることが可能。

.. note::

   Windows Explorer で LibreOffice アプリケーションに関連するファイルアイコンを
   ダブルクリックすると、対応アプリケーションが必要に応じて起動し、指定ファイル
   が開く。

Closing LibreOffice
----------------------------------------------------------------------

LibreOffice を終了するには、通常の Windows デスクトップアプリケーションに対する
終了手段がそのまま使用可能だ。

* |MenuBar| から :menuselection:`&File-->E&xit` を選択
* キーバインド |Ctrl+Q| を押す
* 開いている文書が一つしかない場合にはアプリケーションウィンドウ右上のバツジルシ
  をクリック

Main LibreOffice window
======================================================================

LibreOffice アプリケーションすべてに共通して、メインウィンドウの上部に Title
バー、|MenuBar|、|StandardToolbar| があり、ウィンドウの下部に |StatusBar| がある。

特殊な UI も搭載されている。それについては :doc:`common13` 参照。

Title bar
----------------------------------------------------------------------

Title バーに基本的には現在の文書のファイル名が示される。文書が新規作成されると、
文書名は :guilabel:`Untitled X` のようなものになる。ここで X は数字。新規文書に
は作成順に番号が付けられる。

Menu bar
----------------------------------------------------------------------

Writer を例に挙げて |MenuBar| にあるメニューを解説している。省略。

Toolbars
----------------------------------------------------------------------

LibreOffice のツールバーはそれが見えている場合、docked か floating のどちらかの
状態をとる。

既定では、|StandardToolbar| はどのアプリケーションでもウィンドウ上部に docked で
あり、二番目のツールバーが何であるかはアプリケーションによって異なる。

特に重要なのは、二番目のツールバーは状況依存型であることだ。通常は何が選択されて
いるかによってツールセットが変化する。そのため、例えば Writer で描画物が選択され
ている場合、描画物の書式設定ツールセットである |DrawingObjPropToolbar| が
|FormattingToolbar| に取って代わる。描画物の選択を解除すると
|DrawingObjPropToolbar| が閉じ、|FormattingToolbar| が再び開く。

.. note::

   ツールバーが多いのが嫌な場合、別の UI を検討するといい。:doc:`common13` 参照。

Displaying or closing toolbars
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ツールバーを表示するには :menuselection:`&View-->&Toolbars-->` 以下を調べろ。
チェック印の有無で表示状態がわかる。

Submenus and tool palettes
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ツールバーの項目にサブメニューがある場合、ツールアイコンの右側に▼が表示される。
これをクリックすると、さらなるコマンド、ツールパレット、項目を選択する別の方法を
含むサブメニューが表示される。ツールパレットとはツールバーの単一ツールに付属する
ツールのポップアップの集まりだ。ツールパレットは、次の例を使用して floating ツー
ルバーにすることが可能だ。

#. |DrawingToolbar| の :guilabel:`Basic Shapes` をクリックしてツールパレットを開
   く。
#. ツールバーハンドル（……に見える部分）をクリックし、ツールパレットを開いている
   文書上めがけてドラッグする。
#. ツールバーハンドルを離すと、ツールパレットは floating ツールバーになる。

.. note::

   ツールバーハンドルが表示されていない場合、ツールパレットまたはツールバーは
   docked 位置に固定されているため、それを解除する必要がある。この次の節を参照。

Locking and unlocking toolbars
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ツールバー全部を完全固定する手段が用意されている。|MenuBar| から
:menuselection:`&View-->&Toolbars-->&Lock Toolbars` を選択するのだ。ただし
LibreOffice を再起動する必要がある。このコマンドメニュー項目にチェック印が付いて
いれば、ツールバーロックが機能していることを示す。

この状態を解除するには、同じ手順でチェック印を外す。再起動がやはり必要。

ツールバー全部ではなく、単一のツールバーに対して位置を固定したい場合には、ツール
バーの空き地を右クリックして :menuselection:`&Lock Toolbar Position` を選択す
る。項目にチェック印が付く。解除する場合も同じ項目を選択してチェックを外す。

Moving, docking and floating toolbars
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ツールバーが docked かつ固定されていない場合、ツールバーの左端に︙のようなツール
バーハンドルがある。このハンドルはツールバーの位置を制御するためのものだ。

このハンドルをマウスで適当にドラッグすればツールバーの位置がそれらしく移動する。

ツールバーが floating である場合、その移動方法は簡単だ：

* ツールバーのタイトルバーをドラッグする
* ▼をクリックしてドロップダウンメニューから適当なコマンドを実行する

Context sensitive toolbars
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

LibreOffice のツールバーの中には、物が選択されたとき、またはキャレットがテキスト
内に置かれたときにしか開かない、状況依存型のものがある。例:

* 表組にキャレットが置かれると :guilabel:`Table` ツールバーが開く
* 順序付き一覧または順序なし一覧にキャレットが置かれると :guilabel:`Bullets and
  Numbering` ツールバーが開く
* 画像が選択されると |ImageToolbar| が開く

Customizing toolbars
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ツールバーを floating にするとタイトルバーに ▼ がある。このドロップダウンメ
ニューにある :menuselection:`Visible &Buttons-->` 以下の項目チェックをオンオフす
ることでコマンドセットをカスタマイズすることが可能だ。

* 項目 :menuselection:`&Customize Toolbar...` を選択すると |CustomizeDlg| が開く。
  ここでさらにツールを追加する。詳しくは :doc:`common13` 参照。
* 選択した floating ツールバーを既定位置に dock するには項目
  :menuselection:`&Dock Toolbar` を選択する。タイトルバーダブルクリックのほうが
  早い。
* すべての floating ツールバーを既定位置に dock するには項目
  :menuselection:`Dock &All Toolbars` を選択する。
* 等々

Context menus
----------------------------------------------------------------------

段落や画像などの対象物を右クリックすることでポップアップメニューが開く。利用でき
る機能や選択肢は対象物が何であるかにより異なる。これが便利であるのは、特にメ
ニューやツールバー内の所望のコマンド位置が不明な場合だ。

Status bar
----------------------------------------------------------------------

|StatusBar| は文書に関する情報を提示するほか、いくつかの機能をすばやく変更する便
利な方法も含まれている。アプリケーション固有項目がある。

万が一 |StatusBar| が見えないという場合は |MenuBar|
:menuselection:`&View-->Status &Bar` のチェック状態を確認しろ。

本書では Impress における |StatusBar| の構成を例に挙げて、文書の関連情報がどう示
されているのかを述べている。割愛。

Sidebar
----------------------------------------------------------------------

既定では |Sidebar| はどのアプリケーションでもワークスペースの右側に現れる。

|Sidebar| の表示切替は |MenuBar| :menuselection:`&View-->Sidebar` のチェックを切
り替えるか、キーバインド |Ctrl+F5| で行う。

|Sidebar| は甲板が複数あり、甲板それぞれにはには文書を書式設定するための道具や選
択肢が含まれている。UI 構成は文書の種類とアプリケーションによる。甲板は盤で構成
され、|Sidebar| 右側にあるアイコンバーで甲板を切り替える。

すべての LibreOffice アプリケーションに現れる甲板もある：

* |PropertiesDeck|
* |StylesDeck|
* |GalleryDeck|
* |NavigatorDeck|

|Sidebar| 表示切替には左側にある縦に細長いボタンをクリックする。

|Sidebar| を undock して floating 状態にするには次の方法がある：

* |Sidebar| 右上のハンバーガーをクリックして :menuselection:`Undock` を選択する。
* キーバインド |Ctrl+Shift| + |F10| を押す。

反対に、|Sidebar| をメインウィンドウの通常配置に dock するには次の方法がある：

* |Sidebar| 右上のハンバーガーをクリックして :menuselection:`Dock` を選択する。
* キーバインド |Ctrl+Shift| + |F10| を押す。

----

.. rubric:: 章末注
