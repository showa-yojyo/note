======================================================================
Chapter 5, Working with Images and Graphics
======================================================================

.. include:: ./common-inc.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

LibreOffice 文書へ付け足す画像ファイルの種類：

* 画像ファイル（写真、図面、|PDF| 文書、取り込み画像等）
* LibreOffice Draw を使用して作成した図式
* クリップアートまたは Fontwork を使用して作成した作品
* LibreOffice Calc を使用して作成した統計図表
* LibreOffice Gallery にある画像、クリップアート、図式

Images and graphics
======================================================================

Creating
----------------------------------------------------------------------

基本的には画像は LibreOffice の外部で制作される。

LibreOffice ではさまざまなベクトル（線画）画像およびグラフィックファイルの読み込
み、回転、反転が可能だ。 LibreOffice では、ラスター（ビットマップ）ファイル形式
も対処しており、``.gif``, ``.jpeg``, ``.png``, ``.bpm`` は取り扱える。詳細は付録
B を見ろ。

Microsoft Office ファイルから SmartArt 画像をインポートすることも可能だ。例え
ば、SmartArt を含む Microsoft Word ファイルを Writer で開き、SmartArt 画像を編集
することが可能だ。

Editing
----------------------------------------------------------------------

LibreOffice Draw に画像やグラフィックを編集する機能があるため、追加のグラフィッ
クアプリケーションを使用する必要はない。

無料自由に利用できるオープンソースのソフトウェアも、画像やグラフィックファイルを
編集する際の良い選択肢となる。GIMP や Inkscape が良い。

.. seealso::

   :doc:`/inkscape/index`

Adding
----------------------------------------------------------------------

画像ファイルやグラフィックファイルを次のいずれかの方法で文書に追加する：

* グラフィックプログラムやスキャナーからファイルを直接付け加える
* クリップアートギャラリーから画像やグラフィックをドラッグする
* 計算機上の供給源からコピー＆ペーストする

Inserting
----------------------------------------------------------------------

計算機にあるファイルから LibreOffice 文書に入れる場合、実際の方法は次に依存する
ため、以下に示す追加方法は一例に過ぎない。

* 計算機の OS
* 計算機の構成
* 使用している LibreOffice アプリケーション

Drag and drop
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Windows ならば Explorer などからファイルを LibreOffice 文書中の選択ページに上に
ドラッグ＆ドロップすることができる。

.. note::

   |Ctrl+Shift| を押しながらドラッグ＆ドロップすると、内容物をハードコピーするの
   ではなく、リンク形式で貼り付けることになる。

Insert Image dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. LibreOffice 文書編集中、画像を入れたいページをクリックする。
#. |MenuBar| :menuselection:`&Insert-->&Image...` を選択。
#. あとは分かるだろう。

.. note::

   :guilabel:`Link` をオンにすると、ファイル決定時に確認を求められる。ファイルを
   リンクする場合は :guilabel:`Keep Link` を、画像を埋め込む場合は
   :guilabel:`Embed Graphic` を選択する。この確認メッセージを再び表示させないよ
   うにするには、:guilabel:`Ask when linking a graphic` をオフにする。

   LibreOffice は文書に同じ画像を複数回入れる場合でも、画像のコピーを一つしか埋
   め込まない。

Copy and paste
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. コピー元の画像を含むファイルとコピー先の文書を両方開いておく。
#. コピー元文書で画像を選択し、|Ctrl+C| を押すなどしてクリップボードにコピーす
   る。
#. コピー先文書で、画像を配置する位置でクリックする。
#. |Ctrl+V| を押すなどして、クリップボードから文書に画像を貼り付ける。

Embedding
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

リンクされた画像を埋め込むと、ファイルへのリンクが解除され、文書の一部と化す。
リンクされた画像を埋め込む手順：

#. LibreOffice で文書を開き、|MenuBar| :menuselection:`&Edit-->Lin&ks to
   External Files...` を選択し :guilabel:`Edit Links` ダイアログボックスを開く。
#. 埋め込むファイルを選択する。
#. :guilabel:`&Break Link` をクリックし、|Yes| を押してファイルの埋め込みを確定
   する。

Linking
----------------------------------------------------------------------

リンク方式では画像は文書内に表示されますが、文書が保存されるときには、リンクされ
たファイルへの参照のみが含まれ、被参照ファイルそのものは保存されない。文書と画像
はそれぞれ別個のファイルとして残り、文書のファイルサイズが小さくなる。

長所
   画像を編集プログラムを使って独立して変更できる。

   画像ファイル自体が文書に含まれないため、ファイルサイズを削減できる。
短所
   リンクを含む文書を他の計算機に送付するときにリンクが失われがちだ。例えば、文
   書を含むフォルダーの画像サブフォルダーに画像ファイルを配置した場合、受信者は
   そのフォルダー構造を維持して文書とファイルを扱う必要がある。

Scanning
----------------------------------------------------------------------

画像取込機が計算機に接続されている場合、LibreOffice は画像取込ソフトウェアを使用
して画像を取り込み、それを文書に入れることが可能だ。

機器を所有していないので取り込み手順は割愛。

.. note::

   画像取込ソフトウェアは LibreOffice が認識し、かつメディアを取り込んで文書に入
   れるのに適したアプリケーションでなければならない。

Inserting using the Gallery
----------------------------------------------------------------------

Gallery は素材メディアを文書に付け加えるのに便利なものだ。Writer, Calc, Impress,
Draw で利用可能。Gallery から画像をコピーすると文書に埋め込まれるが、リンクする
こともできます。詳しくは :ref:`common05-anchor-A` を見ろ。

#. |Sidebar| 右側にある Gallery をクリックするか、キーバインド |Alt| + :kbd:`3`
   により |GalleryDeck| を開く。
#. 一覧から Gallery テーマを選択する。
#. 表示された画像から必要なものをクリックで選択する。
#. 文書に必要な画像を入れる。次のいずれかの方法を使用します：

   * 画像を文書中にドラッグ＆ドロップする。
   * 画像を右クリックし |InsertC| を選択する。

   画像は文書の中央に配置される。
#. 画像をリンクとして入れるには |Ctrl+Shift| を押したまま画像を文書にドラッグ＆
   ドロップする。

Editing images or graphics
======================================================================

LibreOffice には画像を編集するための手段が多く用意されている。編集は以下の手順で
行う：

* 切り出し、寸法変更、修正、ピクセルシェーダー的変換、配置
* 画像の周りをテキストで囲む
* 画像を背景や透かしとして用いる

前述のように、複雑な編集ならば専用アプリケーションを用いるのが良い。

Image toolbar
----------------------------------------------------------------------

画像を入れるか選ぶと |ImageToolbar| が自動的に開く。画像を選択すると他の二つの
ツールバーも利用可能になる：

* |ImageFilterToolbar|
* |ColorToolbar|

これらツールバーを併用することで画像に補正や調整を加えることが可能だ。また、透
過、色調調整、反転・回転、特殊効果フィルターなども適用可能だ。

Cropping
----------------------------------------------------------------------

LibreOffice には画像や図形を切り出す方法が二つある：

* :guilabel:`Crop Image` ツール。ツールバー上のツール、または画像を右クリックし
  た後のコンテキストメニューで利用可能。画像を素早く切り出すことが可能だ。
* (Writer) :guilabel:`Image` ダイアログボックス :guilabel:`Crop` タブ。画像を右
  クリックし |PropertiesC| を選択する。さらなる制御が可能だ。

.. admonition:: 読者ノート

   画像を切り出してもデータ量が少なくなるわけではなさそうだ。

Resizing
----------------------------------------------------------------------

LibreOffice 文書に画像を収めるには、寸法を変更する必要がある場合がある。寸法を変
更する最も簡単な方法は選択ハンドルを使用することだ。

#. 対象画像をクリックする。
#. 選択ハンドルの上にカーソルを置くとカーソルの形状が変わり、寸法変化方向が表示
   される：

   * 角ハンドルは画像の幅と高さの両方を同時に変化させる。
   * 水平ハンドルは画像の高さを変化させる。
   * 垂直ハンドルは画像の幅を変化させる。
#. 選択ハンドルをドラッグして画像寸法を変更する。寸法変化中は薄い画像が表示され
   る。
#. ハンドル操作の間、画像の元の縦横比を維持するには |Shift| を押したまま選択ハン
   ドルをドラッグする。選択ハンドルを離す前に |Shift| を離すこと。

Positioning
----------------------------------------------------------------------

文書に画像を入れた後、適正文書形式にするために位置を移動する必要がある場合があ
る。マウスカーソルを使用する方法が最も簡単だ。

#. 対象画像をクリックする。
#. カーソルを選択画像上に移動すると、カーソルの形状が OS 由来の把捉カーソルに変
   化する。
#. 選択画像をクリックし、所望の位置までドラッグする。移動中、薄い画像が表示され
   る。
#. 画像が所望の位置に来たらマウスボタンを離す。

.. tip::

   キーボードの矢印キーを使うのも有力な移動手段だ。

Rotating images
----------------------------------------------------------------------

画像を回転させる最も簡単な方法もマウスカーソルを使用することだ。

#. 対象画像をクリックする。
#. 選択画像もう一度（ダブルクリックにならぬように）クリックし、回転モードに切り
   替える。または、|ImageToolbar| から :guilabel:`Rotate Image` をクリックしても
   よい。
#. マウスを角ハンドルの上に移動すると、マウスカーソルの形が変わり、移動方向を示
   す。
#. 回転に満足したらマウスボタンを離す。
#. 回転角度を 15 度の倍数に制限するには、|Shift| を押しながら画像を回転させる。
   選択ハンドルを離す前に |Shift| を離すこと。
#. オブジェクトの回転中心を変更するには、回転前に中央ピボット点をクリックし、所
   望の位置までドラッグする。

Flipping
----------------------------------------------------------------------

文書に画像を入れた後、縦方向または横方向に反転させることが可能だ。どの
LibreOffice アプリケーションを使用しているかによるが、次のいずれかの方法を使用し
て、画像をすばやく反転する：

* |ImageToolbar| から反転コマンド図像をクリックする。
* |MenuBar| :menuselection:`F&ormat-->F&lip-->` からコマンドを選択する。
* 画像の右クリックメニュー :menuselection:`F&lip-->` からコマンドを選択する。
* |Sidebar| |PropertiesDeck| |Pos&SizeTab| にある反転コマンドをクリックする。

Arranging
----------------------------------------------------------------------

LibreOffice では画像をスタックで整理する。スタックの最上位にある画像は、下位にあ
る画像と重なっている場合、それを覆い隠す。画像を選択し、次のいずれかの方法でス
タック階層を変更する：

* :guilabel:`Line and Filling` ツールバーから必要な器具をクリックする。
* 選択画像を右クリックし、:menuselection:`A&rrange-->` から必要な項目を選択する。

各画像のスタック階層は変更可能だ。利用可能な選択肢：

Bring to Front
   選択画像を他の画像すべての手前に移動する。
Forward One
   選択画像をスタック内で一階層上（手前側）に移動する。
Back One
   選択画像をスタック内で一階層下（奥側）に移動する。
Send to Back
   選択画像を他の画像すべての奥に移動する。

.. admonition:: 利用者ノート

   原文の選択肢名は現況と異なる。本稿では現況を優先する。

Alignment and positioning
----------------------------------------------------------------------

文書ページ上のテキストや他のオブジェクトに対して、画像の並びと位置を選択する必要
がある。

Arrangement
   画像を想像上の縦軸に配置する。画像同士をどのように重ね合わせるか、あるいはテ
   キストとの相対関係を制御する。
Alignment
   係留点に対する、画像の垂直方向または水平方向の位置。
Anchoring
   画像が文書内で固定されるための参照点。ページ、枠、升目、段落、文字などが参照
   点として働く。画像には必ず係留点がある。
Text wrapping
   文書内で、画像と周囲のテキストとの関係を指す。以下のように、テキストを画像に回
   り込ませることができるテキスト折り返し選択肢がある：

   * 画像の片側または両側
   * 画像の上または下
   * 画像のテキストの重ね刷りを許す
   * 画像がテキストを覆うことを許す
   * 画像を独立した段落または文字として扱う

Exporting
----------------------------------------------------------------------

他のグラフィックアプリケーションを使って画像を編集するには、文書から直接ファイル
をエクスポートする。以下の手順は一例であり、実際の手順は先述のように計算機環境に
よって変わってくる。

#. 画像を右クリックして :menuselection:`Sa&ve...` を選択し、:guilabel:`Image
   Export` ダイアログボックスを開く。
#. 画像エクスポート先フォルダーに移動する。
#. 保存ファイル名を入力する。
#. |Save| を押してファイルをエクスポートし、ダイアログボックスを閉じる。

あとは適当な画像編集アプリケーションを開き、エクスポートした画像ファイルに対して
必要な編集を行い、必要な形式で保存する。その後、画像を文書に再度入れる。

Compressing
----------------------------------------------------------------------

画像のファイルサイズが大きい場合、圧縮してファイルサイズを小さくすることが可能
だ。この結果、文書のファイルサイズは小さくなるが、画像が圧縮されると品質が低下す
る可能性がある。以下の手順はあくまで一例だ

#. 画像を右クリックして :menuselection:`Co&mpress...` を選択し、
   :guilabel:`Compress Image` ダイアログボックスを開く。
#. :guilabel:`Compression` と :guilabel:`Resolution` にある選択肢を使用して、画
   像を圧縮する。
#. 必要に応じて :guilabel:`Calculate N&ew Size` をクリックし、圧縮された画像の
   ファイル容量を確認する。
#. |OK| を押して変更を保存し、ダイアログボックスを閉じる。

.. _common05-anchor-A:
.. TODO: LibreOffice Gallery
