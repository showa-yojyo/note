======================================================================
Chapter 5, Working with Images and Graphics
======================================================================

.. include:: ./common-inc.txt

.. contents:: 章見出し
   :depth: 3
   :local:

Introduction
======================================================================

LibreOffice 文書へ付け足す画像ファイルの種類：

* 画像ファイル（写真、図面、|PDF| 文書、取り込み画像等）
* LibreOffice Draw を使用して作成した図式
* クリップアートまたは Fontwork を使用して作成した作品
* LibreOffice Calc を使用して作成した統計図表
* LibreOffice Gallery にある画像、クリップアート、図式

Images and graphics
======================================================================

Creating
----------------------------------------------------------------------

基本的には画像は LibreOffice の外部で制作される。

LibreOffice ではさまざまなベクトル（線画）画像およびグラフィックファイルの読み込
み、回転、反転が可能だ。 LibreOffice では、ラスター（ビットマップ）ファイル形式
も対処しており、``.gif``, ``.jpeg``, ``.png``, ``.bpm`` は取り扱える。詳細は付録
B を見ろ。

Microsoft Office ファイルから SmartArt 画像をインポートすることも可能だ。例え
ば、SmartArt を含む Microsoft Word ファイルを Writer で開き、SmartArt 画像を編集
することが可能だ。

Editing
----------------------------------------------------------------------

LibreOffice Draw に画像やグラフィックを編集する機能があるため、追加のグラフィッ
クアプリケーションを使用する必要はない。

無料自由に利用できるオープンソースのソフトウェアも、画像やグラフィックファイルを
編集する際の良い選択肢となる。GIMP や Inkscape が良い。

.. seealso::

   :doc:`/inkscape/index`

Adding
----------------------------------------------------------------------

画像ファイルやグラフィックファイルを次のいずれかの方法で文書に追加する：

* グラフィックプログラムやスキャナーからファイルを直接付け加える
* クリップアートギャラリーから画像やグラフィックをドラッグする
* 計算機上の供給源からコピー＆ペーストする

Inserting
----------------------------------------------------------------------

計算機にあるファイルから LibreOffice 文書に入れる場合、実際の方法は次に依存する
ため、以下に示す追加方法は一例に過ぎない。

* 計算機の OS
* 計算機の構成
* 使用している LibreOffice アプリケーション

Drag and drop
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Windows ならば Explorer などからファイルを LibreOffice 文書中の選択ページに上に
ドラッグ＆ドロップすることができる。

.. note::

   |Ctrl+Shift| を押しながらドラッグ＆ドロップすると、内容物をハードコピーするの
   ではなく、リンク形式で貼り付けることになる。

Insert Image dialog
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

|InsertImageDlg| を用いる方法がいちばん正式な手順と思われる。

#. LibreOffice 文書編集中、画像を入れたいページをクリックする。
#. |MenuBar| :menuselection:`&Insert-->&Image...` を選択。
#. あとは分かるだろう。

.. note::

   :guilabel:`Link` をオンにすると、ファイル決定時に確認を求められる。ファイルを
   リンクする場合は :guilabel:`Keep Link` を、画像を埋め込む場合は
   :guilabel:`Embed Graphic` を選択する。この確認メッセージを再び表示させないよ
   うにするには、:guilabel:`Ask when linking a graphic` をオフにする。

   LibreOffice は文書に同じ画像を複数回入れる場合でも、画像のコピーを一つしか埋
   め込まない。

Copy and paste
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

#. コピー元の画像を含むファイルとコピー先の文書を両方開いておく。
#. コピー元文書で画像を選択し、|Ctrl+C| を押すなどしてクリップボードにコピーす
   る。
#. コピー先文書で、画像を配置する位置でクリックする。
#. |Ctrl+V| を押すなどして、クリップボードから文書に画像を貼り付ける。

Embedding
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

リンクされた画像を埋め込むと、ファイルへのリンクが解除され、文書の一部と化す。
リンクされた画像を埋め込む手順：

#. LibreOffice で文書を開き、|MenuBar| :menuselection:`&Edit-->Lin&ks to
   External Files...` を選択し :guilabel:`Edit Links` ダイアログボックスを開く。
#. 埋め込むファイルを選択する。
#. :guilabel:`&Break Link` をクリックし、|Yes| を押してファイルの埋め込みを確定
   する。

Linking
----------------------------------------------------------------------

リンク方式では画像は文書内に表示されますが、文書が保存されるときには、リンクされ
たファイルへの参照のみが含まれ、被参照ファイルそのものは保存されない。文書と画像
はそれぞれ別個のファイルとして残り、文書のファイルサイズが小さくなる。

長所
   画像を編集プログラムを使って独立して変更できる。

   画像ファイル自体が文書に含まれないため、ファイルサイズを削減できる。
短所
   リンクを含む文書を他の計算機に送付するときにリンクが失われがちだ。例えば、文
   書を含むフォルダーの画像サブフォルダーに画像ファイルを配置した場合、受信者は
   そのフォルダー構造を維持して文書とファイルを扱う必要がある。

Scanning
----------------------------------------------------------------------

画像取込機が計算機に接続されている場合、LibreOffice は画像取込ソフトウェアを使用
して画像を取り込み、それを文書に入れることが可能だ。

機器を所有していないので取り込み手順は割愛。

.. note::

   画像取込ソフトウェアは LibreOffice が認識し、かつメディアを取り込んで文書に入
   れるのに適したアプリケーションでなければならない。

Inserting using the Gallery
----------------------------------------------------------------------

Gallery は素材メディアを文書に付け加えるのに便利なものだ。Writer, Calc, Impress,
Draw で利用可能。Gallery から画像をコピーすると文書に埋め込まれるが、リンクする
こともできます。詳しくは :ref:`common05-anchor-A` を見ろ。

#. |Sidebar| 右側にある Gallery をクリックするか、キーバインド |Alt| + :kbd:`3`
   により |GalleryDeck| を開く。
#. 一覧から Gallery テーマを選択する。
#. 表示された画像から必要なものをクリックで選択する。
#. 文書に必要な画像を入れる。次のいずれかの方法を使用します：

   * 画像を文書中にドラッグ＆ドロップする。
   * 画像を右クリックし |InsertC| を選択する。

   画像は文書の中央に配置される。
#. 画像をリンクとして入れるには |Ctrl+Shift| を押したまま画像を文書にドラッグ＆
   ドロップする。

.. _common05-anchor-A:
.. TODO: LibreOffice Gallery
