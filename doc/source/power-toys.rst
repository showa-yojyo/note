======================================================================
Microsoft PowerToys 利用ノート
======================================================================

`Microsoft PowerToys <https://docs.microsoft.com/ja-jp/windows/powertoys/>`__
についての雑多なノートを綴る。

.. note::

   本ノートを記すのに用いている Windows および :program:`PowerToys` のバージョン
   ぞれ次のとおりだ。

   :OS: Windows 10 Home version 22H2
   :PowerToys: v0.64.1

.. contents::

なぜ PowerToys を導入するのか
======================================================================

今のところ特に理由はないが、いざというときの選択肢を増やしておく意味はある。

事前条件
======================================================================

インストールまたはアップグレードの際には OS がインターネットに接続されており、
かつ :command:`winget` が利用可能であるものとする。

インストールとアップグレード
======================================================================

インストール方法は複数あるが、:command:`winget` での JSON ファイルから他のソフト
ウェアと一斉にインストールする運用を想定している。

PowerToys 単体をインストールするならば、コンソールから次のコマンドを実行する：

.. code:: doscon

   > winget install -e --id Microsoft.PowerToys

PowerToys のアップグレード手段はインストールのそれ以上に用意されている。通常は
アプリケーションの既定の設定である自動更新が有効になっているのに頼ればよい。
手動で更新したい場合には、PowerToys 設定画面のボタン
:guilabel:`更新プログラムを確認する` を押して、あとは手なりで進行する。
あるいは :program:`winget` の一括アップグレード運用で更新されるだろう。

ユーティリティー概要
======================================================================

PowerToys は各種アプリケーションの複合体と考えるほうがわかりやすい。
アプリケーション同士の連携は全くないものと捉えるべきだ。

以下では PowerToys をそれぞれのアプリケーション単位について簡単に述べていく。
きちんとした仕様は先述の文書のリンク先各ページに述べられている。

Always on Top
----------------------------------------------------------------------

Always on Top はアクティブウィンドウを画面のいちばん手前に固定する機能だ。
HTML の語彙を借りると z-index を他のウィンドウのどれよりも大きい値にする機能だ。

使い方としては、対象となるウィンドウがアクティブ状態であることを確認後、
:kbd:`WinKey` + :kbd:`Ctrl` + :kbd:`T` を押す。するとウィンドウの枠が太くハイラ
イトされ、機能が有効であることがわかりやすくなる。

この状態を元に戻すには、再びこのショートカットキーを押す。

機能設定欄では、機能有効時のウィンドウ外観や、効果音の有無、
当機能を設定しないプロセス名を登録することができる。

活用法としては、テキストエディターを最大化した状態で、別のプログラムを観察すると
きにそのウィンドウを小さくして横に並べるというようなものが思い浮かぶ。

Awake
----------------------------------------------------------------------

一般的には、一定時間入力がないと OS としての Windows はディスプレイを切り、ス
リープまたはサスペンドモードに移行する。この動作は内部的には「電源とスリープの設
定」に従う。 PowerToys Awake は、この OS 設定を上書きすることができる。つま
り、Windows を起動したままにする機能を有するユーティリティーだ。何らかの長時間処
理を実行するときに、スリープやサスペンドから抑止するという用途にうってつけだ。

動作
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:guilabel:`モード` では、本ツールが有効であるときに PC の状態の管理方法を指定する。
決定できるのは次の三つのいずれかとなる：

:guilabel:`選択した電源プランを引き続き使用する`
    PC 本来の電源プランを適用する。つまり当ツール固有の機能を用いない。
:guilabel:`無期限に起動したままにする`
    この設定を変更するまで、PC の通知、実行を維持する。
:guilabel:`一時的に起動したままにする`
    設定画面のタイマーで設定されている一定時間 PC を起動させ続ける。
    時間切れになると、PC 本来の電源プランに戻る。

:guilabel:`画面をオンにしたままにする` は PowerToys Awake によって PC を
起動状態にしているときに、ディスプレイを点けたままにするかどうかを切り替えられる。
既定では PC がスリープ状態にならなくてもディスプレイは切られることに注意。

その他の UI
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

PowerToys Awake が有効であるとき、Windows のタスクトレイに専用アイコンが出現する。
そのメニューから上述のモードを設定することができる。

また、PowerToys フォルダーから PowerToys Awake を独立プロセスとして直接実行する
こともできる。コンソールから :program:`PowerToys.Awake.exe` を実行する場合には、
コマンドラインオプションを指定することもできる。引数なしで起動すると、Awake は
:guilabel:`無期限に起動したままにする` 相当の挙動を呈する。

Color Picker
----------------------------------------------------------------------

Color Picker は Photoshop のスポイトツールをデスクトップ全体に持ってきたかのよう
な機能だ。画面上の任意の点をマウスでクリックすると、その色がいったん保存される。
この情報を、あらかじめ取り決めていた表現形式のテキストとして「貼り付ける」ことも
できる。

* ショートカットキーは :kbd:`WinKey` + :kbd:`Shift` + :kbd:`C`.
* 例えば色を見たいだけの場合には、設定を :guilabel:`色の選択のみ` に簡略化しておく。

FancyZones
----------------------------------------------------------------------

FancyZones はデスクトップ上のウィンドウ群を対象とするレイアウトマネージャーだ。
設定画面でデスクトップを何らかの区画群に分割しておき、マウスまたはキーボード操作
でアクティブウィンドウを任意の区間にフィットさせるものだ。
FancyZones の説明文では、この区画一つのことを zone と称している。

.. note::

   撮影が面倒なのでここには載せないが、スクリーンショットを見ると理解しやすい。

レイアウト編集画面
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

キーボード :kbd:`WinKey` + :kbd:`Shift` + :kbd:`@` で FancyZones 機能の有効化を
し、同時にレイアウト編集画面を開く。テンプレートを基にゾーンを細分してカスタマイ
ズしておき、それを有効化しておくのがより一般的な設定様式だ。

ウィンドウをゾーンへ配置する
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

マウスを使う場合には、配置をするウィンドウのタイトルバーを :kbd:`Shift` キーを押
しながらドラッグする。キーを押すタイミングはドラッグ前でも途中でもかまわない。

ウィンドウを動かしているとゾーンがプレビューされるので、所望のものがハイライトさ
れたらドロップする。

ゾーンとゾーンの間にマウスを移動させたり、:kbd:`Ctrl` キーも押していたりすること
で、隣接するゾーンを考慮して最終的なウィンドウの配置が決定する。

キーボードなど
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

オプション :guilabel:`ゾーンの切替` が有効であると、次のショートカットキーが有効
になる。現在のゾーンにウィンドウが複数あるときに、アクティブウィンドウを順次切り
替える。

* :kbd:`WinKey` + :kbd:`PgUp`
* :kbd:`WinKey` + :kbd:`PgDn`

オプション :guilabel:`Windows スナップのオーバーライド` が有効であると、次の
ショートカットキーが有効になる。アクティブウィンドウを各ゾーンにゾーン番号順に順
次シフトする。

* :kbd:`WinKey` + :kbd:`←`
* :kbd:`WinKey` + :kbd:`→`

相対位置に基づいてシフトする方式もある。レイアウトによって使い分けるのがわかり易
いだろう。

より繊細な設定
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   使いこなせるようになったら追記する。

File Explorer add-ons
----------------------------------------------------------------------

File Explorer add-ons は Windows のエクスプローラーのプレビュー表示を拡張する。
ファイルのサムネイル表示とプレビューウィンドウ :kbd:`Alt` + :kbd:`P` にイメージ
が反映される。例えば Markdown ファイル、SVG ファイルのプレビューができるようにな
る。これは助かる。

驚いたことに STL ファイルや OBJ ファイルもプレビュー表示対応している。
Utah ティーポットのデータをマウスドラッグで回転させることすら可能だ。

File Locksmith
----------------------------------------------------------------------

File Locksmith は、どのファイルがどのプロセスで使用されているかをチェックするた
めの Windows シェル拡張機能だ。:program:`PowerToys` をインストールした後、
:program:`Explorer` で選択したファイル（いくつでも可）を右クリックし、コンテ
キストメニューから :menuselection:`このファイルは何で使っていますか？` を選択する。

フォルダーが選択された場合、含まれるファイルとサブフォルダーも再帰的にすべてス
キャンされる。File Locksmith が起動すると、アクセス可能な実行中のプロセスすべて
をスキャンし、それらがどのファイルを使用しているかを検査する。別のユーザーが実行
しているプロセスにはアクセスできないため、結果一覧に表示されないことがある。すべ
てのプロセスをスキャンするには、:guilabel:`管理者として再起動する` ボタンを押す。

スキャン後、プロセス一覧が表示される。ボタン :guilabel:`タスクを終了する` を押して
プロセスを終了させたり、折りたたみボタンをクリックして次の情報を表示させたりす
ることができる。

* プロセス ID
* ユーザー
* ファイル

File Locksmith は終了したプロセスを（終了指示が外部からであっても）一覧から自動
的に削除する。プロセス一覧を手動で更新するには、ボタン :guilabel:`再読み込み` を
押す。

Hosts File Editor
----------------------------------------------------------------------

Hosts File Editor はファイル :file:`hosts` の設定を編集するためのユーティリ
ティーだ。

Windows にもドメイン名とそれに対応する IP アドレスを含むローカルのファイル
:file:`hosts` があり、 IP ネットワーク上のホストを識別して位置を特定するための対
応表として機能する。ウェブサイトを訪問するたびに、コンピューターはまずファイル
:file:`hosts` を検査して、どの IP アドレスに接続するかを確認する。情報がない場
合、ISP はサイトを読み込むための資源を DNS に照会する。

これはウェブサイトを新しいホスティングプロバイダーやドメイン名に移行するようなシ
ナリオで、一、二日のダウンタイムがかかる場合に便利だ。ホストファイルを使用してド
メインに関連付けるカスタム IP アドレスを作成すると、新しいサーバー上でどのように
見えるかを確認できる。

.. admonition:: 利用者ノート

   ファイルパスがわかっていれば VS Code で編集しても全然構わない。

新しいエントリー
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:program:`PowerToys` 本体の設定で Hosts File Editor が有効になっていることをまず
確認する必要がある。

Hosts File Editor を使用して新しいエントリーを追加するには、ボタン
:guilabel:`新しいエントリー` を押して追加画面を表示する。それから次の項目を埋める：

.. csv-table::
   :delim: @
   :header: 入力欄,入力値

   :guilabel:`アドレス` @ IP アドレス
   :guilabel:`ホスト`   @ ホスト名
   :guilabel:`コメント` @ 記入目的を確認するためのコメント

最後にスイッチ :guilabel:`アクティブ` が有効になっていることを確認し、
:guilabel:`追加` をクリックする。

フィルター
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ホストファイルのエントリーを絞るには、漏斗アイコンをクリックし、

* :guilabel:`アドレス`
* :guilabel:`ホスト`
* :guilabel:`コメント`

のいずれかに文字列を入力する。

バックアップ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Hosts File Editor は編集前にファイル :file:`hosts` をバックアップする。
バックアップファイルは、:file:`%SystemRoot%\\System32\\drivers\\etc` に
:file:`hosts_PowerToysBackup_YYYYMMDDHHMSS` のような名前で置かれる。

設定
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

歯車アイコンメニューから次のオプションを構成できる：

.. csv-table::
   :delim: @
   :header: 設定項目,趣旨

   :guilabel:`管理者として実行する` @ これを有効にしないと :file:`hosts` を保存できない
   :guilabel:`起動時に警告を表示する` @ DNS の名前解決変更可能性があることを警告するかどうか
   :guilabel:`追加の行の位置` @ :guilabel:`上部` か :guilabel:`下部` か

Image Resizer
----------------------------------------------------------------------

Image Resizer は Windows エクスプローラーのコンテキストメニューを拡張し、画像
ファイルに対して作用する。画像の寸法を前もって設定しておいたものに拡縮する機能
だ。汎用画像編集アプリケーションを起動するのが億劫な場合に活用できる。

まずは :guilabel:`Image Resizer を有効化する` を ON にする。

コンテキストメニュー
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

エクスプローラーで Image Resizer が対応している画像ファイルを選択してコンテキス
トメニューを表示させると、次の項目がメニューにある：

* :guilabel:`画面のサイズ変更`
* :guilabel:`右に回転`
* :guilabel:`左に回転`

サイズ変更コマンドだけが追加入力を要求する。

出力ファイルに関する設定
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:guilabel:`ファイル` の各設定を次のようにしておく：

:guilabel:`ファイル名の形式` をより単純にする。たとえば ``%1-%2`` くらいでいい。

:guilabel:`ファイルの変更されたタイムスタンプ` を
:guilabel:`元のファイルのタイムスタンプ` に変更する。

Keyboard Manager
----------------------------------------------------------------------

Keyboard Manager はフリーウェアでありがちな、キーボードのキーを入れ替える機能を
有する。もっと細かい機能があるのだが、ややこしいのでこれだけでいい。

設定画面の :guilabel:`Keyboard Manager を有効にする` を ON にすることで、以下の
再マップ機能が利用可能になる。

:guilabel:`キーの再マップ` で表示される画面で、キーボードの物理的なキーから仮想
的なキーへの対応を定義する。指定方法は GUI から明らかだろう。このキー対応はウィ
ンドウ全てで有効になる。

:guilabel:`ショートカットの再マップ` で表示される画面では、プログラムレベルの
ウィンドウごとに対応を定義するようなものだ。しかもキーからキーへの対応というより
は、ショートカットキーからショートカットキーへの対応となる。

Mouse Utility
----------------------------------------------------------------------

最初の二つの機能が有用だ。画面をビデオキャプチャーするときに意識するといい。
部分機能ごとに :guilabel:`外観および動作` 設定画面が用意されている。

マウスの検索
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

マウスカーソルを揺さ振るか、左 :kbd:`Ctrl` を二度押すかのどちらかの操作で、マウ
スカーソルの位置をハイライトする。

:guilabel:`マウスの検索を有効にする` を ON にすることで、この機能が有効となる。

:guilabel:`アクテイプ化の方法` では、上述の操作をどちらにするのかを指定する。

:guilabel:`除外するアプリ` にプログラム名を追加すると、そのプログラムのウィンド
ウがアクティブであるときに当機能はマウス検索を行わない。Dungeon Master RTC に適
用することが考えられる。

マウス蛍光ペン
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

マウスクリック（左右どちらか）時にカーソル近傍を丸くハイライト表示する機能だ。

:guilabel:`マウス宝光ペンの有効化` を ON にすることで、この機能が有効となる。

マウス操作中に :guilabel:`アクティブ化のショートカット` で指定されているショート
カットキーを押すことでハイライトをするか否かを決める。初期設定ショートカットキー
は :kbd:`WinKey` + :kbd:`Shift` + :kbd:`H` だ。

マウスホインターの十字線
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

当機能は私には用途がないので省略。

PowerRename
----------------------------------------------------------------------

PowerRename は Linux におけるコマンド :command:`rename` の GUI 版と解釈できる。

1. エクスプローラーでファイルを普通は複数選択する。
2. コンテキストメニューを表示する。設定次第では :kbd:`Shift` キーを押したまま表示する。
3. 項目 :kbd:`PowerRename` を選択する。

すると大仰な画面が表示される。左側のテキストボックス二つを操作する。Linux の
:command:`rename` の要領で、置換前後のファイル名パターンを指定する。

:guilabel:`PowerRename を有効化する` を ON にすることで、エクスプローラーのコン
テキストメニューが本機能に対応する。

オプション設定は変更しないでいいだろう。

PowerToys Run
----------------------------------------------------------------------

PowerToys Run は Windows における :program:`ファイル名を指定して実行` ダイアロ
グボックスをさらに一般化したようなランチャーだと考えられる。

機能を有効するには、次をすべて実施する：

* PowerToys 本体をとにかく起動状態にしておく。
* 当機能設定画面の :guilabel:`PowerToys Run を 有効化する` を ON にする。

ランチャーを開くにはショートカットキー :kbd:`Alt` + :kbd:`Space` を押す。この
キーバインドは元来、タイトルバーを持つウィンドウの左上アイコンを右クリックすると
きに表示されるメニューを出すコマンドだ。

ランチャーを起動すると大きいテキストボックスが表示されるので、何文字かタイプする
といい。候補がいくつかポップアップする。そこから目当てのアイテムを選択すればいい。
使っているうちに起動できる対象が徐々に判明していくだろう。

より繊細な設定
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. todo::

   使いこなせるようになったら追記する。

Quick Accent
----------------------------------------------------------------------

Quick Accent はアルファベット一文字を入力するときに、アクセントを手軽に付与する
機能を提供する。

使ってみるとキー操作が難しい。例えば文字 a にウムラウトをつけたいとする。
このとき、まずキー :kbd:`A` を押し、そのまま離さずに :kbd:`Space` を押すと画面上に
次のボタンからなるツールバーが出る：

.. code:: text

   à â á ä ã å æ

:kbd:`Space` か左右の矢印キーを叩いて所望の文字、この場合には左から四番目の文字
を選択して :kbd:`A` キーから指を離すことで入力中の文字が入れ替わる。

Screen Ruler
----------------------------------------------------------------------

Screen Ruler はマウス操作で画面上の寸法を測るユーティリティーだ。
ショートカットキー :kbd:`WinKey` + :kbd:`Shift` + :kbd:`M` で起動する。

ウィンドウのサイズを測るのに利用するのが自然だと思うが、本機能は「線」を検出でき
る箇所同士ならばどこでも長さを測る。何か面白い用途があるかもしれない。

Shortcut Guide
----------------------------------------------------------------------

Shortcut Guide は Windows のショートカットキー一覧を表示する。ただそれだけのもの
だ。アクティブなアプリケーションのショートカットキーを表示するような高等なもので
はない。ここに記載されている内容を完全に記憶してしまえば、もう用がない機能だ。

ショートカットキー :kbd:`WinKey` + :kbd:`Shift` + :kbd:`/` で起動する。

馴染みのないショートカットキーだなと思ったら、体に染み付くまで反復練習するといい。

アクティブウィンドウがあるか否かで、ショートカットキー一覧画面の左側が少し異なる。
スナップ操作のキー表示が無効のように示される。

Text Extractor
----------------------------------------------------------------------

Text Extractor は画面上の選択範囲からテキストを抽出する機能だ。起動後、画面が薄
暗くなる。このとき、マウスドラッグで矩形選択すると、中に含まれている文字列をク
リップボードにコピーする。

起動には :kbd:`WinKey` + :kbd:`Shift` + :kbd:`T` を押す。

携帯電話でオンライン麻雀ゲームのスコア画面を撮影することがよくあるのだが、その数
字を転写するのがたいへん面倒だ。画像を PC にインポートして画面に表示させてこの機
能でテキストを抽出したい。

Video Conference Mute
----------------------------------------------------------------------

Video Conference Mute は電話会議中に、どのアプリケーションを使っている途中でも、
クリック一つでマイクをミュートしたり、カメラをオフにすることができる機能のようだ。

.. todo::

   現在、マイクもカメラも保有していないので、当ツールを評価することがかなわない。

本機能は PowerToys 本体を管理者権限で起動しておかないと、設定が全くできない。
そうなっていない場合には :guilabel:`全般` 画面で設定を確認することだ。その上で
本機能の設定画面にある :guilabel:`ビデオ会議のミュートを有効にする` スイッチを
ON にする。これで本機能が有効になり、次のショートカットキー群が効くようになる。

ショートカットキー
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

本機能に備わるコマンドのショートカットキーを設定する。既定のキーバインドを次に記
しておく。

:kbd:`WinKey` + :kbd:`Shift` + :kbd:`Q`
   押すたびに、マイクとカメラの双方の状態が切り替わる。
:kbd:`WinKey` + :kbd:`Shift` + :kbd:`A`
   押すたびに、マイクのミュート状態が切り替わる。
:kbd:`WinKey` + :kbd:`Shift` + :kbd:`O`
   押すたびに、カメラの状態が切り変わる。

マイク
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

どのマイクを本機能の対象とするのかを指定する。普通は全指定でいいと思う。

カメラ
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

どのカメラを本ツールの対象にするのかを指定したり、カメラの電源を切ったときに、ダ
ミーとして使用する画像を指定する。オーバーレイイメージはファイルシステムの画像
ファイルパスで指示する。

ツールバー
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

上述のショートカットキーを使用するとあるミニツールバーが表示される。そこでは
マイクとカメラがオン、オフ、未使用のどの状態なのかを確認できる。
:guilabel:`ツールバーの位置` では、このツールバーを画面のどの辺に表示するかを設
定する。

また、モニターが複数取り付けられているときには当ツールバーを表示するモニターを
:guilabel:`ツールバーを表示する` で指定するといい。

全般設定
======================================================================

:guilabel:`バージョン` とある場所からは、次のことができる：

* 起動中の PowerToys のバージョン番号、
* 更新プログラムの有無確認、
* リリースノートの確認、および
* :guilabel:`更新プログラムを自動ダウンロードする` かどうかの切り替えをする。

:guilabel:`管理者モード` とある場所からは、次のことができる：

* 管理者モードの確認および設定。
* 管理者モードに関する詳細情報の確認。

一般モードから管理者モードに切り替えるときには PowerToys が再起動する。その逆は
不能になっており、管理者モードで PoewrToys を開くと、この設定項目が変更不能にな
る。

:guilabel:`外観および動作` とある場所からは、次のことができる：

* テーマをライト、ダーク、Windows 既定のいずれかに指定する。
* :guilabel:`起動時に実行` スイッチで、OS 起動時に PowerToys を起動するかどうか
  を決める。

バックアップ
======================================================================

次のフォルダー以下に JSON ファイル群が大量に保存されている。これらが PowerToys
およびサブソフト群の設定内容を保持しているのだろう。したがって、このフォルダーを
丸ごとバックアップしておこう。

.. code:: text

   %LOCALAPPDATA%\Microsoft\PowerToys

参考：
`Import and Export of PowerToys Settings <https://github.com/microsoft/PowerToys/issues/14149>`__

精選機能集
======================================================================

私が重用したい機能を順不同に記す。使用の度合いはおそらくばらつきがあるだろう。

* File Explorer add-ons は採用決定。テキストエディターを開かなくても JSON ファイ
  ルが確認できたりするのは大きい。
* Image Resizer は使ってみると手軽なので採用する。プリセットは不要。小だけ使う。
  タイムスタンプを保持する設定を推奨。
* Keyboard Manager は条件付きで採用。レジストリーを別の手段で変更していないとき
  に使う。
* PowerRename はいちおう採用。
* PowerToys Run はたいへん便利なので採用。Windows の
  :program:`ファイル名を指定して実行` を上書きしたいくらいだ。
* Shortcut Guide はこれらのショートカットキーを習得するまで有効にする。
* Text Extractor は採用。日本語文字列に空白文字がしばしばサンドイッチされるが。

こんなものだろう。不採用の機能は設定画面のスイッチで無効にしておく。

関連ノート
======================================================================

* :doc:`/freeware`: PowerToys の機能には、他のフリーウェアのほうが高性能であるこ
  とがある部分がある。
* :doc:`/winget`: PowerToys 自身を初インストールするときの参考になるかもしれない
  ノート。
