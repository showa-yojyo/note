======================================================================
Video Conference Mute
======================================================================

Video Conference Mute（以下 VCM と約める）は電話会議中に、どのアプリケーションを
使っている途中でも、クリック一つでマイクをミュートしたり、カメラをオフにすること
ができる機能だ。

VCM は新規開発を現在終了している。不具合修正しかしていないようだ。事情については
VCM 設定画面のリンク先を参照するといい。

.. attention::

   :doc:`./index` 冒頭の前提条件に留意すること。

.. contents::

操作手順
======================================================================

本機能は :program:`PowerToys` 本体を管理者権限で起動しておかないと、設定が全くで
きない。そうなっていない場合には :guilabel:`全般` 画面で設定を確認することだ。そ
の上で本機能の設定画面にある :guilabel:`ビデオ会議のミュートを有効にする` スイッ
チを ON にする。これで本機能が有効になり、後述するショートカットキー群が効くよう
になる。

キーバインドのいずれかによりコマンドを実行すると、小さなツールバーが表示される。
マイクとカメラの状態がオン、オフ、未使用の何であるかを示すものだ。

VCM を使用するには、カメラ・マイクを使用しているプログラム側でも設定が必要だ。カ
メラ・マイクのソースとして選択されていなければならない。当該プログラムの UI で
:guilabel:`PowerToys VideoConference Mute` を指定することだ。

設定
======================================================================

:guilabel:`ビデオ会議のミュートを有効にする` スイッチをオンにすることで、機能が
有効になるとともに、下記設定項目のコントロールが有効になる。

ショートカットキー
----------------------------------------------------------------------

VCM に備わるコマンドのショートカットキーを設定する。既定のキーバインドを次に記し
ておく。

.. csv-table::
   :delim: @
   :header-rows: 1
   :widths: auto

   キーバインド @ コマンド
   :kbd:`Win` + :kbd:`Shift` + :kbd:`Q` @ マイクとカメラ双方のミュート状態を切り替える
   :kbd:`Win` + :kbd:`Shift` + :kbd:`A` @ マイクのミュート状態を切り替わる
   :kbd:`Win` + :kbd:`Shift` + :kbd:`O` @ カメラのミュート状態を切り変わる

マイク
----------------------------------------------------------------------

:guilabel:`選択したマイク` でどのマイクを本機能の対象とするのかを指定する。普通
は全指定 :guilabel:`[All]` でいい。

カメラ
----------------------------------------------------------------------

:guilabel:`選択したカメラ`
    VCM が使用するマシンのカメラを指定する。
:guilabel:`カメラがミュートのときに表示される画像`
    VCM がカメラを塞いでいる間に表示するダミー画像を指定する。ファイルシステムの
    画像ファイルパスで指示する。

ツールバー
----------------------------------------------------------------------

上述のように、VCM ミュート中にはミニツールバーが表示される。
:guilabel:`ツールバーの位置` では、このツールバーを画面のどの辺に表示するかを設
定する。

また、モニターが複数取り付けられているときには当ツールバーを表示するモニターを
:guilabel:`ツールバーを表示する` で指定するといい。

ドロップダウンリスト :guilabel:`ツールバーを非表示にする` では、VCM ツールバーを
どのような条件成立時に隠すかを指定する。次の三つから選ぶ：

* :guilabel:`許可しない`
* :guilabel:`カメラとマイクの両方がミュート解除されている場合`
* :guilabel:`カメラとマイクの両方がミュートされている場合`
