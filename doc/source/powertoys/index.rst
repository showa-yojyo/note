======================================================================
Microsoft PowerToys 利用ノート
======================================================================

`Microsoft PowerToys <https://docs.microsoft.com/ja-jp/windows/powertoys/>`__
についての雑多なノートを綴る。

.. note::

   本ノートを記すのに用いている Windows および :program:`PowerToys` のバージョン
   情報はそれぞれ次のとおりだ。

   :OS: Windows 10 Home version 22H2
   :PowerToys: v0.64.1

   本当は GUI 言語を英語にしたいが OS に強く依存するようなので日本語で行く。

.. contents::

なぜ PowerToys を導入するのか
======================================================================

今のところ特に理由はないが、いざというときの選択肢を増やしておく意味はある。

事前条件
======================================================================

インストールまたはアップグレードの際には OS がインターネットに接続されており、
かつ :program:`winget` が利用可能であるものとする。

インストールとアップグレード
======================================================================

インストール方法は複数あるが、:program:`winget` での JSON ファイルから他のソフト
ウェアと一斉にインストールする運用を想定している。

:program:`PowerToys` 単体をインストールするならば、コンソールから次のコマンドを
実行する：

.. code:: doscon

   > winget install -e --id Microsoft.PowerToys

:program:`PowerToys` のアップグレード手段はインストールのそれ以上に用意されてい
る。通常はアプリケーションの既定の設定である自動更新が有効になっているのに頼れば
よい。手動で更新したい場合には、:program:`PowerToys` 設定画面のボタン
:guilabel:`更新プログラムを確認する` を押して、あとは手なりで進行する。あるいは
:program:`winget` の一括アップグレード運用で更新されるだろう。

ユーティリティー概要
======================================================================

:program:`PowerToys` は各種アプリケーションの複合体と考えるほうがわかりやすい。
アプリケーション同士の連携は全くないものと捉えるべきだ。

以下では :program:`PowerToys` をそれぞれのアプリケーション単位について簡単に述べ
ていく。きちんとした仕様は先述の文書のリンク先各ページに述べられている。

.. toctree::
   :maxdepth: 1

   always-on-top
   awake
   color-picker
   fancy-zones
   file-explorer-add-ons
   file-locksmith
   hosts-file-editor
   image-resizer
   keyboard-manager
   mouse-utility
   power-rename
   powertoys-run
   quick-accent
   screen-ruler
   shortcut-guide
   text-extractor
   video-conference-mute

全般設定
======================================================================

:guilabel:`バージョン` とある場所からは、次のことができる：

* 起動中の :program:`PowerToys` のバージョン番号、
* 更新プログラムの有無確認、
* リリースノートの確認、および
* :guilabel:`更新プログラムを自動ダウンロードする` かどうかの切り替えをする。

:guilabel:`管理者モード` とある場所からは、次のことができる：

* 管理者モードの確認および設定。
* 管理者モードに関する詳細情報の確認。

一般モードから管理者モードに切り替えるときには :program:`PowerToys` が再起動す
る。その逆は不能になっており、管理者モードで :program:`PowerToys` を開くと、この
設定項目が変更不能になる。

:guilabel:`外観および動作` とある場所からは、次のことができる：

* テーマをライト、ダーク、Windows 既定のいずれかに指定する。
* :guilabel:`起動時に実行` スイッチで、OS 起動時に :program:`PowerToys` を起動す
  るかどうかを決める。

バックアップ
======================================================================

次のフォルダー以下に JSON ファイル群が大量に保存されている。これらが
:program:`PowerToys` およびサブソフト群の設定内容を保持しているのだろう。したがっ
て、このフォルダーを丸ごとバックアップしておこう。

.. code:: text

   %LOCALAPPDATA%\Microsoft\PowerToys

参考：
`Import and Export of PowerToys Settings <https://github.com/microsoft/PowerToys/issues/14149>`__

精選機能集
======================================================================

私が重用したい機能を順不同に記す。使用の度合いはおそらくばらつきがあるだろう。

* File Explorer add-ons は採用決定。テキストエディターを開かなくても JSON ファイ
  ルが確認できたりするのは大きい。
* Image Resizer は使ってみると手軽なので採用する。プリセットは不要。小だけ使う。
  タイムスタンプを保持する設定を推奨。
* Keyboard Manager は条件付きで採用。レジストリーを別の手段で変更していないとき
  に使う。
* PowerRename はいちおう採用。
* PowerToys Run はたいへん便利なので採用。Windows の
  :program:`ファイル名を指定して実行` を上書きしたいくらいだ。
* Shortcut Guide はこれらのショートカットキーを習得するまで有効にする。
* Text Extractor は採用。日本語文字列に空白文字がしばしばサンドイッチされるが。

こんなものだろう。不採用の機能は設定画面のスイッチで無効にしておく。

関連ノート
======================================================================

* :doc:`/freeware`: :program:`PowerToys` の機能には、他のフリーウェアのほうが高
  性能であることがある部分がある。
* :doc:`/winget`: :program:`PowerToys` 自身を初インストールするときの参考になる
  かもしれないノート。
