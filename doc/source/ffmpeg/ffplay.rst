======================================================================
:program:`ffplay` ノート
======================================================================

WSLg が有効になっている必要があるが、:program:`ffplay` でコンソールから手を離さ
ずにビデオを再生することが可能だ。他にも :program:`ffmpeg` の出力をパイプして再
生するという使い方や、フィルターを試すためだけに使う用途もある。

.. contents::

再生
======================================================================

基本編で述べたように、メディアファイルを引数に与えて単に実行すると、ビデオなら
ウィンドウが出現してその内容が再生される。音声のみのファイルならば音が聞こえる。

フィルター実験
----------------------------------------------------------------------

もう一つの使い方は、FFmpeg のフィルター機能を試すのに使うというものだ。例えば次
のコマンドを実行するとある映像が再生される：

.. code:: console

   bash$ ffplay -f lavfi -i "testsrc=duration=10:size=256x224:rate=30" -autoexit

パイプ
----------------------------------------------------------------------

パイプを介する再生方法も用意されている。:command:`ffmpeg` の encoding オプション
の値を ``matroska`` にするのが望ましい。

.. code:: console

   bash$ ffmpeg ... -f matroska - | ffplay -

キーボード操作
======================================================================

:program:`ffplay` のプレイヤーウィンドウがアクティブになっている状態で、キーボー
ドのキー押しイベントをいくつか受け入れる。よく使うものをまとめておく：

.. csv-table::
   :delim: |
   :header: Keybind,Command
   :widths: auto

   :kbd:`Q` or :kbd:`ESC` | プレイヤーを終了する
   :kbd:`P`, :kbd:`SPC` | 一時停止
   :kbd:`F` | 全画面モードを切り替える
   :kbd:`M` | ミュートを切り替える
   :kbd:`S` | 次のフレームにステップ（必要ならばストリームを一時停止）
   :kbd:`→` or :kbd:`←` | 十秒移動
   :kbd:`↑` or :kbd:`↓` | 一分移動
   :kbd:`PageUp` or :kbd:`PageDown` | 章移動（ない場合は十分移動）

マウス操作
----------------------------------------------------------------------

:program:`ffplay` のビューワーウィンドウがアクティブになっている状態で、受け入れ
られるマウスイベントがある。

.. csv-table::
   :delim: |
   :header: Event,Command
   :widths: auto

   右クリック | 幅の割合に対応する尺を百分率でシーク
   左ダブルクリック | 全画面モードを切り替え

コマンドラインオプション
----------------------------------------------------------------------

画面寸法指定などの有用なオプションをまとめる：

.. csv-table::
   :delim: |
   :header: オプション,操作
   :widths: auto

   ``-autoexit`` | 再生が終了するとプレイヤーも直ちに終了する
   ``-loop N`` | 再生を反復する
   ``-x WIDTH`` | プレイヤーウィンドウの幅（座標ではない）
   ``-y HEIGHT`` | プレイヤーウィンドウの高さ（座標ではない）
   ``-left`` | プレイヤーウィンドウの x 座標
   ``-top`` | プレイヤーウィンドウの y 座標
