<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Calc Guide Chapter 8, Using Formulas and Functions ノート &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=c9b0a06a" />
    <script src="../../_static/documentation_options.js?v=4354bf25"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Calc Guide Chapter 9, Using Pivot Tables ノート" href="calc09.html" />
    <link rel="prev" title="Calc Guide Chapter 7, Printing, Exporting, Emailing, and Signing ノート" href="calc07.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc07.html" title="Previous">Calc Guide Chapter 7, Printing, Exporting, Emailing, and Signing ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Calc Guide 読書ノート</a>
        </li>
        <li>
          <a href="calc09.html" title="Next">Calc Guide Chapter 9, Using Pivot Tables ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="calc-guide-chapter-8-using-formulas-and-functions">
<h1>Calc Guide Chapter 8, Using Formulas and Functions ノート<a class="headerlink" href="#calc-guide-chapter-8-using-formulas-and-functions" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">章見出し</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id10">Introduction</a></p></li>
<li><p><a class="reference internal" href="#setting-up-a-spreadsheet" id="id11">Setting up a spreadsheet</a></p>
<ul>
<li><p><a class="reference internal" href="#the-trap-of-fixed-values" id="id12">The trap of fixed values</a></p></li>
<li><p><a class="reference internal" href="#lack-of-documentation" id="id13">Lack of documentation</a></p></li>
<li><p><a class="reference internal" href="#error-checking-formulas" id="id14">Error-checking formulas</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#creating-formulas" id="id15">Creating formulas</a></p>
<ul>
<li><p><a class="reference internal" href="#operators-in-formulas" id="id16">Operators in formulas</a></p></li>
<li><p><a class="reference internal" href="#operator-types" id="id17">Operator types</a></p>
<ul>
<li><p><a class="reference internal" href="#arithmetic-operators" id="id18">Arithmetic operators</a></p></li>
<li><p><a class="reference internal" href="#comparative-operators" id="id19">Comparative operators</a></p></li>
<li><p><a class="reference internal" href="#text-operators" id="id20">Text operators</a></p></li>
<li><p><a class="reference internal" href="#reference-operators" id="id21">Reference operators</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#relative-and-absolute-references" id="id22">Relative and absolute references</a></p>
<ul>
<li><p><a class="reference internal" href="#relative-referencing" id="id23">Relative referencing</a></p></li>
<li><p><a class="reference internal" href="#absolute-referencing" id="id24">Absolute referencing</a></p></li>
<li><p><a class="reference internal" href="#named-ranges" id="id25">Named ranges</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#order-of-calculation" id="id26">Order of calculation</a></p></li>
<li><p><a class="reference internal" href="#calculations-linking-sheets" id="id27">Calculations linking sheets</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#understanding-functions" id="id28">Understanding functions</a></p>
<ul>
<li><p><a class="reference internal" href="#compatibility-with-other-spreadsheet-applications" id="id29">Compatibility with other spreadsheet applications</a></p></li>
<li><p><a class="reference internal" href="#understanding-the-structure-of-functions" id="id30">Understanding the structure of functions</a></p></li>
<li><p><a class="reference internal" href="#nested-functions" id="id31">Nested functions</a></p></li>
<li><p><a class="reference internal" href="#using-the-functions-deck" id="id32">Using the Functions deck</a></p></li>
<li><p><a class="reference internal" href="#using-the-function-wizard" id="id33">Using the Function Wizard</a></p></li>
<li><p><a class="reference internal" href="#array-formulas" id="id34">Array formulas</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-an-array-formula" id="id35">What is an array formula?</a></p></li>
<li><p><a class="reference internal" href="#when-do-you-use-array-formulas" id="id36">When do you use array formulas?</a></p></li>
<li><p><a class="reference internal" href="#creating-array-formulas" id="id37">Creating array formulas</a></p></li>
<li><p><a class="reference internal" href="#implicit-intersection-of-array-formulas" id="id38">Implicit intersection of array formulas</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#strategies-for-creating-formulas-and-functions" id="id39">Strategies for creating formulas and functions</a></p>
<ul>
<li><p><a class="reference internal" href="#place-a-unique-formula-in-each-cell" id="id40">Place a unique formula in each cell</a></p></li>
<li><p><a class="reference internal" href="#break-formulas-into-parts-and-combine-the-parts" id="id41">Break formulas into parts and combine the parts</a></p></li>
<li><p><a class="reference internal" href="#speeding-up-calculations" id="id42">Speeding up calculations</a></p>
<ul>
<li><p><a class="reference internal" href="#use-array-formulas-on-massive-data" id="id43">Use array formulas on massive data</a></p></li>
<li><p><a class="reference internal" href="#use-consolidation-functions" id="id44">Use consolidation functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#use-macros-to-create-functions" id="id45">Use macros to create functions</a></p></li>
<li><p><a class="reference internal" href="#multi-threading" id="id46">Multi-threading</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#finding-and-fixing-errors" id="id47">Finding and fixing errors</a></p>
<ul>
<li><p><a class="reference internal" href="#error-messages" id="id48">Error messages</a></p></li>
<li><p><a class="reference internal" href="#examples-of-common-errors" id="id49">Examples of common errors</a></p>
<ul>
<li><p><a class="reference internal" href="#div-0-division-by-zero" id="id50">#DIV/0! division by zero</a></p></li>
<li><p><a class="reference internal" href="#value-no-result-and-ref-incorrect-references" id="id51">#VALUE! no result and #REF! incorrect references</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#color-coding-for-input" id="id52">Color coding for input</a></p>
<ul>
<li><p><a class="reference internal" href="#value-highlighting" id="id53">Value highlighting</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#the-detective" id="id54">The Detective</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#examples-of-functions" id="id55">Examples of functions</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-arithmetic-and-statistics" id="id56">Basic arithmetic and statistics</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-arithmetic" id="id57">Basic arithmetic</a></p></li>
<li><p><a class="reference internal" href="#simple-statistics" id="id58">Simple statistics</a></p></li>
<li><p><a class="reference internal" href="#using-these-functions" id="id59">Using these functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#rounding-off-numbers" id="id60">Rounding off numbers</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#volatile-non-volatile-functions" id="id61">Volatile / non-volatile functions</a></p></li>
<li><p><a class="reference internal" href="#using-wildcards-and-regular-expressions-in-functions" id="id62">Using wildcards and regular expressions in functions</a></p></li>
<li><p><a class="reference internal" href="#advanced-functions" id="id63">Advanced functions</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>数式は数とテキストを評価するセルデータと考えられる。</p>
<p>関数とはセルに入る定義済みの計算のことだと考えられる。引数を入れるだけで自動的に計算が行われる。関数を使って、求める結果を得るために必要な数式を作成する。</p>
</section>
<section id="setting-up-a-spreadsheet">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Setting up a spreadsheet</a><a class="headerlink" href="#setting-up-a-spreadsheet" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>数式に定数を入力するのは避けろ。</p></li>
<li><p>何をするシートであるのかを記述する文書、メモ、コメントを含める。</p></li>
<li><p>数式が意図どおりに働くことを確認するために、エラーチェックを仕込む。</p></li>
</ul>
<section id="the-trap-of-fixed-values">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">The trap of fixed values</a><a class="headerlink" href="#the-trap-of-fixed-values" title="Link to this heading">¶</a></h3>
<p>例えば一つのセルに為替レートと金額を乗じる数式を含めるとして、為替レートを生の数値で表現するのではなく、乗算式が為替レート単品を含むセルを参照するように書くほうが良い。</p>
<ul class="simple">
<li><p>為替レートが変化した場合、計算式の編集が不要になる。</p></li>
<li><p>複雑な計算式を管理しやすい部分に分割することで、失敗を最小限に抑える。</p></li>
</ul>
</section>
<section id="lack-of-documentation">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Lack of documentation</a><a class="headerlink" href="#lack-of-documentation" title="Link to this heading">¶</a></h3>
<p>文書化がないと、当初の目的や方法論が不明確になり、解読が困難になりがちだ。そうなると最初からやり直す方が簡単で、以前の作業が無駄になる。セルにコメントを挿入し、ラベルや見出しを使用すれば、スプレッドシートは後で簡単に修正でき、時間と労力を節約できる。</p>
</section>
<section id="error-checking-formulas">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Error-checking formulas</a><a class="headerlink" href="#error-checking-formulas" title="Link to this heading">¶</a></h3>
<p>スプレッドシートにチェックを設けると便利だ。</p>
<p><span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Calc‣View</span> ページ <span class="guilabel">Formula indicator and hint</span> をオンにしろ。これにより、数式を含むセルの左下に小三角形が描かれ、ツールチップには数式が示される。数式バー非表示派の利用者の使い勝手が向上する。</p>
</section>
</section>
<section id="creating-formulas">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Creating formulas</a><a class="headerlink" href="#creating-formulas" title="Link to this heading">¶</a></h2>
<p>数式を入力する方法：</p>
<ul class="simple">
<li><p>セルに対して直接入力</p>
<ul>
<li><p>数式は記号 <code class="docutils literal notranslate"><span class="pre">=</span></code> で始める必要がある</p></li>
<li><p>数式が前置単項演算子から始まる場合、等号は自動的に追加される</p></li>
<li><p>そうしないとテキスト扱いになる</p></li>
</ul>
</li>
<li><p><span class="guilabel">Function Wizard</span> を利用</p>
<ul>
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣<span class="accelerator">F</span>unction…</span> 実行</p></li>
<li><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F2</kbd> 押し</p></li>
</ul>
</li>
<li><p>Sidebar <span class="guilabel">Functions</span> 甲板 を利用 (<kbd class="kbd docutils literal notranslate">Alt</kbd> + <kbd class="kbd docutils literal notranslate">5</kbd>)</p></li>
</ul>
<section id="operators-in-formulas">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Operators in formulas</a><a class="headerlink" href="#operators-in-formulas" title="Link to this heading">¶</a></h3>
<p>シートの各升目はデータ置場または計算場所として使用可能。データを入力するには、升目に単に入力し、次のセルに移動するか、<kbd class="kbd docutils literal notranslate">Enter</kbd> を押す。数式では、等号 <code class="docutils literal notranslate"><span class="pre">=</span></code> はその升目が計算に使用されることを示す。</p>
<p>左の計算（読者注※ <code class="docutils literal notranslate"><span class="pre">=15+46</span></code> の例）では升目を一つしか使っていないが、データを升目に入れ、その升目を参照して計算を行っている右の計算（※： <code class="docutils literal notranslate"><span class="pre">=B3+B4</span></code> の例）が真の力を示している。この場合、升目 B3 と B4 がデータ置場で、B5 が計算を実行する升目だ。計算式の加算記号は升目 B3 と B4 の内容の和が数式を持つ升目に入ることを示している。数式すべてがこの概念に基づいている。その他の数式の使い方を次に示す：</p>
<table class="docutils align-left" id="id5">
<caption><span class="caption-text">数式の一般的な使い方</span><a class="headerlink" href="#id5" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>数式</p></th>
<th class="head"><p>意味</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">=A1+10</span></code></p></td>
<td><p>升目 A1 に 10 を加えた内容を表示する。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">=A1*16%</span></code></p></td>
<td><p>升目 A1 の内容の 16% を表示する。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">=A1*A2</span></code></p></td>
<td><p>升目 A1 と A2 の内容の積を表示する。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">=ROUND(A1,1)</span></code></p></td>
<td><p>升目 A1 の内容を小数点第一位で四捨五入して表示する。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">=EFFECT(5%,12)</span></code></p></td>
<td><p>年 5% の名目金利を年 12 回支払う場合の実効金利を計算する。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">=B8-SUM(B10:B14)</span></code></p></td>
<td><p>升目 B8 から升目 B10 から B14 の和を差し引いた値を計算する。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">=SUM(B8,SUM(B10:B14))</span></code></p></td>
<td><p>升目 B10 から B14 の和を計算し、その値を B8 に加える。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">=SUM(B1:B1048576)</span></code></p></td>
<td><p>B 列のすべての数値を合計する。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">=AVERAGE(BloodSugar)</span></code></p></td>
<td><p>BloodSugar という名前で定義された名前付き範囲の平均を表示する。例えば
BloodSugar は B3:B10 のような範囲を表す。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">=IF(C31&gt;140,&quot;HIGH&quot;,&quot;OK&quot;)</span></code></p></td>
<td><p>論理関数は、<cite>IF</cite> 文に代表されるように、特定された升目のデータに基づいて条件付き応答を行うこともできる。この例では C31 の内容が 140 より大きければ
<cite>HIGH</cite> と表示され、そうでなければ <cite>OK</cite> と表示される。</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>この章で説明する数式の作成以外の目的で等号 <code class="docutils literal notranslate"><span class="pre">=</span></code> を入力する場合は、この記号の前にアポストロフィーまたはシングルクォーテーションを入れろ。Calc はシングルクォーテーション以降をすべてテキストとして扱う。</p>
</div>
</section>
<section id="operator-types">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Operator types</a><a class="headerlink" href="#operator-types" title="Link to this heading">¶</a></h3>
<p>Calc では演算子は算術演算子、比較演算子、テキスト演算子、参照演算子に分類されているようだ。</p>
<section id="arithmetic-operators">
<h4><a class="toc-backref" href="#id18" role="doc-backlink">Arithmetic operators</a><a class="headerlink" href="#arithmetic-operators" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>演算子 <code class="docutils literal notranslate"><span class="pre">%</span></code> は後置単項演算子として働く（意味は百分率）</p></li>
<li><p>べき乗のための演算子はキャレット記号 <code class="docutils literal notranslate"><span class="pre">^</span></code> を用いる。古の Basic 由来？</p></li>
</ul>
</section>
<section id="comparative-operators">
<h4><a class="toc-backref" href="#id19" role="doc-backlink">Comparative operators</a><a class="headerlink" href="#comparative-operators" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>比較演算の結果は <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> または <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> を返すと考えてよい</p></li>
<li><p>不等式は <code class="docutils literal notranslate"><span class="pre">&lt;&gt;</span></code> を用いる</p></li>
</ul>
</section>
<section id="text-operators">
<h4><a class="toc-backref" href="#id20" role="doc-backlink">Text operators</a><a class="headerlink" href="#text-operators" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>二項演算子 <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> は文字列連結演算</p></li>
</ul>
<p>テキストはスプレッドシート上のさまざまな場所にある断片を連結することができる。関数``CONCATENATE`` を用いても連結可能だ。</p>
</section>
<section id="reference-operators">
<h4><a class="toc-backref" href="#id21" role="doc-backlink">Reference operators</a><a class="headerlink" href="#reference-operators" title="Link to this heading">¶</a></h4>
<p>セルの識別方法ついて述べられている：</p>
<blockquote>
<div><p>An individual cell is identified by the column identifier (letter) located
along the top of the columns and a row identifier (number) found along the
left-hand side of the spreadsheet. On spreadsheets read from left to right,
the reference for the upper left cell is A1.</p>
</div></blockquote>
<p>最も単純な形では参照はセル一つを参照するが、矩形や立方体の範囲を参照したり、参照リストの中にある参照を参照することもできる。このような参照を作るには参照演算子を用いる。</p>
<section id="reference-range-operator">
<h5>Reference range operator<a class="headerlink" href="#reference-range-operator" title="Link to this heading">¶</a></h5>
<p>コロンは左参照で参照されるセルと右参照で参照されるセルの両方を含む最小範囲への参照を形成する。見慣れぬ範囲指定を Table 12 から引用しておく：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Example</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>(A2:B4):C9</p></td>
<td><p>セル A2 とセル C9 がそれぞれ左上と右下の矩形範囲</p></td>
</tr>
<tr class="row-odd"><td><p>Sheet1.A3:Sheet3.D4</p></td>
<td><p>シート Sheet1, Sheet2, Sheet3 すべての A3:D4</p></td>
</tr>
<tr class="row-even"><td><p>1:20</p></td>
<td><p>行 1 から 20 までのセルすべて</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-left" id="id6">
<caption><span class="caption-text">参照範囲演算子の例</span><a class="headerlink" href="#id6" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>例</p></th>
<th class="head"><p>意味</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A2:B4</span></code></p></td>
<td><p>二列×三行、六升の矩形範囲への参照。入力行の数式内の参照をクリックすると枠線が矩形を示す。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(A2:B4):C9</span></code></p></td>
<td><p>升目 A2 と C9 がそれぞれ左上と右下の矩形範囲を参照。つまり、この範囲には三列×八行の 24 個の升目が含まれる。このアドレス指定法は最初の範囲を
A2:B4 から A2:C9 に拡張する。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Sheet1.A3:Sheet3.D4</span></code></p></td>
<td><p>24 升、四列×二行高さ×三層の立方体範囲を参照。シートタブエリアに
Sheet1, Sheet2, Sheet3 がこの順番で表示されていると仮定すれば。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">B:B</span></code></p></td>
<td><p>B 列のすべての升目への参照。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A:D</span></code></p></td>
<td><p>A 列から D 列の升目全部への参照。</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">20:20</span></code></p></td>
<td><p>20 行目の升目全部への参照。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">1:20</span></code></p></td>
<td><p>一行目から 20 行目までにある升目全部への参照。</p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">B4:A2</span></code>, <code class="docutils literal notranslate"><span class="pre">B2:A4</span></code>, <code class="docutils literal notranslate"><span class="pre">A4:B2</span></code> を直接入力すると、Calc はそれを <code class="docutils literal notranslate"><span class="pre">A2:B4</span></code> に変換する。つまり、範囲の左上の升目はコロンの左、右下の升目はコロンの右になる。しかし、例えば <code class="docutils literal notranslate"><span class="pre">B4</span></code> に <code class="docutils literal notranslate"><span class="pre">_start</span></code>, <code class="docutils literal notranslate"><span class="pre">A2</span></code> に <code class="docutils literal notranslate"><span class="pre">_end</span></code> と名前をつければ
<code class="docutils literal notranslate"><span class="pre">_start:_end</span></code> をエラーなく使用できる。セル名の付け方については
<a class="reference internal" href="#calc08-anchor-named"><span class="std std-ref">Named ranges</span></a> を見ろ。</p>
</section>
<section id="reference-concatenation-operator">
<h5>Reference concatenation operator<a class="headerlink" href="#reference-concatenation-operator" title="Link to this heading">¶</a></h5>
<p>セル union 演算子 <code class="docutils literal notranslate"><span class="pre">~</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">A1:C3~B2:D2</span></code>.</p>
<ul class="simple">
<li><p>この式の評価は参照リストという型の値だと考えられる。</p></li>
<li><p>関数によっては引数に参照リストを取り得る。</p></li>
<li><p>上に union と記したが、集合和の意味は薄い。</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">COUNT(A1:C3~B2:D2)</span></code> は 10 セルで構成されるにも関わらず 12 を返す。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SUM(A1:C3~B2:D2)</span></code> と <code class="docutils literal notranslate"><span class="pre">SUM(A1:C3,B2:D2)</span></code> は同じ値を返すが、処理が違う。</p></li>
</ul>
</li>
</ul>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>この演算子が活躍する場面が思い浮かばない。</p>
</div>
</section>
<section id="reference-intersection-operator">
<h5>Reference intersection operator<a class="headerlink" href="#reference-intersection-operator" title="Link to this heading">¶</a></h5>
<p>セル intersection 演算子 <code class="docutils literal notranslate"><span class="pre">!</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">A2:B4</span> <span class="pre">!</span> <span class="pre">B3:D6</span></code></p>
<ul class="simple">
<li><p>結果は左辺の参照と右辺の参照の両方に含まれるセルすべてを含む。</p></li>
<li><p>結果が単一範囲を指す場合、単一範囲への参照として評価される。</p></li>
<li><p>オペランドが参照リストであってもかまわない。</p></li>
<li><p>一般には、評価が参照リストになるらしい。</p></li>
</ul>
<p><span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Calc‣Calculate</span> ページ の <span class="guilabel"><span class="accelerator">A</span>utomatically find column and row
labels</span> をオンにしてあると、行や列に名前を付けておいて <code class="samp docutils literal notranslate"><em><span class="pre">row_name</span></em> <span class="pre">!</span>
<em><span class="pre">column_name</span></em></code> のような式でクロス集計のセルをわかりやすく参照することができる。</p>
</section>
<section id="examples">
<h5>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h5>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>時間が余ったらやる</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>最初に計算する部分を括弧で囲め。</p>
</div>
</section>
</section>
</section>
<section id="relative-and-absolute-references">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Relative and absolute references</a><a class="headerlink" href="#relative-and-absolute-references" title="Link to this heading">¶</a></h3>
<p>参照は、Calc 内の特定の升目の位置を参照する方法で、相対（現在の升目に対して）または絶対（一定量）のいずれかを指定できる。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>相対参照と絶対参照について、これらの概念を理解しろ。セルのコピーやリンクに欠かせない。</p>
</div>
<section id="relative-referencing">
<h4><a class="toc-backref" href="#id23" role="doc-backlink">Relative referencing</a><a class="headerlink" href="#relative-referencing" title="Link to this heading">¶</a></h4>
<p>いきなりだが例：</p>
<ol class="arabic simple">
<li><p>スプレッドシートのセル C3 と C4 にそれぞれ数字 4 と 11 を入力する。</p></li>
<li><p>セル B5 に数式 <code class="docutils literal notranslate"><span class="pre">=B3+B4</span></code> を入力する。</p></li>
<li><p>セル B5 をセル C5 にコピーする。これを行うには、単純なコピー＆ペーストを使うか、B5 をクリックして C5 にドラッグする。</p></li>
<li><p>セル C5 をクリックする。Formula バー には <code class="docutils literal notranslate"><span class="pre">=B3+B4</span></code> ではなく <code class="docutils literal notranslate"><span class="pre">=C3+C4</span></code> が表示され、C5 の値は C3 と C4 の値である 4 と 11 の合計である 15 になる。</p></li>
</ol>
<p>セル B5 のセル B3 とセル B4 への参照は相対参照だ。これは、Calc が B5 の数式を解釈し、それを B 列のセルに適用し、その結果を数式を保持しているセルに入れることを意味する。数式を別のセルにコピーしたときも、同じ手順でそのセルに入れる値を計算した。今回はセル C5 の数式がセル C3 と C4 を参照している。</p>
<ul class="simple">
<li><p>相対参照は現在のセルに対するオフセットの対と考えられる。</p></li>
<li><p>以前のスプレッドシートでは、オフセットペア表記方法を数式で使用可能だった。</p></li>
</ul>
<p>この数式をセル B5 から別のセルにコピーすると、結果は常に、数式を含むセルの一行上と行上の二つのセルから取得した数値二つの合計になる。</p>
<p>Calc でアドレスを参照する既定の方式は相対参照だ。</p>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>オフセット方式のほうがコピー＆ペーストで参照を含む式を操作するときの動作を説明しやすいから良いと思う。</p>
</div>
</section>
<section id="absolute-referencing">
<h4><a class="toc-backref" href="#id24" role="doc-backlink">Absolute referencing</a><a class="headerlink" href="#absolute-referencing" title="Link to this heading">¶</a></h4>
<p>数字の列に一定の金額を掛けたい場合がある。数字の列は米ドルで表示されるかもしれない。これらの金額をユーロに変換するには、各ドルの金額に為替レートを掛ける必要がある。 $10.00 をユーロに換算するには 0.75 を掛けることになり、この場合は €7.50
となる。次の例は、為替レートを入力し、そのレートを使用して列の金額を米ドルからユーロに変換する方法だ：</p>
<ol class="arabic simple">
<li><p>セル D1 に為替レート Eur:USD (0.75) を入力する。セル D2, D3, D4 に米ドル金額を入力する。10, 20, 30 でいい。</p></li>
<li><p>セル E2 に数式 <code class="docutils literal notranslate"><span class="pre">=D2*D1</span></code> を入力する。結果は 7.5 となり、正しく表示される。</p></li>
<li><p>セル E2 の数式をセル E3 にコピーする。結果は 200 で、明らかに誤りだ。Calc は相対参照を使って数式をコピーした。E3 の数式は <code class="docutils literal notranslate"><span class="pre">=D3*D2</span></code> であり、望まれる
<code class="docutils literal notranslate"><span class="pre">=D3*D1</span></code> ではない。</p></li>
<li><p>セル E2 で数式を <code class="docutils literal notranslate"><span class="pre">=D2*$D$1</span></code> に編集し、セル E3 と E4 にコピーする。結果は 15
と 22.5 となり、正しい。</p></li>
</ol>
<p>D と 1 の前の <code class="docutils literal notranslate"><span class="pre">$</span></code> 記号は、セル D1 への参照を相対から絶対すなわち固定に変換する。この数式を別のセルにコピーすると、二番目の部分は常に <code class="docutils literal notranslate"><span class="pre">$D$1</span></code> と表示される。この数式の解釈は「同じ行の一列左のセルの値を取り、セル D1 の値を掛ける」だ。</p>
<p>セル参照は次の表に示す四つの方法で表すことができる：</p>
<table class="docutils align-left" id="id7">
<caption><span class="caption-text">Cell reference types</span><a class="headerlink" href="#id7" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>参照例</p></th>
<th class="head"><p>記述</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>D1</p></td>
<td><p>相対。升目 E3 から見て左に一列、上に二行の升目。</p></td>
</tr>
<tr class="row-odd"><td><p>$D$1</p></td>
<td><p>絶対。升目 D1 そのもの。</p></td>
</tr>
<tr class="row-even"><td><p>$D1</p></td>
<td><p>部分的に絶対。升目 E3 からは D 列の升目であり、二行上の升目。</p></td>
</tr>
<tr class="row-odd"><td><p>D$1</p></td>
<td><p>部分的に絶対。升目 E3 から左一列目、一行目の升目。</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>数式の参照を変更するには、セルをハイライトし、<kbd class="kbd docutils literal notranslate">F4</kbd> を押して四種類の参照を循環させろ。数式の一部だけを循環させるには、Formula バー でセルを選択し、<kbd class="kbd docutils literal notranslate">F4</kbd> で循環させる。<span class="menuselection"><span class="accelerator">S</span>heet‣Cycle Cell Re<span class="accelerator">f</span>erence Types</span> を選択することは <kbd class="kbd docutils literal notranslate">F4</kbd> を押すことと等価だ。</p>
</div>
<p>数式をコピー＆ペーストしたり、スプレッドシートをリンクしたりするのに、相対参照と絶対参照の理解が必須だ。</p>
</section>
<section id="named-ranges">
<span id="calc08-anchor-named"></span><h4><a class="toc-backref" href="#id25" role="doc-backlink">Named ranges</a><a class="headerlink" href="#named-ranges" title="Link to this heading">¶</a></h4>
<p>升目やその範囲には名前を付けることができる。升目や範囲に名前を付けると、数式の読みやすさや文書の保守性が向上する。簡単な例としては、升目範囲 B1:B10 に <cite>Weight</cite>
という名前を付け、範囲内の値すべてのを合計するようなものだ。数式は
<code class="docutils literal notranslate"><span class="pre">=SUM(B1:B10)</span></code> だ。これが名前を付けることで数式を <code class="docutils literal notranslate"><span class="pre">=SUM(Weight)</span></code> に変換可能だ。数式の読みやすさの点で、この利点は明らかだ。</p>
<p>もう一つの利点は、名前付き範囲の場所や規模が変更されると、名前付き範囲を引数として持つ数式すべてが更新されることだ。例えば、<cite>Weight</cite> の範囲が P10:P30 になった場合、<cite>Weight</cite> を引数として持つどの数式も見直す必要はない。</p>
<p>名前を与える方法：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">S</span>heet‣<span class="accelerator">N</span>amed Ranges and Expressions‣<span class="accelerator">D</span>efine…</span> コマンドを実行する。<span class="guilabel">Define Name</span> ダイアログボックス で対象升目範囲と名前を指示する。</p></li>
<li><p>または、シートから升目範囲を選択し、Formula バー の左にある <span class="guilabel">Name</span>
欄で名前を入力する。</p></li>
</ul>
<p>名前付き範囲を修正するには <span class="guilabel">Manage Names</span> ダイアログボックス を用いる。このダイアログは Menu バー
から <span class="menuselection"><span class="accelerator">S</span>heet‣<span class="accelerator">N</span>amed Ranges and Expressions‣Manage…</span> を選択するか、<kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F3</kbd> を押すことで開く。</p>
<section id="named-expressions">
<h5>Named expressions<a class="headerlink" href="#named-expressions" title="Link to this heading">¶</a></h5>
<p>数式に名前をつけることも可能だ：</p>
<ol class="arabic simple">
<li><p><span class="guilabel">Degine Name</span> ダイアログボックスを開く</p></li>
<li><p><span class="guilabel"><span class="accelerator">N</span>ame</span> 欄に名前を与える</p></li>
<li><p><span class="guilabel">Range or formula <span class="accelerator">e</span>xpression</span> 欄に数式を入力する</p></li>
<li><p><span class="guilabel"><span class="accelerator">A</span>dd</span> を押す</p></li>
</ol>
<p>例として、C1 から C10 までの升目で円周を計算する必要があり、B1 から B10 までの升目でそれらの半径が与えられているとする。式 <code class="docutils literal notranslate"><span class="pre">=2*PI()*B1</span></code> で名前付き式
<cite>CIRCUMFERENCE</cite> を定義する。升目 C1 に <code class="docutils literal notranslate"><span class="pre">=CIRCUMFERENCE</span></code> と入力して <kbd class="kbd docutils literal notranslate">Enter</kbd> を押す。数式が升目 C1 に適用される。これをコピーして C2 から C10 までの残りの升目に貼り付けると、すべての円の円周が得られる。範囲 C1:C10 の升目全ては
<code class="docutils literal notranslate"><span class="pre">=CIRCUMFERENCE</span></code> という式を持つ。</p>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>名前付き数式の定義に間接参照セルを含ませる場合、定義時のセルアドレスが影響する。</p>
</div>
<p>名前付き表現は、升目のアドレス指定、つまり絶対参照と相対参照に同じ規則を使うことに気をつけろ。</p>
</section>
</section>
</section>
<section id="order-of-calculation">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Order of calculation</a><a class="headerlink" href="#order-of-calculation" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Order_of_operations">Order of operations - Wikipedia</a>
に準拠する。</p>
<p>Calc は数式全体を評価した後、プログラミングの優先順位に基づいて数式を分解し、乗算と除算を他の演算の前に実行する。したがって、数式を作成するときは、数式をテストして、期待される正しい結果が得られることを確認する必要がある。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>括弧を使用して、意図した順序で操作をグループ化しろ。例えば、
<code class="docutils literal notranslate"><span class="pre">=B4+G12*C4/M12</span></code> は <code class="docutils literal notranslate"><span class="pre">=((B4+G12)*C4)/M12</span></code> となる。</p>
</div>
</section>
<section id="calculations-linking-sheets">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Calculations linking sheets</a><a class="headerlink" href="#calculations-linking-sheets" title="Link to this heading">¶</a></h3>
<p>複数のシート間でデータを連動させることが可能だ。シートの名前は特定のデータがどこにあるかを特定するのに役立つ。<cite>Payroll</cite> や <cite>Boise Sales</cite> のような名前は <cite>Sheet1</cite>
よりもずっと意味がある。<cite>SHEET</cite> という関数はシートコレクション内のシート番号（位置）を返す。各文書にはシートが複数あり、左から順に番号が付けられる。<cite>Sheet1</cite>,
<cite>Sheet2</cite>, … といった具合だ。シートをドラッグしてタブの異なる位置に移動すると、この関数はこのシートの現在の位置を示す番号を返す。Calc の新規ファイルでは、既定ではシートは一枚だ。</p>
<p>たとえば、<cite>Sheet1</cite> の A1 に <code class="docutils literal notranslate"><span class="pre">=SHEET()</span></code> という数式を入力すると、値 1 が返される。
<cite>Sheet 1</cite> をドラッグして <cite>Sheet2</cite> と <cite>Sheet3</cite> の間に配置すると値は 2 に変わる。</p>
<p>他の業績からデータを取得する計算の例は業務の場面で見ることができる。業務では各支店の業績の収益と費用を単一の合算表にまとめる。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p><cite>Branch1</cite>, <cite>Branch2</cite>, <cite>Branch3</cite> の三枚のシートそれぞれが各支店の業績を同じ間取りで持っている。合算表を <cite>Combined</cite> シートで持っている。そこの升目には例えば
<code class="docutils literal notranslate"><span class="pre">=Branch1.K7</span> <span class="pre">+</span> <span class="pre">Branch2.K7</span> <span class="pre">+</span> <span class="pre">Branch3.K7</span></code> のような数式がある。</p>
</div>
<p>シートは同じ構造にしろ。最も簡単な方法は、新しいスプレッドシートを開き、最初の分岐シートを設定し、データを入力し、升目を書式設定し、行と列のさまざまな合計の数式を準備することだ。その後、最初のシートから次のようにコピーを作成する：</p>
<ol class="arabic simple">
<li><p>シートタブで右クリックし、<span class="menuselection">Rename S<span class="accelerator">h</span>eet…</span> を選択。<cite>Branch1</cite> と入力する。再度タブを右クリックし、<span class="menuselection"><span class="accelerator">M</span>ove or Copy Sheet…</span> を選択。</p></li>
<li><p><span class="guilabel">Move/Copy Sheet</span> ダイアログボックス で <span class="guilabel">Copy</span> を選択し <span class="guilabel"><span class="accelerator">I</span>nsert before</span> 領域で <cite>-move to end position-</cite> を選択。 <span class="guilabel">New <span class="accelerator">n</span>ame</span> の項目を
<cite>Branch2</cite> に変更する。<span class="guilabel">C<span class="accelerator">o</span>py</span> をクリック。これを繰り返して、<cite>Branch3</cite> と <cite>Combined</cite> シートを作成。</p></li>
<li><p><cite>Branch2</cite> と <cite>Branch3</cite> のデータをそれぞれのシートに入力する。それぞれのシートは独立し、個々の支店の業績を報告する。</p></li>
<li><p><cite>Combined</cite> シートでセル K7 をクリックする。<cite>Branch1</cite> のタブをクリックし、
<kbd class="kbd docutils literal notranslate">+</kbd> を押し、<cite>Branch2</cite> と <cite>Branch3</cite> のシートでも同じことを繰り返し、
<kbd class="kbd docutils literal notranslate">Enter</kbd> を押す。これで、セル K7 に三支店の売上高を加算する数式ができた。</p></li>
<li><p>計算式をコピーし、K7:N17 の範囲をハイライトして、Paste Special
<a class="footnote-reference brackets" href="#calc08-footnote-1" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> を実行する。ダイアログの <span class="guilabel">Paste</span> 区画にある
<span class="guilabel"><span class="accelerator">A</span>ll</span> と:guilabel:<cite>For&amp;mats</cite> をオフにし、その領域にある他のすべてのオプションをオンにして <span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。</p></li>
<li><p><span class="guilabel"><span class="accelerator">Y</span>es</span> ボタン を押す。これで、元のシートで設定した書式を維持したまま、各セルに数式がコピーされた。この例では書式設定されていない行のゼロを削除して、シートを整頓する必要がある。</p></li>
</ol>
<p><span class="guilabel">Function Wizard</span> を使用してリンクすることもできる。使い方は
<a class="reference internal" href="#calc08-anchor-wizard"><span class="std std-ref">Using the Function Wizard</span></a> を見ろ。</p>
</section>
</section>
<section id="understanding-functions">
<h2><a class="toc-backref" href="#id28" role="doc-backlink">Understanding functions</a><a class="headerlink" href="#understanding-functions" title="Link to this heading">¶</a></h2>
<p>Calc にはデータの分析や参照に役立つ関数が 500 以上用意されている。これらの関数の多くは数値を扱うものだが、日付や時刻、テキストを扱うものもある。関数は、二つの数値を足し合わせたり、数値の一覧の平均を求めるような単純なものから、標本の標準偏差や数値の双曲正接を計算するような複雑なものまである。</p>
<p>通常、関数の名前はその関数が何をするのかを省略したものだ。例えば、<cite>FV</cite> 関数は投資の将来価値を示し、<cite>BIN2HEX</cite> は二進数を 16 進数に変換する。Calc では関数は大文字、小文字、または混合で入力することができる。</p>
<p>基本的な関数のいくつかは演算子と多少似ている。演算子 <code class="docutils literal notranslate"><span class="pre">+</span></code> に対する関数 <cite>SUM</cite>
や、演算子 <code class="docutils literal notranslate"><span class="pre">*</span></code> に対する関数 <cite>PRODUCT</cite> といったものだ。</p>
<p>各関数には計算に使われるいくつかの引数がある。これらの引数にはそれぞれ名前があったりなかったりする。場合によっては、引数には定義済み選択肢があり、それを理解するために <span class="guilabel">Function Wizard</span> や <span class="guilabel">Functions</span> 甲板 のテキスト、あるいは Help を参照する必要がある。しかし、多くの場合、引数は手動で入力する値か、スプレッドシートの升目、升目範囲にすでに入力されている値だ。Calc では他の升目から値を入力するには、その升目の名前や範囲を入力するか、マウスで升目を選択する。升目の値が変更されると、関数の結果が自動的に更新される。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>利用可能な各関数の詳細については次の Wiki ページを見ろ。</p>
<p><a class="reference external" href="https://wiki.documentfoundation.org/Documentation/Calc_Functions">Documentation/Calc Functions - The Document Foundation Wiki</a></p>
<p>これらの Wiki ページは利用可能な文書に最近追加されたものであり、継続的に改善されている。</p>
</div>
<section id="compatibility-with-other-spreadsheet-applications">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Compatibility with other spreadsheet applications</a><a class="headerlink" href="#compatibility-with-other-spreadsheet-applications" title="Link to this heading">¶</a></h3>
<p>Calc が MS Excel のスプレッドシートを開くと、特定の関数で発生する非互換性を回避する措置が自動的に働く。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>この節は真面目に読んでいない。</p>
</div>
</section>
<section id="understanding-the-structure-of-functions">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">Understanding the structure of functions</a><a class="headerlink" href="#understanding-the-structure-of-functions" title="Link to this heading">¶</a></h3>
<p>関数呼び出しは等号、関数名、引数リストから構成される。</p>
<hr class="docutils" />
<p>すべての関数は似たような構造を持っている。関数の入力に適切なツールを使えば、この構造を学ぶことから逃れられるが、それでもトラブルシューティングのために知っておく価値はある。</p>
<p>典型的な例として、入力された検索条件に合致する升目を見つける関数の構造は次のようになる：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">=</span><span class="n">DCOUNT</span><span class="p">(</span><span class="n">Database</span><span class="p">,</span> <span class="n">Database</span> <span class="n">field</span><span class="p">,</span> <span class="n">Search</span> <span class="n">criteria</span><span class="p">)</span>
</pre></div>
</div>
<p>関数は単体では存在できず、常に数式の一部でなければならない。したがって、関数が数式全体を表している場合でも、数式の最初に <code class="docutils literal notranslate"><span class="pre">=</span></code> がなければならない。関数が数式のどこにあるかにかかわらず、関数は上の例の <cite>DCOUNT</cite> のように、その名前で始まる。す。関数名の後には引数が続く。引数は、特にオプションと記載されていない限り、すべて必須だ。</p>
<p>引数は括弧内に追加され、カンマで区切られる。Calc 関数は最大 255 個の引数を取ることができる。引数には数値や一つの升目だけでなく、数個から数百個の升目を含む配列や升目範囲も指定できる。</p>
<p>関数の性質に応じて、表7のように引数を入力することができる。</p>
<table class="docutils align-left" id="id8">
<caption><span class="caption-text">title</span><a class="headerlink" href="#id8" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>実引数</p></th>
<th class="head"><p>意味</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>“text data”</p></td>
<td><p>引用符は、テキストまたは文字列データが入力されていることを示す。</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>数として 9 が入力されている。</p></td>
</tr>
<tr class="row-even"><td><p>“9”</p></td>
<td><p>数字の 9 がテキストとして入力されている。</p></td>
</tr>
<tr class="row-odd"><td><p>A1</p></td>
<td><p>セル A1 のアドレスが入力される。</p></td>
</tr>
<tr class="row-even"><td><p>B2:D9</p></td>
<td><p>セル範囲を入力している。</p></td>
</tr>
</tbody>
</table>
</section>
<section id="nested-functions">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">Nested functions</a><a class="headerlink" href="#nested-functions" title="Link to this heading">¶</a></h3>
<p>関数は他の関数の中で引数として使うこともできる。これを入れ子関数と呼ぶ。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=SUM(2,PRODUCT(5,7))
</pre></div>
</div>
<p>入れ子関数で何ができるかを知るために、自己学習モジュールを設計していると想像するがいい。モジュール中、学生は小テストを三つ行い、結果を升目 A1, A2, A3 に入力しする。A4 では <code class="docutils literal notranslate"><span class="pre">=AVERAGE(A1:A3)</span></code> という式で小テストの結果を平均することから始まる入れ子式を作成できる。この数式は <cite>IF</cite> 関数を使用して、小テストの平均評点に依存するフィードバックを学生に与える：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=IF(AVERAGE(A1:A3)&gt;85, &quot;Congratulations! You are ready to advance to the next module&quot;, &quot;Failed. Please review the material again. If necessary, contact your instructor for help&quot;)
</pre></div>
</div>
<p>平均点次第で合格か不合格のメッセージが学生に送られる。</p>
<p>平均の入れ子式には等号が必要ないことに注意。どちらの式も、式の最初にある等号だけで十分なのだ。</p>
<p>スプレッドシートに慣れていないうちは関数をスクリプト言語として考えるのがいちばんだ。ここでは簡単な例を挙げたが、関数を入れ子にすることで、Calc の数式はすぐに複雑になる。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calc は、数式を入力するときに便利な記憶補助として、升目の横にあるツールチップに表示される数式の構文を保持する。</p>
</div>
</section>
<section id="using-the-functions-deck">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Using the Functions deck</a><a class="headerlink" href="#using-the-functions-deck" title="Link to this heading">¶</a></h3>
<p>より確実な方法は Sidebar <span class="guilabel">Functions</span> 甲板 を使用することだ。この甲板は
<span class="menuselection"><span class="accelerator">V</span>iew‣Function List</span> を選択するか、Sidebar がすでに表示されている場合は右にあるタブパネルの <span class="guilabel">Functions</span> 図像をクリックすることで表示される。</p>
<p><span class="guilabel">Functions</span> 甲板 には各関数とその引数の簡単な記述がある。関数を強調表示し、小窓の下部を見ると記述が表示される。必要であれば、マウスポインターを一覧と記述の間の区切りに合わせろ。ポインターが両方向矢印になったらそれを上にドラッグして記述の紙幅を広げろ。関数名をダブルクリックすると、関数の各引数の仮置場とともに、その関数が現在の升目に入る。</p>
<p><span class="guilabel">Functions</span> 甲板 の使用は手入力とほぼ同じ速さで、使いたい数式を覚えておく必要がないという利点がある。エラーの可能性も低くなるはずだ。もう一つは、最後に使用した数式を表示する機能だろう。</p>
</section>
<section id="using-the-function-wizard">
<span id="calc08-anchor-wizard"></span><h3><a class="toc-backref" href="#id33" role="doc-backlink">Using the Function Wizard</a><a class="headerlink" href="#using-the-function-wizard" title="Link to this heading">¶</a></h3>
<p>関数入力は Sidebar よりも <span class="guilabel">Function Wizard</span> のほうが使用頻度が高いらしい。</p>
<p>最もよく使われる入力方法は <span class="guilabel">Function Wizard</span> だ。これを開くには次のいずれかを行う：</p>
<ul class="simple">
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">I</span>nsert‣<span class="accelerator">F</span>unction…</span> を選択</p></li>
<li><p>Formula バー の <span class="guilabel">Function Wizard</span> 図像をクリック</p></li>
<li><p>キーバインド <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F2</kbd></p></li>
</ul>
<p><span class="guilabel">Function Wizard</span> は <span class="guilabel">Functions</span> 甲板 と同じヘルプ機能を備えているが、完成した関数の結果や、その関数の一部である大きな数式の結果を見ることができるフィールドを追加する。</p>
<p>リストを短くするために関数の区分を選択し、名前の付いた関数をスクロールダウンして、必要な関数をダブルクリックして選択しろ。<span class="guilabel">Function Wizard</span> で利用可能な区分と、各区分で利用可能な関数の数は表8だ。</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>table 8</p>
</div>
<p>関数を選択すると、その説明がダイアログの右側に表示される。オプションとして
<span class="guilabel"><span class="accelerator">S</span>earch</span> 欄関数名を入力することができ、文字が打ち込まれるたびに検索結果が絞り込まれる。</p>
<p>テキストボックスに手動でデータを入力できるか、<span class="guilabel">Shrink</span> ボタンを押して
<span class="guilabel">Function Wizard</span> を縮小し、シートから升目を選択できるようになる領域が
<span class="guilabel">Function Wizard</span> の右側に表示されるようになる。</p>
<p>升目を選択するには、それを直接クリックするか、マウスの左ボタンを押したままドラッグして必要な領域を選択する。</p>
<p>領域が選択されたら <span class="guilabel">Expand</span> ボタンを押して再びウィザードに戻る。</p>
<p>複数の引数が必要な場合は、次のテキストボックスをクリックし、次の升目、升目範囲について選択工程を繰り返す。この作業を必要なだけ繰り返せ。ウィザードは <cite>SUM</cite> 関数の範囲または引数を 255 個まで受け付ける。</p>
<p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押して関数を受け入れ、セルに追加し、結果を得る。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>一覧で関数をダブルクリックして選択し、気が変わって別の関数を再度ダブルクリックして選択した場合、二番目に選択した数式が <span class="guilabel">Fo<span class="accelerator">r</span>mula</span> 欄の一番目に選択した数式に追加される。<span class="guilabel">Fo<span class="accelerator">r</span>mula</span> 欄を消去してから、関数をダブルクリックして追加する必要がある。</p>
<p>この付加機能により <span class="guilabel">Fo<span class="accelerator">r</span>mula</span> 欄で数式を積み上げて複雑な数式を作成することができる。</p>
</div>
<p>また、Structure タブを選択すると、数式の部位を木表示することができる。
<span class="guilabel">Functions</span> 甲板 の主な利点は、各引数がそれぞれのフィールドに入力され、管理が容易になることだ。この信頼性の代償として入力が遅くなるが、スプレッドシートを作成する際には、一般的に高速度よりも精度の方が重要だ。</p>
<p><span class="guilabel">Function Wizard</span> の構造ビューは、とても長く、入れ子である複雑な数式のデバッグや修正に重要だ。このビューでは数式が解析され、各数式部品がより単純な関数呼び出しまたは算術演算によって計算され、計算規則に従って結合される。計算式の解析された各要素を視覚化し、中間結果が正しいかどうかを、間違いが見つかるまで検査することができる。</p>
<p>関数は <span class="guilabel">Input</span> 行 に入力することができる。<span class="guilabel">Input</span> 行 に関数を入力した後
<kbd class="kbd docutils literal notranslate">Enter</kbd> を押すか、Formula バー の <span class="guilabel">✓</span> を押すと升目に関数が追加され、その結果が表示される。</p>
<p>値ではなく数式がセルに表示される場合は <span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Calc‣View</span> ページ の
<span class="guilabel"><span class="accelerator">F</span>ormulas</span> がオンになっていやしないかを確認しろ。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Menu バー の <span class="menuselection"><span class="accelerator">V</span>iew‣Sho<span class="accelerator">w</span> Formula</span> やキーバインド <kbd class="kbd docutils literal notranslate">Ctrl</kbd> +
<kbd class="kbd docutils literal notranslate">&#64;</kbd> でも数式のオンオフが切り替えられる。</p>
</div>
</section>
<section id="array-formulas">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Array formulas</a><a class="headerlink" href="#array-formulas" title="Link to this heading">¶</a></h3>
<section id="what-is-an-array-formula">
<h4><a class="toc-backref" href="#id35" role="doc-backlink">What is an array formula?</a><a class="headerlink" href="#what-is-an-array-formula" title="Link to this heading">¶</a></h4>
<p>配列数式を理解しろ。配列式は一般に複数の値を同時に扱う。</p>
<p>複数の値を処理できるだけでなく、複数の値を返すこともある。結果も配列になる。</p>
<p>Calc が数式を更新すると、影響を受ける各升目が読み込まれ、その数式が再計算される。同じ数式（式は計算するデータしか変更しない）を持つ升目が一列に千個あるとすると、解釈と実行に千個の同一の数式が必要になる。</p>
<p>配列式は計算式を一度評価し、配列の規模と同じ回数だけ計算を実行するため、各升目の計算式を解釈する時間を節約できる。計算式自体の記憶領域節約にもなる。</p>
<p>仮に A1:C5 範囲にある値を十倍して別の範囲 E1:G5 に出力したいとする。配列を利用するならば次のようになる：</p>
<ol class="arabic simple">
<li><p>E1:G5 を選択する</p></li>
<li><p>数式 <code class="docutils literal notranslate"><span class="pre">=10*A1:C5</span></code> を入力し、キーバインド <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">Enter</kbd> でこの入力を確定する。</p></li>
</ol>
<p>その結果 3x5 の配列ができる。</p>
</section>
<section id="when-do-you-use-array-formulas">
<h4><a class="toc-backref" href="#id36" role="doc-backlink">When do you use array formulas?</a><a class="headerlink" href="#when-do-you-use-array-formulas" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>異なる値を使って計算を繰り返す必要がある場合は、配列式を使え。</p></li>
<li><p>配列式を追加するには、配列範囲全体を選択してから、配列式に必要な変更を加える。</p></li>
<li><p>配列二つを乗算する <cite>MMULT</cite> 関数など、配列のためのさまざまな数学関数がある。</p></li>
</ul>
</section>
<section id="creating-array-formulas">
<h4><a class="toc-backref" href="#id37" role="doc-backlink">Creating array formulas</a><a class="headerlink" href="#creating-array-formulas" title="Link to this heading">¶</a></h4>
<p><span class="guilabel">Function Wizard</span> を使用して配列式を作成する場合は、結果が配列で返されるように
<span class="guilabel"><span class="accelerator">A</span>rray</span> を毎回オンにしろ。</p>
<p>配列式をセルに直接入力することもできる。その結果、自動的にセルの配列が作成される。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>配列数式は中括弧の中に表示される。中括弧を手動で入力して配列数式を作成することは不可能だ。</p>
<p>結果配列の升目は変更に対して自動的に保護される。しかし、配列の升目範囲全体を選択することで、配列式を編集またはコピーすることが可能だ。</p>
</div>
</section>
<section id="implicit-intersection-of-array-formulas">
<h4><a class="toc-backref" href="#id38" role="doc-backlink">Implicit intersection of array formulas</a><a class="headerlink" href="#implicit-intersection-of-array-formulas" title="Link to this heading">¶</a></h4>
<p>引数などの参照範囲が配列式を示す「通常の」数式を作成することもできる。この式は配列式の「暗黙の交差」としても知られている。結果は、参照範囲と数式が見つかった行または列の交点から得られる。交点がない場合、または交点の範囲が複数の行または列にまたがる場合は、#VALUE! エラーメッセージが現れる。次の例でこの概念を説明する。</p>
<p>A1:C3 に適当に数値を入れておく。次の手順を実施するとする：</p>
<ol class="arabic">
<li><p>升目 D1 に配列式 <code class="docutils literal notranslate"><span class="pre">{=A1:A3</span> <span class="pre">+</span> <span class="pre">100}</span></code> を入れる。D1:D3 のそれぞれに期待する和が出力される。</p></li>
<li><p>升目 D2 に非配列式 <code class="docutils literal notranslate"><span class="pre">=A1:A3</span> <span class="pre">+</span> <span class="pre">100</span></code> を入れる。D1 と D3 は空のままで、D2 には値 195 が入っていることを確認する。これが配列数式の暗黙の交差だ。入力された数式は内部的には値を三つ返すが、表示されるのはそのうちの二つ目だけだ。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>この入力は不可能。前述の仕様により D2 は保護されている。</p>
</div>
</li>
<li><p>升目 D4 に非配列式 <code class="docutils literal notranslate"><span class="pre">=A1:A3</span> <span class="pre">+</span> <span class="pre">100</span></code> を入れる。すると D4 はエラーを表示する。これは行 4 が数式の範囲 A1:A3 から外れているからだ。</p></li>
</ol>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>この節は要旨がよくわからない。</p>
</div>
</section>
</section>
</section>
<section id="strategies-for-creating-formulas-and-functions">
<h2><a class="toc-backref" href="#id39" role="doc-backlink">Strategies for creating formulas and functions</a><a class="headerlink" href="#strategies-for-creating-formulas-and-functions" title="Link to this heading">¶</a></h2>
<p>スプレッドシートを自分以外が使用する場合は特に、どこでどのような入力が必要であるかを容易に理解するように示せ。表計算シートの目的、入出力仕様は最初のシートに記載することが多い。</p>
<p>論理式や条件付き書式を使用してエラーを捕捉するのは良い考えだ。</p>
<section id="place-a-unique-formula-in-each-cell">
<h3><a class="toc-backref" href="#id40" role="doc-backlink">Place a unique formula in each cell</a><a class="headerlink" href="#place-a-unique-formula-in-each-cell" title="Link to this heading">¶</a></h3>
<p>使い捨てスプレッドシートであれば、適切なセルそれぞれに一意となる数式を配置しろ。</p>
</section>
<section id="break-formulas-into-parts-and-combine-the-parts">
<h3><a class="toc-backref" href="#id41" role="doc-backlink">Break formulas into parts and combine the parts</a><a class="headerlink" href="#break-formulas-into-parts-and-combine-the-parts" title="Link to this heading">¶</a></h3>
<p>分割統治法に則れ。長い数式を小さな部分に分解し、それらを組み立てるように全体を構成しろ。</p>
</section>
<section id="speeding-up-calculations">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">Speeding up calculations</a><a class="headerlink" href="#speeding-up-calculations" title="Link to this heading">¶</a></h3>
<p>数千から数十万の行と数列を持つシートは財務部や研究所で頻繁に見られる。このような生データセットに対して行われる計算は時間がかかり、数分から数時間、場合によっては数日に及ぶこともある。</p>
<p>よくある間違いは、升目ごとに数式を入れ、何千もの数式の解釈と計算を行うことだ。ここでは計算高速化に与する事項を見ていく。</p>
<section id="use-array-formulas-on-massive-data">
<h4><a class="toc-backref" href="#id43" role="doc-backlink">Use array formulas on massive data</a><a class="headerlink" href="#use-array-formulas-on-massive-data" title="Link to this heading">¶</a></h4>
<p>配列式は一つの式が大量データに適用される。大きなデータ集合の場合、計算量を大幅に削減する。</p>
</section>
<section id="use-consolidation-functions">
<h4><a class="toc-backref" href="#id44" role="doc-backlink">Use consolidation functions</a><a class="headerlink" href="#use-consolidation-functions" title="Link to this heading">¶</a></h4>
<p>連結関数はデータセットに対して計算を実行する。<cite>SUM</cite>, <cite>SUMIF</cite>, <cite>SUMIFS</cite>,
<cite>SUMPRODUCT</cite> が連結関数の例だ。例えば、べらぼうに長い部品表があり、そこに数量を単価で乗算し、合計して原価を計算する必要がある場合、部品表の各登録項目に数式を適用して合計する代わりに、</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>SUMPRODUCT(quantity, unitprice)
</pre></div>
</div>
<p>という数式を使用することができる。<cite>SUMPRODUCT</cite> は数量データセットの各升目に単価の対応する升目を乗算し、製品すべてを合計する。</p>
<p>同じような状況は、元のデータセットの部分集合を合計しなければならないときにも起こる。 そのような場合は、各登録項目にテストを適用して合計の一部とする必要がある。例えば、値が厳密に正の場合だ。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>SUMIF(data_to_test; &quot;&gt;0&quot;; data_to_sum)
</pre></div>
</div>
<p>を使用する。ここで、<code class="docutils literal notranslate"><span class="pre">data_to_test</span></code> は正の値をテストするデータセット、
<code class="docutils literal notranslate"><span class="pre">data_to_sum</span></code> はテストに応じて値を合計する列、<code class="docutils literal notranslate"><span class="pre">&quot;&gt;0&quot;</span></code> はテストそのものだ。</p>
<p>その他の連結関数には <cite>AVERAGEIF</cite>, <cite>COUNTIF</cite>, <cite>MINIFS</cite>, <cite>MAXIFS</cite> などがある。</p>
</section>
</section>
<section id="use-macros-to-create-functions">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">Use macros to create functions</a><a class="headerlink" href="#use-macros-to-create-functions" title="Link to this heading">¶</a></h3>
<p>独自の関数やマクロを作成するという戦略もある。末端利用者によるスプレッドシートの使用を大幅に簡素化し、数式を単純に保つことでエラーを回避できる可能性が高い場合にこの方法論が採用される。また、修正や更新を一元管理することで、管理も容易になる。</p>
<p>マクロの使用については <a class="reference internal" href="calc13.html"><span class="doc">Chapter 13, Macros</span></a> で説明する。</p>
<p>マクロや独自関数を多用することの危険性は、スプレッドシートの基礎となる原則が、元の作成者以外の使用者には、時には作成者にも、見えづらくなってしまうことだ。</p>
</section>
<section id="multi-threading">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">Multi-threading</a><a class="headerlink" href="#multi-threading" title="Link to this heading">¶</a></h3>
<p>現代の計算機の多くは複数コア処理器を搭載し、複数スレッドを搭載している。コアは
CPU 内の物理的なハードウェア部品だ。スレッドは CPU の仕事量と仕事を効率的に管理するための仮想部品だ。CPU は一度に複数スレッドとやりとりすることができ、複数スレッドによって CPU はより効率的になり、全体的な能率が向上する。</p>
<p>Calc は複数スレッドを支援しており、使用中の計算機で利用可能な並列処理をスプレッドシートで利用る。この機能は <span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Calc‣Calculate</span> ページ の <span class="guilabel">Enable
multi-threaded calculation</span> で制御可能だ。これをオフにすることは勧められない。</p>
<p>Calc はスプレッドシートで並行作業が有効な箇所を自動的に特定し、それに応じて処理を行う。一般的に、スレッドが使用されるのは、数式グループに使用され、列内の隣接するセルが同じ数式を使用するが、相対的升目アドレス割当のために結果が異なる場合だ。最適化が列ベースであるため、行ベースのレイアウトでは効率が悪くなる可能性がある。</p>
</section>
</section>
<section id="finding-and-fixing-errors">
<h2><a class="toc-backref" href="#id47" role="doc-backlink">Finding and fixing errors</a><a class="headerlink" href="#finding-and-fixing-errors" title="Link to this heading">¶</a></h2>
<p>数式とその数式が参照しているセルを調べるため、エラーメッセージ、入力の色分け、検出各機能が用意されている。</p>
<section id="error-messages">
<h3><a class="toc-backref" href="#id48" role="doc-backlink">Error messages</a><a class="headerlink" href="#error-messages" title="Link to this heading">¶</a></h3>
<p>数式のエラーメッセージは、通常 501 から 540 までの数、あるいは <code class="docutils literal notranslate"><span class="pre">#NAME?</span></code> エラーメッセージの場合はセルに表示され、エラーの簡単な説明がステータスバーの右側に示される。</p>
<p>ほとんどのエラーメッセージは、数式の入力方法に問題があることを示しているが、いく
Calc またはその現在の設定の制限にぶつかっていることを示すものもある。</p>
<p>エラーメッセージは間違いを正すための貴重な手がかりとなる。付録 B および Help
で、エラーコードを検索すると、詳細な説明を見つけることができる。最も一般的なものを表 9 に示す。</p>
<table class="docutils align-left" id="id9">
<caption><span class="caption-text">一般的なエラーメッセージ</span><a class="headerlink" href="#id9" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>コード</p></th>
<th class="head"><p>意味</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>#NAME?</p></td>
<td><p>Err:525. 引数に有効な参照がない。</p></td>
</tr>
<tr class="row-odd"><td><p>#REF!</p></td>
<td><p>Err:524. 参照されている升目に対する列、行、シートのいずれかが失われている。</p></td>
</tr>
<tr class="row-even"><td><p>#VALUE!</p></td>
<td><p>Err:519. 引数の一つの値が要求される型でない。例えば、値の周囲に二重引用符がない場合など。また、使用されている升目や範囲の書式が間違っている場合もある。</p></td>
</tr>
<tr class="row-odd"><td><p>#DIV/0!</p></td>
<td><p>Err:532. ゼロによる除算。</p></td>
</tr>
<tr class="row-even"><td><p>#NUM!</p></td>
<td><p>Err:503. 計算の結果、定義された値域をオーバーフローする。</p></td>
</tr>
<tr class="row-odd"><td><p>509</p></td>
<td><p>等号などの演算子が数式にない。</p></td>
</tr>
<tr class="row-even"><td><p>510</p></td>
<td><p>数式に変数がない。</p></td>
</tr>
</tbody>
</table>
</section>
<section id="examples-of-common-errors">
<h3><a class="toc-backref" href="#id49" role="doc-backlink">Examples of common errors</a><a class="headerlink" href="#examples-of-common-errors" title="Link to this heading">¶</a></h3>
<section id="div-0-division-by-zero">
<h4><a class="toc-backref" href="#id50" role="doc-backlink">#DIV/0! division by zero</a><a class="headerlink" href="#div-0-division-by-zero" title="Link to this heading">¶</a></h4>
<p>このエラーは、数値をゼロまたは空白のセルで割った結果生じる。この種の問題を避ける簡単な方法がある：</p>
<p>ゼロまたは空白のセルが表示されている場合は、条件関数を使用する。例えば、関数
<code class="docutils literal notranslate"><span class="pre">IF</span></code> を使用して <code class="docutils literal notranslate"><span class="pre">=IF(C3&gt;0,</span> <span class="pre">B3/C3,</span> <span class="pre">&quot;No</span> <span class="pre">Report&quot;)</span></code> のように処理する。</p>
</section>
<section id="value-no-result-and-ref-incorrect-references">
<h4><a class="toc-backref" href="#id51" role="doc-backlink">#VALUE! no result and #REF! incorrect references</a><a class="headerlink" href="#value-no-result-and-ref-incorrect-references" title="Link to this heading">¶</a></h4>
<p>エラー <code class="docutils literal notranslate"><span class="pre">#VALUE!</span></code> は升目に正しくない値の型が含まれている場合によく起こるエラーだ。</p>
<p>エラー <code class="docutils literal notranslate"><span class="pre">REF!</span></code> は参照の欠落が原因だ。数式が削除されたシートを参照しているなどの場合がある。</p>
</section>
</section>
<section id="color-coding-for-input">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">Color coding for input</a><a class="headerlink" href="#color-coding-for-input" title="Link to this heading">¶</a></h3>
<p>入力の色分けというのは、数式中の升目参照、範囲参照、関数呼び出しの各引数の文字列色のことを指す。</p>
<p>Calc では参照される升目の輪郭線に八色を使用する。最初は青で始まり、相異なる七色が続き、再び青から順番に循環する。</p>
<section id="value-highlighting">
<h4><a class="toc-backref" href="#id53" role="doc-backlink">Value highlighting</a><a class="headerlink" href="#value-highlighting" title="Link to this heading">¶</a></h4>
<p>出力にも色分けがあり、字の並びとしては同一でも、型が異なる場合（例：数値とテキスト）を見分けるときに有用だ。</p>
<p><span class="menuselection"><span class="accelerator">V</span>iew‣View <span class="accelerator">H</span>ighlighting</span> (<kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F8</kbd>) をオンにすると、中身の文字に異なる色を割り当てることで、テキストと数値のデータ型を区別する。テキストは黒文字、数値は青文字だ。<a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> も参照。</p>
</section>
</section>
<section id="the-detective">
<h3><a class="toc-backref" href="#id54" role="doc-backlink">The Detective</a><a class="headerlink" href="#the-detective" title="Link to this heading">¶</a></h3>
<p>長いか複雑なスプレッドシートでは、色分けがあまり役に立たなくなる。</p>
<p>升目参照の連鎖をたどるには <span class="menuselection"><span class="accelerator">T</span>ools‣<span class="accelerator">D</span>etective‣</span> 各種コマンドを実行する。これで矢印がシート内に描かれる。</p>
<ul class="simple">
<li><p>対象セルにカーソルを置き <kbd class="kbd docutils literal notranslate">Shift</kbd> + (<kbd class="kbd docutils literal notranslate">F9</kbd> or <kbd class="kbd docutils literal notranslate">F5</kbd>) を押すのが早い</p></li>
<li><p>矢印の向きが気に入らない</p></li>
<li><p>矢印を消去するには <span class="menuselection"><span class="accelerator">T</span>ools‣<span class="accelerator">D</span>etective‣Remove <span class="accelerator">A</span>ll Traces</span>
コマンドを実行</p></li>
</ul>
<p><span class="menuselection"><span class="accelerator">T</span>ools‣<span class="accelerator">D</span>etective‣Trace <span class="accelerator">E</span>rror</span> の使い方を習得しろ。</p>
</section>
</section>
<section id="examples-of-functions">
<h2><a class="toc-backref" href="#id55" role="doc-backlink">Examples of functions</a><a class="headerlink" href="#examples-of-functions" title="Link to this heading">¶</a></h2>
<p>初心者は算術、統計に区分されている関数から学べ。</p>
<section id="basic-arithmetic-and-statistics">
<h3><a class="toc-backref" href="#id56" role="doc-backlink">Basic arithmetic and statistics</a><a class="headerlink" href="#basic-arithmetic-and-statistics" title="Link to this heading">¶</a></h3>
<p>最も基本的な関数は、基本的な算術計算やセル範囲の数値を評価する数式を作る。</p>
<section id="basic-arithmetic">
<h4><a class="toc-backref" href="#id57" role="doc-backlink">Basic arithmetic</a><a class="headerlink" href="#basic-arithmetic" title="Link to this heading">¶</a></h4>
<p>算術演算子が用意されているのに、関数 <code class="docutils literal notranslate"><span class="pre">SUM</span></code>, <code class="docutils literal notranslate"><span class="pre">PRODUCT</span></code> などを敢えて使う理由としては、オペランドがセル範囲にわたる場合などが考えられる。<code class="docutils literal notranslate"><span class="pre">=A1+A2+A3+A4+A5</span></code> よりも <code class="docutils literal notranslate"><span class="pre">=SUM(A1:A5)</span></code> のほうが明らかに良い。</p>
</section>
<section id="simple-statistics">
<h4><a class="toc-backref" href="#id58" role="doc-backlink">Simple statistics</a><a class="headerlink" href="#simple-statistics" title="Link to this heading">¶</a></h4>
<p>表計算関数のもう一つの一般的な使い方は、クラスでの一連のテストの点数や、企業の四半期ごとの利益の概要など、リストから有用な情報を引き出すことだ。</p>
<ul class="simple">
<li><p><cite>COUNT</cite> は指定されたセル範囲内の記載項目の総数を返す。</p></li>
<li><p><cite>MIN</cite>, <cite>MAX</cite> はセル範囲か、個別の入力された一連のセルから最小または最大の記載項目を返す。</p>
<ul>
<li><p><cite>MINA</cite>, <cite>MAXA</cite> は上記関数の変種であって、数値でない値をゼロとして扱う。</p></li>
<li><p>他にも、名前が <cite>A</cite> で終わる関数は、値がテキストである場合にこのような措置を講じる。</p></li>
</ul>
</li>
<li><p><cite>SMALL</cite>, <cite>LARGE</cite> は n も与えて第 n 位の値を返す。</p></li>
<li><p><cite>AVERAGE</cite> は算術平均を返す。</p></li>
<li><p><cite>MEDIAN</cite> は中央値を返す。</p></li>
<li><p><cite>MODE</cite> は最頻値を返す。</p></li>
<li><p><cite>QUARTILE</cite> は入力配列から指定四分位数の項目を返す。最小値、最大値は 0, 4 をそれぞれ指示する。</p></li>
<li><p><cite>RANK</cite> は値の配列における順位を返す。昇順にも降順にも列挙させることが可能。</p></li>
</ul>
<p>これらの関数には機能が重複するものがある。例えば、<cite>MIN</cite> と <cite>MAX</cite> は両方とも
<cite>QUARTILE</cite> でカバーされている。他の事例では、カスタムソートや絞り込みでほとんど同じ結果が得られることがある。どちらを使うかは好みや要望次第だ。<cite>MIN</cite> と <cite>MAX</cite>
は覚えやすいから使いたいという人もいるし、<cite>QUARTILE</cite> は汎用性が高いから使いたいという人もいる。</p>
</section>
<section id="using-these-functions">
<h4><a class="toc-backref" href="#id59" role="doc-backlink">Using these functions</a><a class="headerlink" href="#using-these-functions" title="Link to this heading">¶</a></h4>
<p>一般的には、関数は絞り込みや並び替えよりも簡単に調整でき、柔軟だ。</p>
<p>時には、便利な空白の升目に数式を一時的に入力し、入力が終わったら削除したいと思うかもしれない。しかし、常に同じ関数を使用している場合は、雛形を作成し、使用するすべての関数を入力し、その左側の升目をラベルとして使用するのがよい。いったん雛形を作成すれば、登録項目の変更に応じて、自動的かつ即興的に、または <kbd class="kbd docutils literal notranslate">F9</kbd> を押して選択したすべての升目を更新することで、各計算式を簡単に更新することが可能だ。</p>
</section>
</section>
<section id="rounding-off-numbers">
<h3><a class="toc-backref" href="#id60" role="doc-backlink">Rounding off numbers</a><a class="headerlink" href="#rounding-off-numbers" title="Link to this heading">¶</a></h3>
<p>Calc には統計や数学目的で数字を丸めるさまざまな方法がある。Help を見ろ。</p>
<p><code class="docutils literal notranslate"><span class="pre">ROUND</span></code> 関数は呼び出し有無の比較を検討すると安心だ。例えば、</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">=ROUND((SUM(A1,A2))</span></code> をセル A3 に、</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=ROUND(A3)</span></code> をセル A4 に</p></li>
</ul>
<p>置き、それぞれの関数をラベル付けするというやり方もある。</p>
</section>
</section>
<section id="volatile-non-volatile-functions">
<h2><a class="toc-backref" href="#id61" role="doc-backlink">Volatile / non-volatile functions</a><a class="headerlink" href="#volatile-non-volatile-functions" title="Link to this heading">¶</a></h2>
<blockquote>
<div><p>Functions that are <em>always</em> recalculated whenever a recalculation occurs are
termed <em class="dfn">volatile</em> functions.</p>
</div></blockquote>
<p>揮発性関数の動作の一部を理解するために、空のスプレッドシートを作成し、升目 A1 に
<code class="docutils literal notranslate"><span class="pre">=RAND()</span></code> という数式を入力した簡単な例を考えてみよう。<cite>RAND</cite> は揮発性関数の一つだ。升目 A1 に 0 から 1 の間の乱数が生じる。その後、升目 B2 に任意の値を入力して <kbd class="kbd docutils literal notranslate">Enter</kbd> を押すと、A1 に表示されていた値が更新され、別の乱数が表示されることに気づく。使用者が A1 の数式を変更していないにもかかわらず、また更新された B2 が
A1 と連動していないにもかかわらず、Calc は A1 の乱数を再計算する。まとめると、
<cite>RAND</cite> 関数は、以下のいずれかのときに新しい値を生成する：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣Ca<span class="accelerator">l</span>culate‣<span class="accelerator">R</span>ecalculate</span> を選択</p></li>
<li><p><kbd class="kbd docutils literal notranslate">F9</kbd> を押す</p></li>
<li><p>任意の入力イベントで任意の升目が更新された</p></li>
</ul>
<p>揮発性関数を理解することは、特に大規模なスプレッドシートを作成する場合に重要だ。スプレッドシートを作成する際には、揮発性関数を適切に使用するように設計しろ。</p>
<p>例えば乱数生成関数やタイムスタンプ関数は揮発性だ。</p>
<p><cite>RAND</cite> 関数と <cite>RANDBETWEEN</cite> 関数に関しては、不揮発性の等価物である <cite>RAND.NV</cite> と
<cite>RANDBETWEEN.NV</cite> が用意されている。これらは関数の値をそれほど頻繁に更新する必要がない場合に便利だ。不揮発性関数は、関数を含む升目が選択されている場合を除き、新しい入力イベントで再計算されず、上記の操作のいずれによっても再計算されない。ファイルを開くときに再計算される。</p>
</section>
<section id="using-wildcards-and-regular-expressions-in-functions">
<h2><a class="toc-backref" href="#id62" role="doc-backlink">Using wildcards and regular expressions in functions</a><a class="headerlink" href="#using-wildcards-and-regular-expressions-in-functions" title="Link to this heading">¶</a></h2>
<p>関数には、その実引数に正規表現またはワイルドカードを使用可能であるものがある。</p>
<p>正規表現は、テキスト文字列を検索する最も強力な方法だ。例を含む正規表現の詳細については <a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> の当該節を見ろ。</p>
<p>MS Excel はこのような正規表現を扱っていない。Calc 文書を変換して提出するような状況では使用を避けろ。</p>
<p>正規表現引数に対応している関数例：</p>
<ul class="simple">
<li><p>名前が <cite>D</cite> から始まるデータベース関数</p></li>
<li><p>平均値、勘定関数、最大値、最小値、和を得る各関数</p></li>
<li><p>表探索関数</p></li>
<li><p>当然ながら検索・置換関数</p></li>
</ul>
<p><span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Calc‣Calculate</span> ページ に関連設定項目がある：</p>
<ul class="simple">
<li><p><span class="guilabel">Formula Wildcards</span> ではワイルドカードのみが有効になっている</p></li>
<li><p><span class="guilabel">General Calculate</span> 項目の一部が正規表現の関係する動作に影響する。</p></li>
</ul>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>チュートリアルのような記述があるが、割愛。</p>
</div>
</section>
<section id="advanced-functions">
<h2><a class="toc-backref" href="#id63" role="doc-backlink">Advanced functions</a><a class="headerlink" href="#advanced-functions" title="Link to this heading">¶</a></h2>
<p>Calc 文書はユーザー定義関数またはアドインによって機能拡張可能だ。</p>
<p>ユーザー定義関数は、マクロ (<a class="reference internal" href="calc13.html"><span class="doc">Chapter 13, Macros</span></a>) を使用するか、個別のアドインや拡張機能を記述することで設定可能。マクロは Basic, BeanShell, JavaScript, Python のいずれかで記述される。</p>
<hr class="docutils" />
<p class="rubric">章末注</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="calc08-footnote-1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> を見ろ。</p>
</aside>
</aside>
</section>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc07.html" title="Previous">Calc Guide Chapter 7, Printing, Exporting, Emailing, and Signing ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Calc Guide 読書ノート</a>
        </li>
        <li>
          <a href="calc09.html" title="Next">Calc Guide Chapter 9, Using Pivot Tables ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="../../index.html" title="読書ノート Home"><img src="../../_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>