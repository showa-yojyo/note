<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Calc Guide Chapter 9, Using Pivot Tables ノート &#8212; 読書ノート 1.6dev</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=c9b0a06a" />
    <script src="../../_static/documentation_options.js?v=4354bf25"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Calc Guide Chapter 10, Data Analysis ノート" href="calc10.html" />
    <link rel="prev" title="Calc Guide Chapter 8, Using Formulas and Functions ノート" href="calc08.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc08.html" title="Previous">Calc Guide Chapter 8, Using Formulas and Functions ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Calc Guide 読書ノート</a>
        </li>
        <li>
          <a href="calc10.html" title="Next">Calc Guide Chapter 10, Data Analysis ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="calc-guide-chapter-9-using-pivot-tables">
<h1>Calc Guide Chapter 9, Using Pivot Tables ノート<a class="headerlink" href="#calc-guide-chapter-9-using-pivot-tables" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">章見出し</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id4">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#database-preconditions" id="id5">Database preconditions</a></p></li>
<li><p><a class="reference internal" href="#data-sources" id="id6">Data sources</a></p>
<ul>
<li><p><a class="reference internal" href="#calc-spreadsheet" id="id7">Calc spreadsheet</a></p></li>
<li><p><a class="reference internal" href="#registered-data-source" id="id8">Registered data source</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-shortcuts" id="id9">Using shortcuts</a></p></li>
<li><p><a class="reference internal" href="#creating-a-pivot-table" id="id10">Creating a pivot table</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#the-pivot-table-layout-dialog" id="id11">The Pivot Table Layout dialog</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-layout" id="id12">Basic layout</a></p></li>
<li><p><a class="reference internal" href="#more-options" id="id13">More Options</a></p></li>
<li><p><a class="reference internal" href="#more-settings-for-the-fields-field-options" id="id14">More settings for the fields: Field options</a></p>
<ul>
<li><p><a class="reference internal" href="#options-for-data-fields" id="id15">Options for data fields</a></p></li>
<li><p><a class="reference internal" href="#options-for-row-and-column-fields" id="id16">Options for row and column fields</a></p></li>
<li><p><a class="reference internal" href="#options-for-filter-fields" id="id17">Options for filter fields</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#working-with-the-results-of-the-pivot-table" id="id18">Working with the results of the pivot table</a></p>
<ul>
<li><p><a class="reference internal" href="#changing-the-layout" id="id19">Changing the layout</a></p></li>
<li><p><a class="reference internal" href="#grouping-rows-or-columns-of-a-pivot-table" id="id20">Grouping rows or columns of a pivot table</a></p>
<ul>
<li><p><a class="reference internal" href="#grouping-of-categories-with-scalar-values" id="id21">Grouping of categories with scalar values</a></p></li>
<li><p><a class="reference internal" href="#grouping-of-categories-with-date-time-values" id="id22">Grouping of categories with date / time values</a></p></li>
<li><p><a class="reference internal" href="#grouping-without-automatic-creation-of-intervals" id="id23">Grouping without automatic creation of intervals</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sorting-the-result" id="id24">Sorting the result</a></p>
<ul>
<li><p><a class="reference internal" href="#select-sort-order-from-drop-down-menus-on-each-column-heading" id="id25">Select sort order from drop-down menus on each column heading</a></p></li>
<li><p><a class="reference internal" href="#sort-manually-by-using-drag-and-drop" id="id26">Sort manually by using drag and drop</a></p></li>
<li><p><a class="reference internal" href="#sort-automatically" id="id27">Sort automatically</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#drilling-showing-details" id="id28">Drilling (showing details)</a></p></li>
<li><p><a class="reference internal" href="#filtering" id="id29">Filtering</a></p></li>
<li><p><a class="reference internal" href="#updating-refreshing-changed-values" id="id30">Updating (refreshing) changed values</a></p></li>
<li><p><a class="reference internal" href="#cell-formatting" id="id31">Cell formatting</a></p></li>
<li><p><a class="reference internal" href="#deleting-a-pivot-table" id="id32">Deleting a pivot table</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-pivot-table-results-elsewhere" id="id33">Using pivot table results elsewhere</a></p>
<ul>
<li><p><a class="reference internal" href="#the-problem" id="id34">The problem</a></p></li>
<li><p><a class="reference internal" href="#the-solution-function-getpivotdata" id="id35">The solution: Function <cite>GETPIVOTDATA()</cite></a></p>
<ul>
<li><p><a class="reference internal" href="#syntax" id="id36">Syntax</a></p></li>
<li><p><a class="reference internal" href="#first-syntax-variation" id="id37">First syntax variation</a></p></li>
<li><p><a class="reference internal" href="#second-syntax-variation" id="id38">Second syntax variation</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-pivot-charts" id="id39">Using pivot charts</a></p>
<ul>
<li><p><a class="reference internal" href="#id3" id="id40">Introduction</a></p></li>
<li><p><a class="reference internal" href="#creating-a-pivot-chart" id="id41">Creating a pivot chart</a></p></li>
<li><p><a class="reference internal" href="#editing-a-pivot-chart" id="id42">Editing a pivot chart</a></p></li>
<li><p><a class="reference internal" href="#updating-a-pivot-chart" id="id43">Updating a pivot chart</a></p></li>
<li><p><a class="reference internal" href="#filtering-a-pivot-chart" id="id44">Filtering a pivot chart</a></p></li>
<li><p><a class="reference internal" href="#deleting-a-pivot-chart" id="id45">Deleting a pivot chart</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>ピボットテーブルは、大量のデータを簡単に組み合わせ、比較、分析、要約するためのツールだ。これを使用すると、ソースデータのさまざまな概要や関心分野の詳細を表示したり、報告書を作成したりできる。</p>
<section id="database-preconditions">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Database preconditions</a><a class="headerlink" href="#database-preconditions" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルで作業するには、行と列で構成される、データベースのテーブルに似た生データの一覧が必要だ。フィールド名は一覧の最初の行だ。</p>
<p>データ給源は外部ファイルまたはデータベースだ。最も単純な例として、データが Calc
スプレッドシートで与えられている、並べ替え機能を単に使えば済むことがある。</p>
<p>リスト形式のデータを処理するために、Calc はスプレッドシートのどこにリストがあるかを知る必要がある。リストはシート内のどの位置にあってもかまわない。スプレッドシートには関連性のないリストを複数含めることができる。</p>
<p>Calc はリストを自動的に認識する。次のロジックを使用する：選択した升目を起点に、周囲のセル上下左右すべてを調べる。空の行または列を検出した場合、またはスプレッドシートの左または上の境界に当たった場合、リスト境界を認識する。つまり、リストに空の行や列がない場合にのみ、説明した関数が正しく動作する。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Calc がリストを自動的に正しく認識させるため、リスト内に空の行や空の列がないことを確認しろ。</p>
</div>
<p>ピボットテーブルを作成する前にセルを複数選択した場合、上述の自動認識ロジックは適用されない。その代わりに、Calc は選択セルをそのまま使用してピボットテーブルを作成するとみなす。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>ピボットテーブルの作成を開始する前に、必ず升目を一つだけ選択しろ。これにより、Calc はデータリストの全範囲を自動的に判断する。</p>
</div>
<p>比較的よくある誤りの原因は、リストを誤って宣言してしまい、それを並び替えてしまうことだ。升目を複数選択した場合、例えば列全体を選択した場合、並び替えによって一行にまとまるべきデータが混ざり合ってしまう。</p>
<p>このような形式的な側面に加えて、リストの論理構造もとても重要だ。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calc リストは正規形、つまり単純な線形構造を持たなければならない。</p>
</div>
<p>データを入力するときは、アウトライン、グループ、概略を追加しない。以下は、経験の浅い表計算使用者がよく犯す間違いだ：</p>
<ul class="simple">
<li><p>例えば、記事のグループごとにシートを設ける。こうしてしまうと、分析が各グループ内でしか不可能だ。</p></li>
<li><p>売上一覧で金額の列を一つしか作らず、各従業員の金額の列を作成したとする。この場合、さまざまな列のデータをグループ化することは困難だ。したがって、ピボットテーブルを使用した分析は不可能だ。ピボットテーブルで分析するにはデータがすべて同じ列に入力されている必要がある</p></li>
<li><p>金額を時系列順に入力し、各月末に合計を作成したとする。この場合、ピボットテーブルは合計を他の値と同等に扱うため、異なる基準でリストを並べ替えることは不可能だ。月次結果の取得は高速で簡単なピボットテーブル機能の一つだ。</p></li>
</ul>
</section>
<section id="data-sources">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Data sources</a><a class="headerlink" href="#data-sources" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルのデータ給源としては、Calc スプレッドシートまたは LibreOffice
に登録されている外部データソースが考えられる。</p>
<section id="calc-spreadsheet">
<h4><a class="toc-backref" href="#id7" role="doc-backlink">Calc spreadsheet</a><a class="headerlink" href="#calc-spreadsheet" title="Link to this heading">¶</a></h4>
<p>Calc スプレッドシートでリストを分析するのは、最も単純でよく使われる用例だ。リストは定期的に更新されたり、他のアプリケーションからデータをインポートしたりする。</p>
<p>リストデータはスプレッドシートに直接入力することも、別のファイルやアプリケーションからコピーすることもある。また、Web Page Query の入力フィルターを使用して、<abbr title="HyperText Markup Language">HTML</abbr> ファイル、<abbr title="Comma-Separated Values">CSV</abbr> ファイル、Calc スプレッドシート、Microsoft Excel スプレッドシートからデータをはめ込むことも可能だ。詳細については <a class="reference internal" href="calc11.html"><span class="doc">Chapter 11, Linking Data</span></a> を参照しろ。</p>
<p>別のアプリケーションからデータを挿入する際の Calc の動作はデータの形式によって異なる。データが一般的なスプレッドシート形式の場合、直接コピーされる。このダイアログボックスの詳細については <a class="reference internal" href="calc01.html"><span class="doc">Chapter 1, Introduction</span></a> を見ろ。</p>
</section>
<section id="registered-data-source">
<h4><a class="toc-backref" href="#id8" role="doc-backlink">Registered data source</a><a class="headerlink" href="#registered-data-source" title="Link to this heading">¶</a></h4>
<p>登録済みデータ給源とは LibreOffice 以外のデータベースに保存されているデータへの接続だ。これを使用する場合、分析対象のデータはスプレッドシートに保存されない。
Calc では LibreOffice Base で作成および管理されているデータベース以外にも、さまざまなデータ給源を使用可能だ。<a class="reference internal" href="calc11.html"><span class="doc">Chapter 11, Linking Data</span></a> を見ろ。</p>
</section>
</section>
<section id="using-shortcuts">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Using shortcuts</a><a class="headerlink" href="#using-shortcuts" title="Link to this heading">¶</a></h3>
<p>Calc でピボットテーブルを頻繁に使用する場合、組み込みメニューの頻繁な使用に不便を感じる。組み込みキーバインドがすでに与えられている場合がある。例として、選択データ範囲をグループ化する <kbd class="kbd docutils literal notranslate">F12</kbd> がある。その他の場合、組み込みのツールバーにはすでに関連する図像が用意されていることがある。例えば、<span class="guilabel">Standard</span> ツールバー における <span class="guilabel">Insert or Edit Pivot Table</span> 図像だ。</p>
<p>組み込みのキーバインドやツールバーを使用するだけでなく、独自に定義することもできる。<a class="reference internal" href="calc15.html"><span class="doc">Chapter 15, Setting up and Customizing</span></a> を見ろ。</p>
</section>
<section id="creating-a-pivot-table">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Creating a pivot table</a><a class="headerlink" href="#creating-a-pivot-table" title="Link to this heading">¶</a></h3>
<p>Calc に生データリストの全範囲を自動的に決定させたい場合は、このリスト内の升目を一つ選択する。明示的に定義したい場合は、関連する升目すべてを選択する。</p>
<p>ピボットテーブルを作成するコマンドは次のいずれか：</p>
<ul class="simple">
<li><p>セルが選択されている状態で、Menu バー の <span class="menuselection"><span class="accelerator">I</span>nsert‣Pi<span class="accelerator">v</span>ot
Table…</span> を実行</p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">P</span>ivot Table‣<span class="accelerator">I</span>nsert or Edit…</span> を実行</p></li>
<li><p><span class="guilabel">Standard</span> ツールバー の <span class="guilabel">Insert or Edit Pivot Table</span> 図像を押す</p></li>
</ul>
<p><span class="guilabel">Select Source</span> ダイアログボックス が表示され、選択したデータ升目、名前がすでに設定されている升目範囲、または LibreOffice に登録済みのデータ給源のいずれかを使用するか選択できる。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>名前付き範囲の詳細については <a class="reference internal" href="calc14.html"><span class="doc">Chapter 14, Calc as a Database</span></a> を、登録データ給源へのリンクの詳細については <a class="reference internal" href="calc11.html"><span class="doc">Chapter 11, Linking Data</span></a> を見ろ。</p>
</div>
<p><span class="guilabel">Select Source</span> ダイアログボックス で <span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押すと <span class="guilabel">Pivot Table Layout</span> ダイアログボックス が表示される。</p>
</section>
</section>
<section id="the-pivot-table-layout-dialog">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">The Pivot Table Layout dialog</a><a class="headerlink" href="#the-pivot-table-layout-dialog" title="Link to this heading">¶</a></h2>
<p>ピボットテーブルの機能は <span class="guilabel">Pivot Table Layout</span> ダイアログボックス とスプレッドシートでの結果の操作を通じて管理する。当節では前者について見ていく。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>ピボットテーブルの初期作成後に <span class="guilabel">Pivot Table Layout</span> ダイアログボックス を再度表示するには、ピボットテーブルの任意の升目をクリックしてから上述のピボットテーブル作成手順と同じことをするか、ピボットテーブルの任意の升目を右クリックしてコンテキストメニューから <span class="menuselection"><span class="accelerator">P</span>roperties…</span> を選択する。</p>
</div>
<section id="basic-layout">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Basic layout</a><a class="headerlink" href="#basic-layout" title="Link to this heading">¶</a></h3>
<p><span class="guilabel">Pivot Table Layout</span> ダイアログボックス にはピボットテーブルの間取りを示す領域が四つある：</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">F</span>ilters</span></p></li>
<li><p><span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span></p></li>
<li><p><span class="guilabel"><span class="accelerator">R</span>ow Fields</span></p></li>
<li><p><span class="guilabel"><span class="accelerator">D</span>ata Fields</span></p></li>
</ul>
<p>これらのほかに、原データリストのフィールド名を含む <span class="guilabel"><span class="accelerator">A</span>vailable Fields</span> がある。間取りを選択するには、<span class="guilabel"><span class="accelerator">A</span>vailable Fields</span> から他の四領域にフィールドをドラッグ＆ドロップする。</p>
<p><span class="guilabel"><span class="accelerator">D</span>ata Fields</span> には最低一つはフィールドが必要だ。上級者はここにフィールドを複数使用する。当欄には、例えば <cite>SUM</cite> などの集計関数が使用される。</p>
<p><span class="guilabel"><span class="accelerator">R</span>ow Fields</span> と <span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span> は結果がどのグループからソートされるかを示す。多くの場合、行または列の小計を得るために、一度に複数のフィールドが使用される。フィールドの順序は、全体的なものから特定のものへの合計の順序を与える。</p>
<p>例えば、<cite>Region</cite> と <cite>Employee</cite> を <span class="guilabel"><span class="accelerator">R</span>ow Fields</span> エリアにドラッグすると合計が地域に分割される。地域内にはさまざまな従業員の一覧が表示される。</p>
<p><span class="guilabel"><span class="accelerator">F</span>ilters</span> に配置されたフィールドは、ドロップダウンリストとして結果のピボットテーブルの上部に表示される。結果の概要では選択したベースデータの一部しかみが考慮されない。例えば、<span class="guilabel"><span class="accelerator">F</span>ilters</span> に <cite>Employee</cite> を含めると、従業員ごとに表示される結果を絞り込み処理できる。</p>
<p>フィールドを四領域から削除する場合、項目をドラッグ＆ドラップで <span class="guilabel"><span class="accelerator">A</span>vailable Fields</span>
に戻す。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>選択したフィールドを <span class="guilabel">Pivot Table Layout</span> ダイアログボックス のある領域から別の領域に素早く移動するには、<kbd class="kbd docutils literal notranslate">Alt</kbd> を押しながら、対象領域のラベルの下線付きの文字に対応するキーを押す。</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>既定では、Calc は <span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span> に <cite>Data</cite> を入れる。<cite>Data</cite> は必要に応じて
<span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span> と <span class="guilabel"><span class="accelerator">R</span>ow Fields</span> 領域の間で移動できる。<cite>Data</cite> はその領域のフィールドリスト内での位置によっては、ピボットテーブルの結果に <cite>Data</cite> というラベルのボタンが表示され、結果の間取りに影響を与えることがある。この機能を使用しない場合は <cite>Data</cite> をその領域のフィールドリストの最後に配置しろ。</p>
</div>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p><span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span> に最初から入っている <cite>Data</cite> は使うつもりがなくても、自分で追加した項目の下に移動させておけ。</p>
</div>
</section>
<section id="more-options">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">More Options</a><a class="headerlink" href="#more-options" title="Link to this heading">¶</a></h3>
<p><span class="guilabel">Pivot Table Layout</span> ダイアログボックス を展開して、さらにオプションを表示するには、
<span class="guilabel">O<span class="accelerator">p</span>tions</span> および <span class="guilabel">Source and Destination</span> ラベルに隣接するプラス記号をクリックする。</p>
<p>ダイアログの <span class="guilabel">O<span class="accelerator">p</span>tions</span> をクリックするとチェックボックスが複数現れる。好みで。</p>
<p>ダイアログの <span class="guilabel">Source and Destination</span> をクリックすると、ピボットテーブルの入出力場所を編集可能な入力欄が現れる。これを使えば新シートに表を生成しないようにできる。</p>
<p class="rubric">Options</p>
<dl>
<dt><span class="guilabel"><span class="accelerator">I</span>gnore empty rows</span></dt><dd><p>原データが推奨形式でない場合、ピボットテーブルに空行を無視させる。</p>
</dd>
<dt><span class="guilabel">Identif<span class="accelerator">y</span> categories</span></dt><dd><p>原データにリスト内の項目がなく、推奨されるデータ構造を満たしていない場合、ピボットテーブルはその上に一覧された区分にそれを追加する。オフにするとピボットテーブルは <cite>(empty)</cite> を入れる。</p>
<p>オフにすると、ピボットテーブルには区分 <cite>(empty)</cite> が表示される。</p>
<p>論理的には、オンの場合の動作の方が優れている。空項目が表示されるリストは並べ替えや絞り込みなどの機能が使用できないため、有用性が低い。</p>
</dd>
<dt><span class="guilabel">Total colum<span class="accelerator">n</span>s</span>, <span class="guilabel">Total ro<span class="accelerator">w</span>s</span></dt><dd><p>これらのオプションを使用すると、ピボットテーブルに各列の合計を表示する行を追加するか、各行の合計を表示する列を右端に追加するかを決定できる。項目が累積されている場合や比較の結果である場合など、無意味であることもある。</p>
</dd>
<dt><span class="guilabel">Add fi<span class="accelerator">l</span>ter</span></dt><dd><p>ピボットテーブルの結果の上に <cite>Filter</cite> というラベルの付いた升目を追加するかどうかを指定する。これにより、ピボットテーブル内に追加の絞り込みオプションが追加される。<a class="reference internal" href="#calc09-anchor-filtering"><span class="std std-ref">Filtering</span></a> を見ろ。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>このオプションによる絞り込みと、<span class="guilabel">Pivot Table Layout</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">F</span>ilters</span> にフィールドを含めることで搭載される絞り込みとは独立している。</p>
</div>
</dd>
<dt><span class="guilabel"><span class="accelerator">E</span>nable drill to details</span></dt><dd><p>合計列または合計行から生成された升目を含め、ピボットテーブルの結果のデータセル一つをダブルクリックすると、新しいシートが開き、個々の項目の詳細な一覧が表示される。行または列フィールド領域の升目をダブルクリックすると、<span class="guilabel">Show Detail</span> ダイアログが開く。この機能がオフである場合、ダブルクリックはスプレッドシート内での通常の編集機能を維持する。詳細については
<a class="reference internal" href="#calc09-anchor-drilling"><span class="std std-ref">Drilling (showing details)</span></a> でやる。</p>
</dd>
</dl>
<p class="rubric">Destination</p>
<dl>
<dt><span class="guilabel">Source</span></dt><dd><p>この領域の <span class="guilabel">Selection</span> フィールドには、シート名と、ピボットテーブルの原データを含む升目範囲が表示される。原スプレッドシートに名前付き範囲がある場合は <span class="guilabel">Named ran<span class="accelerator">g</span>e</span> オプションで選択できる。</p>
</dd>
<dt><span class="guilabel">Destination</span></dt><dd><p>この領域のコントロールは結果を表示する場所を定義する。</p>
<p><span class="guilabel">New sheet</span> を選択すると、スプレッドシートファイルに新規シートが追加され、そこに結果が配置される。新規シートには <code class="samp docutils literal notranslate"><span class="pre">Pivot</span>
<span class="pre">Table_sheetname_</span><em><span class="pre">X</span></em></code> という形式で名前が付けられる。ここで <cite>X</cite> には作成された表の番号が入る。<cite>Sales List</cite> という名前のシートの場合を例に挙げると、最初に作成されるピボットテーブルの新規シートの名前は <cite>Pivot Table_Sales List_1</cite> だ。各新規シートは給源シートの隣に加わる。</p>
<p>対象スプレッドシートに名前付き範囲がある場合は <span class="guilabel">Named range</span> オプションで選択できる。</p>
<p>この領域の <span class="guilabel">Selection</span> フィールドには、シート名とピボットテーブルの結果の升目範囲が表示される。</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>ピボットテーブルを原データと同じシートに表示するには、<span class="guilabel">Destination</span>
領域の <span class="guilabel">Selection</span> をオンにし、右側にある Shrink ボタンを押し、シートの空の領域の適切な升目をクリックして Expand ボタンを押し、
<span class="guilabel">Pivot Table Layout</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。</p>
</div>
</section>
<section id="more-settings-for-the-fields-field-options">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">More settings for the fields: Field options</a><a class="headerlink" href="#more-settings-for-the-fields-field-options" title="Link to this heading">¶</a></h3>
<p>前節のオプションはピボットテーブル全般に有効だ。また、ピボットテーブル間取りに現在含まれているフィールドの設定も変更できる。フィールドの設定を変更するには、<span class="guilabel">Pivot Table Layout</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">F</span>ilters</span>, <span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span>, <span class="guilabel"><span class="accelerator">R</span>ow Fields</span>,
<span class="guilabel"><span class="accelerator">D</span>ata Fields</span> のいずれかでそのフィールドをダブルクリックする。<span class="guilabel"><span class="accelerator">A</span>vailable Fields</span>
のフィールドをダブルクリックしても効果はない。<span class="guilabel"><span class="accelerator">D</span>ata Fields</span> のフィールドで使用できるオプションは、他の三領域のフィールドで使用できるそれとは異なる。</p>
<section id="options-for-data-fields">
<h4><a class="toc-backref" href="#id15" role="doc-backlink">Options for data fields</a><a class="headerlink" href="#options-for-data-fields" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">D</span>ata Fields</span> 欄とそれ以外でダイアログの内容が若干異なる。</p></li>
<li><p><span class="guilabel">Subtotals</span> をオンにして小計を表示させることも可能。試すときにはマニュアルのように行フィールドを二つ以上指定するとわかりやすい。</p></li>
</ul>
<p>ダイアログの <span class="guilabel"><span class="accelerator">O</span>ptions…</span> ボタンで開くダイアログボックスで、さらなる表示周りの項目を指定可能。</p>
<ul class="simple">
<li><p><span class="guilabel">Compact Layout</span> オプションが魅力的だが、日付の書式が保存されないようで困る。</p></li>
</ul>
<p><span class="guilabel">Pivot Table Layout</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">D</span>ata Fields</span> ある対象フィールドをダブルクリックすると
<span class="guilabel">Data Field</span> ダイアログボックス が開く。</p>
<p><span class="guilabel">Data Field</span> ダイアログボックス では集計関数を選択可能だ。<cite>Sum</cite> 関数などを使用することがよくある。標準偏差や勘定関数などの他の関数も使用可能。例えば、勘定関数は数値以外のデータフィールドに便利だ。</p>
<p>空の列や行を結果表に含めるには <span class="guilabel">Show it<span class="accelerator">e</span>ms without data</span> をオンにする。</p>
<p>ダイアログの <span class="guilabel"><span class="accelerator">D</span>isplayed Value</span> 区画 を展開するにはプラス記号をクリックする。</p>
<p><span class="guilabel"><span class="accelerator">D</span>isplayed Value</span> 区画 では集計機能を使用した分析に関する他の可能性を選択可能だ。
<span class="guilabel"><span class="accelerator">T</span>ype</span> の設定によっては <span class="guilabel"><span class="accelerator">B</span>ase field</span> と <span class="guilabel">Ba<span class="accelerator">s</span>e
item</span> の定義を選択する必要がある。</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>余裕があれば Table 1 をまとめろ。</p>
</div>
</section>
<section id="options-for-row-and-column-fields">
<h4><a class="toc-backref" href="#id16" role="doc-backlink">Options for row and column fields</a><a class="headerlink" href="#options-for-row-and-column-fields" title="Link to this heading">¶</a></h4>
<p><span class="guilabel">Pivot Table Layout</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">R</span>ow Fields</span> または <span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span> でフィールドをダブルクリックすると、<span class="guilabel">Data Field</span> ダイアログボックス が表示される。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p><span class="guilabel"><span class="accelerator">D</span>ata Fields</span> のダブルクリックのときとは構成が異なる。</p>
</div>
<p>各区分の小計を表示するかどうかを選択可能だ。既定では活動していない。小計が有用であるのは、ある行または列フィールドの値が、別の（サブ）フィールドの小計に分割可能である場合に限る。</p>
<p>データフィールド（前述）にも使用できる小計を計算するには、<span class="guilabel">Data Field</span> ダイアログボックス
<span class="guilabel">Subtotals</span> 区画で <span class="guilabel"><span class="accelerator">A</span>utomatic</span> を選択する。</p>
<p>使用する小計の型を選択するには <span class="guilabel"><span class="accelerator">U</span>ser-defined</span> を選択し、計算したい小計の型を一覧からクリックする。この一覧にある関数は <span class="guilabel"><span class="accelerator">U</span>ser-defined</span> が選択されている場合に限り使用可となる。</p>
<p>通常、基となるデータベースに項目がない区分の行や列はピボットテーブル上では見えない。<span class="guilabel">Show it<span class="accelerator">e</span>ms without data</span> をオンにすると、これらを強制的に表示できる。</p>
<p><span class="guilabel">Data Field</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">O</span>ptions…</span> ボタンを押して <span class="guilabel">Data Dield Options</span> ダイアログボックス
にアクセスする。これを使用して <span class="guilabel">Pivot Table Layout</span> ダイアログボックス の|ColumnFields| と
<span class="guilabel"><span class="accelerator">R</span>ow Fields</span> のフィールドに対する追加オプションを指定する。</p>
<p>用意されている選択肢は次のとおり：</p>
<dl id="calc09-anchor-sort-by">
<dt><span class="guilabel">Sort by</span></dt><dd><p>列または行を並べ替えたいデータフィールドを指定する。</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">A</span>scending</span> は最小値から最大値へ昇順に並び替わる。対象フィールドがダイアログを開いたフィールドである場合、項目は名前順に並べ替わる。データフィールドが選択された場合は、項目は選択されたデータフィールドの結果値で並び替わる。</p></li>
<li><p><span class="guilabel"><span class="accelerator">D</span>escending</span> はその降順版。</p></li>
<li><p><span class="guilabel"><span class="accelerator">M</span>anual</span> は値が辞書式配列に並べ替わる。</p></li>
</ul>
</dd>
<dt><span class="guilabel">Display Options</span></dt><dd><p>例外的でない行を除いた、すべての行フィールドの表示オプションを指定可能。Layout ドロップダウンリストから、リストボックス内のフィールドの間取りモードを選択する。ピボットテーブルの各項目のデータの後に空行を追加するには
<span class="guilabel"><span class="accelerator">E</span>mpty line after each item`を選択する。:guilabel:`<span class="accelerator">R</span>epeat item
labels</span> を必要に応じてオンまたはオフにする。</p>
<p><span class="guilabel"><span class="accelerator">L</span>ayout</span> ドロップダウンリストには間取りモードオプションが四つある。要求に最も適した間取りを選択しろ：</p>
<ul class="simple">
<li><p><cite>Tabular layout</cite></p></li>
<li><p><cite>Outline layout with subtotals at the top</cite></p></li>
<li><p><cite>Outline layout with subtotals at the bottom</cite></p></li>
<li><p><cite>Compact layout</cite></p></li>
</ul>
</dd>
<dt><span class="guilabel">Show Automatically</span></dt><dd><p>指定したフィールドで並び替えるときに、上位または下位何個の項目を表示するかを与える。<span class="guilabel"><span class="accelerator">S</span>how</span> をオンにして自動的に表示する項目の最大数を入力する。<span class="guilabel"><span class="accelerator">F</span>rom</span> ドロップダウンリストでは指定された順序で最上位または最下位の項目を選択する。<span class="guilabel">Using field</span> ドロップダウンリストでデータを並べ替えるデータフィールドを選択する。</p>
</dd>
<dt><span class="guilabel">Hide <span class="accelerator">I</span>tems</span></dt><dd><p>計算から隠す項目をオンにする。</p>
</dd>
<dt><span class="guilabel">Hierarch<span class="accelerator">y</span></span></dt><dd><p>フィールドに階層が複数ある場合、使用するものを選択する。ピボットテーブルはデータ階層を含む外部原データに基づいている必要がある。ほとんどの使用者にとって、Calc は 一つのフィールドに複数の階層を設けないため、通常このオプションは灰色表示される。ピボットテーブル拡張を使用する場合、その拡張で一部のフィールドに階層を複数定義するとこの選択肢が使用できるようになる可能性がある。その拡張の仕様を見ないとわからない。</p>
</dd>
</dl>
</section>
<section id="options-for-filter-fields">
<h4><a class="toc-backref" href="#id17" role="doc-backlink">Options for filter fields</a><a class="headerlink" href="#options-for-filter-fields" title="Link to this heading">¶</a></h4>
<p><span class="guilabel"><span class="accelerator">F</span>ilters</span> のフィールドに対する <span class="guilabel">Data Field</span> ダイアログボックス は <span class="guilabel"><span class="accelerator">R</span>ow Fields</span> と <span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span>
のフィールドに対するそれと同じ設定だ。ピボットテーブルの柔軟性を利用すれば、絞り込み、列、行の間で異なるフィールドを切り替えることが可能だ。フィールドは指定した設定を保持する。絞り込みフィールドには行または列フィールドと同じ性質がある。これらの設定はフィールドを絞り込みフィールドとしてではなく、行または列フィールドとして使用する場合に限り効果がある。</p>
</section>
</section>
</section>
<section id="working-with-the-results-of-the-pivot-table">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">Working with the results of the pivot table</a><a class="headerlink" href="#working-with-the-results-of-the-pivot-table" title="Link to this heading">¶</a></h2>
<p><span class="guilabel">Pivot Table Layout</span> ダイアログボックス はたいへん柔軟で、マウスを数回クリックするだけでピボットテーブルを完全に再構築できる。</p>
<section id="changing-the-layout">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Changing the layout</a><a class="headerlink" href="#changing-the-layout" title="Link to this heading">¶</a></h3>
<p>ピボットテーブル上で <span class="guilabel">Pivot Table Layout</span> ダイアログボックス を開いて、フィールドをドラッグ＆ドロップし直せば、表のレイアウトを容易に変更可能だ。そして、ピボットテーブルの結果ビューでも操作可能なものがある。それらしい UI 要素をマウスでドラッグして試して覚えろ。</p>
<p>一部の操作は、ピボットテーブルの結果ビューでも実行可能。結果内で、絞り込み、列、行フィールドのいずれかを別の位置にドラッグしろ。行から列への移動など、別のフィールドに移動する場合は、マウスポインターの形が開始時の形（矢印の頭の水平または垂直のブロック）から反対に変わり、ドロップできるようになる。</p>
<p>列、行、絞り込みフィールドをピボットテーブルから削除するには、そのフィールドをクリックして表の外へドラッグしろ。<span class="guilabel">Pivot Table Layout</span> ダイアログボックス に戻って設定し直さない限り、削除したフィールドは戻らない。</p>
</section>
<section id="grouping-rows-or-columns-of-a-pivot-table">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Grouping rows or columns of a pivot table</a><a class="headerlink" href="#grouping-rows-or-columns-of-a-pivot-table" title="Link to this heading">¶</a></h3>
<p>分析や要約の多くでは、区分をグループ化する必要がある。クラスで結果を併合可能だ。グループ化はそれがまだなされていないピボットテーブルでしか実行不可だ。</p>
<p>正しい升目領域を選択したら、Menu バー の <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">G</span>roup and Outline‣<span class="accelerator">G</span>roup…</span> を選択するか、<kbd class="kbd docutils literal notranslate">F12</kbd>
を押す。グループ化される値の型はグループ化がどのように機能するかを主に決定するものだ。スカラー値か、グループ化したいテキストなどの値かを区別する必要がある。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>グループ化する前に、グループ化されていないデータでピボットテーブルを作成する必要がある。ピボットテーブルの作成に必要な時間は、基本データの規模ではなく、列と行の数によって主に決まる。グループ化により、少ない行数と列数でピボットテーブルを作成できる。データ給源によっては、ピボットテーブルに多くの区分を含めることが可能だ。</p>
</div>
<p>グループ化を解除するには、グループ内をクリックし、<span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">G</span>roup
and Outline‣<span class="accelerator">U</span>ngroup…</span> を選択するか、<kbd class="kbd docutils literal notranslate">F12</kbd> を押す。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>ピボットテーブルに対するグループ化の動作を己の家計簿で確認した。</p>
</div>
<section id="grouping-of-categories-with-scalar-values">
<h4><a class="toc-backref" href="#id21" role="doc-backlink">Grouping of categories with scalar values</a><a class="headerlink" href="#grouping-of-categories-with-scalar-values" title="Link to this heading">¶</a></h4>
<p>スカラー値をグループ化するには、グループ化する区分の行または列の升目を一つ選択する。そして次のいずれかを行う：</p>
<ul class="simple">
<li><p>Menu バー の <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">G</span>roup and Outline‣<span class="accelerator">G</span>roup…</span> を選択</p></li>
<li><p><kbd class="kbd docutils literal notranslate">F12</kbd> を押す</p></li>
</ul>
<p>これにより <span class="guilabel">Grouping</span> ダイアログボックスが開く。どの値の範囲でグループ化するかを:guilabel:<cite>Start</cite> と <span class="guilabel">End</span> で定義できる。既定設定は最小値から最大値までの全範囲だ。<span class="guilabel">Group by</span> ではクラスサイズ（区間サイズ）を入力できる。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>動作確認できず。</p>
</div>
</section>
<section id="grouping-of-categories-with-date-time-values">
<h4><a class="toc-backref" href="#id22" role="doc-backlink">Grouping of categories with date / time values</a><a class="headerlink" href="#grouping-of-categories-with-date-time-values" title="Link to this heading">¶</a></h4>
<p>日付・時刻値をグループ化するのも前節と同様の手順を実行する。</p>
<p><span class="guilabel">Group by</span> フィールドで指定するクラスサイズは、日付時刻の場合、日単位の時間間隔を明示的に指定する代わりに、定義済みの時間間隔（秒、分、時、日、月、四半期、年）のいずれかを選択できる。</p>
</section>
<section id="grouping-without-automatic-creation-of-intervals">
<h4><a class="toc-backref" href="#id23" role="doc-backlink">Grouping without automatic creation of intervals</a><a class="headerlink" href="#grouping-without-automatic-creation-of-intervals" title="Link to this heading">¶</a></h4>
<p>区分のいくつか（例えば、テキストフィールドを含むカテゴリー）では、区間を作成することはできない。そのようなフィールドに対しては、どの値をグループにまとめるかを定義することならば可能だ。</p>
<p>これらの区分をグループ化するには、ピボットテーブルの結果で、グループにまとめたい個々のフィールド値をすべて選択する。そのような選択状態で Menu バー の
<span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">G</span>roup and Outline‣<span class="accelerator">G</span>roup…</span> を選択するか、<kbd class="kbd docutils literal notranslate">F12</kbd> を押して選択升目をグループ化する。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> を押しながらクリックすることで、連続していない複数の升目を選択可能。</p>
</div>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>家計簿で、例えば「場所」の列で「ビッグエー墨田業平店」と「ビッグエー墨田京島店」を選択して <kbd class="kbd docutils literal notranslate">F12</kbd> を押すと、この機能のありがたさを理解できる。</p>
</div>
<p>入力フィールドの名前を編集することで、グループと新しく作成されたグループフィールドの既定の名前を変更できる。例えば、<cite>Group2</cite> を <cite>Technical</cite> に）。後で間取りを変更した場合でも、ピボットテーブルはこれらの設定を記憶する。</p>
<p>グループの部分合計を追加するには、ピボットテーブルの結果を右クリックし、
<span class="menuselection"><span class="accelerator">P</span>roperties…</span> を選択する。<span class="guilabel"><span class="accelerator">R</span>ow Fields</span> の対象項目をダブルクリックし、
<span class="guilabel">Data Field</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">A</span>utomatic</span> を選択する。<span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押していく。</p>
<p>まだ有効になっていない場合は、<span class="guilabel">Pivot Table Layout</span> ダイアログボックス で <span class="guilabel"><span class="accelerator">E</span>nable drill
to details</span> を選択する。対象列の名前およびグループフィールド登録項目をダブルクリックして、グループ登録項目木を操作する。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>構造化されたデータベースを使用すると、ピボットテーブル内で手動で並べ替えを行う必要がなくなる。</p>
</div>
</section>
</section>
<section id="sorting-the-result">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Sorting the result</a><a class="headerlink" href="#sorting-the-result" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルの結果は、既定では、列および行の区分が昇順で表示されるように並べ替えられる。並べ替え順序を変更する方法：</p>
<ul class="simple">
<li><p>列の見出しにあるドロップダウンメニューで並べ替え順序を選択する</p></li>
<li><p>ドラッグ＆ドロップを使用して手動で並べ替える</p></li>
<li><p>該当する行または行の <span class="guilabel">Data Dield Options</span> ダイアログボックス で並べ替え順序を選択</p></li>
</ul>
<section id="select-sort-order-from-drop-down-menus-on-each-column-heading">
<span id="calc09-anchor-drop-down"></span><h4><a class="toc-backref" href="#id25" role="doc-backlink">Select sort order from drop-down menus on each column heading</a><a class="headerlink" href="#select-sort-order-from-drop-down-menus-on-each-column-heading" title="Link to this heading">¶</a></h4>
<p>登録項目を並べ替える最も簡単な方法は、行または列フィールドの列見出しの右側にある▼をクリックし、次の並べ替え選択肢のいずれかを選択することだ。</p>
<ul class="simple">
<li><p><cite>Sort Ascending</cite></p></li>
<li><p><cite>Sort Descending</cite></p></li>
<li><p><cite>Custom Sort</cite></p></li>
</ul>
<p><cite>Custom Sort</cite> を選択すると、<span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Calc‣Sort Lists</span> ページ で定義済みのカスタム並べ替えのいずれかに従って並べ替えが行われる。並べ替えリストの作成と使用の詳細については <a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> を見ろ。</p>
<p>このダイアログにはピボットテーブルのデータを簡単に絞り込み処理する機能もある。必要な個々のチェックボックスをオンにして、ピボットテーブルの結果に表示されるデータを選択する。すべてを表示する、現在の項目のみ見せる、現在の項目のみ隠す、といった選択肢が設けられている。<span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押して、選択した絞り込み処理を有効にする。絞り込みが実行されると、▼の色が青地に白に変わり、右下に小さな白い四角が追加される。</p>
</section>
<section id="sort-manually-by-using-drag-and-drop">
<h4><a class="toc-backref" href="#id26" role="doc-backlink">Sort manually by using drag and drop</a><a class="headerlink" href="#sort-manually-by-using-drag-and-drop" title="Link to this heading">¶</a></h4>
<p>ピボットテーブルの結果で区分の値を持つ升目を移動することで、区分内の順序を変更できる。ドラッグした升目はドロップした升目の前にねじ込まれる。</p>
<p>Calc では、升目が選択されていなければならず、キャレットがセル内にあるだけでは不十分であることに気をつけろ。選択升目の背景は異なる色になる。升目一つに目印を付けるには次のいずれかを実行する：</p>
<ul class="simple">
<li><p>升目をクリックし、さらに <kbd class="kbd docutils literal notranslate">Shift</kbd> を押しながらクリックする。</p></li>
<li><p>マウスボタンを押し、升目二つにまたがる範囲をドラッグし、マウスボタンを放さずに最初の升目にドラッグする。マウスボタンを離す。これで、ドラッグ＆ドロップで個々の升目を動かすことができる。</p></li>
</ul>
<p>升目を複数選択するには、余分なキーを押さずに升目を一つマークし、<kbd class="kbd docutils literal notranslate">Shift</kbd> または
<kbd class="kbd docutils literal notranslate">Ctrl</kbd> を押しながら他の升目をクリックする。</p>
</section>
<section id="sort-automatically">
<h4><a class="toc-backref" href="#id27" role="doc-backlink">Sort automatically</a><a class="headerlink" href="#sort-automatically" title="Link to this heading">¶</a></h4>
<p>自動的に並べ替えるには、ピボットテーブル内で右クリックし、<span class="menuselection"><span class="accelerator">P</span>roperties…</span> を選択する。<span class="guilabel">Pivot Table Layout</span> ダイアログボックス が開く。</p>
<p>並べ替えたい行または列フィールドをダブルクリックします。開いた
<span class="guilabel">Data Field</span> ダイアログボックス で <span class="guilabel"><span class="accelerator">O</span>ptions…</span> を押して
<span class="guilabel">Data Dield Options</span> ダイアログボックス を表示する。</p>
<p><span class="guilabel">Sort by</span> で <a class="reference internal" href="#calc09-anchor-sort-by"><span class="std std-ref">並び替え選択肢</span></a> を決める。</p>
</section>
</section>
<section id="drilling-showing-details">
<span id="calc09-anchor-drilling"></span><h3><a class="toc-backref" href="#id28" role="doc-backlink">Drilling (showing details)</a><a class="headerlink" href="#drilling-showing-details" title="Link to this heading">¶</a></h3>
<p>ドリル機能を使用すると、ピボットテーブルの結果中に単一の、圧縮された値の関連詳細データを見られる。この機能は <span class="guilabel">Pivot Table Layout</span> ダイアログボックス で <span class="guilabel"><span class="accelerator">E</span>nable drill
to details</span> をオンにした場合に限り使用できる。</p>
<p>ドリルを活動させるには升目をダブルクリックするか、<span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">G</span>roup
and Outline‣<span class="accelerator">S</span>how Details</span> を選択する。可能性は二つ：</p>
<ol class="arabic">
<li><p>活性升目が行または列フィールドの場合、ドリルが意味するところは別のフィールドの区分への追加的な分解だ。</p>
<p><span class="guilabel">Show Detail</span> ダイアログが表示され、さらに細分化するフィールドを選択できる。</p>
<p>詳細を再度隠すには <cite>Golf</cite> 升目をダブルクリックするか、
<span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">G</span>roup and Outline‣<span class="accelerator">H</span>ide Details</span> を選択する。</p>
<p>ピボットテーブルは、選択したフィールドを追加して隠すことで、選択フィールドを記憶し、次に当該フィールドをドリルダウンするときにダイアログが表示されないようにする。選択した項目を削除するには、 <span class="guilabel">Pivot Table Layout</span> ダイアログボックス を開き、
<span class="guilabel"><span class="accelerator">R</span>ow Fields</span> または <span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span> 領域の不要な選択項目を削除する。</p>
</li>
<li><p>活性升目がデータフィールドである場合、ドリルダウンすると、この値に集約されるデータ給源のすべてのデータ登録項目の一覧が表示される。</p>
<p>このような升目をダブルクリックすると、この値に含まれるすべてのデータセットの新規一覧が新規シートに表示される。</p>
</li>
</ol>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>家計簿でいうと交通費で試すとわかりやすい。最初の場合は交通機関や「交通費」を、最後の場合は金額をダブルクリックすることにそれぞれ相当する。後者の場合、新規シートが現れて、乗車ごとの明細が示される。</p>
</div>
</section>
<section id="filtering">
<span id="calc09-anchor-filtering"></span><h3><a class="toc-backref" href="#id29" role="doc-backlink">Filtering</a><a class="headerlink" href="#filtering" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルの分析をデータベースに含まれる情報の部分集合に制限するために、ピボットテーブル結果を絞り込むことが可能だ。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>原データを含むシートで使用された AutoFilter または標準フィルターはピボットテーブルの分析処理には影響しない。ピボットテーブルでは開始時に選択された完全なリストが常に使用される。</p>
</div>
<p>これを行うには、結果の左上の絞り込みボタンをクリックするか、結果内で右クリックし、コンテキストメニューから <span class="menuselection"><span class="accelerator">F</span>ilter…</span> を選択する。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>絞り込みボタンは <span class="guilabel">Pivot Table Layout</span> ダイアログボックス の <span class="guilabel">Add fi<span class="accelerator">l</span>ter</span> がオンである場合にしか使用できない。</p>
</div>
<p><span class="guilabel">Filter</span> ダイアログボックス では標準フィルターと同様にして絞り込みオプションを三つまで定義できる。このダイアログボックスの <span class="guilabel">Op<span class="accelerator">t</span>ions</span> 区画のコントロールは
<span class="guilabel">Standard Filter</span> ダイアログボックス のそれに似ている。<a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> を見ろ。</p>
<p>ピボットテーブルに表示されるデータは、列見出しの右側のドロップダウンまたは絞り込みフィールドを使用して絞り込むことも可能だ。列見出しによる絞り込みについては
<a class="reference internal" href="#calc09-anchor-drop-down"><span class="std std-ref">Select sort order from drop-down menus on each column heading</span></a> を見ろ。</p>
<p><span class="guilabel">Pivot Table Layout</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">F</span>ilters</span> 領域に配置したフィールドは、ピボットテーブルの結果を絞り込むもう一つの実用的な方法だ。その利点は、使用する絞り込み基準が明確に示されることにある。絞り込みフィールドボタンの右側にある▼をクリックすると、関連する絞り込みダイアログにアクセスできる。</p>
<p id="calc09-anchor-filtering-status">絞り込みフィールドボタンに隣接するテキストは、絞り込み状態を示す：</p>
<ul class="simple">
<li><p>何も絞られていない場合は <cite>- all -</cite></p></li>
<li><p>全てではないが複数の項目が絞られる場合は <cite>- multiple -</cite></p></li>
<li><p>その値だけが絞られる場合はその値</p></li>
</ul>
</section>
<section id="updating-refreshing-changed-values">
<span id="calc09-anchor-refresh"></span><h3><a class="toc-backref" href="#id30" role="doc-backlink">Updating (refreshing) changed values</a><a class="headerlink" href="#updating-refreshing-changed-values" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルを作成した後で原データを変更しても作成された表は自動的に更新されない。こういう場合はピボットテーブルを手動で更新する必要がある。</p>
<p>更新するにはピボットテーブルをクリックして次のいずれかを実行する：</p>
<ul class="simple">
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">P</span>ivot Table‣<span class="accelerator">R</span>efresh</span></p></li>
<li><p>右クリックメニューから <span class="menuselection"><span class="accelerator">R</span>efresh</span></p></li>
</ul>
<p>原データの登録項目が増減した場合には、<span class="guilabel">Pivot Table Layout</span> ダイアログボックス <span class="guilabel">Source</span>
欄で範囲を変更することで表を更新可能だ。より複雑な変更が生じた場合には、ピボットテーブル全体を作り直せ。</p>
</section>
<section id="cell-formatting">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">Cell formatting</a><a class="headerlink" href="#cell-formatting" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルの結果領域の升目書式は自動的に整形される。この書式設定は、Calc
にあるすべてのツールを用いて変更可能だ。ただし、直接書式設定を使用してピボットテーブルの設計に変更を加えると、次に表を更新するときに自動適用される書式設定に戻る。</p>
<p>ピボットテーブルの作成時に、標準升目スタイルがまだ含まれていない場合は文書中のスタイル一覧に追加される。これらのスタイルそれぞれがピボットテーブルの部分に適用される。これらのピボットテーブルスタイルはカスタマイズ可能だ。ピボットテーブルのスタイルは次のとおり：</p>
<ul class="simple">
<li><p><cite>Pivot Table Category</cite></p></li>
<li><p><cite>Pivot Table Corner</cite></p></li>
<li><p><cite>Pivot Table Field</cite></p></li>
<li><p><cite>Pivot Table Result</cite></p></li>
<li><p><cite>Pivot Table Title</cite></p></li>
<li><p><cite>Pivot Table Value</cite></p></li>
</ul>
<p>カスタマイズしたければ、このスタイルを <span class="menuselection"><span class="accelerator">E</span>dit Style…</span> すればいい。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>ピボットテーブルスタイルを使用しろ。更新時にピボットテーブルの形式が予期せず変更されなくなり、文書内にあるピボットテーブルすべてが同じ体裁をとることが保証できる。</p>
</div>
<p>データフィールドの数値形式について、Calc は原リストにおける対応する升目で使用されている数値形式を採用する。ほとんどの場合、これは便利だ。ただし、結果が分数または百分率の場合、ピボットテーブルはこれが問題になり得るということを認識しない。数値の形式を手動で修正できるが、上の議論のとおり、そのような修正は次の更新以降無効だ。</p>
</section>
<section id="deleting-a-pivot-table">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Deleting a pivot table</a><a class="headerlink" href="#deleting-a-pivot-table" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルを削除する方法は次のいずれかを実行する：</p>
<ul class="simple">
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">P</span>ivot Table‣<span class="accelerator">D</span>elete</span></p></li>
<li><p>右クリックメニューから <span class="menuselection"><span class="accelerator">D</span>elete</span></p></li>
</ul>
<p>ピボットテーブル専用シートを割り当てている場合には、シート丸ごと削除でもいい。</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>関連付けられたピボットチャートがあるピボットテーブルを削除すると、ピボットチャートも削除される。このような場合、削除を確認するためのダイアログボックスが表示される。</p>
</div>
</section>
</section>
<section id="using-pivot-table-results-elsewhere">
<h2><a class="toc-backref" href="#id33" role="doc-backlink">Using pivot table results elsewhere</a><a class="headerlink" href="#using-pivot-table-results-elsewhere" title="Link to this heading">¶</a></h2>
<section id="the-problem">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">The problem</a><a class="headerlink" href="#the-problem" title="Link to this heading">¶</a></h3>
<p>通常、値を含むセルのアドレスを入力して値への参照を作成する。例えば、式 <code class="docutils literal notranslate"><span class="pre">=C6*2</span></code>
は、升目 C6 への参照を作成し、2 倍した値を返す。この升目がピボットテーブルの結果領域にある場合は、行フィールドと列フィールドの特定の区分を参照して計算された結果が格納される。Figure 47 では、升目 C6 に、区分が <cite>Sailing</cite> である <cite>Employee</cite>
<cite>Hans</cite> の売上値の合計が格納されてる。升目 C12 の数式はこの値を使う。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>C12 は明白にピボットテーブル結果外のアドレスであるとする。</p>
</div>
<p>原データまたはピボットテーブルの間取りが変更された場合は、<cite>Sailing</cite> 区分に属する
<cite>Hans</cite> の売上値が別の升目に表示される可能性があることを考慮する必要がある。数式はまだ升目 C6 を参照しているため、間違った値が使用される。正しい値は別の場所にある。</p>
</section>
<section id="the-solution-function-getpivotdata">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">The solution: Function <cite>GETPIVOTDATA()</cite></a><a class="headerlink" href="#the-solution-function-getpivotdata" title="Link to this heading">¶</a></h3>
<p>関数 <cite>GETPIVOTDATA</cite> を使用してピボットテーブル内の値への参照を、この値の特定の識別区分を使用して取得する。この関数はピボットテーブルの結果をスプレッドシート内の別の場所で再利用する場合に、Calc の数式内で使用可能だ。</p>
<section id="syntax">
<h4><a class="toc-backref" href="#id36" role="doc-backlink">Syntax</a><a class="headerlink" href="#syntax" title="Link to this heading">¶</a></h4>
<p>変種が二つある：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=GETPIVOTDATA(Target Field; Pivot Table[; Field 1; Item 1][; ... [Field 126; Item 126]])
=GETPIVOTDATA(Pivot Table; Constraints)
</pre></div>
</div>
<p>最初の変種中、角括弧はそれが囲んでいる引数がオプションであることを示す。</p>
</section>
<section id="first-syntax-variation">
<h4><a class="toc-backref" href="#id37" role="doc-backlink">First syntax variation</a><a class="headerlink" href="#first-syntax-variation" title="Link to this heading">¶</a></h4>
<p>引数 <cite>Target Field</cite> は関数内で使用するピボットテーブルのデータフィールドを指定する。ピボットテーブルにデータフィールドが一つしかない場合、この項目は無視されるのだが、いずれにせよ入力する必要はある。</p>
<p>ピボットテーブルにデータフィールドが複数ある場合は、データ給源のフィールド名
(e.g. “Sales Value”) またはデータフィールド自体のフィールド名 (e.g. “Sum - Sales
Value”) を入力する必要がある。</p>
<p>引数 <cite>Pivot Table</cite> は使用するピボットテーブルを指定する。文書内にはピボットテーブルが複数含まれている場合がある。ここにはピボットテーブルの領域内のセル参照を入力する。ピボットテーブルの左上隅の升目を常に使用すると、間取りが変更されても、そのセルが常にピボットテーブル内にあることを保証できる。</p>
<p class="rubric">例</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=GETPIVOTDATA(&quot;Sales Value&quot;;A1)
</pre></div>
</div>
<p>最初の二つの引数のみを入力すると、関数はピボットテーブルの合計結果を返す。</p>
<p>フィールド名と要素のペアとしてさらに引数を追加して、特定の部分合計を取得可能だ。
Figure 49 の例では、<cite>Hans for Sailing</cite> の部分合計を取得するため、セル C12 の数式は以下のようになる：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=GETPIVOTDATA(&quot;Sales Value&quot;,A1,&quot;Employee&quot;,&quot;Hans&quot;,&quot;Category&quot;,&quot;Sailing&quot;)
</pre></div>
</div>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>Figure 各種は本書実物を参照しろ。だいだいわかるだろう。</p>
</div>
</section>
<section id="second-syntax-variation">
<h4><a class="toc-backref" href="#id38" role="doc-backlink">Second syntax variation</a><a class="headerlink" href="#second-syntax-variation" title="Link to this heading">¶</a></h4>
<p>引数 <cite>Pivot Table</cite> は最初の構文変種と同じ方法で指定する。</p>
<p>引数 <cite>Constraints</cite> にはピボットテーブルから取得する値を指定するリストを空白で区切って入力する。データフィールドが複数ある場合は、このリストにデータフィールド名を含める必要がある。特定の部分結果を選択するには、<code class="samp docutils literal notranslate"><em><span class="pre">Field</span>
<span class="pre">name</span></em><span class="pre">[</span><em><span class="pre">Element</span></em><span class="pre">]</span></code> の形式で登録項目を追加する。</p>
<p>Figure 50 の例では、<cite>Sailing</cite> の <cite>Hans</cite> の部分合計を取得する場合、セル C12 の数式は以下のようになる：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=GETPIVOTDATA(A1,&quot;Sales Value Employee[Hans] Category[Sailing]&quot;)
</pre></div>
</div>
</section>
</section>
</section>
<section id="using-pivot-charts">
<h2><a class="toc-backref" href="#id39" role="doc-backlink">Using pivot charts</a><a class="headerlink" href="#using-pivot-charts" title="Link to this heading">¶</a></h2>
<section id="id3">
<h3><a class="toc-backref" href="#id40" role="doc-backlink">Introduction</a><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルはデータを再編成、操作、要約するための強力なツールであり、ピボットチャートはピボットテーブルの情報を視覚的表現を設ける。ピボットテーブルの出力からピボットチャートを作成でき、ピボットテーブルが変更された場合はピボットチャートも変更される。</p>
<p>ピボットチャートは <a class="reference internal" href="calc03.html"><span class="doc">Chapter 3, Creating Charts and Graphs</span></a> で説明した、より一般的な統計図表の特殊な実例だ。ピボットチャートと Calc の他の図表の主な違いは次のとおりだ：</p>
<ul class="simple">
<li><p>ピボットチャートはピボットテーブルから発行されたデータの変化を追跡し、それに応じて自身のデータ系列とデータ範囲を自動調整する。</p></li>
<li><p>ピボットチャートボタンがピボットチャートに備わっている。これらのボタンはピボットチャート独自のもので、通常の図表にはない。ボタンの重要な目的は、基礎となるピボットテーブルの間取りを表すことで、ピボットテーブルのフィールドが表示される。絞り込みフィールドを表すボタンはピボットテーブルの上部にある。行フィールドを表すボタンは、ピボットチャートの下部に表示される。列フィールドを表すボタンはピボットチャートの右側の凡例に重ねて表示される。ピボットチャートのボタンを使用して、ピボットチャートに表示されるデータを絞り込むことも可能だ。</p></li>
</ul>
</section>
<section id="creating-a-pivot-chart">
<h3><a class="toc-backref" href="#id41" role="doc-backlink">Creating a pivot chart</a><a class="headerlink" href="#creating-a-pivot-chart" title="Link to this heading">¶</a></h3>
<p>ピボットチャートの作成方法は次のいずれか：</p>
<ul class="simple">
<li><p>メインメニュー <span class="menuselection"><span class="accelerator">I</span>nsert‣<span class="accelerator">C</span>hart…</span></p></li>
<li><p><span class="guilabel">Standard</span> ツールバー の <span class="guilabel">Insert Chart</span> を押す</p></li>
</ul>
<p>Calc がピボットテーブルを検出し、<span class="guilabel">Chart Wizard</span> が開く。<span class="guilabel">Chart Wizard</span> を使用して、ピボットチャートの図表型と図表要素を選択可能だ。このウィザードは通常のグラフに対応するそれと似ているが、ピボットチャートの場合、データ範囲とデータ系列を定義する手順が無効になっている。</p>
<p>ウィザードの最初の手順段階では、図表型を選択し、通常の図表と同じオプションが利用できる。</p>
<p>第二段階は図表要素を選択することであり、これらは通常の図表と同様だ。</p>
<p><span class="guilabel"><span class="accelerator">F</span>inish</span> ボタン を押してウィザードを閉じ、ピボットチャートを作成する。</p>
</section>
<section id="editing-a-pivot-chart">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">Editing a pivot chart</a><a class="headerlink" href="#editing-a-pivot-chart" title="Link to this heading">¶</a></h3>
<p>ピボットチャートを作成した後、それを移動したり、寸法を変更したり、見てくれを改善したいことがある。Calc にはグラフの種類、グラフ要素、フォント、色、その他多くのオプションを変更するためのツールが搭載されている。ピボットチャートで使用できる機能は、通常のチャートで使用できる機能と同じなので、<a class="reference internal" href="calc03.html"><span class="doc">Chapter 3, Creating Charts and Graphs</span></a> を見ろ。</p>
</section>
<section id="updating-a-pivot-chart">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">Updating a pivot chart</a><a class="headerlink" href="#updating-a-pivot-chart" title="Link to this heading">¶</a></h3>
<p>ピボットテーブルの原データが変更された場合は、ピボットテーブルを更新すると、ピボットチャートもそれに応じて更新される。ピボットテーブル（すなわちピボットチャート）を更新する方法は <a class="reference internal" href="#calc09-anchor-refresh"><span class="std std-ref">Updating (refreshing) changed values</span></a> を見ろ。</p>
</section>
<section id="filtering-a-pivot-chart">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">Filtering a pivot chart</a><a class="headerlink" href="#filtering-a-pivot-chart" title="Link to this heading">¶</a></h3>
<p>ピボットチャートから不要なデータを削除するには絞り込みを使え。</p>
<p>ピボットテーブルに適用される絞り込みはすべて、連動しているピボットチャートにも等しく影響する。ピボットテーブルの多様な絞り込みの仕組みについては
<a class="reference internal" href="#calc09-anchor-filtering"><span class="std std-ref">Filtering</span></a> を見ろ。</p>
<p>ピボットチャートのボタンには関連するポップアップ操作があることを示す▼がある。絞り込みが適用されている場合、この▼は黒から青に変わる。ピボットチャートボタンはチャートをダブルクリックすると操作可能になり、チャートの周囲に灰色の枠が表示される。この操作によりピボットチャートは編集モードになる。</p>
<p>ピボットチャートの上部にある絞り込みフィールドボタンをクリックすると簡素なダイアログが表示される。これを使ってピボットテーブル・チャートに適用される絞り込みを変更する。ボタンの凡例の右側の部分には <a class="reference internal" href="#calc09-anchor-filtering-status"><span class="std std-ref">絞り込み状態</span></a> が示される。</p>
<p>ピボットチャートの下部と右側にある、▼を含むボタンをクリックすると、並べ替えと絞り込みのダイアログにアクセスできる。これを使用して、ピボットテーブル・チャートに適用される並べ替えおよび絞り込みを変更する。</p>
</section>
<section id="deleting-a-pivot-chart">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">Deleting a pivot chart</a><a class="headerlink" href="#deleting-a-pivot-chart" title="Link to this heading">¶</a></h3>
<p>ピボットチャートを削除するには、チャートを選択状態にして <kbd class="kbd docutils literal notranslate">Delete</kbd> を押せ。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ピボットチャートを削除しても関連するピボットテーブルに影響はない。</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>関連付けられたピボットチャートがあるピボットテーブルを削除すると、ピボットチャートも削除される。このとき、ピボットテーブルの削除を確認するダイアログボックスが表示される。</p>
</div>
</section>
</section>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc08.html" title="Previous">Calc Guide Chapter 8, Using Formulas and Functions ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Calc Guide 読書ノート</a>
        </li>
        <li>
          <a href="calc10.html" title="Next">Calc Guide Chapter 10, Data Analysis ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="../../index.html" title="読書ノート Home"><img src="../../_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>