<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Calc Guide Chapter 9 Using Pivot Tables ノート &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=1a9a5cd9" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=5a6f99c4"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Calc Guide Chapter 10 Data Analysis ノート" href="calc10.html" />
    <link rel="prev" title="Calc Guide Chapter 8 Using Formulas and Functions ノート" href="calc08.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc08.html" title="Previous document">Calc Guide Chapter 8 Using Formulas and Functions ノート</a>
        </li>
        <li>
          <a href="calc10.html" title="Next document">Calc Guide Chapter 10 Data Analysis ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="calc-guide-chapter-9-using-pivot-tables">
<h1>Calc Guide Chapter 9 Using Pivot Tables ノート<a class="headerlink" href="#calc-guide-chapter-9-using-pivot-tables" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#the-pivot-table-layout-dialog" id="id2">The Pivot Table Layout dialog</a></p></li>
<li><p><a class="reference internal" href="#working-with-the-results-of-the-pivot-table" id="id3">Working with the results of the pivot table</a></p></li>
<li><p><a class="reference internal" href="#using-pivot-table-results-elsewhere" id="id4">Using pivot table results elsewhere</a></p></li>
<li><p><a class="reference internal" href="#using-pivot-charts" id="id5">Using pivot charts</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>ピボットテーブルは、大量のデータを簡単に組み合わせ、比較、分析、要約するためのツールだ。これを使用すると、ソースデータのさまざまな概要や関心分野の詳細を表示したり、報告書を作成したりできる。</p>
<p>ピボットテーブルで作業するには、行と列で構成される、データベースのテーブルに似た生データの一覧が必要だ。フィールド名は一覧の最初の行だ。</p>
<p>ピボットテーブルを作成するコマンドは次のいずれか：</p>
<ul class="simple">
<li><p>セルが選択されている状態で、メニューバーの <span class="menuselection"><span class="accelerator">I</span>nsert ‣ Pi<span class="accelerator">v</span>ot
Table…</span> を実行</p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">P</span>ivot Table ‣ <span class="accelerator">I</span>nsert or Edit…</span> を実行</p></li>
<li><p><span class="guilabel">Standard</span> ツールバーの <span class="guilabel">Insert or Edit Pivot Table</span> 図像を押す</p></li>
</ul>
<p><span class="guilabel">Select Source</span> ダイアログが開く。選択されているセル領域で良ければ次へ進め。</p>
</section>
<section id="the-pivot-table-layout-dialog">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">The Pivot Table Layout dialog</a><a class="headerlink" href="#the-pivot-table-layout-dialog" title="Permalink to this heading">¶</a></h2>
<p>ピボットテーブルの機能は <span class="guilabel">Pivot Table Layout</span> ダイアログとスプレッドシートでの結果の操作で管理する。</p>
<ul class="simple">
<li><p>レイアウトを選択するには <span class="guilabel"><span class="accelerator">A</span>vailable Fields</span> 欄から他の四欄にフィールドをドラッグ＆ドロップする。</p></li>
<li><p>逆に、フィールドを四欄から削除する場合、項目をドラッグ＆ドラップで
<span class="guilabel"><span class="accelerator">A</span>vailable Fields</span> に戻す。</p></li>
</ul>
<p><span class="guilabel"><span class="accelerator">D</span>ata Fields</span> 欄には最低一つはフィールドが必要だ。</p>
<ul class="simple">
<li><p>上級者はここにフィールドを複数使用する。</p></li>
<li><p>当欄のフィールドには、例えば <code class="docutils literal notranslate"><span class="pre">SUM</span></code> などの集計関数が使用される。</p></li>
</ul>
<p><span class="guilabel"><span class="accelerator">R</span>ow Firlds</span> と <span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span> は、結果がどのグループからソートされるかを示す。</p>
<ul class="simple">
<li><p>行または列の小計を得るために、一度にフィールドが複数使用される場合が多い。</p></li>
<li><p>フィールドの順序は、全体的なものから特定のものへの合計の順序を与える。</p></li>
</ul>
<p><span class="guilabel"><span class="accelerator">F</span>ilters</span> 欄に配置されたフィールドは、ドロップダウンリストとして結果のピボットテーブルの上部に表示される。</p>
<p><span class="guilabel">Col<span class="accelerator">u</span>mn Fields</span> に最初から入っている <span class="guilabel">Data</span> は使うつもりがなくても、自分で追加した項目の下に移動させておけ。</p>
<p>ダイアログの <span class="guilabel">O<span class="accelerator">p</span>tions</span> をクリックするとチェックボックスが複数現れる。好みで。</p>
<p>ダイアログの <span class="guilabel">Source and Destination</span> をクリックすると、ピボットテーブルの入出力場所を編集可能な入力欄が現れる。これを使えば新シートに表を生成しないようにできる。</p>
<hr class="docutils" />
<p>フィールドの設定を変更するには、ダイアログの四欄内にある対象フィールドをダブルクリックしろ。<span class="guilabel">Data Field</span> ダイアログが開く。</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">D</span>ata Fields</span> 欄とそれ以外でダイアログの内容が若干異なる。</p></li>
<li><p><span class="guilabel">Function</span> 欄では <span class="guilabel">Sum</span> などの集計関数が選択可能だ。</p></li>
<li><p><span class="guilabel">Subtotals</span> をオンにして小計を表示させることも可能。試すときにはマニュアルのように行フィールドを二つ以上指定するとわかりやすい。</p></li>
</ul>
<p>ダイアログの <span class="guilabel"><span class="accelerator">O</span>ptions…</span> ボタンで開くダイアログボックスで、さらなる表示周りの項目を指定可能。</p>
<ul class="simple">
<li><p><span class="guilabel">Compact Layout</span> オプションが魅力的だが、日付の書式が保存されないようで困る。</p></li>
</ul>
</section>
<section id="working-with-the-results-of-the-pivot-table">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Working with the results of the pivot table</a><a class="headerlink" href="#working-with-the-results-of-the-pivot-table" title="Permalink to this heading">¶</a></h2>
<p>ピボットテーブル上で <span class="guilabel">Pivot Table Layout</span> ダイアログを開いて、フィールドをドラッグ＆ドロップし直せば、表のレイアウトを容易に変更可能だ。そして、ピボットテーブルの結果ビューでも操作可能なものがある。それらしい UI 要素をマウスでドラッグして試して覚えろ。</p>
<ul class="simple">
<li><p>フィールドを列と行を変更するようにドラッグする</p></li>
<li><p>フィールドを表の外側にドラッグして削除する</p></li>
</ul>
<p>TODO: グループ化</p>
<hr class="docutils" />
<p>ピボットテーブルの結果は、列および行の区分が昇順で表示されるように並べ替えられる。下三角の印から察せられるように、この順序を変更することが可能だ。</p>
<ul class="simple">
<li><p>下三角をクリックすると、ソートオプションとフィルター一覧からなるミニウィンドウが開く。</p></li>
<li><p>先述の <span class="guilabel">Data Field Options</span> ダイアログでソート種別を昇順、降順、辞書式から指定可能。</p></li>
</ul>
<hr class="docutils" />
<p><span class="guilabel"><span class="accelerator">E</span>nable drill to details</span> をオンにしていると、ピボットテーブル内の列内セルをダブルクリックすると <span class="guilabel">Show Details</span> ダイアログボックスを開くようになる。</p>
<hr class="docutils" />
<p>ピボットテーブル全体に作用するフィルターは、表分析を元データの部分集合に制限する機能だ。</p>
<p>フィルターフィールドボタンに隣接するテキストは、絞り込み状態を示す。</p>
<ul class="simple">
<li><p>何も絞られていない場合は <span class="guilabel">- all -</span></p></li>
<li><p>全てではないが複数の項目が絞られる場合は <span class="guilabel">- multiple -</span></p></li>
<li><p>その値だけが絞られる場合はその値</p></li>
</ul>
<hr class="docutils" />
<p>ピボットテーブルを作成した後では元データを変更しても表は自動的に更新されない。基こういう場合はピボットテーブルを手動で更新する必要がある。</p>
<p>更新するにはピボットテーブルをクリックして次のいずれかを実行する：</p>
<ul class="simple">
<li><p>メインメニューから <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">P</span>ivot Table ‣ <span class="accelerator">R</span>efresh</span></p></li>
<li><p>右クリックメニューから <span class="menuselection"><span class="accelerator">R</span>efresh</span></p></li>
</ul>
<p>元データのレコードが増えたなどの場合には、ピボットテーブルのレイアウトダイアログの <span class="guilabel">Source</span> 欄で範囲を変更することで表を更新しろ。面倒な場合にはピボットテーブル全体を作り直せ。</p>
<hr class="docutils" />
<p>ピボットテーブルのセル書式設定は自動で決まる。サイドバー <span class="guilabel">Styles</span> で言うところの次が適用されている：</p>
<ul class="simple">
<li><p>Pivot Table Category</p></li>
<li><p>Pivot Table Corner</p></li>
<li><p>Pivot Table Field</p></li>
<li><p>Pivot Table Result</p></li>
<li><p>Pivot Table Title</p></li>
<li><p>Pivot Table Value</p></li>
</ul>
<p>カスタマイズしたければ、このスタイルを <span class="menuselection"><span class="accelerator">E</span>dit Style…</span> すればいい。</p>
<hr class="docutils" />
<p>ピボットテーブルを削除する方法は次のいずれかを実行する：</p>
<ul class="simple">
<li><p>メインメニューから <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">P</span>ivot Table ‣ <span class="accelerator">D</span>elete</span></p></li>
<li><p>右クリックメニューから <span class="menuselection"><span class="accelerator">D</span>elete</span></p></li>
</ul>
<p>ピボットテーブル専用シートを割り当てている場合には、シート丸ごと削除でもいい。</p>
</section>
<section id="using-pivot-table-results-elsewhere">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Using pivot table results elsewhere</a><a class="headerlink" href="#using-pivot-table-results-elsewhere" title="Permalink to this heading">¶</a></h2>
<p>関数 <code class="docutils literal notranslate"><span class="pre">GETPIVOTDATA</span></code> というものがある。ピボットテーブルの結果をスプレッドシート内の別の場所で再利用する場合に、数式で使用可能。出番が来たら調べる。</p>
</section>
<section id="using-pivot-charts">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Using pivot charts</a><a class="headerlink" href="#using-pivot-charts" title="Permalink to this heading">¶</a></h2>
<p>ピボットチャートはピボットテーブルの視覚的表現物だ。ピボットテーブルの出力からピボットチャートを作成でき、ピボットテーブルが変更された場合はピボットチャートも変更される。</p>
<p>ピボットチャートは汎用チャートの特化版だ。次のような特徴がある：</p>
<ul class="simple">
<li><p>テーブルの変化を追跡し、それに応じてチャートのデータ系列とデータ範囲を自動的に調整する。</p></li>
<li><p>チャートにはチャートボタンが備わっている。</p></li>
</ul>
<hr class="docutils" />
<p>ピボットチャートの作成方法は次のいずれか：</p>
<ul class="simple">
<li><p>メインメニュー <span class="menuselection"><span class="accelerator">I</span>nsert ‣ <span class="accelerator">C</span>hart…</span></p></li>
<li><p><span class="guilabel">Standard</span> ツールバーの <span class="guilabel">Insert Chart</span> を押す</p></li>
</ul>
<p><span class="guilabel">Chart Wizard</span> ダイアログボックスが開く。適宜設定。</p>
<hr class="docutils" />
<p>チャートボタン（下三角が示されているもの）でフィールド項目を絞り込む。</p>
<ul class="simple">
<li><p>元ピボットテーブルと連動している？</p></li>
<li><p>絞り込み機能はチャートのほうがむしろ有用かもしれない。</p></li>
</ul>
<hr class="docutils" />
<p>ピボットチャートを削除するには、チャートを選択状態にして <kbd class="kbd docutils literal notranslate">Del</kbd> を押せ。</p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc08.html" title="Previous document">Calc Guide Chapter 8 Using Formulas and Functions ノート</a>
        </li>
        <li>
          <a href="calc10.html" title="Next document">Calc Guide Chapter 10 Data Analysis ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../../_static/logos.png"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>