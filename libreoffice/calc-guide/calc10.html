<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Calc Guide Chapter 10 Data Analysis ノート &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=1a9a5cd9" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=5a6f99c4"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script async="async" src="../../_static/mathjax-v3.js?v=bf1ec211"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Calc Guide Chapter 11 Linking Data ノート" href="calc11.html" />
    <link rel="prev" title="Calc Guide Chapter 9 Using Pivot Tables ノート" href="calc09.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc09.html" title="Previous document">Calc Guide Chapter 9 Using Pivot Tables ノート</a>
        </li>
        <li>
          <a href="calc11.html" title="Next document">Calc Guide Chapter 11 Linking Data ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="calc-guide-chapter-10-data-analysis">
<h1>Calc Guide Chapter 10 Data Analysis ノート<a class="headerlink" href="#calc-guide-chapter-10-data-analysis" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#consolidating-data" id="id2">Consolidating data</a></p>
<ul>
<li><p><a class="reference internal" href="#consolidation-settings" id="id3">Consolidation settings</a></p></li>
<li><p><a class="reference internal" href="#consolidation-example" id="id4">Consolidation example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#creating-subtotals" id="id5">Creating subtotals</a></p>
<ul>
<li><p><a class="reference internal" href="#using-the-subtotal-function" id="id6">Using the <code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> function</a></p></li>
<li><p><a class="reference internal" href="#the-subtotals-tool" id="id7">The Subtotals tool</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-scenarios" id="id8">Using scenarios</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-scenarios" id="id9">Creating scenarios</a></p></li>
<li><p><a class="reference internal" href="#scenario-settings" id="id10">Scenario settings</a></p></li>
<li><p><a class="reference internal" href="#changing-scenarios" id="id11">Changing scenarios</a></p></li>
<li><p><a class="reference internal" href="#working-with-scenarios-using-the-navigator" id="id12">Working with scenarios using the Navigator</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-the-multiple-operations-tool" id="id13">Using the Multiple Operations tool</a></p>
<ul>
<li><p><a class="reference internal" href="#multiple-operations-with-one-formula-and-one-variable" id="id14">Multiple Operations with one formula and one variable</a></p></li>
<li><p><a class="reference internal" href="#calculating-with-several-formulas-simultaneously" id="id15">Calculating with several formulas simultaneously</a></p></li>
<li><p><a class="reference internal" href="#multiple-operations-with-two-variables" id="id16">Multiple operations with two variables</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-goal-seek" id="id17">Using Goal Seek</a></p>
<ul>
<li><p><a class="reference internal" href="#goal-seek-example" id="id18">Goal Seek example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-the-solver" id="id19">Using the Solver</a></p>
<ul>
<li><p><a class="reference internal" href="#solver-dialog" id="id20">Solver dialog</a></p></li>
<li><p><a class="reference internal" href="#solver-options" id="id21">Solver options</a></p></li>
<li><p><a class="reference internal" href="#solver-example" id="id22">Solver example</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-statistics-tools" id="id23">Using Statistics tools</a></p>
<ul>
<li><p><a class="reference internal" href="#sampling-tool" id="id24">Sampling tool</a></p></li>
<li><p><a class="reference internal" href="#descriptive-statistics-tool" id="id25">Descriptive Statistics tool</a></p></li>
<li><p><a class="reference internal" href="#analysis-of-variance-anova-tool" id="id26">Analysis of Variance (ANOVA) tool</a></p></li>
<li><p><a class="reference internal" href="#correlation-tool" id="id27">Correlation tool</a></p></li>
<li><p><a class="reference internal" href="#covariance-tool" id="id28">Covariance tool</a></p></li>
<li><p><a class="reference internal" href="#exponential-smoothing-tool" id="id29">Exponential Smoothing tool</a></p></li>
<li><p><a class="reference internal" href="#moving-average-tool" id="id30">Moving Average tool</a></p></li>
<li><p><a class="reference internal" href="#regression-tool" id="id31">Regression tool</a></p></li>
<li><p><a class="reference internal" href="#paired-t-test-tool" id="id32">Paired t-test tool</a></p></li>
<li><p><a class="reference internal" href="#f-test-tool" id="id33">F-test tool</a></p></li>
<li><p><a class="reference internal" href="#z-test-tool" id="id34">Z-test tool</a></p></li>
<li><p><a class="reference internal" href="#chi-square-test-tool-test-of-independence" id="id35">Chi-Square Test tool (Test of Independence)</a></p></li>
<li><p><a class="reference internal" href="#fourier-analysis-tool" id="id36">Fourier Analysis tool</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>関連機能はメインメニュー <span class="menuselection"><span class="accelerator">D</span>ata</span> と <span class="menuselection"><span class="accelerator">T</span>ools</span> に分散している。</p>
</section>
<section id="consolidating-data">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Consolidating data</a><a class="headerlink" href="#consolidating-data" title="Permalink to this heading">¶</a></h2>
<p>複数のワークシートに散在しているデータを結合して集計する機能として
<span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">C</span>onsolidate…</span> コマンドがある。これを実行すると
<span class="guilabel">Consolidate</span> ダイアログが開く。この使い方が自力ではわからない。</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">F</span>unction</span> ドロップダウンリストから所望の集計関数を指定する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">S</span>ource data ranges</span> 欄を指定する。それから <span class="guilabel">Add</span> ボタンを押して選択範囲を <span class="guilabel">Consolidation ranges</span> 一覧に追加する。この追加処理を所望の範囲をカバーするまで反復する。</p></li>
<li><p><span class="guilabel">Copy results <span class="accelerator">t</span>o</span> 欄を指定する。</p></li>
</ul>
<p><span class="guilabel">OK</span> を押して処理を実行する。指定した場所にある値を集計関数に入力として渡して評価し、指定した場所に出力する。</p>
<section id="consolidation-settings">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Consolidation settings</a><a class="headerlink" href="#consolidation-settings" title="Permalink to this heading">¶</a></h3>
<p>ダイアログ上のプラスマークをクリックすると、詳細オプション項目群が現れる。</p>
<p>ラベル系オプションは選択範囲それぞれの最初の列や最初の行がフィールドである場合、かつそれらがすべて一致している場合にはオンにするのが自然だろう。</p>
<p><span class="guilabel"><span class="accelerator">L</span>ink to source data</span> をオンにすると、<span class="guilabel"><span class="accelerator">S</span>ource data ranges</span>
の値が変化すると <span class="guilabel">Copy results <span class="accelerator">t</span>o</span> の値も自動的に更新される。</p>
</section>
<section id="consolidation-example">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Consolidation example</a><a class="headerlink" href="#consolidation-example" title="Permalink to this heading">¶</a></h3>
<p>ガイド本文のデータを手で再現して Consolidation コマンドの動作を体で理解しろ。</p>
<blockquote>
<div><p>The source ranges and target range are saved as part of the document. If you
later open a document with consolidated ranges, they will still be available
in the Consolidation ranges list of the Consolidate dialog.</p>
</div></blockquote>
</section>
</section>
<section id="creating-subtotals">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Creating subtotals</a><a class="headerlink" href="#creating-subtotals" title="Permalink to this heading">¶</a></h2>
<p>小計を得る方法は二つだ：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> 関数</p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Sub<span class="accelerator">t</span>otals…</span> コマンド</p></li>
</ul>
<section id="using-the-subtotal-function">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Using the <code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> function</a><a class="headerlink" href="#using-the-subtotal-function" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> 関数は Function Wizard の数学区分とサイドバーの関数デッキの下に一覧されている。本関数はわずかな区分だけで使用する場合に効果的だ。</p>
<p>ガイド本文のデータを手で再現して Sales Value の列の下のセルに <code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> 呼び出しを埋める。急所は、自動フィルターで例えば Employee を Brigitte に絞り込むと、それに応じて <code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> の値が更新されることにある。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> の第一引数の謎数値が計算の種類を指す。</p></li>
<li><p>列の下に出力セルを設けると、当然だが自動フィルター適用時にそれが隠れる。
<code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> の動作を試すときにはどう絞り込んでも隠れないセルに書け。</p></li>
</ul>
</section>
<section id="the-subtotals-tool">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">The Subtotals tool</a><a class="headerlink" href="#the-subtotals-tool" title="Permalink to this heading">¶</a></h3>
<p>コマンドのほうはラベル付きの列に配置された高々三つの配列の小計を実行可能だ。さらに、自動フィルターを適用し、手作業で絞り込む必要がないように機能する。</p>
<p>対象データ全体を選択（列見出しラベル含む）してからメインメニュー
<span class="menuselection"><span class="accelerator">D</span>ata ‣ Sub<span class="accelerator">t</span>otals…</span> を実行する。<span class="guilabel">Subtotals</span> ダイアログボックスが開く。項目を指定する：</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">G</span>roup by</span> には小計グループフィールドを指定する</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>alculate subtotals for</span> には数値計算の対象フィールドを指定する</p></li>
<li><p>必要なら <span class="guilabel">2nd Group</span>, <span class="guilabel">3rd Group</span> タブの内容も指定する</p></li>
</ul>
<hr class="docutils" />
<p>実行直後、ワークシート行番号列の左にアウトラインが現れる。このアウトラインは小計の階層構造を表す。</p>
<ul class="simple">
<li><p>アウトラインの上部にある番号</p></li>
<li><p>またはプラス <span class="guilabel">+</span> とマイナス <span class="guilabel">-</span> 記号</p></li>
</ul>
<p>を使用して、階層内の別階層データ表示を切り替える。アウトラインの表示切り替えには次のコマンドがある：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">G</span>roup and Outline ‣ <span class="accelerator">R</span>emove Outline</span></p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">G</span>roup and Outline ‣ <span class="accelerator">A</span>utoOutline</span></p></li>
</ul>
<p>アウトラインの左側ほど総計の、右側ほど小計の度合いがそれぞれ強まる。</p>
<hr class="docutils" />
<p><span class="guilabel">Options</span> タブに小計オプションがいろいろある。</p>
<hr class="docutils" />
<p><span class="guilabel">Subtotals</span> ダイアログボックスで、</p>
<ul class="simple">
<li><p>現在のタブで行った変更を元に戻すには <span class="guilabel">Reset</span> ボタンを押す。</p></li>
<li><p>作成済みの小計を削除するには <span class="guilabel">Remove</span> ボタンを押す。</p></li>
</ul>
</section>
</section>
<section id="using-scenarios">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Using scenarios</a><a class="headerlink" href="#using-scenarios" title="Permalink to this heading">¶</a></h2>
<p>計算に対する異なる条件の影響を検査する必要があるが、反復する手動データ入力を処理したくない場合に有用な機能だ。</p>
<section id="creating-scenarios">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Creating scenarios</a><a class="headerlink" href="#creating-scenarios" title="Permalink to this heading">¶</a></h3>
<p>対象セル（最低二つ）を選択してメインメニュー <span class="menuselection"><span class="accelerator">T</span>ools ‣
Sc<span class="accelerator">e</span>nario…</span> を実行すると <span class="guilabel">Create Scenario</span> ダイアログボックスが開く。</p>
<ul class="simple">
<li><p>シナリオは通常複数作成するので、名前はまともに付けろ。</p></li>
<li><p>どの計算がシナリオに依存しているかを追跡するには、シナリオセル上でメインメニュー <span class="menuselection"><span class="accelerator">T</span>ools ‣ <span class="accelerator">D</span>etective ‣ <span class="accelerator">T</span>race Depenendents</span> を実行すると良い。</p></li>
<li><p>対象セルはどこにあってもかまわない。散在していてもいい。</p></li>
</ul>
</section>
<section id="scenario-settings">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Scenario settings</a><a class="headerlink" href="#scenario-settings" title="Permalink to this heading">¶</a></h3>
<p><span class="guilabel">Create Scenario</span> ダイアログボックスのオプション項目はそれほど使わない？</p>
<p><span class="guilabel"><span class="accelerator">D</span>isplay border</span> をオフにするとワークシート内で紛れる。オンにするべきだろう。</p>
</section>
<section id="changing-scenarios">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Changing scenarios</a><a class="headerlink" href="#changing-scenarios" title="Permalink to this heading">¶</a></h3>
<p>シナリオ関連の記述では、ワークシートとセルの保護という言葉が何度も述べられていることに注意。次の四項目のオンオフ状態の組み合わせで、変更が許可されるかどうかが決まる：</p>
<ul class="simple">
<li><p>ワークシートに対する保護</p></li>
<li><p>シナリオセルに対する保護</p></li>
<li><p><span class="guilabel">Copy <span class="accelerator">b</span>ack</span></p></li>
<li><p><span class="guilabel"><span class="accelerator">P</span>revent changes</span></p></li>
</ul>
<p>いちばんわかりやすいのはワークシート保護がオフの場合だ。シナリオセルの値は変更可能で、シナリオは <span class="guilabel">Copy <span class="accelerator">b</span>ack</span> の設定次第で更新可能性が決まる。残りの組み合わせはガイド本文を参照するしかない。</p>
</section>
<section id="working-with-scenarios-using-the-navigator">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Working with scenarios using the Navigator</a><a class="headerlink" href="#working-with-scenarios-using-the-navigator" title="Permalink to this heading">¶</a></h3>
<p>ワークシートにシナリオを追加した後、特定のシナリオを表示するには、まず
<span class="guilabel">Navigator</span> ダイアログボックスを次のいずれかの方法で開く：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">V</span>iew ‣ Na<span class="accelerator">v</span>igator</span></p></li>
<li><p><kbd class="kbd docutils literal notranslate">F5</kbd></p></li>
</ul>
<p>それから <span class="guilabel">Scenarios</span> 図像をクリックしろ。</p>
<p>現在のワークシートにシナリオを適用するには、当該シナリオ名をダブルクリックしろ。動作が遅いのが気になる。</p>
<p>シナリオを削除する方法は次のいずれか：</p>
<ul class="simple">
<li><p>シナリオ名の右クリックメニューから <span class="menuselection"><span class="accelerator">D</span>elete</span> を実行する。</p></li>
<li><p>シナリオ名を選択し <kbd class="kbd docutils literal notranslate">Del</kbd> を押す。</p></li>
</ul>
<p>シナリオを編集するには、シナリオ名の右クリックメニューから
<span class="menuselection"><span class="accelerator">P</span>roperties…</span> を実行する。シナリオ作成時のものとよく似た
<span class="guilabel">Edit Scenario</span> ダイアログボックスが開く。</p>
</section>
</section>
<section id="using-the-multiple-operations-tool">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Using the Multiple Operations tool</a><a class="headerlink" href="#using-the-multiple-operations-tool" title="Permalink to this heading">¶</a></h2>
<p>データを単一ワークシートにまとめ、数式、変数、表の範囲をラベルで識別するようにすると、このコマンドは使いやすいとある。</p>
<section id="multiple-operations-with-one-formula-and-one-variable">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Multiple Operations with one formula and one variable</a><a class="headerlink" href="#multiple-operations-with-one-formula-and-one-variable" title="Permalink to this heading">¶</a></h3>
<p>一数式一変数の場合が基本だ。<span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">M</span>ultiple Operations…</span>
コマンドを実行する準備手順はこうだ：</p>
<ol class="arabic simple">
<li><p>ワークシートのセルに、数式と、それが用いる変数を一つ以上入力する。</p></li>
<li><p>同じワークシートで、列または行を占めるセル範囲（変数範囲）に値を入力する。</p></li>
<li><p>今定義した変数範囲と、それに続く隣接した空セルの両方を含む範囲を選択する。変数範囲がどのように配列されているかによって、これらの空セルは、右の列（範囲が列の場合）か、すぐ下の行（行の場合）のいずれかになる。</p></li>
</ol>
<p>これで <span class="guilabel">Multiple Operations</span> ダイアログボックスが開く。</p>
<ul class="simple">
<li><p><span class="guilabel">Formulas</span> には上述の最初手順で定義した（数式への）セル参照を指定する。</p></li>
<li><p>上述の変数範囲が列型ならば <span class="guilabel"><span class="accelerator">C</span>olumn input cell</span> に、行型ならば
<span class="guilabel"><span class="accelerator">R</span>ow input cell</span> に使用したい変数へのセルを指定する。</p></li>
</ul>
<p><span class="guilabel"><span class="accelerator">O</span>K</span> をクリックして実行する。指定の空セルに結果が得られる。各結果値は、それに隣接する変数値に対応し、一緒になって結果表を形成する。</p>
<hr class="docutils" />
<p>ガイド本文の例の状況：</p>
<ul class="simple">
<li><p>B1: 単価 10 ドルで販売する玩具を生産しているとする</p></li>
<li><p>B2: 各項目の製造費用は 2 ドル</p></li>
<li><p>B3: 年間固定コストは 10,000 ドル</p></li>
<li><p>B4: 販売数量の最初の見積もりは 2,000 個</p></li>
</ul>
<p>だとしている。問題は、収支を均衡させるために何個の玩具を販売する必要があるか、だ。この問題を解く手順はこうなる：</p>
<ol class="arabic simple">
<li><p>セル B5 に数式 <code class="docutils literal notranslate"><span class="pre">=B4*(B1-B2)-B3</span></code> を入力する。単純な一次式だ。</p></li>
<li><p>例えばセル D2:D11 に 500 から 5000 までの値を 500 刻みで入力しておく。</p></li>
<li><p>セル D2:E11 を選択して <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">M</span>ultiple Operations…</span> を実行する</p></li>
</ol>
<p>ダイアログボックスの指定はこのようにする：</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">F</span>ormulas</span> にはセル B5 を指定</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>olumn input cell</span> にはセル B4 を指定</p></li>
</ul>
<p><span class="guilabel"><span class="accelerator">O</span>K</span> をクリックすると空セルが埋まり、損益分岐が目視確認可能になる。</p>
</section>
<section id="calculating-with-several-formulas-simultaneously">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Calculating with several formulas simultaneously</a><a class="headerlink" href="#calculating-with-several-formulas-simultaneously" title="Permalink to this heading">¶</a></h3>
<p>数式を複数にすることも可能だ。</p>
<ul class="simple">
<li><p>数式の個数ぶんだけ対応する列・行を出力表に用意する必要がある。</p></li>
<li><p>たとえば、数式 A, B, C をこの順序で一行に並べた場合、出力は表の一列目、二列目、三列目に A, B, C の順で格納される。</p></li>
</ul>
<hr class="docutils" />
<p>本文では、直前の販売データの例に年間全体の利益に加え、販売した商品ごとの年間利益を計算する問題を解いている。</p>
<ul class="simple">
<li><p>セル C5 に <code class="docutils literal notranslate"><span class="pre">=B5/B4</span></code> を入力</p></li>
<li><p>セル D2:F11 を選択して <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">M</span>ultiple Operations…</span> を実行する</p></li>
</ul>
<p>ダイアログボックスの指定はこのようにする：</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">F</span>ormulas</span> にはセル B5:C5 を指定</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>olumn input cell</span> にはセル B4 を指定（変わらず）</p></li>
</ul>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p><span class="guilabel"><span class="accelerator">C</span>olumn input cell</span> の指定を間違いやすい。</p>
</div>
</section>
<section id="multiple-operations-with-two-variables">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Multiple operations with two variables</a><a class="headerlink" href="#multiple-operations-with-two-variables" title="Permalink to this heading">¶</a></h3>
<p>二変数で Multiple Operations を使用すると、二次元の結果表が得られる。変数それぞれが表の次元の一つを定義し、両方の変数の交代値がそれぞれ表の行見出しと列見出しになる。表の各セルは、行見出し値と列見出し値の個別の対に対応する。</p>
<p>順序が重要であって、<span class="guilabel"><span class="accelerator">C</span>olumn input cell</span> 欄は行見出しの値に対応し、<span class="guilabel"><span class="accelerator">R</span>ow input cell</span> 欄は列見出しの値に対応する。</p>
<p>二変数を使用する場合、Multiple Operations は複数の数式では機能しない。</p>
<hr class="docutils" />
<p>最後の例では販売数と販売単価を変数にする。手順の変更点をまとめる：</p>
<ul class="simple">
<li><p>セル E1:H1 に直に値 8, 10, 15, 20 を入力する</p></li>
<li><p>セル D1:H11 を選択してコマンドを起動</p></li>
</ul>
<p>ダイアログボックスの指定が増える：</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">R</span>ow input cell</span> に B1 を指定する。これにより、8, 10, 15, 20 が B1
で定義された単価変数と連動する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>olumn input cell</span> には従来どおり B4 を指定する。これは 500, …,
5000 のセルが販売量変数 B4 に連動することを意味する。</p></li>
</ul>
</section>
</section>
<section id="using-goal-seek">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Using Goal Seek</a><a class="headerlink" href="#using-goal-seek" title="Permalink to this heading">¶</a></h2>
<p>Goal Seek は、出力を与えて逆算して、どのような入力ならばその結果を生み出すかを発見する手法の一つだ。欲しい結果はすでに知っているが、それに到達する方法や、条件を変更した場合にどのように変化するかなどを見出すのに有用な機能だ。</p>
<section id="goal-seek-example">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Goal Seek example</a><a class="headerlink" href="#goal-seek-example" title="Permalink to this heading">¶</a></h3>
<p>本文では年利計算を例に説明している。年利は資本金、利息期間、金利の積で与えられる。</p>
<ul class="simple">
<li><p>金利 7.5% (B3)</p></li>
<li><p>期間 1 (B2)</p></li>
</ul>
<p>が一定であるとする。15,000 ドルの年間益を達成するために必要な投資資本がいくらか知りたい。そこでまずは初期資本を 100,000 ドル (B1) と見積もるという話だ。ワークシート上での手順例：</p>
<ol class="arabic simple">
<li><p>セル B1, B2, B3 に上述の定数を入力する</p></li>
<li><p>セル B4 に数式 <code class="docutils literal notranslate"><span class="pre">=B1*B2*B3</span></code> を入力する</p></li>
<li><p>メインメニューから <span class="menuselection"><span class="accelerator">T</span>ools ‣ <span class="accelerator">G</span>oal Seek…</span> を実行する</p></li>
</ol>
<p><span class="guilabel">Goal Seek</span> ダイアログボックス上での指定例：</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">F</span>ormula cell</span> に年間益であるセル B4 を指定する</p></li>
<li><p><span class="guilabel"><span class="accelerator">V</span>ariable cell</span> に初期資本であるセル B1 を指定する</p></li>
<li><p><span class="guilabel"><span class="accelerator">T</span>arget value</span> に希望額である 15000 を入力する</p></li>
</ul>
<p><span class="guilabel"><span class="accelerator">O</span>K</span> を押すとメッセージボックスが開き、解が得られる。ここで
<span class="guilabel"><span class="accelerator">Y</span>es</span> で終わると、変数セル B1 が解で上書きされる。</p>
<p>Goal Seek アルゴリズムは、内部的に数回反復して目標に収束する。 計算が失敗した場合、失敗を報告するメッセージボックスが開く（最も近い値を変数セルに挿入するかどうかを選択可能）。</p>
</section>
</section>
<section id="using-the-solver">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Using the Solver</a><a class="headerlink" href="#using-the-solver" title="Permalink to this heading">¶</a></h2>
<p>数理計画問題や最適化問題を解くことができる。与えた制約条件の下で関数を最小化したり最大化したりする問題だ。</p>
<p>Calc には現在、数種類の solver が備わっている。</p>
<p>問題を解くのに solver を用いるのであれば、問題を次のように定式化しないといけない。通常、目的は制約条件を満たし、目的関数の結果を最大化または最小化する決定変数の値を見つけることだ。</p>
<dl class="simple">
<dt>決定変数</dt><dd><p><span class="math notranslate nohighlight">\(n\)</span> 個の非負変数 <span class="math notranslate nohighlight">\({x_1, ..., x_n}\)</span> の集合</p>
</dd>
<dt>制約</dt><dd><p>決定変数を含む一次等式または不等式の集合</p>
</dd>
<dt>目的関数</dt><dd><p>決定変数を含む一次式</p>
</dd>
</dl>
<p>Solver 設定は ODS ファイルに保存されて、各タブは独自のモデルを持つことが可能だ。</p>
<section id="solver-dialog">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Solver dialog</a><a class="headerlink" href="#solver-dialog" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">T</span>ools ‣ Sol<span class="accelerator">v</span>er…</span> 実行でダイアログボックスを開く。JRE が無効の場合にはメッセージボックスが現れる。とりあえず <span class="guilabel"><span class="accelerator">N</span>o</span> で進んで様子見とする。</p>
<p><span class="guilabel">Solver</span> ダイアログボックスが開く。</p>
<ul class="simple">
<li><p>Solver 設定が完了したら <span class="guilabel"><span class="accelerator">S</span>olve</span> を押して値の調整と結果の計算を開始する。</p></li>
<li><p>やり直す場合には <span class="guilabel"><span class="accelerator">R</span>eset All</span> を押してダイアログボックス上をクリアする。</p></li>
</ul>
<p>DEPS Evolutionary Algorithm または SCO Evolutionary Algorithm を使用している場合、エンジンの実行は定期的に中断して <span class="guilabel">Solver Status</span> ダイアログボックスが開くことがある。</p>
<ul class="simple">
<li><p>このダイアログはエンジンの計算の現在の状態に関する診断情報を示すもので、専門家にとって興味がある。</p>
<ul>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> を押せばこのダイアログを閉じて計算を終了する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>ontinue</span> 押せば次のエンジン処理が中断するところまで待機する。</p></li>
</ul>
</li>
<li><p>ダイアログボックスの表示は <span class="guilabel">Solver Options</span> ダイアログボックスの
<span class="guilabel">Show enhanced solver status</span> をオフにすると生じない。</p></li>
</ul>
<p>成功裡に完了すると、<span class="guilabel">Solving Result</span> が開く。これにはボタンが二つある：</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">K</span>eep Result</span> を押せば結果を保存する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">R</span>estore Previous</span> を押せば結果を破棄して直前の値を復元する。</p></li>
</ul>
</section>
<section id="solver-options">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Solver options</a><a class="headerlink" href="#solver-options" title="Permalink to this heading">¶</a></h3>
<p><span class="guilabel">Solver dialog</span> 下部の <span class="guilabel">O<span class="accelerator">p</span>tions…</span> ボタンを押すと
<span class="guilabel">Options</span> ダイアログボックスが開き、エンジンそれぞれに関する設定を行える。</p>
</section>
<section id="solver-example">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Solver example</a><a class="headerlink" href="#solver-example" title="Permalink to this heading">¶</a></h3>
<p>10,000 ドルを投資信託二つに一年間投資するとする。</p>
<ul class="simple">
<li><p>ファンド X は金利 8% の低リスクファンドで、</p></li>
<li><p>ファンド Y は金利 12% の高リスクファンドだ。</p></li>
</ul>
<p>合計 1,000 ドルの利息を得るためには、それぞれのファンドにいくら投資すればよいか。この問題を solver を用いて解く。</p>
<p>ワークシートを本文のように埋めて <span class="menuselection"><span class="accelerator">T</span>ools ‣ Sol<span class="accelerator">v</span>er…</span> を実行。ダイアログを開く。</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">T</span>arget cell</span> には利子総額である B4 を指定</p></li>
<li><p>ラジオボタン <span class="guilabel"><span class="accelerator">V</span>alue of</span> を選択し、テキストボックスに得たい利息額である 1000 を入力</p></li>
<li><p><span class="guilabel"><span class="accelerator">B</span>y changing cells</span> にはファンド X への投資額である C2 を指定</p></li>
<li><p><span class="guilabel"><span class="accelerator">L</span>imiting conditions</span> を与える</p>
<ul>
<li><p>C2≦C4`: ファンド X への投資額が利用可能額を超えてはならない</p></li>
<li><p>C2≧0: ファンド X への投資額は非負でなければならない</p></li>
<li><p>C2 は整数である（便宜上）</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="using-statistics-tools">
<h2><a class="toc-backref" href="#id23" role="doc-backlink">Using Statistics tools</a><a class="headerlink" href="#using-statistics-tools" title="Permalink to this heading">¶</a></h2>
<p>メインメニュー <span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣</span> に統計分析コマンド各種が並んでいる。今見たら 13 コマンドもある。</p>
<section id="sampling-tool">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Sampling tool</a><a class="headerlink" href="#sampling-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">S</span>ampling…</span> コマンドは表から標本抽出して別の表を作成する。</p>
<ul class="simple">
<li><p>抽出はランダムに、または周期的になされる。</p></li>
<li><p>抽出は行単位で行われる。</p></li>
</ul>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>試してみるとテキストデータがゼロになるようだ？</p>
</div>
</section>
<section id="descriptive-statistics-tool">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Descriptive Statistics tool</a><a class="headerlink" href="#descriptive-statistics-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">D</span>escriptive Statistics…</span> コマンドは指定データ集合の主な統計的特性（平均、標準偏差、等々）の報告表を作成する。確率統計の教科書で出てくる概念と同じだろう。</p>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>こういうダイアログボックスが開くところから始まるコマンドは、実行直前にフィールドセルを含むデータ集合全体を選択状態にしておくと良い。</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Descriptive_statistics">Descriptive statistics - Wikipedia</a></p>
</div>
</section>
<section id="analysis-of-variance-anova-tool">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Analysis of Variance (ANOVA) tool</a><a class="headerlink" href="#analysis-of-variance-anova-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">A</span>nalysis of Variance (ANOVA)</span> コマンドは標本中の複数グループの平均を比較する。</p>
<p>実行するとダイアログボックスが開いて、<span class="guilabel"><span class="accelerator">O</span>K</span> を押すと分析するという流れだ。</p>
<ul class="simple">
<li><p>結果にセル領域を相当費やすので、<span class="guilabel"><span class="accelerator">R</span>esults to</span> の指定に気をつけろ。</p></li>
<li><p><span class="guilabel">Rows <span class="accelerator">p</span>er sample</span> UI は現在無効。</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Analysis_of_variance">Analysis of variance - Wikipedia</a></p>
</div>
</section>
<section id="correlation-tool">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Correlation tool</a><a class="headerlink" href="#correlation-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">C</span>orrelation…</span> コマンドは数値データの組の相関を計算し、相関係数を求める。</p>
<p>本書の例では数学、物理、生物の得点間の相関を検証するものということになる。出力を見ればどう理解すればいいかわかるだろう。</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Correlation">Correlation - Wikipedia</a></p>
</div>
</section>
<section id="covariance-tool">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Covariance tool</a><a class="headerlink" href="#covariance-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">C</span>ovariance…</span> コマンドは共分散、数値データセットが共にどれだけ変化するかを測定する。</p>
<p>ダイアログボックスの UI は相関係数コマンドと同じだ。</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Covariance">Covariance - Wikipedia</a></p>
</div>
</section>
<section id="exponential-smoothing-tool">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Exponential Smoothing tool</a><a class="headerlink" href="#exponential-smoothing-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics &gt; Exponential Smoothing…</span> コマンドは、平滑化された結果を生成するようにデータ集合をいじる。株式市場分析や標本測定などの分野で用いられる機能とのことだ。</p>
<p>ダイアログボックス上の減衰係数 <span class="guilabel"><span class="accelerator">S</span>moothing factor</span> はコマンド実行後でも対応するセルの値を編集することで結果を更新することが可能だ。</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Exponential_smoothing">Exponential smoothing - Wikipedia</a></p>
</div>
</section>
<section id="moving-average-tool">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">Moving Average tool</a><a class="headerlink" href="#moving-average-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">M</span>oving Average…</span> コマンドは時系列データ集合の移動平均を計算する。コマンドを実行するとダイアログボックスが開く。</p>
<ul class="simple">
<li><p><span class="guilabel"><span class="accelerator">T</span>rim input range to actual data content</span> をオンにすると、計算前に入力範囲を実際のデータ内容に刈り取ることを許可する。処理性能に影響する。</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Moving_average">Moving average - Wikipedia</a></p>
</div>
</section>
<section id="regression-tool">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">Regression tool</a><a class="headerlink" href="#regression-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">R</span>egression…</span> コマンドは独立変数複数個と従属変数一個からなるデータセットの線形回帰、対数回帰、累乗回帰のいずれかの分析を行う。</p>
<p>ダイアログボックス上では：</p>
<ul class="simple">
<li><p><span class="guilabel">Con<span class="accelerator">f</span>idence level</span> には信頼度数を 0 から 1 までの値で指定する。</p></li>
<li><p><span class="guilabel">Calc<span class="accelerator">u</span>late residuals</span> をオンにすると残差の計算を行う。傾きと切片の推定値とその統計量にしか興味がない場合に有益だ。</p></li>
</ul>
<p>出力については、例によってスペースをたくさん消費するので出力先指定に注意しろ。
Confidence level の値はワークシート上に分析結果が生じてからでも変更、更新可能だ。</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Regression_analysis">Regression analysis - Wikipedia</a></p>
</div>
</section>
<section id="paired-t-test-tool">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Paired t-test tool</a><a class="headerlink" href="#paired-t-test-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ Paired <span class="accelerator">t</span>-test…</span> コマンドは t 検定を実行する。関連する標本集合二つの母平均を比較し、それらの差を決定する。</p>
<p>ダイアログボックスは統計コマンドでよくある単純なものだ。</p>
<ul class="simple">
<li><p>出力表では、アルファと仮説平均差に異なる値を挿入可能。t 値各種は自動更新。</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Student's_t-test">Student’s t-test - Wikipedia</a></p>
</div>
</section>
<section id="f-test-tool">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">F-test tool</a><a class="headerlink" href="#f-test-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">F</span>-test…</span> コマンドは標本二つの F 検定を行う。母集団二つの分散が等しいという仮説を検定する。</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/F-test">F-test - Wikipedia</a></p>
</div>
</section>
<section id="z-test-tool">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Z-test tool</a><a class="headerlink" href="#z-test-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">Z</span>-test…</span> コマンドは標本二つの Z 検定を行う。帰無仮説を検定する。</p>
<p>ダイアログボックスで <span class="menuselection"><span class="accelerator">O</span>K</span> を押すだけでは検定は完了しない。各標本の Known Variance 欄を手動で埋める必要がある。本文の例を再現する場合は次を入力しろ：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">=VAR(A1:A13)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=VAR(B1:B13)</span></code></p></li>
</ul>
<p>Z 検定は標本数 30 を超える大きな標本に対してよりよく働く。</p>
<ul class="simple">
<li><p>Alpha と Hypothesized Mean Difference の入力に異なる値を挿入することも可能だ。後続の z 値と P 値が自動更新される。</p></li>
<li><p>選択した Alpha と適切な計算 P 値を比較する分析をしろ。これは片側検定か両側検定かによって異なる。計算 P 値が Alpha より小さければ仮説は棄却される。</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Z-test">Z-test - Wikipedia</a></p>
</div>
</section>
<section id="chi-square-test-tool-test-of-independence">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">Chi-Square Test tool (Test of Independence)</a><a class="headerlink" href="#chi-square-test-tool-test-of-independence" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ <span class="accelerator">C</span>hi-square Test…</span> コマンドは標本の
<span class="math notranslate nohighlight">\(\xi^2\)</span> 検定を計算し、測定値集合が対応する期待値集合にどの程度適合するかを決定する。</p>
<p>例によってワークシートの Alpha 値を手動で変更して、関連項目を自動更新することが可能だ。本コマンドでは Critical Value 欄がそうなる。</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Chi-squared_test">Chi-squared test - Wikipedia</a></p>
</div>
</section>
<section id="fourier-analysis-tool">
<h3><a class="toc-backref" href="#id36" role="doc-backlink">Fourier Analysis tool</a><a class="headerlink" href="#fourier-analysis-tool" title="Permalink to this heading">¶</a></h3>
<p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Statistics ‣ F<span class="accelerator">o</span>urier Analysis…</span> コマンドは複素数の入力配列の離散 Fourier 変換を計算することにより、データ集合の Fourier 解析を行う。</p>
<p>ダイアログボックス上では：</p>
<ul>
<li><p><span class="guilabel"><span class="accelerator">I</span>nput range</span> では変換元データを含むセル範囲を指定する。通常は、変換する複素数の配列を表す 2 x N または N x 2 の範囲であり、配列はそれぞれデータの実部と虚部を表す。</p></li>
<li><p><span class="guilabel">In<span class="accelerator">v</span>erse</span> をオンにすると、逆離散 Fourier 変換を計算する。</p></li>
<li><p><span class="guilabel">Output in <span class="accelerator">p</span>olar form</span> をオンにすると、出力が極形式になる。</p></li>
<li><p>出力を極形式にする場合、さらに <span class="guilabel"><span class="accelerator">M</span>inimum magnitude for polar form
output</span> をオンにすると、dB 単位で指定した値より小さい成分が抑制される。信号の大きさと位相のスペクトルを見るときに有用だ。</p>
<p>FFT アルゴリズムを実行すると、わずかな丸め誤差がつねに発生し、存在しない周波数の位相がゼロにならない。この引数に適切な値を指定することで、このような成分を抑制する。</p>
</li>
</ul>
<p>本文の例を見ると、実数列の分析は単に虚部をゼロに埋めた列を添えれば動作するようだ。</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Fourier_analysis">Fourier analysis - Wikipedia</a></p>
</div>
</section>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc09.html" title="Previous document">Calc Guide Chapter 9 Using Pivot Tables ノート</a>
        </li>
        <li>
          <a href="calc11.html" title="Next document">Calc Guide Chapter 11 Linking Data ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../../_static/logos.png"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>