<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 14, Calc as a Database ノート &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=c9b0a06a" />
    <script src="../../_static/documentation_options.js?v=4354bf25"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Calc Guide Chapter 15, Setting up and Customizing ノート" href="calc15.html" />
    <link rel="prev" title="LibreOffice Calc Chapter 13, Macros ノート" href="calc13.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc13.html" title="Previous">LibreOffice Calc Chapter 13, Macros ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Calc Guide 読書ノート</a>
        </li>
        <li>
          <a href="calc15.html" title="Next">Calc Guide Chapter 15, Setting up and Customizing ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="chapter-14-calc-as-a-database">
<h1>Chapter 14, Calc as a Database ノート<a class="headerlink" href="#chapter-14-calc-as-a-database" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">章見出し</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id7">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#a-database-primer" id="id8">A database primer</a></p></li>
<li><p><a class="reference internal" href="#calc-as-a-database-like-program" id="id9">Calc as a database-like program</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#associating-a-range-with-a-name" id="id10">Associating a range with a name</a></p>
<ul>
<li><p><a class="reference internal" href="#named-ranges" id="id11">Named ranges</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-named-ranges-using-row-or-column-headers" id="id12">Creating named ranges using row or column headers</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#database-ranges" id="id13">Database ranges</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sorting" id="id14">Sorting</a></p></li>
<li><p><a class="reference internal" href="#filtering" id="id15">Filtering</a></p>
<ul>
<li><p><a class="reference internal" href="#autofilter" id="id16">AutoFilter</a></p></li>
<li><p><a class="reference internal" href="#standard-filters" id="id17">Standard filters</a></p></li>
<li><p><a class="reference internal" href="#advanced-filters" id="id18">Advanced filters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#useful-database-like-functions" id="id19">Useful database-like functions</a></p>
<ul>
<li><p><a class="reference internal" href="#database-category-functions" id="id20">Database category functions</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id21">Overview</a></p></li>
<li><p><a class="reference internal" href="#database-function-arguments" id="id22">Database function arguments</a></p></li>
<li><p><a class="reference internal" href="#defining-search-criteria" id="id23">Defining search criteria</a></p></li>
<li><p><a class="reference internal" href="#example-of-database-function-use" id="id24">Example of Database function use</a></p></li>
<li><p><a class="reference internal" href="#list-of-database-functions" id="id25">List of Database functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#other-database-like-functions" id="id26">Other database-like functions</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>LibreOffice Base 部品は包括的な RDB 機能を有している一方、Calc は単純かつ有能なデータベースのような土台として機能するのに十分な機能を有する。</p>
<p>当初は Calc スプレッドシートでデータを管理し、その後より包括的なデータベースシステムを使用することを決めた場合、Calc データを Base へ移行することは容易だ。反対に、Calc の機能の一部を利用してデータの分析や表現を行いたい Base 利用者にとっては、Calc 文書からリンクされたデータ範囲の作成、ピボット表分析、統計図表の原データとして Base を使用することが可能だ。</p>
<section id="a-database-primer">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">A database primer</a><a class="headerlink" href="#a-database-primer" title="Link to this heading">¶</a></h3>
<p>一般的なデータベースでは、関連するデータは表に整理され、スプレッドシートに似た格子状の行と列に配列される。</p>
<ul class="simple">
<li><p>表の各行はデータ登録項目を表す。</p></li>
<li><p>表の各列は各登録項目内のフィールドを表す。</p>
<ul>
<li><p>フィールドの各升目は名前などといった個々のデータ項目または属性を含む。</p></li>
<li><p>各登録項目は人などといった単一の実体に対応する関連属性で構成される。</p></li>
</ul>
</li>
</ul>
<p>表一つに対するフィールド数は一定であることが多いが、登録項目数は決まっていない。</p>
<p>表には何百、何千という行があるかもしれないが、指定された条件を満たす登録項目を検索する情報要求を使って、個々の登録項目を簡単に見出し、検索し、更新することが可能だ。スプレッドシートに対する利点の一つはこの検索性の良さにある。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>情報要求というのは SQL でいう SELECT 文を指す。</p>
</div>
<p>このデータベース表の概念を説明するために、授業の成績表を例にとって考える。このシートでは、各行がクラスを受講している学生を表し、各列に学生の名前と成績が記載されいる。この表を使用すると、名前を検索するだけで個別の学生の成績をすばやく調べることができる。また、平均点が不合格の登録項目を絞り込むことで、どの学生がクラスに合格しているかを判断することができる。</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Grading sheet example</span><a class="headerlink" href="#id3" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Student</p></th>
<th class="head"><p>HW #1</p></th>
<th class="head"><p>HW #2</p></th>
<th class="head"><p>HW #3</p></th>
<th class="head"><p>Quiz #1</p></th>
<th class="head"><p>Quiz #2</p></th>
<th class="head"><p>Test #1</p></th>
<th class="head"><p>Average</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Andrew</p></td>
<td><p>90</p></td>
<td><p>100</p></td>
<td><p>82</p></td>
<td><p>90</p></td>
<td><p>88</p></td>
<td><p>92</p></td>
<td><p>90.33</p></td>
</tr>
<tr class="row-odd"><td><p>Bethany</p></td>
<td><p>95</p></td>
<td><p>100</p></td>
<td><p>82</p></td>
<td><p>80</p></td>
<td><p>88</p></td>
<td><p>93</p></td>
<td><p>89.67</p></td>
</tr>
<tr class="row-even"><td><p>Charles</p></td>
<td><p>80</p></td>
<td><p>93</p></td>
<td><p>73</p></td>
<td><p>80</p></td>
<td><p>75</p></td>
<td><p>84</p></td>
<td><p>80.83</p></td>
</tr>
<tr class="row-odd"><td><p>David</p></td>
<td><p>75</p></td>
<td><p>86</p></td>
<td><p>91</p></td>
<td><p>40</p></td>
<td><p>88</p></td>
<td><p>79</p></td>
<td><p>76.50</p></td>
</tr>
<tr class="row-even"><td><p>Emily</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
<td><p>81</p></td>
<td><p>100</p></td>
<td><p>75</p></td>
<td><p>94</p></td>
<td><p>91.67</p></td>
</tr>
<tr class="row-odd"><td><p>Ferdinand</p></td>
<td><p>85</p></td>
<td><p>93</p></td>
<td><p>73</p></td>
<td><p>60</p></td>
<td><p>50</p></td>
<td><p>72</p></td>
<td><p>72.17</p></td>
</tr>
<tr class="row-even"><td><p>Georgia</p></td>
<td><p>70</p></td>
<td><p>80</p></td>
<td><p>55</p></td>
<td><p>39</p></td>
<td><p>75</p></td>
<td><p>67</p></td>
<td><p>64.33</p></td>
</tr>
<tr class="row-odd"><td><p>Haley</p></td>
<td><p>85</p></td>
<td><p>93</p></td>
<td><p>82</p></td>
<td><p>70</p></td>
<td><p>75</p></td>
<td><p>76</p></td>
<td><p>80.17</p></td>
</tr>
<tr class="row-even"><td><p>Ian</p></td>
<td><p>100</p></td>
<td><p>100</p></td>
<td><p>91</p></td>
<td><p>90</p></td>
<td><p>100</p></td>
<td><p>96</p></td>
<td><p>96.17</p></td>
</tr>
<tr class="row-odd"><td><p>Jennifer</p></td>
<td><p>85</p></td>
<td><p>93</p></td>
<td><p>73</p></td>
<td><p>80</p></td>
<td><p>100</p></td>
<td><p>90</p></td>
<td><p>86.83</p></td>
</tr>
</tbody>
</table>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p><cite>Average</cite> フィールドはもちろん <cite>AVERAGE</cite> 関数の値だ。</p>
</div>
<p>LibreOffice Base は完全な機能を備えた RDB システムだが、Calc は RDB モデルに対応していない。</p>
</section>
<section id="calc-as-a-database-like-program">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Calc as a database-like program</a><a class="headerlink" href="#calc-as-a-database-like-program" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Calc は平坦な非 RDB 表に似ている。DB 表をシートに含めることも可能だ。</p></li>
<li><p>幅広いコマンドや関数を用いてデータを深く分析することが可能だ。</p>
<ul>
<li><p>並び替え</p></li>
<li><p>絞り込み</p></li>
<li><p>ピボット</p></li>
<li><p>2D/3D 図式などによる視覚的表現</p></li>
</ul>
</li>
</ul>
<p>Calc は完全な機能を備えたデータベースアプリケーションに取って代わるものではないが、小規模な個人的あるいは業務上のさまざまな場面でデータを管理するのに役立つ。</p>
</section>
</section>
<section id="associating-a-range-with-a-name">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Associating a range with a name</a><a class="headerlink" href="#associating-a-range-with-a-name" title="Link to this heading">¶</a></h2>
<p>シート内にデータベース表を仕込むには、その表が占める領域が要る。その領域とは、一つ以上の升目が連続するグループであるような範囲により表される。表に対する範囲に出入りしやすくするために、範囲に意味のある名前を与えることが可能だ。</p>
<p>名前の利点を挙げると：</p>
<ul class="simple">
<li><p>範囲を特定しやすくなる。特に文書内で複数の範囲を扱う場合は。</p></li>
<li><p>名前付き範囲は、単にアドレスで参照するのではなく、名前で参照することが可能。例えば、<cite>Scores</cite> という名前の範囲があれば、升目内で <code class="docutils literal notranslate"><span class="pre">=SUM(Scores)</span></code> のような数式で参照することができる。</p></li>
<li><p>名前付き範囲への名前による参照が範囲のアドレスが変更されるたびに自動的に更新される。これにより、範囲の位置が変更されるたびに参照を変更する必要がなくなる。</p></li>
<li><p>名前付き範囲はすべて Navigator (<kbd class="kbd docutils literal notranslate">F5</kbd>) から閲覧可能かつ入手可能。</p></li>
</ul>
<p>Calc には二種類の名前付き範囲が存在する：</p>
<dl class="simple">
<dt>データベース範囲</dt><dd><p>データベースのような操作の設定を保存する名前付き範囲</p>
</dd>
<dt>標準的範囲</dt><dd><p>データベース範囲でない名前付き範囲</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>この分類はどういうことだ？</p>
</div>
<section id="named-ranges">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Named ranges</a><a class="headerlink" href="#named-ranges" title="Link to this heading">¶</a></h3>
<p>技術的には、名前付き範囲は名前付き数式であり、その内容は文字列として設定される。よく使われる式は、</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$Sheet1.$A$1:$E$15
</pre></div>
</div>
<p>のような絶対升目範囲だ。しかし、他の式型も可能だ。例えば、</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$Sheet1.$A$1:$A$4~$Sheet1.$B$1:$B$4
</pre></div>
</div>
<p>という式は、二つの別々の升目範囲を含む（チルダ文字は連結演算子）。あるいは、半径を指定して円の面積を計算するために、</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>PI()*B1*B1
</pre></div>
</div>
<p>のような数式を定義することもできる。</p>
<p>以下、単一の行列のような（連結成分が一つしかない）セル範囲として定義された名前付き範囲について述べられる。</p>
<p>新しい名前付き範囲を作成する簡単な方法は：</p>
<ol class="arabic simple">
<li><p>シートで関連する升目を選択</p></li>
<li><p>Formula バー の左にある <span class="guilabel">Name Box</span> 欄に名前を入力</p></li>
<li><p>入力中に表示される <span class="guilabel">Define Name for Range</span> ツールチップに注目し、入力が終わったら <kbd class="kbd docutils literal notranslate">Enter</kbd> を押す</p></li>
</ol>
<p><span class="guilabel">Define Name</span> ダイアログボックスを使う方法もある。次のどちらかで開く：</p>
<ul class="simple">
<li><p>Menu バー <span class="menuselection"><span class="accelerator">S</span>heet‣<span class="accelerator">N</span>amed Ranges and Expressions‣<span class="accelerator">D</span>efine…</span>
実行</p></li>
<li><p><span class="guilabel">Manage Names</span> ダイアログボックス で <span class="guilabel"><span class="accelerator">A</span>dd…</span> を押す</p></li>
</ul>
<p><span class="guilabel">Manage Names</span> ダイアログボックス の開き方は：</p>
<ul class="simple">
<li><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F3</kbd> を押す</p></li>
<li><p>Formula バー の左にある <span class="guilabel">Name Box</span> ドロップダウンリストで
<span class="menuselection">Manage Names…</span> を実行</p></li>
</ul>
<p><span class="guilabel">Paste Names</span> ダイアログボックスを使えば、定義済み名前付き範囲を入力するのが楽になる。開き方は次のどちらかを実行：</p>
<ul class="simple">
<li><p>Menu バー <span class="menuselection"><span class="accelerator">I</span>nsert‣<span class="accelerator">N</span>amed Ranges or Expressions…</span></p></li>
<li><p>Menu バー <span class="menuselection"><span class="accelerator">S</span>heet‣<span class="accelerator">N</span>amed Ranges and Expressions‣<span class="accelerator">I</span>nsert…</span></p></li>
</ul>
<p>項目を選択して <span class="guilabel"><span class="accelerator">P</span>aste</span> ボタンを押せば、現在のキャレット位置に選択した名前付き範囲が貼り付く。</p>
<p>範囲の作成と編集について詳しくは <a class="reference internal" href="calc07.html"><span class="doc">Chapter 7, Printing, Exporting, Emailing, and Signing</span></a>, <a class="reference internal" href="calc08.html"><span class="doc">Chapter 8, Using Formulas and Functions</span></a> を参照しろ。</p>
<section id="creating-named-ranges-using-row-or-column-headers">
<h4><a class="toc-backref" href="#id12" role="doc-backlink">Creating named ranges using row or column headers</a><a class="headerlink" href="#creating-named-ranges-using-row-or-column-headers" title="Link to this heading">¶</a></h4>
<p>Create Names ツールでは、表のヘッダーから複数の名前付き範囲を同時に作成できる。これらのヘッダーは表の境界（上下の行、左右の列）から描画することができ、ヘッダーに対応する各行または各列は、名前付き範囲自体の作成に使用される。例えば、表のいちばん上の行に含まれるヘッダーから範囲を作成することを選択した場合、各範囲は各ヘッダーラベルに対応する列から個別に生成される。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ヘッダー升目は Create Names ツールを使って生成された名前付き範囲には含まれない。これらの各升目のラベルが範囲の名前付けに使われるからだ。</p>
</div>
<p>Create Names ツールを使う手順：</p>
<ol class="arabic simple">
<li><p>シートにて名前付き範囲を作成する表を選択する。ヘッダーの行や列も選択に含めろ。</p></li>
<li><p>Menu バー <span class="menuselection"><span class="accelerator">S</span>heet‣<span class="accelerator">N</span>amed Ranges and
Expressions‣<span class="accelerator">C</span>reate…</span> を選択して <span class="guilabel">Create Names</span> ダイアログボックスを開く。</p></li>
<li><p>Calc はどの行または列にヘッダーが含まれているかを自動的に識別し、該当するチェックボックス（最上行、左列、最下行、右列）にマークを付ける。この選択を変更したい場合は、この時点でいずれかのボックスを手動でオンオフ可能。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押してダイアログボックスを閉じて新しい名前付き範囲を作成する。</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>この挙動があるので、複数の行や列に同じラベルを付けてはいけない。</p>
</div>
</section>
</section>
<section id="database-ranges">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Database ranges</a><a class="headerlink" href="#database-ranges" title="Link to this heading">¶</a></h3>
<p>データベース範囲はデータベースの表のように使用することを意図して設計されている。各行は登録項目を表し、各セルは登録項目内のフィールドを表す。データベース範囲は名前付き範囲と以下の点で異なる：</p>
<ul class="simple">
<li><p>データベース範囲は数式ではあり得ない。</p></li>
<li><p>データベース範囲は単一の矩形セル範囲でしかあり得ない。</p></li>
<li><p>データベース範囲では最初の行と最後の行を見出しと小計用途としてそれぞれ書式を有する。表のフィールドそれぞれに対して、セルの書式を保持することもできる。</p></li>
<li><p>データベース範囲はシート内のアドレスからの相対参照不可。</p></li>
<li><p>データベース範囲は、並び替え、絞り込み、小計、データインポートの設定を記述子と呼ばれるデータ構造に格納し、マクロを使用してアクセスすることが可能（データベース操作が実行されると記述子は更新される）。</p></li>
<li><p>データベース範囲は外部データに接続することが可能（そこからデータをスプレッドシートに取り込む）。</p></li>
</ul>
<p>データベース範囲の定義には <span class="guilabel">Define Database Range</span> ダイアログボックスを使う。</p>
<p>データベース範囲を作成する手順：</p>
<ol class="arabic">
<li><p>（全範囲を自動決定させる場合）データベース表のセル領域内の升目を一つ選択する</p></li>
<li><p>Menu バー <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">D</span>efine Range…</span> 実行</p></li>
<li><p><span class="guilabel">Name</span> 欄に範囲名を入力する（変な字は使うな）</p></li>
<li><p>必要なら <span class="guilabel">O<span class="accelerator">p</span>tions</span> を展開してオプションを指定する</p>
<dl class="simple">
<dt><span class="guilabel">Co<span class="accelerator">n</span>tains column labels</span></dt><dd><p>最上段をフィールドの見出し用に確保するかどうかを示す。</p>
</dd>
<dt><span class="guilabel">Contains <span class="accelerator">t</span>otals row</span></dt><dd><p>一番下の行を合計用に確保するかどうかを示す。</p>
</dd>
<dt><span class="guilabel">Insert or delete <span class="accelerator">c</span>ells</span></dt><dd><p>このオプションが有効な場合、給源に新しい登録項目が追加されると、データベース範囲に新しい行と列が入る。外部データベース給源が範囲にリンクされている場合のみ関係がある。手動でデータベース範囲を更新するには、Menu バー の
<span class="menuselection"><span class="accelerator">D</span>ata‣R<span class="accelerator">e</span>fresh Range</span> を使用する。</p>
</dd>
<dt><span class="guilabel">Keep <span class="accelerator">f</span>ormatting</span></dt><dd><p>最初のデータ行の既存の升目書式をデータベース範囲全体に適用する。</p>
</dd>
<dt><span class="guilabel">Don’t save <span class="accelerator">i</span>mported data</span></dt><dd><p>このオプションを選択すると、原データベースへの参照のみが保存され、範囲の升目の内容は維持されない。</p>
</dd>
<dt><span class="guilabel">Source</span></dt><dd><p>現在のデータベース給源が存在する場合は、その情報を表示する。</p>
</dd>
<dt><span class="guilabel">Operations</span></dt><dd><p>データベース範囲にどのような操作が適用されたかを示す。例えば <cite>Sort</cite>,
<cite>Filter</cite>, <cite>Subtotals</cite> など。</p>
</dd>
</dl>
</li>
<li><p><span class="guilabel"><span class="accelerator">A</span>dd</span> を押してデータベース範囲一覧に範囲を追加する</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン</p></li>
</ol>
<p>既存データベース範囲を変更する手順：</p>
<ol class="arabic simple">
<li><p>Menu バー <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">D</span>efine Range…</span> を選択。</p></li>
<li><p>範囲一覧から項目を一つ選ぶ（または名前を直接指定）とボタンのラベルが
<span class="guilabel">M<span class="accelerator">o</span>dify</span> に変化する。</p></li>
<li><p>ダイアログボックス内 <span class="guilabel">Range</span> や <span class="guilabel">O<span class="accelerator">p</span>tions</span> で変更を加える。</p></li>
<li><p><span class="guilabel">M<span class="accelerator">o</span>dify</span> を押して範囲を更新する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押してダイアログボックスを閉じ、変更したデータベース範囲を保存する。</p></li>
</ol>
<p>既存データベース範囲を削除する手順：</p>
<ol class="arabic simple">
<li><p>Menu バー <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">D</span>efine Range…</span> 実行</p></li>
<li><p>範囲一覧から項目を一つ選ぶ（または名前を直接指定）</p></li>
<li><p><span class="guilabel"><span class="accelerator">D</span>elete</span> ボタンを押す</p></li>
<li><p>確認に対して <span class="guilabel"><span class="accelerator">Y</span>es</span> ボタン を押す</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押してダイアログボックスを閉じる</p></li>
</ol>
<p>既存データベース範囲を選択する手順：</p>
<ol class="arabic simple">
<li><p>Menu バー <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">S</span>elect Range…</span> 実行</p></li>
<li><p>一覧から項目を選択</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す</p></li>
</ol>
<p>データ源からデータを取得して新規データベース範囲を作成する手順：</p>
<ol class="arabic simple">
<li><p>Data Sources Explorer を開く</p></li>
<li><p>左窓で目的データ源ツリーを展開</p></li>
<li><p>必要な表または問い合わせをクリックし、その構成データを右窓に表示する</p></li>
<li><p>右窓の左上にある空白の矩形領域をクリックし、表示されている表または質問内の全データを選択する。</p></li>
<li><p>データの左上隅になるスプレッドシート升目にデータをドラッグ＆ドロップ</p></li>
</ol>
<p>これでインポートされたデータの升目範囲を包含し、<cite>Import1</cite>, <cite>Import2</cite> などの形式の既定の名前を持つ新規データベース範囲が自動的に生成する。</p>
<p>Menu バー <span class="menuselection"><span class="accelerator">D</span>ata‣R<span class="accelerator">e</span>fresh Range</span> を選択すると、関連するデータ源のデータが更新されればデータベース範囲の内容が更新される。シートのデータは外部データベースのデータと一致するように更新される。リンク方法については <a class="reference internal" href="calc11.html"><span class="doc">Chapter 11, Linking Data</span></a> を参照しろ。</p>
</section>
</section>
<section id="sorting">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Sorting</a><a class="headerlink" href="#sorting" title="Link to this heading">¶</a></h2>
<blockquote>
<div><p>Sorting is the process of rearranging data in a range or a sheet according to
a specified sort order.</p>
</div></blockquote>
<p>単一列の値に基づいてデータベース表を並び替えるもっとも単純な方法は、次のように
Sort Ascending と Sort Descending ツールを使うものだ：</p>
<ol class="arabic simple">
<li><p>列のセルをどれでもよいので選択</p></li>
<li><p>昇順に並び替えるならば次のいずれかを実行（降順の場合は対応する UI を使用）：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣Sort <span class="accelerator">A</span>scending</span> を実行</p></li>
<li><p><span class="guilabel">Standard</span> ツールバー <span class="guilabel">Sort Ascending</span> 図像をクリック</p></li>
<li><p>AutoFilters を有効にしている場合は、関連列の AutoFilter コンボボックスで昇順並び替えを選択してもよい</p></li>
</ul>
</li>
</ol>
<p>これらの並べ替えコマンドは自動的に表が占めるセル範囲すべてを識別し、指示された列の値のみに基づいて表全体を並べ替える。ただし、ヘッダー行はそれと認識され、並べ替えの対象から外れる。</p>
<p>AutoFilter コンボボックスは次節で述べられるが、<span class="menuselection">Sort Ascending</span>,
<span class="menuselection">Sort Descending</span> に加え、升目の背景色やフォント色で並び替える
<span class="menuselection">Sort by Color</span> 項目もある。</p>
<p>複雑な並び替えを実現するには、Menu バー <span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">S</span>ort…</span> を実行して <span class="guilabel">Sort</span> ダイアログボックス を開く。開く前に表内の升目を一つ選択しておけ。</p>
<p><span class="guilabel">Sort Criteria</span> タブ では並び替えを三段階指定することが可能。<span class="guilabel">Sort Key</span>
キー番号の小さいものから大きいのものへ順次並び替えられる。</p>
<p><span class="guilabel">Options</span> タブ にはさらなる並び替えオプションが用意されている。これらについては
<a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> を参照しろ。</p>
</section>
<section id="filtering">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Filtering</a><a class="headerlink" href="#filtering" title="Link to this heading">¶</a></h2>
<blockquote>
<div><p>A filter is a tool that hides or displays records within a sheet based on a
set of filtering criteria.</p>
</div></blockquote>
<p>絞り込みは長いデータ一覧から特定の項目を発見するのに便利だ。三種類の絞り込みがある：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣Auto<span class="accelerator">F</span>ilter</span></p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣More <span class="accelerator">F</span>ilters‣<span class="accelerator">S</span>tandard Filter…</span></p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣More <span class="accelerator">F</span>ilters‣<span class="accelerator">A</span>dvanced Filter…</span></p></li>
</ul>
<p>データベース表に適用されている絞り込みを解除したい場合には
<span class="menuselection"><span class="accelerator">D</span>ata‣More <span class="accelerator">F</span>ilters‣<span class="accelerator">R</span>eset Filter</span> を実行。</p>
<p><a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> も参照しろ。</p>
<section id="autofilter">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">AutoFilter</a><a class="headerlink" href="#autofilter" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>もっとも簡単な絞り込み</p></li>
<li><p>データ列の上部にある▼ボタンからコンボボックスにアクセス</p></li>
</ul>
<p>データベース表の列すべてに AutoFilters を追加するには、</p>
<ol class="arabic simple">
<li><p>表内のセルをどれでもいいからクリック</p></li>
<li><p>次のいずれかを実行：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣Auto<span class="accelerator">F</span>ilter</span></p></li>
<li><p><span class="guilabel">Standard</span> ツールバー <span class="guilabel">AutoFilter</span> 図像クリック</p></li>
<li><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">L</kbd> 押し</p></li>
</ul>
</li>
</ol>
<p>AutoFilter 全解除手順は次のいずれかを実行：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣Auto<span class="accelerator">F</span>ilter</span></p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣More <span class="accelerator">F</span>ilters‣<span class="accelerator">H</span>ide AutoFilter</span></p></li>
<li><p><span class="guilabel">Standard</span> ツールバー <span class="guilabel">AutoFilter</span> 図像クリック</p></li>
<li><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">L</kbd> 押し</p></li>
</ul>
<p>コンボボックスのオプション：</p>
<ul class="simple">
<li><p>昇順か降順で並び替え</p></li>
<li><p>背景色か文字色で並び替え</p></li>
<li><p>背景色か文字色で絞り込み</p></li>
<li><p><span class="menuselection">Filter by Condition‣</span> 以下にある絞り込み項目</p>
<ul>
<li><p><span class="menuselection">Empty</span></p></li>
<li><p><span class="menuselection">Not Empty</span></p></li>
<li><p><span class="menuselection">Top 10</span></p></li>
<li><p><span class="menuselection">Bottom 10</span></p></li>
</ul>
</li>
<li><p>チェックボックス各種は値の絞り込みに対応</p></li>
<li><p>列に絞り込みが適用中の場合、<span class="guilabel">Clear Filter</span> で解除</p></li>
</ul>
<p>AutoFilter のコンボボックスとそのオプションの使い方の詳細については <a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> を見ろ。</p>
</section>
<section id="standard-filters">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Standard filters</a><a class="headerlink" href="#standard-filters" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>標準絞り込みは AutoFilters よりも複雑で、最大八つの絞り込み条件を設定可能。</p></li>
<li><p>強力絞り込みは正規表現により設定可能。</p></li>
<li><p>標準絞り込みはダイアログボックスを使用する。開き方は：</p>
<ul>
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">D</span>ata‣More <span class="accelerator">F</span>ilters‣<span class="accelerator">S</span>tandard Filter…</span></p></li>
<li><p>AutoFilter コンボボックスの <span class="menuselection">Standard Filter…</span> オプション</p></li>
</ul>
</li>
</ul>
<p><a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> 参照。</p>
</section>
<section id="advanced-filters">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Advanced filters</a><a class="headerlink" href="#advanced-filters" title="Link to this heading">¶</a></h3>
<p>高度な絞り込みの判定基準は、ダイアログボックスに入力するのではなく、シートに保存される。そのため、使う前にまず絞り込み基準を含むセル範囲を設定する必要がある。</p>
<p>判定基準範囲を設定する手順：</p>
<ol class="arabic simple">
<li><p>絞り込む範囲の列見出しをシートの空き地にコピー（別シートでかまわない）</p></li>
<li><p>判定基準範囲列見出しの下に絞り込み判定を入力する。</p>
<ul class="simple">
<li><p>同じ行の判定は AND で接続される</p></li>
<li><p>各行の判定グループは OR で接続される</p></li>
<li><p>空セルは無視される</p></li>
<li><p>絞り込み一つあたり最大八行定義可能</p></li>
</ul>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>基準領域には定義された絞り込み基準を持つ列の見出しだけを含めることも可能だが、簡単のために、データベース表の見出しすべてを基準領域にコピーすることも可能だ。</p>
</div>
<p>ここまでやって高度な絞り込みを設定することになる：</p>
<ol class="arabic simple">
<li><p>絞り込み対象セル範囲を選択（データベース表ならばセル一つでいい）。</p></li>
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">D</span>ata‣More <span class="accelerator">F</span>ilters‣<span class="accelerator">A</span>dvanced Filter…</span>
を選択して <span class="guilabel">Advanced Filter</span> ダイアログボックスを開く。</p></li>
<li><p><span class="guilabel">Read <span class="accelerator">F</span>ilter Criteria From</span> 欄にドロップダウンから名前付き範囲を選択するか、参照を入力するか、シートから升目を選択して、基準範囲のアドレスを入力する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押して絞り込みを適用し、ダイアログボックスを閉じる。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>個々の名前付き範囲に対して、<span class="guilabel">Define Name</span> ダイアログボックス と <span class="guilabel">Manage Names</span> ダイアログボックス で
<span class="guilabel"><span class="accelerator">F</span>ilter</span> にチェックを入れることができる。この方法で絞り込みのためにマークされた名前付き範囲しか <span class="guilabel">Advanced Filter</span> ダイアログボックスの <span class="guilabel">Read <span class="accelerator">F</span>ilter Criteria From</span> 欄のドロップダウンボックスで選択できない。データベースの範囲はドロップダウンボックスで選択できない。</p>
</div>
<p>高度なオプションは標準オプションと同じであり、<a class="reference internal" href="calc02.html"><span class="doc">Chapter 2, Entering and Editing Data</span></a> でさらに詳しく説明されている。</p>
<p>例を再現するには次の内容を別のシートに用意しておく：</p>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Advanced filter criteria range</span><a class="headerlink" href="#id4" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Student</p></th>
<th class="head"><p>HW #1</p></th>
<th class="head"><p>HW #2</p></th>
<th class="head"><p>HW #3</p></th>
<th class="head"><p>Quiz #1</p></th>
<th class="head"><p>Quiz #2</p></th>
<th class="head"><p>Test #1</p></th>
<th class="head"><p>Average</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p>&gt;75</p></td>
<td><p>&gt;75</p></td>
<td><p>&gt;75</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Ferdinand</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>前掲のデータベース表を選択状態にして Advanced Filter を実行する。それからこの表をドロップダウンボックスに指定する。その結果、元のデータベース表の行が絞り込まれて、Ferdinand 自身の行と、それよりも成績の良い行だけに絞られる。</p>
</div>
</section>
</section>
<section id="useful-database-like-functions">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Useful database-like functions</a><a class="headerlink" href="#useful-database-like-functions" title="Link to this heading">¶</a></h2>
<section id="database-category-functions">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Database category functions</a><a class="headerlink" href="#database-category-functions" title="Link to this heading">¶</a></h3>
<section id="overview">
<h4><a class="toc-backref" href="#id21" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading">¶</a></h4>
<p>Database 区分にある関数 12 個はスプレッドシート内の矩形領域を占める単純なデータベースを分析するのを助けることを目的としており、データは各登録項目ごとに一行として整理されている。各列のヘッダーセルには列の名前が表示され、通常、その列の各セルの内容を示す。</p>
<p>Database 区分の関数は次の三つの引数を取る：</p>
<dl class="simple">
<dt>Database</dt><dd><p>データベースのセル範囲</p>
</dd>
<dt>DatabaseField</dt><dd><p>関数の計算に用いるデータを含む列</p>
</dd>
<dt>SearchCriteria</dt><dd><p>検索条件を含む別領域セル範囲</p>
</dd>
</dl>
<p>データベース区分の関数すべては同じ単純な操作の考え方を持つ。まず、指定された
SearchCriteria を使用して、後続の計算で使用するデータベース内の登録項目の部分集合を識別する。それからデータ値を抽出し、特定の関数（平均、合計、積など）に関連付けられた計算を実行する。処理されるのは選択された登録項目の DatabaseField 列の値だ。</p>
</section>
<section id="database-function-arguments">
<h4><a class="toc-backref" href="#id22" role="doc-backlink">Database function arguments</a><a class="headerlink" href="#database-function-arguments" title="Link to this heading">¶</a></h4>
<p class="rubric">Database</p>
<ul class="simple">
<li><p>範囲の最初の行はフィールド名からなり、それ以降の行は対応するフィールド値を持つ登録項目だ。</p></li>
<li><p>升目範囲定義としては、矩形の左上と右下のセル参照をコロンで結合する。A1:E10 のように。</p></li>
<li><p>名前付き範囲またはデータベース範囲名を指定してもよい。こちらのほうが可読性と保守性を向上する。</p></li>
</ul>
<p class="rubric">DatabaseField</p>
<ul class="simple">
<li><p>検索条件が適用されデータ行が選択された後、関数が計算に使用する列を指定する。</p></li>
<li><p>この引数を指定する方法はいろいろある。</p>
<ul>
<li><p>データベース領域内のヘッダー升目への参照あるいは（有効な）名前を入力する。</p></li>
<li><p>データベース領域内の列を 1 から開始する（有効な）番号で指定する。</p></li>
<li><p>データベース範囲の最初の行から見出し名をリテラル文字列で指定する。</p></li>
</ul>
</li>
<li><p><cite>DCOUNT</cite>, <cite>DCOUNTA</cite> 以外の Database 関数ではこの引数は入力必須だ。</p></li>
</ul>
<p class="rubric">SearchCriteria</p>
<ul class="simple">
<li><p>検索条件を含む升目範囲を指定する。</p></li>
<li><p>Database 引数と同様に、最初の行もフィールド名。それ以降の行は関連フィールドについての条件だ。</p></li>
<li><p>Database 領域と SearchCriteria 領域は隣接している必要はない。同一シート内にある必要もない。</p></li>
<li><p>セル範囲定義方法は Database 引数と同様。</p></li>
</ul>
</section>
<section id="defining-search-criteria">
<h4><a class="toc-backref" href="#id23" role="doc-backlink">Defining search criteria</a><a class="headerlink" href="#defining-search-criteria" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p>SearchCriteria 領域が占める列数は Database 領域の幅に一致する必要はない。</p></li>
<li><p>SearchCriteria の最初の行に現れる見出しすべては Database のそれと一致する必要がある。</p></li>
<li><p>条件式は SearchCriteria 領域の二行目以降のセルに入力される。</p></li>
<li><p>比較演算子を用いて SearchCriteria 領域セルに条件を作成する。セルが空でなく、比較演算子で始まらないものは <code class="docutils literal notranslate"><span class="pre">=</span></code> とみなされる。</p></li>
</ul>
<p>一行に複数の条件を書くと、それらは AND で結ばれる。別々の行に書くと OR で結ばれる。</p>
<p><span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Calc‣Calculate</span> ページ の <span class="guilabel">Enable w<span class="accelerator">i</span>ldcards in formulas</span> が選択されていれば、ワイルドカードを使用して SearchCriteria を作成できる。スプレッドシートで Microsoft Excel との相互運用性が重要な場合はこれを選択する必要がある。</p>
<p><span class="guilabel">Enable r<span class="accelerator">e</span>gular expressions in formulas</span> が選択されていれば、正規表現を使用してさらに強力な条件を作成できる。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>検索基準文字列が正規表現である関数を使用する場合、最初の試みは基準文字列を数値に変換することだ。例えば、<code class="docutils literal notranslate"><span class="pre">.0</span></code> は 0.0 に変換される。成功すれば、正規表現マッチではなく数値マッチとなる。しかし、小数の区切り文字が <code class="docutils literal notranslate"><span class="pre">.</span></code> でないロケールに切り替えると、正規表現の変換が働くようになる。数値表現ではなく正規表現として強制的に評価するには、<code class="docutils literal notranslate"><span class="pre">.[0]</span></code> や <code class="docutils literal notranslate"><span class="pre">.\0</span></code>, <code class="docutils literal notranslate"><span class="pre">(?i).0</span></code> など、数値として誤読されない表現を使用する。</p>
</div>
<p><span class="guilabel">Search criteria = and &lt;&gt; must apply to <span class="accelerator">w</span>hole cells</span> オプションはデータベース関数に設定する検索条件が升目全体に正確に一致するかどうかを制御する。スプレッドシートで Microsoft Excel との相互運用性が重要な場合はオンにする。</p>
</section>
<section id="example-of-database-function-use">
<h4><a class="toc-backref" href="#id24" role="doc-backlink">Example of Database function use</a><a class="headerlink" href="#example-of-database-function-use" title="Link to this heading">¶</a></h4>
<p>本書のスクリーンショットに倣え。</p>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Example usage of a Database function (database table)</span><a class="headerlink" href="#id5" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Grade</p></th>
<th class="head"><p>Age</p></th>
<th class="head"><p>Distance (meters)</p></th>
<th class="head"><p>Weight (kg)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Andy</p></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p>150</p></td>
<td><p>40</p></td>
</tr>
<tr class="row-odd"><td><p>Betty</p></td>
<td><p>4</p></td>
<td><p>10</p></td>
<td><p>1000</p></td>
<td><p>42</p></td>
</tr>
<tr class="row-even"><td><p>Charles</p></td>
<td><p>3</p></td>
<td><p>10</p></td>
<td><p>300</p></td>
<td><p>51</p></td>
</tr>
<tr class="row-odd"><td><p>Daniel</p></td>
<td><p>5</p></td>
<td><p>11</p></td>
<td><p>1200</p></td>
<td><p>48</p></td>
</tr>
<tr class="row-even"><td><p>Eva</p></td>
<td><p>2</p></td>
<td><p>8</p></td>
<td><p>650</p></td>
<td><p>33</p></td>
</tr>
<tr class="row-odd"><td><p>Frank</p></td>
<td><p>2</p></td>
<td><p>7</p></td>
<td><p>300</p></td>
<td><p>42</p></td>
</tr>
<tr class="row-even"><td><p>Greta</p></td>
<td><p>1</p></td>
<td><p>7</p></td>
<td><p>200</p></td>
<td><p>36</p></td>
</tr>
<tr class="row-odd"><td><p>Harry</p></td>
<td><p>3</p></td>
<td><p>9</p></td>
<td><p>1200</p></td>
<td><p>44</p></td>
</tr>
<tr class="row-even"><td><p>Irene</p></td>
<td><p>2</p></td>
<td><p>8</p></td>
<td><p>1000</p></td>
<td><p>42</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">Example usage of a Database function (criteria table)</span><a class="headerlink" href="#id6" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Grade</p></th>
<th class="head"><p>Age</p></th>
<th class="head"><p>Distance (meters)</p></th>
<th class="head"><p>Weight (kg)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td></td>
<td></td>
<td><p>&gt; 600</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>データベース区分の関数の使い方を示す簡単な例だ。選択された升目 E15 の数式は
Formula バー で見ることができ、<cite>DCOUNT</cite> 関数の呼び出しで構成されてる。この関数呼び出しの引数は：</p>
<dl class="simple">
<dt>Database 引数</dt><dd><p>この例で使用するデータベース表はヘッダー行から Irene の行まで。</p>
</dd>
<dt>DatabaseField 引数</dt><dd><p><cite>DCOUNT</cite> 関数はさらに計算することなく条件に一致する登録項目を数えるので、この引数に値を指定する必要はないが、ないことを示すために引数リストの区切り文字は指定しないといけない。</p>
</dd>
<dt>SearchCriteria 引数</dt><dd><p>この例で使用される検索条件領域は A12:E13 に及ぶ。D13 の条件 <code class="docutils literal notranslate"><span class="pre">&gt;600</span></code> は
<cite>DCOUNT</cite> に <cite>Distance (meters)</cite> 列に 600 m より大きい値を持つすべての登録項目を数えさせる。多くの場合、検索条件領域内にデータベース表の列見出しを複製すると便利だ。しかし、これは必須ではなく、式 <code class="docutils literal notranslate"><span class="pre">=DCOUNT(A1:E10,,D12:D13)</span></code> は全く同じ値 5 を与える。</p>
</dd>
</dl>
<p>Help で <em>database functions</em> を検索するか、
&lt;<a class="reference external" href="https://wiki.documentfoundation.org/Documentation/Calc_Functions">https://wiki.documentfoundation.org/Documentation/Calc_Functions</a>&gt; の Calc
Functions Wiki 内の各関数の関連ページにアクセスすると多くの例が見つかる。</p>
</section>
<section id="list-of-database-functions">
<h4><a class="toc-backref" href="#id25" role="doc-backlink">List of Database functions</a><a class="headerlink" href="#list-of-database-functions" title="Link to this heading">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>これらの関数は計算中、日付や論理値を数値として扱う。</p>
</div>
<dl>
<dt><cite>DAVERAGE</cite></dt><dd><p>指定された検索条件に一致するすべての行について、指定された列のセル（フィールド）の数値の平均を計算する。</p>
</dd>
<dt><cite>DCOUNT</cite>, <cite>DCOUNTA</cite></dt><dd><p>指定された検索条件に一致するすべての行に対して、指定された列のうち</p>
<ul class="simple">
<li><p>数値を含むセルの数を返す。</p></li>
<li><p>空でないセルの数を返す。</p></li>
</ul>
<p>列が指定されていない場合、内容に関係なく、指定された検索条件に一致するすべての登録項目の数を返す。</p>
</dd>
<dt><cite>DGET</cite></dt><dd><p>指定された検索条件に一致する唯一の行に対して、指定された列のセル内容を返す。</p>
</dd>
<dt><cite>DMAX</cite>, <cite>DMIN</cite></dt><dd><p>指定された検索条件に一致するすべての行について、数値を含む指定された列のセル全体の最大値、最小値を計算する。</p>
<ul class="simple">
<li><p>空白セルや数値以外の文字を含むセルは含まれない。</p></li>
<li><p>一致する登録項目が見つからない場合など、変な場合には 0 を返す。</p></li>
</ul>
</dd>
<dt><cite>DPRODUCT</cite></dt><dd><p>すべての数値の積を返す。</p>
</dd>
<dt><cite>DSTDEV</cite>, <cite>DSTDEVP</cite></dt><dd><p>指定された検索条件に一致するすべての行について、指定列のセル内の数値に基づいて標本標準偏差、母集団標準偏差を計算する。数値以外の値は無視。</p>
</dd>
<dt><cite>DSUM</cite></dt><dd><p>すべての数値の和を返す。</p>
</dd>
<dt><cite>DVAR</cite>, <cite>DVARP</cite></dt><dd><p>標本分散、母集団分散。</p>
</dd>
</dl>
</section>
</section>
<section id="other-database-like-functions">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Other database-like functions</a><a class="headerlink" href="#other-database-like-functions" title="Link to this heading">¶</a></h3>
<p>Calc に用意されている関数の中には、表形式のデータで使用することを意図したもの
(e.g. <code class="docutils literal notranslate"><span class="pre">HLOOKUP</span></code>, <code class="docutils literal notranslate"><span class="pre">VLOOKUP</span></code>) もあれば、どのような状況でも使用できるものもある。</p>
<p>本書の表はデータベースに Calc の表を使用する場合に役立つ関数の一覧だ。その多くは、データベース以外の状況で使用される典型的なスプレッドシート関数としておなじみのものだが、中にはデータベース表テーブルで特に役立つものもある。</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Table 1: Some useful database-like functions の実習を考える。</p>
</div>
</section>
</section>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc13.html" title="Previous">LibreOffice Calc Chapter 13, Macros ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Calc Guide 読書ノート</a>
        </li>
        <li>
          <a href="calc15.html" title="Next">Calc Guide Chapter 15, Setting up and Customizing ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="../../index.html" title="読書ノート Home"><img src="../../_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>