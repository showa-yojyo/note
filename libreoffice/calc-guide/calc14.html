<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 14 Calc as a Database ノート &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=1a9a5cd9" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=5a6f99c4"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Calc Guide Chapter 15, Setting up and Customizing ノート" href="calc15.html" />
    <link rel="prev" title="LibreOffice Calc Chapter 13 Macros ノート" href="calc13.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc13.html" title="Previous document">LibreOffice Calc Chapter 13 Macros ノート</a>
        </li>
        <li>
          <a href="calc15.html" title="Next document">Calc Guide Chapter 15, Setting up and Customizing ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="chapter-14-calc-as-a-database">
<h1>Chapter 14 Calc as a Database ノート<a class="headerlink" href="#chapter-14-calc-as-a-database" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">章見出し</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#a-database-primer" id="id3">A database primer</a></p></li>
<li><p><a class="reference internal" href="#calc-as-a-database-like-program" id="id4">Calc as a database-like program</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#associating-a-range-with-a-name" id="id5">Associating a range with a name</a></p>
<ul>
<li><p><a class="reference internal" href="#named-ranges" id="id6">Named ranges</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-named-ranges-using-row-or-column-headers" id="id7">Creating named ranges using row or column headers</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#database-ranges" id="id8">Database ranges</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#sorting" id="id9">Sorting</a></p></li>
<li><p><a class="reference internal" href="#filtering" id="id10">Filtering</a></p>
<ul>
<li><p><a class="reference internal" href="#autofilter" id="id11">AutoFilter</a></p></li>
<li><p><a class="reference internal" href="#standard-filters" id="id12">Standard filters</a></p></li>
<li><p><a class="reference internal" href="#advanced-filters" id="id13">Advanced filters</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#useful-database-like-functions" id="id14">Useful database-like functions</a></p>
<ul>
<li><p><a class="reference internal" href="#database-category-functions" id="id15">Database category functions</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id16">Overview</a></p></li>
<li><p><a class="reference internal" href="#database-function-arguments" id="id17">Database function arguments</a></p></li>
<li><p><a class="reference internal" href="#defining-search-criteria" id="id18">Defining search criteria</a></p></li>
<li><p><a class="reference internal" href="#example-of-database-function-use" id="id19">Example of Database function use</a></p></li>
<li><p><a class="reference internal" href="#list-of-database-functions" id="id20">List of Database functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#other-database-like-functions" id="id21">Other database-like functions</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>LibreOffice Base 部品は包括的な RDB 機能を有している一方、Calc は単純かつ有能なデータベースのような土台として機能するのに十分な機能を有する。</p>
<p>当初は Calc スプレッドシートでデータを管理し、その後より包括的なデータベースシステムを使用することを決めた場合、Calc データを Base へ移行することは容易だ。反対に、Calc の機能の一部を利用してデータの分析や表現を行いたい Base 利用者にとっては、Calc 文書からリンクされたデータ範囲の作成、ピボット表分析、図式の原データとして Base を使用することが可能だ。</p>
<section id="a-database-primer">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">A database primer</a><a class="headerlink" href="#a-database-primer" title="Permalink to this heading">¶</a></h3>
<p>一般的なデータベースでは、関連するデータは表に整理され、スプレッドシートに似た格子状の行と列に配列される。</p>
<ul class="simple">
<li><p>表の各行はデータレコードを表す。</p></li>
<li><p>表の各列は各レコード内のフィールドを表す。</p>
<ul>
<li><p>フィールドの各セルは、名前のような個々のデータ項目または属性を含む。</p></li>
<li><p>各レコードは、人のような単一の実体に対応する関連属性で構成される。</p></li>
<li><p>表一つに対するフィールド数は一定であることが多いが、レコード数は決まっていない。</p></li>
</ul>
</li>
</ul>
<p>テーブルには何百、何千という行があるかもしれないが、指定された条件を満たすレコードを検索する情報要求を使って、個々のレコードを簡単に見出し、検索し、更新することが可能だ。スプレッドシートに対する利点の一つはこの検索性の良さにある。</p>
<p>本書では成績表を例示して解説している。</p>
<p>LibreOffice Base は完全な機能を備えた RDB システムだが、Calc は RDB モデルに対応していない。</p>
</section>
<section id="calc-as-a-database-like-program">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Calc as a database-like program</a><a class="headerlink" href="#calc-as-a-database-like-program" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Calc は平坦な非 RDB 表に似ている。DB 表をシートに含めることも可能だ。</p></li>
<li><p>幅広いコマンドや関数を用いてデータを深く分析することが可能だ。</p>
<ul>
<li><p>並び替え</p></li>
<li><p>絞り込み</p></li>
<li><p>ピボット</p></li>
<li><p>2D/3D 図式などによる視覚的表現</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="associating-a-range-with-a-name">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Associating a range with a name</a><a class="headerlink" href="#associating-a-range-with-a-name" title="Permalink to this heading">¶</a></h2>
<p>シート内にデータベース表を仕込むには、その表が占める領域が要る。その領域とは、一つ以上のセルが連続するグループであるような範囲により表される。表に対する範囲にアクセスしやすくするために、範囲に意味のある名前を与えることが可能だ。</p>
<p>名前の利点を挙げると：</p>
<ul class="simple">
<li><p>範囲を特定しやすくなる。</p></li>
<li><p>アドレスだけでなく名前でも参照可能。</p></li>
<li><p>名前付き範囲への名前による参照が範囲のアドレスが変更されるたびに自動的に更新される。</p></li>
<li><p>名前付き範囲はすべて Navigator (<kbd class="kbd docutils literal notranslate">F5</kbd>) から閲覧可能かつアクセス可能。</p></li>
</ul>
<p>Calc には二種類の名前付き範囲が存在する：</p>
<dl class="simple">
<dt>データベース範囲</dt><dd><p>データベースのような操作の設定を保存する名前付き範囲</p>
</dd>
<dt>標準的範囲</dt><dd><p>データベース範囲でない名前付き範囲</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>この分類はどういうことだ？</p>
</div>
<section id="named-ranges">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Named ranges</a><a class="headerlink" href="#named-ranges" title="Permalink to this heading">¶</a></h3>
<p>以下、単一の行列のような（連結成分が一つしかない）セル範囲として定義された名前付き範囲について述べられる。</p>
<p>新しい名前付き範囲を作成する簡単な方法は：</p>
<ol class="arabic simple">
<li><p>シートで関連するセルを選択</p></li>
<li><p>数式バーの左にある <span class="guilabel">Name Box</span> 欄に名前を入力</p></li>
<li><p>入力中に表示される <span class="guilabel">Define Name for Range</span> ツールチップに注目し、入力が終わったら <kbd class="kbd docutils literal notranslate">Enter</kbd> を押す</p></li>
</ol>
<p><span class="guilabel">Define Name</span> ダイアログボックスを使う方法もある。次のどちらかで開く：</p>
<ul class="simple">
<li><p>メニュー <span class="menuselection"><span class="accelerator">S</span>heet ‣ <span class="accelerator">N</span>amed Ranges and Expressions ‣
<span class="accelerator">D</span>efine…</span> 実行</p></li>
<li><p><span class="guilabel">Manage Names</span> ダイアログボックスで <span class="guilabel"><span class="accelerator">A</span>dd…</span> を押す</p></li>
</ul>
<p><span class="guilabel">Manage Names</span> ダイアログボックスの開き方は：</p>
<ul class="simple">
<li><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F3</kbd> を押す</p></li>
<li><p>数式バーの左にある <span class="guilabel">Name Box</span> ドロップダウンリストで
<span class="menuselection">Manage Names…</span> を実行</p></li>
</ul>
<p><span class="guilabel">Paste Names</span> ダイアログボックスを使えば、定義済み名前付き範囲を入力するのが楽になる。開き方は次のどちらかを実行：</p>
<ul class="simple">
<li><p>メニュー <span class="menuselection"><span class="accelerator">I</span>nsert ‣ <span class="accelerator">N</span>amed Ranges or Expressions…</span></p></li>
<li><p>メニュー <span class="menuselection"><span class="accelerator">S</span>heet ‣ <span class="accelerator">N</span>amed Ranges and Expressions ‣
<span class="accelerator">I</span>nsert…</span></p></li>
</ul>
<p>項目を選択して <span class="guilabel"><span class="accelerator">P</span>aste</span> ボタンを押せば、現在のキャレット位置に選択した名前付き範囲が貼り付く。</p>
<p>範囲については Chapter 7, 8 を参照しろ。</p>
<section id="creating-named-ranges-using-row-or-column-headers">
<h4><a class="toc-backref" href="#id7" role="doc-backlink">Creating named ranges using row or column headers</a><a class="headerlink" href="#creating-named-ranges-using-row-or-column-headers" title="Permalink to this heading">¶</a></h4>
<p>メニュー <span class="menuselection"><span class="accelerator">S</span>heet ‣ <span class="accelerator">N</span>amed Ranges and Expressions ‣
<span class="accelerator">C</span>reate…</span> コマンドの用途：</p>
<p>表ヘッダーから名前付き範囲を複数同時に作成可能だ。これらのヘッダーは、表の境界線（上下の行、左右の列）から引くもので、ヘッダーに対応する各行または各列は名前付き範囲自体の作成に使用される。</p>
<p>例えば、表の一番上の行に含まれるヘッダーから範囲を作成する場合、それぞれの範囲はヘッダーラベルそれぞれに対応する列から生成される。</p>
<p>ヘッダーセルはこのコマンドを使って生成された名前付き範囲には含まれない。</p>
<p>手順：</p>
<ol class="arabic simple">
<li><p>シートにて名前付き範囲を作成する表を選択する。ヘッダーの行や列も選択に含めろ。</p></li>
<li><p>上記メニューを実行して <span class="guilabel">Create Names</span> ダイアログボックスを開く。</p></li>
<li><p>チェックボックスのオンオフを確認する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span></p></li>
</ol>
<p>この挙動があるので、複数の行や列に同じラベルを付けてはいけない。</p>
</section>
</section>
<section id="database-ranges">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Database ranges</a><a class="headerlink" href="#database-ranges" title="Permalink to this heading">¶</a></h3>
<p>データベース範囲はデータベースの表のように使用することを意図して設計されている。各行はレコードを表し、各セルはレコード内のフィールドを表す。データベース範囲は名前付き範囲と以下の点で異なる：</p>
<ul class="simple">
<li><p>データベース範囲は数式ではあり得ない。</p></li>
<li><p>データベース範囲は単一の矩形セル範囲でしかあり得ない。</p></li>
<li><p>データベース範囲では最初の行と最後の行を見出しと小計用途としてそれぞれ書式を有する。表のフィールドそれぞれに対して、セルの書式を保持することもできる。</p></li>
<li><p>データベース範囲はシート内のアドレスからの相対参照不可。</p></li>
<li><p>データベース範囲は、並び替え、絞り込み、小計、データインポートの設定を記述子と呼ばれるデータ構造に格納し、マクロを使用してアクセスすることが可能（データベース操作が実行されると記述子は更新される）。</p></li>
<li><p>データベース範囲は外部データに接続することが可能（そこからデータをスプレッドシートに取り込む）。</p></li>
</ul>
<p>データベース範囲の定義には <span class="guilabel">Define Database Range</span> ダイアログボックスを使う。</p>
<ol class="arabic simple">
<li><p>（全範囲を自動決定させる場合）データベース表のセル領域内のセルを一つ選択する</p></li>
<li><p>メニュー <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">D</span>efine Range…</span> 実行</p></li>
<li><p><span class="guilabel">Name</span> 欄に範囲名を入力する（変な字は使うな）</p></li>
<li><p>必要なら <span class="guilabel">Options</span> を展開してオプションを指定する</p></li>
<li><p><span class="guilabel"><span class="accelerator">A</span>dd</span> を押してデータベース範囲一覧に範囲を追加する</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span></p></li>
</ol>
<p>既存データベース範囲を変更する手順：</p>
<ol class="arabic simple">
<li><p>メニュー <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">D</span>efine Range…</span> 実行</p></li>
<li><p>範囲一覧から項目を一つ選ぶ（または名前を直接指定）とボタンのラベルが
<span class="guilabel">M<span class="accelerator">o</span>dify</span> に変化する</p></li>
<li><p>ダイアログボックス内 <span class="guilabel">Range</span> や <span class="guilabel">Options</span> で変更を加える</p></li>
<li><p><span class="guilabel">M<span class="accelerator">o</span>dify</span></p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span></p></li>
</ol>
<p>既存データベース範囲を削除する手順：</p>
<ol class="arabic simple">
<li><p>メニュー <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">D</span>efine Range…</span> 実行</p></li>
<li><p>範囲一覧から項目を一つ選ぶ（または名前を直接指定）</p></li>
<li><p><span class="guilabel"><span class="accelerator">D</span>elete</span></p></li>
<li><p><span class="guilabel"><span class="accelerator">Y</span>es</span></p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span></p></li>
</ol>
<p>既存データベース範囲を選択する手順：</p>
<ol class="arabic simple">
<li><p>メニュー <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">S</span>elect Range…</span> 実行</p></li>
<li><p>一覧から項目を選択</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span></p></li>
</ol>
<p>データ源からデータを取得して新規データベース範囲を作成する手順：</p>
<ol class="arabic simple">
<li><p>Data Sources Explorer を開く</p></li>
<li><p>左窓で目的データ源ツリーを展開</p></li>
<li><p>必要な表または問い合わせをクリックし、その構成データを右窓に表示する</p></li>
<li><p>右窓の全データを選択</p></li>
<li><p>データの左上隅になるスプレッドシートセルにデータをドラッグ＆ドロップ</p></li>
</ol>
<p>これでインポートされたデータのセル範囲を包含し、Import1, Import2 などの形式の既定の名前を持つ新規データベース範囲が自動的に生成する。</p>
<p>メニュー <span class="menuselection">Data ‣ R<span class="accelerator">e</span>fresh Range</span> を選択すると、関連するデータ源のデータが更新されればデータベース範囲の内容が更新される。シートのデータは外部データベースのデータと一致するように更新される。リンク方法については Chapter 11
を参照しろ。</p>
</section>
</section>
<section id="sorting">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Sorting</a><a class="headerlink" href="#sorting" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>Sorting is the process of rearranging data in a range or a sheet according to
a specified sort order.</p>
</div></blockquote>
<p>単一列の値に基づいてデータベース表を並び替えるもっとも単純な方法：</p>
<ol class="arabic simple">
<li><p>列のセルをどれでもよいので選択</p></li>
<li><p>昇順に並び替えるならば次のいずれかを実行（降順の場合は対応する UI を使用）：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Sort <span class="accelerator">A</span>scending</span> を実行</p></li>
<li><p>標準ツールバーの <span class="guilabel">Sort Ascending</span> 図像をクリック</p></li>
<li><p>AutoFilters を有効にしている場合は、関連列の AutoFilter コンボボックスで昇順並び替えを選択してもよい</p></li>
</ul>
</li>
</ol>
<p>これらの並べ替えコマンドは自動的に表が占めるセル範囲すべてを識別し、指示された列の値のみに基づいて表全体を並べ替える。ただし、ヘッダー行はそれと認識され、並べ替えの対象から外れる。</p>
<p>AutoFilter コンボボックスは次節で述べられるが、メニュー:menuselection:<cite>Sort by
Color</cite> に加え、<span class="menuselection">Sort Ascending</span> と <span class="menuselection">Sort
Descending</span> の項目もある。</p>
<p>複雑な並び替えを実現するには、メニュー <span class="menuselection"><span class="accelerator">D</span>ata ‣ <span class="accelerator">S</span>ort…</span> を実行して <span class="guilabel">Sort</span> ダイアログボックスを開く。開く前に表内のセルを一つ選択しておけ。</p>
<p>タブ <span class="guilabel">Sort Criteria</span> では並び替えを三段階指定することが可能。
<span class="guilabel">Sort Key</span> キー番号の小さいものから大きいのものへ順次並び替えられる。</p>
<p>タブ <span class="guilabel">Options</span> にはさらなる並び替えオプションが用意されている。これらについては Chapter 2 を参照しろ。</p>
</section>
<section id="filtering">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Filtering</a><a class="headerlink" href="#filtering" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p>A filter is a tool that hides or displays records within a sheet based on a
set of filtering criteria.</p>
</div></blockquote>
<p>絞り込みは長いデータ一覧から特定の項目を発見するのに便利だ。三種類の絞り込みがある：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Auto<span class="accelerator">F</span>ilter</span></p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ More <span class="accelerator">F</span>ilters ‣ <span class="accelerator">S</span>tandard Filter…</span></p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ More <span class="accelerator">F</span>ilters ‣ <span class="accelerator">A</span>dvanced Filter…</span></p></li>
</ul>
<p>データベース表に適用されている絞り込みを解除したい場合には <span class="menuselection"><span class="accelerator">D</span>ata
‣ More <span class="accelerator">F</span>ilters ‣ <span class="accelerator">R</span>eset Filter</span> を実行。</p>
<p>Chapter 2 も参照しろ。</p>
<section id="autofilter">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">AutoFilter</a><a class="headerlink" href="#autofilter" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>もっとも簡単な絞り込み</p></li>
<li><p>データ列の上部にある▼ボタンからコンボボックスにアクセス</p></li>
</ul>
<p>データベース表の列すべてに AutoFilters を追加するには、</p>
<ol class="arabic simple">
<li><p>表内のセルをどれでもいいからクリック</p></li>
<li><p>次のいずれかを実行：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Auto<span class="accelerator">F</span>ilter</span></p></li>
<li><p><span class="guilabel">Standard</span> ツールバー <span class="guilabel">AutoFilter</span> 図像クリック</p></li>
<li><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">L</kbd> 押し</p></li>
</ul>
</li>
</ol>
<p>AutoFilter 全解除手順は次のいずれかを実行：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ Auto<span class="accelerator">F</span>ilter</span></p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ More <span class="accelerator">F</span>ilters ‣ <span class="accelerator">H</span>ide AutoFilter</span></p></li>
<li><p><span class="guilabel">Standard</span> ツールバー <span class="guilabel">AutoFilter</span> 図像クリック</p></li>
<li><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">L</kbd> 押し</p></li>
</ul>
<p>コンボボックスのオプション：</p>
<ul class="simple">
<li><p>昇順か降順で並び替え</p></li>
<li><p>背景色か文字色で並び替え</p></li>
<li><p>背景色か文字色で絞り込み</p></li>
<li><p><span class="menuselection">Filter by Condition ‣</span> 以下にある絞り込み項目</p>
<ul>
<li><p><span class="menuselection">Empty</span></p></li>
<li><p><span class="menuselection">Not Empty</span></p></li>
<li><p><span class="menuselection">Top 10</span></p></li>
<li><p><span class="menuselection">Bottom 10</span></p></li>
</ul>
</li>
<li><p>チェックボックス各種は値の絞り込みに対応</p></li>
<li><p>列に絞り込みが適用中の場合、<span class="guilabel">Clear Filter</span> で解除</p></li>
</ul>
</section>
<section id="standard-filters">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Standard filters</a><a class="headerlink" href="#standard-filters" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>標準絞り込みは AutoFilters よりも複雑で、最大八つの絞り込み条件を設定可能。</p></li>
<li><p>強力絞り込みは正規表現により設定可能。</p></li>
<li><p>標準絞り込みはダイアログボックスを使用する。開き方は：</p>
<ul>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ More <span class="accelerator">F</span>ilters ‣ <span class="accelerator">S</span>tandard Filter…</span></p></li>
<li><p>AutoFilter コンボボックスの <span class="menuselection">Standard Filter…</span> オプション</p></li>
</ul>
</li>
</ul>
<p>Chapter 2 参照。</p>
</section>
<section id="advanced-filters">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Advanced filters</a><a class="headerlink" href="#advanced-filters" title="Permalink to this heading">¶</a></h3>
<p>高度な絞り込みの判定基準は、ダイアログボックスに入力するのではなく、シートに保存される。そのため、使う前にまず絞り込み基準を含むセル範囲を設定する必要がある。</p>
<p>判定基準範囲を設定する手順：</p>
<ol class="arabic simple">
<li><p>絞り込む範囲の列見出しをシートの空き地にコピー（別シートでかまわない）</p></li>
<li><p>判定基準範囲列見出しの下に絞り込み判定を入力する。</p>
<ul class="simple">
<li><p>同じ行の判定は AND で接続される</p></li>
<li><p>各行の判定グループは OR で接続される</p></li>
<li><p>空セルは無視される</p></li>
<li><p>絞り込み一つあたり最大八行定義可能</p></li>
</ul>
</li>
</ol>
<p>ここまでやって高度な絞り込みを設定することになる：</p>
<ol class="arabic simple">
<li><p>絞り込み対象セル範囲を選択（データベース表ならばセル一つでいい）</p></li>
<li><p><span class="menuselection"><span class="accelerator">D</span>ata ‣ More <span class="accelerator">F</span>ilters ‣ <span class="accelerator">A</span>dvanced Filter…</span></p></li>
<li><p>ダイアログボックス操作</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span></p></li>
</ol>
<p>個々の名前付き範囲に対して、<span class="guilabel">Define Name</span> と <span class="guilabel">Manage Names</span>
ダイアログボックスで <span class="guilabel"><span class="accelerator">F</span>ilter</span> にチェックを入れることができる。この方法で絞り込みのためにマークされた名前付き範囲しか <span class="guilabel">Advanced Filter</span> ダイアログボックスの <span class="guilabel">Read Filter Criteria From</span> 欄のドロップダウンボックスで選択できない。データベースの範囲はドロップダウンボックスで選択できない。</p>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>本文のこの辺にあるデモを再現しろ。データは：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Student   HW #1   HW #2   HW #3   Quiz #1 Quiz #2 Test #1
Andrew    90      100     82      90      88      92
Bethany   95      100     82      80      88      93
Charles   80      93      73      80      75      84
David     75      86      91      40      88      79
Emily     100     100     81      100     75      94
Ferdinand 85      93      73      60      50      72
Georgia   70      80      55      39      75      67
Haley     85      93      82      70      75      76
Ian       100     100     91      90      100     96
Jennifer  85      93      73      80      100     90
</pre></div>
</div>
</div>
</section>
</section>
<section id="useful-database-like-functions">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Useful database-like functions</a><a class="headerlink" href="#useful-database-like-functions" title="Permalink to this heading">¶</a></h2>
<section id="database-category-functions">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Database category functions</a><a class="headerlink" href="#database-category-functions" title="Permalink to this heading">¶</a></h3>
<section id="overview">
<h4><a class="toc-backref" href="#id16" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h4>
<p>Database 区分にある関数 12 個はスプレッドシート内の矩形領域を占める単純なデータベースを分析するのに役立つことを目的としており、データは各レコードごとに一行として整理されている。各列のヘッダーセルには列の名前が表示され、通常、その列の各セルの内容を示す。</p>
<p>Database 区分の関数は次の三つの引数を取る：</p>
<dl class="simple">
<dt>Database</dt><dd><p>データベースのセル範囲</p>
</dd>
<dt>DatabaseField</dt><dd><p>関数の計算に用いるデータを含む列</p>
</dd>
<dt>SearchCriteria</dt><dd><p>検索条件を含む別領域セル範囲</p>
</dd>
</dl>
</section>
<section id="database-function-arguments">
<h4><a class="toc-backref" href="#id17" role="doc-backlink">Database function arguments</a><a class="headerlink" href="#database-function-arguments" title="Permalink to this heading">¶</a></h4>
<p class="rubric">Database</p>
<ul class="simple">
<li><p>範囲の最初の行はフィールド名からなり、それ以降の行は対応するフィールド値を持つレコードだ。</p></li>
<li><p>セル範囲定義としては、矩形の左上と右下のセル参照をコロンで結合する。<code class="docutils literal notranslate"><span class="pre">A1:E10</span></code>
のように。</p></li>
<li><p>名前付き範囲またはデータベース範囲名を指定してもよい。こちらのほうが可読性と保守性を向上する。</p></li>
</ul>
<p class="rubric">DatabaseField</p>
<ul class="simple">
<li><p>検索条件が適用されデータ行が選択された後、関数が計算に使用する列を指定する。</p></li>
<li><p>この引数を指定する方法はいろいろある。</p>
<ul>
<li><p>データベース領域内のヘッダーセルへの参照あるいは（有効な）名前を入力する。</p></li>
<li><p>データベース領域内の列を 1 から開始する（有効な）番号で指定する。</p></li>
<li><p>データベース範囲の最初の行から見出し名をリテラル文字列で指定する。</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">DCOUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">DCOUNTA</span></code> 以外の Database 関数ではこの引数は入力必須だ。</p></li>
</ul>
<p class="rubric">SearchCriteria</p>
<ul class="simple">
<li><p>Database 引数と同様に、最初の行はフィールド名。それ以降の行は関連フィールドについての条件だ。</p></li>
<li><p>Database 領域と SearchCriteria 領域は隣接している必要はない。同一シート内にある必要もない。</p></li>
<li><p>セル範囲定義方法は Database 引数と同様。</p></li>
</ul>
</section>
<section id="defining-search-criteria">
<h4><a class="toc-backref" href="#id18" role="doc-backlink">Defining search criteria</a><a class="headerlink" href="#defining-search-criteria" title="Permalink to this heading">¶</a></h4>
<ul class="simple">
<li><p>SearchCriteria 領域が占める列数は Database 領域の幅に一致する必要はない。</p></li>
<li><p>SearchCriteria の最初の行に現れる見出しすべては Database のそれと一致する必要がある。</p></li>
<li><p>条件式は SearchCriteria 領域の二行目以降のセルに入力される。</p></li>
<li><p>比較演算子を用いて SearchCriteria 領域セルに条件を作成する。セルが空でなく、比較演算子で始まらないものは <code class="docutils literal notranslate"><span class="pre">=</span></code> とみなされる。</p></li>
</ul>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>正規表現に関する事項と MS Excel との互換性に関する事項は割愛。</p>
</div>
</section>
<section id="example-of-database-function-use">
<h4><a class="toc-backref" href="#id19" role="doc-backlink">Example of Database function use</a><a class="headerlink" href="#example-of-database-function-use" title="Permalink to this heading">¶</a></h4>
<p>本書のスクリーンショットに倣え。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Name Grade   Age     Distance (meters)       Weight (kg)
Andy 3       9       150     40
Betty        4       10      1000    42
Charles      3       10      300     51
Daniel       5       11      1200    48
Eva  2       8       650     33
Frank        2       7       300     42
Greta        1       7       200     36
Harry        3       9       1200    44
Irene        2       8       1000    42
</pre></div>
</div>
</section>
<section id="list-of-database-functions">
<h4><a class="toc-backref" href="#id20" role="doc-backlink">List of Database functions</a><a class="headerlink" href="#list-of-database-functions" title="Permalink to this heading">¶</a></h4>
<p>これらの関数は計算中、日付や論理値を数値として扱う。</p>
<dl>
<dt>DAVERAGE</dt><dd><p>指定された検索条件に一致するすべての行について、指定された列のセル（フィールド）の数値の平均を計算する。</p>
</dd>
<dt>DCOUNT, DCOUNTA</dt><dd><p>指定された検索条件に一致するすべての行に対して、指定された列のうち</p>
<ul class="simple">
<li><p>数値を含むセルの数を返す。</p></li>
<li><p>空でないセルの数を返す。</p></li>
</ul>
<p>列が指定されていない場合、内容に関係なく、指定された検索条件に一致するすべてのレコードの数を返す。</p>
</dd>
<dt>DGET</dt><dd><p>指定された検索条件に一致する唯一の行に対して、指定された列のセル内容を返す。</p>
</dd>
<dt>DMAX, DMIN</dt><dd><p>指定された検索条件に一致するすべての行について、数値を含む指定された列のセル全体の最大値、最小値を計算する。</p>
<ul class="simple">
<li><p>空白セルや数値以外の文字を含むセルは含まれない。</p></li>
<li><p>一致するレコードが見つからない場合など、変な場合には 0 を返す。</p></li>
</ul>
</dd>
<dt>DPRODUCT</dt><dd><p>すべての数値の積を返す。</p>
</dd>
<dt>DSTDEV, DSTDEVP</dt><dd><p>指定された検索条件に一致するすべての行について、指定列のセル内の数値に基づいて標本標準偏差、母集団標準偏差を計算する。数値以外の値は無視。</p>
</dd>
<dt>DSUM</dt><dd><p>すべての数値の和を返す。</p>
</dd>
<dt>DVAR, DVARP</dt><dd><p>標本分散、母集団分散。</p>
</dd>
</dl>
</section>
</section>
<section id="other-database-like-functions">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Other database-like functions</a><a class="headerlink" href="#other-database-like-functions" title="Permalink to this heading">¶</a></h3>
<p>Calc に用意されている関数の中には、表形式のデータで使用することを意図したもの
(e.g. <code class="docutils literal notranslate"><span class="pre">HLOOKUP</span></code>, <code class="docutils literal notranslate"><span class="pre">VLOOKUP</span></code>) もあれば、どのような状況でも使用できるものもある。</p>
<p>本書の表はデータベースに Calc の表を使用する場合に役立つ関数の一覧だ。その多くは、データベース以外の状況で使用される典型的なスプレッドシート関数としておなじみのものだが、中にはデータベース表テーブルで特に役立つものもある。</p>
</section>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc13.html" title="Previous document">LibreOffice Calc Chapter 13 Macros ノート</a>
        </li>
        <li>
          <a href="calc15.html" title="Next document">Calc Guide Chapter 15, Setting up and Customizing ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../../_static/logos.png"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>