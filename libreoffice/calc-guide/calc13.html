<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>LibreOffice Calc Chapter 13 Macros ノート &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=1a9a5cd9" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=5a6f99c4"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Chapter 14 Calc as a Database ノート" href="calc14.html" />
    <link rel="prev" title="Calc Guide Chapter 12 Sharing and Reviewing Spreadsheets ノート" href="calc12.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc12.html" title="Previous document">Calc Guide Chapter 12 Sharing and Reviewing Spreadsheets ノート</a>
        </li>
        <li>
          <a href="calc14.html" title="Next document">Chapter 14 Calc as a Database ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <section id="libreoffice-calc-chapter-13-macros">
<h1>LibreOffice Calc Chapter 13 Macros ノート<a class="headerlink" href="#libreoffice-calc-chapter-13-macros" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">章見出し</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id3">Introduction</a></p></li>
<li><p><a class="reference internal" href="#on-visual-basic-for-applications-vba-compatibility" id="id4">On Visual Basic for Applications (VBA) compatibility</a></p></li>
<li><p><a class="reference internal" href="#using-the-macro-recorder" id="id5">Using the macro recorder</a></p></li>
<li><p><a class="reference internal" href="#write-your-own-functions" id="id6">Write your own functions</a></p>
<ul>
<li><p><a class="reference internal" href="#create-a-function-macro" id="id7">Create a function macro</a></p></li>
<li><p><a class="reference internal" href="#using-a-macro-as-a-function" id="id8">Using a macro as a function</a></p></li>
<li><p><a class="reference internal" href="#macro-security-warnings" id="id9">Macro security warnings</a></p></li>
<li><p><a class="reference internal" href="#loaded-unloaded-libraries" id="id10">Loaded / unloaded libraries</a></p></li>
<li><p><a class="reference internal" href="#passing-arguments-to-a-macro" id="id11">Passing arguments to a macro</a></p></li>
<li><p><a class="reference internal" href="#arguments-are-passed-as-values" id="id12">Arguments are passed as values</a></p></li>
<li><p><a class="reference internal" href="#writing-macros-that-act-like-built-in-functions" id="id13">Writing macros that act like built-in functions</a></p></li>
<li><p><a class="reference internal" href="#deleting-libreoffice-basic-macros" id="id14">Deleting LibreOffice Basic macros</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#accessing-cells-directly" id="id15">Accessing cells directly</a></p></li>
<li><p><a class="reference internal" href="#sorting" id="id16">Sorting</a></p></li>
<li><p><a class="reference internal" href="#overview-of-beanshell-javascript-and-python-macros" id="id17">Overview of BeanShell, JavaScript, and Python macros</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id18">Introduction</a></p></li>
<li><p><a class="reference internal" href="#beanshell-macros" id="id19">BeanShell macros</a></p></li>
<li><p><a class="reference internal" href="#javascript-macros" id="id20">JavaScript macros</a></p></li>
<li><p><a class="reference internal" href="#python-macros" id="id21">Python macros</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#scriptforge-library" id="id22">ScriptForge library</a></p></li>
<li><p><a class="reference internal" href="#built-in-object-inspector" id="id23">Built-in object inspector</a></p></li>
<li><p><a class="reference internal" href="#working-with-vba-macros" id="id24">Working with VBA macros</a></p>
<ul>
<li><p><a class="reference internal" href="#loading-vba-code" id="id25">Loading VBA code</a></p></li>
<li><p><a class="reference internal" href="#option-vbasupport-statement" id="id26">Option VBASupport statement</a></p></li>
<li><p><a class="reference internal" href="#vba-userforms-libreoffice-basic-dialogs" id="id27">VBA UserForms (LibreOffice Basic Dialogs)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#conclusion" id="id28">Conclusion</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h2>
<p>マクロとは、後で使用するために保存される一連のコマンドやキー操作のことだ。</p>
<ul class="simple">
<li><p>例：開いているスプレッドシートの現在のセルに自分の住所を入力するマクロ</p></li>
</ul>
<p>マクロを使用すると、単純なタスクと複雑なタスクの両方を自動化できる。</p>
<p>マクロを作成する最も簡単な方法は、Calc の UI を通じて一連の操作を記録することだ。</p>
<p>BASIC 言語の方言である LibreOffice Basic スクリプト言語により記録したマクロを保存する。そして LibreOffice Basic IDE を使用して編集および拡張可能。</p>
<p>マクロを作成する言語としては次の四つのスクリプト言語が対応されている：</p>
<ul class="simple">
<li><p>LibreOffice Basic</p></li>
<li><p>Python</p></li>
<li><p>JavaScript</p></li>
<li><p>BeanShell</p></li>
</ul>
</section>
<section id="on-visual-basic-for-applications-vba-compatibility">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">On Visual Basic for Applications (VBA) compatibility</a><a class="headerlink" href="#on-visual-basic-for-applications-vba-compatibility" title="Permalink to this heading">¶</a></h2>
<p>LibreOffice Basic 言語と VBA 言語は BASIC の方言だ。</p>
<p>MS Excel で書かれたマクロを LibreOffice で使用したい場合は、まず LibreOffice
Basic IDE でコードを編集する必要がある。</p>
</section>
<section id="using-the-macro-recorder">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Using the macro recorder</a><a class="headerlink" href="#using-the-macro-recorder" title="Permalink to this heading">¶</a></h2>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p><em>Getting Started Guide</em> を先に読んでおいたほうがいいかもしれない。</p>
</div>
<p>まず、オプション設定から <span class="menuselection">LibreOffice ‣ Advanced</span> ページでオプション <span class="guilabel">Enable macro recording (may be limited)</span> をオンにしておけ。</p>
<p>本書手順では、スプレッドシートのセル範囲に対して、乗算を伴う特殊な貼り付けを実行するマクロを作成する。要点を記すと：</p>
<ol class="arabic simple">
<li><p><span class="menuselection"><span class="accelerator">T</span>ools ‣ <span class="accelerator">M</span>acros ‣ <span class="accelerator">R</span>ecord Macro</span> で開始。テキストエディターにおけるキーボードマクロ開始のようなものだと考えられる。<span class="guilabel">Record
Macro</span> ミニウィンドウが現れる。</p></li>
<li><p>所望のシート編集を行う。</p></li>
<li><p>ミニウィンドウ内の <span class="guilabel">Stop Recording</span> を押して収録終了。</p></li>
</ol>
<p>正常な操作が収録されると <span class="guilabel">Basic Macros</span> ダイアログボックスが開く。以下、収録内容を編集する手順：</p>
<ol class="arabic simple">
<li><p><span class="guilabel">Save Macro</span> ツリーで現在文書ノードの子にある <span class="guilabel">Standard</span>
を選択する。</p></li>
<li><p>タブの <span class="guilabel"><span class="accelerator">N</span>ew…</span> を押して <span class="guilabel">New Module</span> ダイアログボックスを出し、意味のある名前を入力して <span class="guilabel"><span class="accelerator">O</span>K</span> を押す。</p></li>
</ol>
<p><span class="guilabel">Basic Macros</span> ダイアログボックスの <span class="guilabel">Save Macro In</span> ツリーにはライブラリー容器、ライブラリー、モジュール、マクロが階層化されている。</p>
<p>ライブラリ名、モジュール名、マクロ名に使用可能な文字が規定されているので注意。一般的なプログラミング言語にありがちな規則だと思っていい。</p>
</section>
<section id="write-your-own-functions">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Write your own functions</a><a class="headerlink" href="#write-your-own-functions" title="Permalink to this heading">¶</a></h2>
<section id="create-a-function-macro">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Create a function macro</a><a class="headerlink" href="#create-a-function-macro" title="Permalink to this heading">¶</a></h3>
<p>マクロを作成し、関数を呼び出すようにそれを実行することが可能。単純な関数マクロの定義手順：</p>
<ol class="arabic simple">
<li><p><span class="menuselection"><span class="accelerator">T</span>ools ‣ <span class="accelerator">M</span>acros ‣ <span class="accelerator">O</span>rganize Macros ‣ <span class="accelerator">B</span>asic…</span> を実行して <span class="guilabel">Basic Macros</span> ダイアログボックスを開く。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>rganizer…</span> を押す。<span class="guilabel">Basic Macro Organizer</span> ダイアログボックスが開く。</p></li>
<li><p><span class="guilabel">Libraries</span> タブを開く。</p></li>
<li><p><span class="guilabel">L<span class="accelerator">o</span>cation</span> ドロップダウンリストを現在文書に合わせるなどして、<span class="guilabel"><span class="accelerator">L</span>ibrary</span> 欄の一覧を更新する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">N</span>ew…</span> を押す。</p></li>
<li><p>意味のある名前を記入して <span class="guilabel"><span class="accelerator">O</span>K</span> を押す。一覧が更新する。</p></li>
<li><p>今入力した名前の項目を選択して <span class="guilabel"><span class="accelerator">E</span>dit…</span> を押す。IDE が開く。</p></li>
</ol>
<p>以下、このエディターで VBA 的コードを書いて保存し、シートのセルから数式の形でそれを呼び出すという流れになる。</p>
</section>
<section id="using-a-macro-as-a-function">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Using a macro as a function</a><a class="headerlink" href="#using-a-macro-as-a-function" title="Permalink to this heading">¶</a></h3>
<p>セルを選択し、数式バーにマクロ呼び出しコードを入力すると、Calc がマクロを検出して呼び出し、そのセルに結果を表示する。</p>
</section>
<section id="macro-security-warnings">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Macro security warnings</a><a class="headerlink" href="#macro-security-warnings" title="Permalink to this heading">¶</a></h3>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>本節の内容が再現できない。実際にスプレッドシートを開き直すと本書のスクリーンショットのようなものは現れず。シート上部に警告が表示される。そこには
<span class="guilabel"><span class="accelerator">E</span>nable Macros</span> ボタンのようなものは存在しない。</p>
<p>これはオプション設定の <span class="menuselection">LibreOffice ‣ Security</span> ページの
<span class="guilabel">Macro <span class="accelerator">s</span>ecurity…</span> を押して、<span class="guilabel">Trusted Sources</span> タブの信用ファイルパス一覧を操作して回避することにする。</p>
</div>
</section>
<section id="loaded-unloaded-libraries">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Loaded / unloaded libraries</a><a class="headerlink" href="#loaded-unloaded-libraries" title="Permalink to this heading">¶</a></h3>
<p>スプレッドシートを開くとロードされるマクロライブラリーは次の二種類だ：</p>
<ul class="simple">
<li><p>My Macros ライブラリー容器内の Standard ライブラリー</p></li>
<li><p>文書自身の Standard ライブラリー</p></li>
</ul>
<p>それゆえ、先ほどのスプレッドシートを再度開くと、マクロ関数呼び出しのセルは
<code class="docutils literal notranslate"><span class="pre">#NAME?</span></code> エラーとなる。これを修正する手順は本書のように二段階に分かれる：</p>
<ol class="arabic simple">
<li><p><span class="guilabel">Basic Macros</span> ダイアログボックスを開いて、ツリーノードを選択することで対象ライブラリーをロードする。</p></li>
<li><p>マクロ実装を次のように修正する：</p>
<ul class="simple">
<li><p>本体実装を MyMacros/Standard/CalcFunctions に移転する。</p></li>
<li><p>旧関数はそのラッパーとする。</p></li>
</ul>
</li>
</ol>
</section>
<section id="passing-arguments-to-a-macro">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Passing arguments to a macro</a><a class="headerlink" href="#passing-arguments-to-a-macro" title="Permalink to this heading">¶</a></h3>
<p>本文で示されている関数で用いられている重要な技法とは：</p>
<ol class="arabic simple">
<li><p>仮引数に <code class="docutils literal notranslate"><span class="pre">Optional</span></code> キーワードを付ける。</p></li>
<li><p>オプション引数を関数 <code class="docutils literal notranslate"><span class="pre">IsMissing</span></code> で実引数が与えられたかをチェックする。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">IsArray</span></code> で値が配列であるかどうかをチェックする。</p></li>
<li><p>関数に <code class="docutils literal notranslate"><span class="pre">PositiveSum(A2:B5)</span></code> のように範囲が渡される場合に備え、関数
<code class="docutils literal notranslate"><span class="pre">LBound</span></code> と <code class="docutils literal notranslate"><span class="pre">UBound</span></code> を用いて配列の境界を決定する（前者は 1 であることが確定しているが、コードの一貫性を高めるためにこう書く）。</p></li>
</ol>
<p>本書で次に示されている関数のように、引数リストは一般的なプログラミング言語のそれのように記述される。</p>
</section>
<section id="arguments-are-passed-as-values">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Arguments are passed as values</a><a class="headerlink" href="#arguments-are-passed-as-values" title="Permalink to this heading">¶</a></h3>
<p>Calc からマクロに渡される引数は常に値 (by-value) だ。つまり、どのセルが使用されたかを知ることはできない。どのセルが参照されたかを知る必要がある場合は、範囲を文字列として渡し、その文字列を解析して、参照されたセル内の値を取得するなどする。</p>
</section>
<section id="writing-macros-that-act-like-built-in-functions">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Writing macros that act like built-in functions</a><a class="headerlink" href="#writing-macros-that-act-like-built-in-functions" title="Permalink to this heading">¶</a></h3>
<p>Calc はマクロを関数として検出、呼び出すが、組み込み関数としての振る舞いはしない。例えば、マクロは関数一覧に現れない。</p>
</section>
<section id="deleting-libreoffice-basic-macros">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Deleting LibreOffice Basic macros</a><a class="headerlink" href="#deleting-libreoffice-basic-macros" title="Permalink to this heading">¶</a></h3>
<p>マクロを削除したい場合とモジュールを削除したい場合がある。不要なマクロを削除する手順は：</p>
<ol class="arabic simple">
<li><p>上述のように <span class="guilabel">Macros</span> ダイアログボックスを開く。</p></li>
<li><p>削除対象のマクロを選択して <span class="guilabel">Delete</span> を押す。</p></li>
<li><p>確認で <span class="guilabel"><span class="accelerator">Y</span>es</span> を押す。</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>lose</span> を押す。</p></li>
</ol>
<p>不要なモジュールを削除する手順：</p>
<ol class="arabic simple">
<li><p>上述のように <span class="guilabel">Macros</span> ダイアログボックスを開く。</p></li>
<li><p><span class="guilabel">Organizer</span> を押して <span class="guilabel">Basic Macro Organizer</span> を開く。</p></li>
<li><p><span class="guilabel">Modules</span> タブが開いているので、削除対象モジュールを選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">D</span>elete</span> を押す。</p></li>
<li><p>確認で <span class="guilabel"><span class="accelerator">Y</span>es</span> を押す。</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>lose</span> を押す。</p></li>
</ol>
</section>
</section>
<section id="accessing-cells-directly">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Accessing cells directly</a><a class="headerlink" href="#accessing-cells-directly" title="Permalink to this heading">¶</a></h2>
<p>LibreOffice の内部オブジェクトに直接アクセスして、Calc 文書を操作できる。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ThisComponent.getSheets()</span></code> によってシートにアクセスする。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getCellByPosition(col,</span> <span class="pre">row)</span></code> で特定の行と列のセルを得る。</p></li>
</ul>
<p>セルオブジェクトのメソッドはとりあえず次を知っておくといい。適切な値を設定するには、対応する <code class="docutils literal notranslate"><span class="pre">set</span></code> 関数を使用する：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">getValue()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getString()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getFormula()</span></code></p></li>
</ul>
<p>シートオブジェクトの <code class="docutils literal notranslate"><span class="pre">getCellRangeByName</span></code> メソッドはセルまたはセル範囲を返す。セル範囲は配列の配列としてデータを返すので、二次元の配列として扱うよりも面倒だ。</p>
<p>マクロが Calc 関数として呼び出される場合、関数を含むセルを除き、マクロが呼び出されたシート内のセルの値を変更することはない。</p>
</section>
<section id="sorting">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Sorting</a><a class="headerlink" href="#sorting" title="Permalink to this heading">¶</a></h2>
<p>ソートをコードで実現しようとすると、本書のように案外いろいろなオブジェクトの面倒面倒を見なければならないということを覚えておけば今はいいだろう。</p>
</section>
<section id="overview-of-beanshell-javascript-and-python-macros">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Overview of BeanShell, JavaScript, and Python macros</a><a class="headerlink" href="#overview-of-beanshell-javascript-and-python-macros" title="Permalink to this heading">¶</a></h2>
<section id="id2">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Introduction</a><a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<p>ここまで見てきたコードは LibreOffice Basic という言語だ。他にも次の言語を対応している：</p>
<ul class="simple">
<li><p>BeanShell</p></li>
<li><p>JavaScript</p></li>
<li><p>Python</p></li>
</ul>
<p>先述のマクロ記録機能を使用すると Calc は LibreOffice Basic でマクロを作成する。その他のスクリプト言語を使用するには、自分でコードを記述する必要がある。</p>
<p><span class="menuselection"><span class="accelerator">T</span>ools ‣ <span class="accelerator">M</span>acros ‣ R<span class="accelerator">u</span>n Macro…</span> コマンドは上記の言語のいずれも実行可能だ。</p>
<p><span class="menuselection"><span class="accelerator">T</span>ools ‣ <span class="accelerator">M</span>acros &gt; <span class="accelerator">E</span>dit Macros…</span> コマンドは Basic マクロだけ選択、編集可能だ。</p>
</section>
<section id="beanshell-macros">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">BeanShell macros</a><a class="headerlink" href="#beanshell-macros" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><p>BeanShell is a Java-like scripting language that was first released in 1999.</p>
</div></blockquote>
<p>メニューから <span class="menuselection"><span class="accelerator">T</span>ools ‣ <span class="accelerator">M</span>acros ‣ <span class="accelerator">O</span>rganize Macros ‣
B<span class="accelerator">e</span>anShell…</span> を実行すると <span class="guilabel">BeanShell Macros</span> ダイアログボックスが開く。</p>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>JRE が有効になっている必要がある。無効なら確認ダイアログボックスが開く。</p>
</div>
<p><span class="guilabel"><span class="accelerator">E</span>dit…</span> ボタンを押せばデバッグウィンドウが開く。</p>
</section>
<section id="javascript-macros">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">JavaScript macros</a><a class="headerlink" href="#javascript-macros" title="Permalink to this heading">¶</a></h3>
<p>同じような操作で <span class="guilabel">JavaScript Macros</span> ダイアログボックスが開く。編集ボタンをクリックすると <a class="reference external" href="https://github.com/mozilla/rhino">Rhino JavaScript</a> デバッガーが開く。</p>
</section>
<section id="python-macros">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Python macros</a><a class="headerlink" href="#python-macros" title="Permalink to this heading">¶</a></h3>
<p>同じような操作で <span class="guilabel">Python Macros</span> ダイアログボックスが開く。</p>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>HelloWorld を実行したら Writer が起動する。なぜだ？</p>
</div>
</section>
</section>
<section id="scriptforge-library">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">ScriptForge library</a><a class="headerlink" href="#scriptforge-library" title="Permalink to this heading">¶</a></h2>
<p>ScriptForge ライブラリーの目的は LibreOffice API やコマンドを学ぶことなく、マクロの作成を簡単にすることだ。</p>
<p>ScriptForge ライブラリーは LibreOffice Basic と Python を対応している。各サービスには特定のトピックに関連するメソッドやプロパティーがある。</p>
<ul class="simple">
<li><p><em>Getting Started Guide</em> の関連章に ScriptForge に関する補足説明と例が記載されている。</p></li>
<li><p>LibreOffice ヘルプシステムの索引で ScriptForge を検索すると情報があるはずだ。</p></li>
</ul>
</section>
<section id="built-in-object-inspector">
<h2><a class="toc-backref" href="#id23" role="doc-backlink">Built-in object inspector</a><a class="headerlink" href="#built-in-object-inspector" title="Permalink to this heading">¶</a></h2>
<p>プログラマーにとって、<abbr title="Universal Network Objects">UNO</abbr> オブジェクト型や、サービス、メソッド、プロパティーを発見することは主要な課題の一つだ。</p>
<p>メニューから <span class="menuselection"><span class="accelerator">T</span>ools ‣ Develo<span class="accelerator">p</span>ment Tools</span> を実行するとビューワーが開く。メインウィンドウ下部にドッキングしている。</p>
</section>
<section id="working-with-vba-macros">
<h2><a class="toc-backref" href="#id24" role="doc-backlink">Working with VBA macros</a><a class="headerlink" href="#working-with-vba-macros" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Calc が Excel ワークブックを読み込むにもかかわらず、その VBA が Calc で動作しない主な理由は、Calc がワークシート上のセルなどのワークブック部品にアクセスするために異なる仕組みを用いているためだ。</p></li>
<li><p>VBA コードを変換するには LibreOffice で VBA コードをまず読み込む必要がある。</p></li>
</ul>
<section id="loading-vba-code">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Loading VBA code</a><a class="headerlink" href="#loading-vba-code" title="Permalink to this heading">¶</a></h3>
<p>設定ダイアログボックスの <span class="menuselection">Load/Save ‣ VBA Properties</span> ページでは、LibreOffice で開いた MS Office 文書のマクロを保持するかどうかを選択可能。</p>
<ul class="simple">
<li><p>コードを読み込み、それを変更するとそのコードは MS Office 形式保存時には保存されない。</p></li>
<li><p><span class="guilabel"><span class="accelerator">S</span>ave original Basic code</span> は <span class="guilabel">Load Basic <span class="accelerator">c</span>ode</span> より優先される。</p></li>
</ul>
</section>
<section id="option-vbasupport-statement">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Option VBASupport statement</a><a class="headerlink" href="#option-vbasupport-statement" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Option</span> <span class="pre">VBASupport</span></code> 文は LibreOffice Basic が一部の VBA 文、関数、オブジェクトを対応することを指定する。</p>
<ul class="simple">
<li><p>このオプションはモジュール内の実行可能コードの前に追加する。</p></li>
<li><p>VBA のサポートは完全ではないものの、一般的な使用パターンの大部分を網羅している。</p></li>
<li><p>VBASupport が有効な場合、LibreOffice Basic 関数の引数と戻り値は VBA の引数と同じだ（無効の場合は異なる）。</p></li>
</ul>
</section>
<section id="vba-userforms-libreoffice-basic-dialogs">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">VBA UserForms (LibreOffice Basic Dialogs)</a><a class="headerlink" href="#vba-userforms-libreoffice-basic-dialogs" title="Permalink to this heading">¶</a></h3>
<p>フォーム（ダイアログボックス）は VBA オプションでは自動的に変換処理されない。本書のコードのように手動で直せ。</p>
</section>
</section>
<section id="conclusion">
<h2><a class="toc-backref" href="#id28" role="doc-backlink">Conclusion</a><a class="headerlink" href="#conclusion" title="Permalink to this heading">¶</a></h2>
<p>本章に登場した各話題は本来は一章を割り当てるような大きいものだ。</p>
<p><a class="reference external" href="https://extensions.libreoffice.org/">LibreOffice 拡張機能のウェブサイト</a> には LibreOffice Basic クイックレファレンスカード集がある。</p>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc12.html" title="Previous document">Calc Guide Chapter 12 Sharing and Reviewing Spreadsheets ノート</a>
        </li>
        <li>
          <a href="calc14.html" title="Next document">Chapter 14 Calc as a Database ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="https://showa-yojyo.github.io/" title="プレハブ小屋 Since 1999"><img src="../../_static/logos.png"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>