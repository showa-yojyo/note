<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Calc Guide Chapter 11, Linking Data ノート &#8212; 読書ノート 1.6dev</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=c9b0a06a" />
    <script src="../../_static/documentation_options.js?v=4354bf25"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Calc Guide Chapter 12, Sharing and Reviewing Spreadsheets ノート" href="calc12.html" />
    <link rel="prev" title="Calc Guide Chapter 10, Data Analysis ノート" href="calc10.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc10.html" title="Previous">Calc Guide Chapter 10, Data Analysis ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Calc Guide 読書ノート</a>
        </li>
        <li>
          <a href="calc12.html" title="Next">Calc Guide Chapter 12, Sharing and Reviewing Spreadsheets ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="calc-guide-chapter-11-linking-data">
<h1>Calc Guide Chapter 11, Linking Data ノート<a class="headerlink" href="#calc-guide-chapter-11-linking-data" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">章見出し</p>
<ul class="simple">
<li><p><a class="reference internal" href="#using-multiple-sheets" id="id5">Using multiple sheets</a></p>
<ul>
<li><p><a class="reference internal" href="#why-use-multiple-sheets" id="id6">Why use multiple sheets?</a></p></li>
<li><p><a class="reference internal" href="#setting-up-multiple-sheets" id="id7">Setting up multiple sheets</a></p>
<ul>
<li><p><a class="reference internal" href="#identifying-sheets" id="id8">Identifying sheets</a></p></li>
<li><p><a class="reference internal" href="#inserting-new-sheets" id="id9">Inserting new sheets</a></p></li>
<li><p><a class="reference internal" href="#inserting-sheets-from-a-different-spreadsheet" id="id10">Inserting sheets from a different spreadsheet</a></p></li>
<li><p><a class="reference internal" href="#renaming-sheets" id="id11">Renaming sheets</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#referencing-other-sheets" id="id12">Referencing other sheets</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-the-reference-with-the-mouse" id="id13">Creating the reference with the mouse</a></p></li>
<li><p><a class="reference internal" href="#creating-the-reference-with-the-keyboard" id="id14">Creating the reference with the keyboard</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#protect-spreadsheet-structure" id="id15">Protect spreadsheet structure</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#referencing-other-documents" id="id16">Referencing other documents</a></p>
<ul>
<li><p><a class="reference internal" href="#id2" id="id17">Creating the reference with the mouse</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id18">Creating the reference with the keyboard</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-hyperlinks-and-urls" id="id19">Using hyperlinks and URLs</a></p>
<ul>
<li><p><a class="reference internal" href="#relative-and-absolute-hyperlinks" id="id20">Relative and absolute hyperlinks</a></p></li>
<li><p><a class="reference internal" href="#creating-hyperlinks" id="id21">Creating hyperlinks</a></p></li>
<li><p><a class="reference internal" href="#opening-hyperlinks" id="id22">Opening hyperlinks</a></p></li>
<li><p><a class="reference internal" href="#hyperlink-dialog" id="id23">Hyperlink dialog</a></p></li>
<li><p><a class="reference internal" href="#editing-hyperlinks" id="id24">Editing hyperlinks</a></p></li>
<li><p><a class="reference internal" href="#removing-hyperlinks" id="id25">Removing hyperlinks</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#linking-to-external-data" id="id26">Linking to external data</a></p>
<ul>
<li><p><a class="reference internal" href="#using-the-external-data-dialog" id="id27">Using the External Data dialog</a></p></li>
<li><p><a class="reference internal" href="#using-the-navigator" id="id28">Using the Navigator</a></p></li>
<li><p><a class="reference internal" href="#how-to-find-the-required-data-range-or-table" id="id29">How to find the required data range or table</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#linking-to-registered-data-sources" id="id30">Linking to registered data sources</a></p>
<ul>
<li><p><a class="reference internal" href="#viewing-data-sources" id="id31">Viewing data sources</a></p></li>
<li><p><a class="reference internal" href="#editing-data-sources" id="id32">Editing data sources</a></p></li>
<li><p><a class="reference internal" href="#launching-base-to-work-on-data-sources" id="id33">Launching Base to work on data sources</a></p></li>
<li><p><a class="reference internal" href="#using-data-sources-in-calc-spreadsheets" id="id34">Using data sources in Calc spreadsheets</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#embedding-spreadsheets" id="id35">Embedding spreadsheets</a></p>
<ul>
<li><p><a class="reference internal" href="#object-linking-and-embedding-ole" id="id36">Object Linking and Embedding (OLE)</a></p>
<ul>
<li><p><a class="reference internal" href="#other-ole-objects" id="id37">Other OLE objects</a></p></li>
<li><p><a class="reference internal" href="#non-linked-ole-object" id="id38">Non-linked OLE object</a></p></li>
<li><p><a class="reference internal" href="#linked-ole-object" id="id39">Linked OLE object</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dynamic-data-exchange-dde" id="id40">Dynamic Data Exchange (DDE)</a></p>
<ul>
<li><p><a class="reference internal" href="#dde-link-in-calc" id="id41">DDE link in Calc</a></p></li>
<li><p><a class="reference internal" href="#dde-link-in-writer" id="id42">DDE link in Writer</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#xml-source" id="id43">XML Source</a></p></li>
</ul>
</nav>
<section id="using-multiple-sheets">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Using multiple sheets</a><a class="headerlink" href="#using-multiple-sheets" title="Link to this heading">¶</a></h2>
<section id="why-use-multiple-sheets">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Why use multiple sheets?</a><a class="headerlink" href="#why-use-multiple-sheets" title="Link to this heading">¶</a></h3>
<p><a class="reference internal" href="calc01.html"><span class="doc">Chapter 1, Introduction</span></a> ではスプレッドシートにおける複数シートの概念を紹介した。複数シートは情報整理に役立つ。これらのシート同士をに何らかの関係が定義されれば Calc の能力が完全に発揮される。次の場合を考える：</p>
<div class="docutils container">
<p>John は個人的な財務状況を把握するのに苦労している。彼は銀行口座をいくつか持っているが、その情報は散乱しており、整理されていない。すべてを一度に見ることができるようになるまで、自分の財務をうまく把握することができない。</p>
<p>これを解決するために、John は LibreOffice Calc で財務を追跡することにした。
John は Calc が簡単な数学計算ができることを知っており、口座の残高を一度に確認できるように概要シートを設定したい。</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>今さらだが、MS Excel はワークブックと呼ぶものを Calc はスプレッドシートと呼ぶ。Excel も Calc もシートとワークシートという術語を用いる。</p>
</div>
</section>
<section id="setting-up-multiple-sheets">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Setting up multiple sheets</a><a class="headerlink" href="#setting-up-multiple-sheets" title="Link to this heading">¶</a></h3>
<p>スプレッドシートに複数のシートを設定する方法は <a class="reference internal" href="calc01.html"><span class="doc">Chapter 1, Introduction</span></a> で学習した。</p>
<section id="identifying-sheets">
<h4><a class="toc-backref" href="#id8" role="doc-backlink">Identifying sheets</a><a class="headerlink" href="#identifying-sheets" title="Link to this heading">¶</a></h4>
<p>新規スプレッドシートを開くと <cite>Sheet1</cite> という名前のシートが一枚含まれる。この挙動を <span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Calc‣Defaults</span> ページ で変更可能だ：</p>
<ul class="simple">
<li><p>新規文書が含むシートの数</p></li>
<li><p>新規シートの接頭辞</p></li>
</ul>
<p>スプレッドシートの下部にあるタブを使ってシートを管理する。</p>
</section>
<section id="inserting-new-sheets">
<h4><a class="toc-backref" href="#id9" role="doc-backlink">Inserting new sheets</a><a class="headerlink" href="#inserting-new-sheets" title="Link to this heading">¶</a></h4>
<p>複数ある方法のどれを選ぶかは利用者次第だ。</p>
<ul class="simple">
<li><p>シートタブ左の <span class="guilabel">+</span> をクリックする</p></li>
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">S</span>heet‣Insert <span class="accelerator">S</span>heet…</span> を実行する</p></li>
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">S</span>heet‣Insert Sheet at End</span> を実行する</p></li>
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">S</span>heet‣Insert Shee<span class="accelerator">t</span> from File…</span> を実行する</p></li>
<li><p>シートタブ右クリックメニューから <span class="menuselection">Insert <span class="accelerator">S</span>heet…</span> を実行する</p></li>
</ul>
<p>これらの方法のうち <span class="guilabel">Insert Sheet</span> ダイアログボックス が開くものについては、次のオプションを使ってもよい：</p>
<ul class="simple">
<li><p>新規シートの挿入位置を現在シートの前か次のいずれにするか</p></li>
<li><p>新規シートの枚数</p></li>
<li><p>新規シートがただ一枚の場合に限り、新規シートの名前</p></li>
</ul>
<p>または <span class="guilabel">Append Sheet</span> ダイアログボックスが開くものについては、新規シートの <span class="guilabel"><span class="accelerator">N</span>ame</span> を既定の名前以外のものに指定可能だ。</p>
<hr class="docutils" />
<p>John のスプレッドシートにはシートが六つ必要である。また、これらのシートにそれぞれ口座の名前を付けたい：</p>
<ol class="arabic simple">
<li><p><cite>Summary</cite></p></li>
<li><p><cite>Checking Account</cite></p></li>
<li><p><cite>Savings Account</cite></p></li>
<li><p><cite>Credit Card 1</cite></p></li>
<li><p><cite>Credit Card 2</cite></p></li>
<li><p><cite>Car Loan</cite></p></li>
</ol>
<p>単一シートを持つスプレッドシートを新規作成した後、次のいずれかで達成したい：</p>
<ul class="simple">
<li><p>新規シートを五枚入れし、六枚すべてのシート名を変更する。</p></li>
<li><p>既存シートの名前を変更し、五シートを新規に一枚ずつ入れる。</p></li>
</ul>
<p>シートを入れて後で名前を変更する手順：</p>
<ol class="arabic simple">
<li><p>正しいシートタブが選択されていることを確認し、<span class="guilabel">Insert Sheet</span> ダイアログボックス を開く。</p></li>
<li><p>新しいシートの位置を選ぶ。この例では <span class="guilabel"><span class="accelerator">A</span>fter current sheet</span> を使う。</p></li>
<li><p><span class="guilabel"><span class="accelerator">N</span>ew sheet</span> を選び、<span class="guilabel">N<span class="accelerator">o</span>. of sheets</span> の後に 5 と入力する。複数のシートを入れるため <span class="guilabel">Na<span class="accelerator">m</span>e</span> 欄は使用不能だ。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押してシートを入れる。</p></li>
</ol>
<p>シートの名前を変更する以降の手順については <a class="reference internal" href="#calc11-anchor-renaming"><span class="std std-ref">Renaming sheets</span></a> を見ろ。</p>
<p>シートを入れると同時に名前を付ける手順：</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#calc11-anchor-renaming"><span class="std std-ref">Renaming sheets</span></a> にあるようにして既存のシートの名前を <cite>Summary</cite>
に変更する。</p></li>
<li><p>正しいシートタブが選択されていることを確認し、<span class="guilabel">Insert Sheet</span> ダイアログボックス を開く。</p></li>
<li><p>新しいシートのシートタブの位置を選ぶ。<span class="guilabel">Before current sheet</span> か
<span class="guilabel"><span class="accelerator">A</span>fter current sheet</span> の使えるもの。</p></li>
<li><p><span class="guilabel"><span class="accelerator">N</span>ew sheet</span> を選び、<span class="guilabel">N<span class="accelerator">o</span>. of sheets</span> の後に 1 と入力する。
<span class="guilabel">Na<span class="accelerator">m</span>e</span> 欄が使用可能になる。</p></li>
<li><p><span class="guilabel">Na<span class="accelerator">m</span>e</span> 欄にこの新しいシートの名前、例えば <cite>Checking Account</cite> と入力する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押してシートを入れる。</p></li>
<li><p>新規シートそれぞれに <cite>Savings Account</cite>, <cite>Credit Card 1</cite>, <cite>Credit Card 2</cite>,
<cite>Car Loan</cite> という名前を付ける工程を繰り返す。</p></li>
</ol>
</section>
<section id="inserting-sheets-from-a-different-spreadsheet">
<h4><a class="toc-backref" href="#id10" role="doc-backlink">Inserting sheets from a different spreadsheet</a><a class="headerlink" href="#inserting-sheets-from-a-different-spreadsheet" title="Link to this heading">¶</a></h4>
<p>さらに、<span class="guilabel">Insert Sheet</span> ダイアログボックス には <span class="guilabel"><span class="accelerator">F</span>rom file</span> オプションがある。シートを追加する手順は：</p>
<ol class="arabic simple">
<li><p><span class="guilabel"><span class="accelerator">B</span>rowse…</span> ボタン を押すとファイルダイアログボックスが開く</p></li>
<li><p>別の Calc ファイルなどを選択する</p></li>
<li><p>シート一覧が現れる</p></li>
<li><p>追加するシートを選択する</p></li>
</ol>
<p><span class="guilabel"><span class="accelerator">L</span>ink</span> をオンにすると、参照様式がシートのコピーではなくリンクになる。</p>
<ul class="simple">
<li><p>他のスプレッドシートから生きたデータを取り込むことを実現する。</p></li>
<li><p>リンクを更新するには Menu バー から <span class="menuselection"><span class="accelerator">E</span>dit‣Lin<span class="accelerator">k</span>s to External Files…</span> を実行する。</p></li>
<li><p>自動更新にしたければオプション設定だ。<span class="menuselection">LibreOffice Calc‣General</span> ページ の <span class="guilabel">Update
links when opening</span> ラジオボタングループを好みの項目に変えろ。</p></li>
</ul>
<p>信頼できるファイルの場所を定義するには <span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice‣Security</span> ページ で
<span class="guilabel">Macro Security…</span> ボタンを押してダイアログボックスを開く。
<span class="guilabel">Trusted Sources</span> タブをクリックして下の欄を埋める。これはスプレッドシートでマクロを使用する場合に有用だ。マクロについては <a class="reference internal" href="calc13.html"><span class="doc">Chapter 13, Macros</span></a> を見ろ。照してください。</p>
</section>
<section id="renaming-sheets">
<span id="calc11-anchor-renaming"></span><h4><a class="toc-backref" href="#id11" role="doc-backlink">Renaming sheets</a><a class="headerlink" href="#renaming-sheets" title="Link to this heading">¶</a></h4>
<p>シートには意味がある名前を与えろ。既存シートの名前を変える方法：</p>
<ul class="simple">
<li><p>シートタブをダブルクリックする</p></li>
<li><p>シートタブを <kbd class="kbd docutils literal notranslate">Alt</kbd> を押しながらクリックする</p></li>
<li><p>シートタブ右クリックメニューから <span class="menuselection">Rename S<span class="accelerator">h</span>eet…</span> を実行する</p></li>
<li><p>メニューから <span class="menuselection"><span class="accelerator">S</span>heet‣Rename S<span class="accelerator">h</span>eet…</span> を実行する</p></li>
</ul>
<p>以上のいずれの操作でも <span class="guilabel">Rename Sheet</span> ダイアログボックス が開く。ここで新しい名前を
<span class="guilabel"><span class="accelerator">N</span>ame</span> 欄に入力しろ。</p>
<p>シート名は空であってはならず、既存の名前と重複してはいけない。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>次の文字は名前の最初または最後の文字としては使用不可：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>: \ / ? * [ ] &#39;
</pre></div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>LibreOffice Calc のインストールによっては、<kbd class="kbd docutils literal notranslate">Alt</kbd> を押しながらシート名をクリックして新しい名前を直接入力することが可能だ。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>この操作はオススメ。ダブルクリックだとポップアップが出るぶん遅い。</p>
</div>
</div>
<hr class="docutils" />
<p>ここまでの記述により、John は六シートを準備できたとする。</p>
<p>次に勘定元帳を設定する。これは単純な要約で、前回の残高に今回の取引額を加えたものである。引き出しの場合は、残高が少なくなるように、現在の取引を負の数で入力する。基本的な元帳を Figure 8 に示す。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>A2:C6 が次のようになっている：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Description</p></th>
<th class="head"><p>Amount</p></th>
<th class="head"><p>Balance</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Opening Balance</p></td>
<td><p>$75.00</p></td>
<td><p>$75.00</p></td>
</tr>
<tr class="row-odd"><td><p>Pay</p></td>
<td><p>$425.00</p></td>
<td><p>$500.00</p></td>
</tr>
<tr class="row-even"><td><p>Groceries</p></td>
<td><p>-$75.00</p></td>
<td><p>$425.00</p></td>
</tr>
<tr class="row-odd"><td><p>Cable Bill</p></td>
<td><p>-$445.95</p></td>
<td><p>$380.05</p></td>
</tr>
</tbody>
</table>
</div>
<p>この元帳は <cite>Checking Account</cite> シートに設定されている。総残高は升目 F3 で合計される。数式は <code class="docutils literal notranslate"><span class="pre">=C3+SUM(B4:B46)</span></code> だ。これは升目 C3 の開始残高と、その後のすべての取引を合計したものだ。</p>
</section>
</section>
<section id="referencing-other-sheets">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Referencing other sheets</a><a class="headerlink" href="#referencing-other-sheets" title="Link to this heading">¶</a></h3>
<p>他のシートの升目を参照する方法は二つはある：</p>
<ul class="simple">
<li><p>キーボードを使って数式を直接入力する</p></li>
<li><p>マウスを使って入力する</p></li>
</ul>
<hr class="docutils" />
<p><cite>Summary</cite> シートには他の各シートの残高を表示する。Figure 8 の例を五つの勘定科目の各シートにコピーする。現在の残高はシートそれぞれの升目 F3 になる。</p>
<section id="creating-the-reference-with-the-mouse">
<h4><a class="toc-backref" href="#id13" role="doc-backlink">Creating the reference with the mouse</a><a class="headerlink" href="#creating-the-reference-with-the-mouse" title="Link to this heading">¶</a></h4>
<p><cite>Summary</cite> シート上で五つの勘定残高の場所を設定し、升目参照をどこに置くかわかるようにする。Figure 9 は <cite>Balance</cite> 列が空白の <cite>Summary</cite> シートだ。<cite>Checking Account</cite>
に対する参照を升目 B3 に置きたい。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p><cite>Summary</cite> シートの A2:B7 は次のような構成になる：</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Account</p></th>
<th class="head"><p>Balance</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Checking Account</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Savings Account</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Credit Card 1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Credit Card 2</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Car Loan</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>以下、<cite>Balance</cite> 列を数式で埋めていく。</p>
</div>
<p>升目 B3 に升目参照を作成するには升目を選択して次のようにする：</p>
<ol class="arabic simple">
<li><p>Formula バー の入力行の横にある <span class="guilabel">=</span> ボタンをクリックする。
Formula バー の図像が変わり、<span class="guilabel">Input</span> 行 に等号が現れる。</p></li>
<li><p>参照する升目を含むシートのシートタブをクリックする。この場合は <cite>Checking
Account</cite> シートだ。</p></li>
<li><p><cite>Checking Account</cite> シートの升目 F3 をクリックする。<span class="guilabel">Input</span> 行 に
<code class="docutils literal notranslate"><span class="pre">$'Checking</span> <span class="pre">Account'.F3</span></code> が現れ、選択セルは色のついた枠で囲まれる。</p></li>
<li><p>Formula バー の <span class="guilabel">Input</span> 行 にある <span class="guilabel">✓</span> をクリックするか <kbd class="kbd docutils literal notranslate">Enter</kbd>
を押して終了する。</p></li>
</ol>
<p>以上で <cite>Summary</cite> シートの升目 B3 に金額が現れる。</p>
</section>
<section id="creating-the-reference-with-the-keyboard">
<h4><a class="toc-backref" href="#id14" role="doc-backlink">Creating the reference with the keyboard</a><a class="headerlink" href="#creating-the-reference-with-the-keyboard" title="Link to this heading">¶</a></h4>
<p>セル参照は部分が二つある。ドル記号が前置されたシート名と升目参照だ。これらはピリオドで区切られていることに気をつけろ。Calc の既定動作はドル記号を付けて絶対シート参照を形成し、相対升目参照を与えるものだ。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>シート名は空白文字を含むため単一引用符で囲み、必須ピリオドは常に引用符の外側に置く。</p>
</div>
<p>したがって、<cite>Savings Account</cite> の升目参照を単に中に入力すればよい。残高が普通預金シートの同じ升目である F3 にあると仮定すると、升目参照は</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>=$&#39;Savings Account&#39;.F3
</pre></div>
</div>
<p>となる。</p>
</section>
</section>
<section id="protect-spreadsheet-structure">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Protect spreadsheet structure</a><a class="headerlink" href="#protect-spreadsheet-structure" title="Link to this heading">¶</a></h3>
<p>文書のシート構成に満足したら、次のシート操作を禁止したい：</p>
<ul class="simple">
<li><p>シートを追加</p></li>
<li><p>シートを削除</p></li>
<li><p>シートの順序を変更</p></li>
<li><p>シートの名前を変更</p></li>
</ul>
<p>このためには、メニューの <span class="menuselection"><span class="accelerator">T</span>ools‣Protect <span class="accelerator">S</span>preadsheet
Structure…</span> を実行して構造を固定する。パスワード入力ダイアログボックスが開く。パスワードを適当に入力して <span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。上記の操作が不可になる。</p>
<p>シート操作を解禁するにはこのコマンドを再度実行し、指定のパスワードを入力して
<span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。</p>
</section>
</section>
<section id="referencing-other-documents">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Referencing other documents</a><a class="headerlink" href="#referencing-other-documents" title="Link to this heading">¶</a></h2>
<div class="docutils container">
<p>John は家族の口座情報を自分のまとめとは別のスプレッドシートファイルに保存することにした。幸いなことに、Calc は異なるファイルをリンクすることができる。手順は単一スプレッドシートの異なるシートについて説明したのと同じで、どのファイルにシートがあるかを示すためにもう一手間かける。</p>
</div>
<section id="id2">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Creating the reference with the mouse</a><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>マウスを使って参照を作成するには、スプレッドシートを両方開いておく必要がある。</p>
<ol class="arabic">
<li><p>数式を入力する升目を含むほうのスプレッドシートに切り替える。</p></li>
<li><p>数式を入力する升目を選択する。</p></li>
<li><p>Formula バー の左にある <span class="guilabel">=</span> 図像をクリックする。</p></li>
<li><p>もう一方のスプレッドシートに切り替える。</p></li>
<li><p>参照先シートを選択し、参照先セルを選択する。この時点で <kbd class="kbd docutils literal notranslate">Enter</kbd> を押せば確定。</p>
<p>John の場合は <cite>Savings Account</cite> シートを選択して F3 をクリックする。</p>
</li>
<li><p>参照元シートに切り替えて Formula バー の左にある <span class="guilabel">✓</span> をクリックする。</p></li>
</ol>
<p>以上の手順により、升目の内容が適切な参照式になる。</p>
<p>Formula バー の <span class="guilabel">Input</span> 行 をよく見れば、参照の形式がよくわかるだろう。この行の内容に基づいて、キーボードを使って参照を作成することができる。</p>
</section>
<section id="id3">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Creating the reference with the keyboard</a><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>参照元セルの内容として、参照先セルに対する参照式を直接入力すればいい。次のような数式となるはずだ：</p>
<blockquote>
<div><p><code class="samp docutils literal notranslate"><span class="pre">='file://</span><em><span class="pre">/path/to/ods</span></em><span class="pre">'#$'</span><em><span class="pre">SheetName</span></em><span class="pre">'.CellReference</span></code></p>
</div></blockquote>
</section>
</section>
<section id="using-hyperlinks-and-urls">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Using hyperlinks and URLs</a><a class="headerlink" href="#using-hyperlinks-and-urls" title="Link to this heading">¶</a></h2>
<p>スプレッドシート内から別の場所にジャンプするためにハイパーリンクを使用する。次のジャンプ先が実現可能だ：</p>
<ul class="simple">
<li><p>現在のファイルの他の部分</p></li>
<li><p>別のファイル</p></li>
<li><p>Web ページ</p></li>
</ul>
<section id="relative-and-absolute-hyperlinks">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Relative and absolute hyperlinks</a><a class="headerlink" href="#relative-and-absolute-hyperlinks" title="Link to this heading">¶</a></h3>
<p>ファイル内ハイパーリンクは相対パスまたは絶対パスのどちらかだ。</p>
<ul class="simple">
<li><p>絶対リンクは対象が移動すると機能しなくなる。</p></li>
<li><p>相対リンクは開始位置と対象位置が相対的に変わると機能しなくなる。</p></li>
</ul>
<p><span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">Load/Save‣General</span> ページ 以下にハイパーリンク保存方法関連オプション項目が二つある。<abbr title="Universal Resource Locator">URL</abbr> を相対的に保存するかどうかを指示する。</p>
<p>ファイルリンクには相対リンクを使うのがよい。相対リンクは作業中のファイルがリンク先と同じドライブにある場合に限り可能。</p>
<p>相対ハイパーリンクを保存していても、ハイパーリンクは絶対アドレスで常に表示される。この「絶対」アドレスは、ファイルを移動すると更新される。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Calc は内部的に絶対パス名を使用するため、ハイパーリンク上にマウスポインターを置くと、ヘルプチップに絶対参照が表示される。完全なパスとアドレスは <abbr title="HyperText Markup Language">HTML</abbr> エクスポートの結果を表示するとき、<abbr title="HyperText Markup Language">HTML</abbr> ファイルをテキストとして読み込むとき、テキストエディターで開くときにのみ表示される。</p>
</div>
</section>
<section id="creating-hyperlinks">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Creating hyperlinks</a><a class="headerlink" href="#creating-hyperlinks" title="Link to this heading">¶</a></h3>
<p>スプレッドシートにハイパーリンクを挿入する方法は複数ある：</p>
<ul class="simple">
<li><p><span class="guilabel">Hyperlink</span> ダイアログボックス を開く。セルまたはセル内のテキストを選択し、またはキャレットを挿入位置に置き、</p>
<ul>
<li><p>Menu バー から <span class="menuselection"><span class="accelerator">I</span>nsert‣<span class="accelerator">H</span>yperlink…</span> を実行するか、</p></li>
<li><p>キーバインド <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">K</kbd> を押す。</p></li>
</ul>
</li>
<li><p>Navigator (<kbd class="kbd docutils literal notranslate">F5</kbd>) からハイパーリンクを挿入したい箇所（シートタブやセルなど）に項目をドラッグ＆ドロップする。</p></li>
<li><p>ハイパーリンクを入れる場所に対象の <abbr title="Universal Resource Locator">URL</abbr> を入力する。入力文字列をハイパーリンク <abbr title="Universal Resource Locator">URL</abbr> として Calc に自動認識させるには、Menu バー から
<span class="menuselection"><span class="accelerator">T</span>ools‣<span class="accelerator">A</span>utoCorrect Options…</span> を実行して、ダイアログボックス内の <span class="guilabel">Options</span> タブ で <span class="guilabel">URL Recognition</span> をオンにする。</p></li>
</ul>
<p><span class="guilabel">Hyperlink</span> ダイアログボックス を使用する場合、テキストまたはボタンのいずれかを選択できる。どちらの場合も、表示されるテキストとリンク先 <abbr title="Universal Resource Locator">URL</abbr> を異なるものにすることができる。</p>
<p>ハイパーリンクの色を変更するには、<span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice‣Application Colors</span> ページ の次の項目の色を指定しろ：</p>
<ul class="simple">
<li><p><cite>Unvisited links</cite></p></li>
<li><p><cite>Visited links</cite></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>LibreOffice のアプリケーションすべてにおけるハイパーリンクの色が変更される。</p>
</div>
<p>ボタンのハイパーリンクはフォームコントロールの一種だ。他のフォームコントロールと同様に、Design Mode でボタンを右クリックすることで、繋留・配置が可能だ。フォームの詳細については <em>Writer Guide</em> を見ろ。</p>
</section>
<section id="opening-hyperlinks">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Opening hyperlinks</a><a class="headerlink" href="#opening-hyperlinks" title="Link to this heading">¶</a></h3>
<p>ハイパーリンクからジャンプする方法は、ホットテキストの場合は：</p>
<ul class="simple">
<li><p>左クリックか、または <kbd class="kbd docutils literal notranslate">Ctrl</kbd> を押しながら左クリックのいずれか</p></li>
<li><p>右クリックメニューから <span class="menuselection"><span class="accelerator">O</span>pen Hyperlink</span> を実行する</p></li>
</ul>
<p>ことでジャンプする。左クリック絡みは <span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice‣Security</span> ページ における
<span class="guilabel">Security Options and Warnings</span> ダイアログボックス での項目 <span class="guilabel">Ctrl-click required <span class="accelerator">t</span>o open
hyperlinks</span> のオンオフによってどちらの操作が有効であるかが決まる。</p>
<p>ボタンの場合は、Design Mode に入っていない場合には左クリックでジャンプ。Design
Mode へするには、次のいずれかのツールバーの <span class="guilabel">Design Mode</span> をオンにする：</p>
<ul class="simple">
<li><p><span class="guilabel">Form Controls</span> ツールバー</p></li>
<li><p><span class="guilabel">Form Design</span> ツールバー</p></li>
</ul>
</section>
<section id="hyperlink-dialog">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Hyperlink dialog</a><a class="headerlink" href="#hyperlink-dialog" title="Link to this heading">¶</a></h3>
<p><span class="guilabel">Hyperlink</span> ダイアログボックス を開く方法：</p>
<ul class="simple">
<li><p>Menu バー <span class="menuselection"><span class="accelerator">I</span>nsert‣<span class="accelerator">H</span>yperlink…</span> 選択</p></li>
<li><p><span class="guilabel">Standard</span> ツールバー <span class="guilabel">Insert Hyperlink</span> 図像</p></li>
<li><p>キーバインド <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">K</kbd></p></li>
</ul>
<p>ダイアログの左側でハイパーリンク区分から一つを選択する。</p>
<p><span class="guilabel">Further Settings</span> 区画がハイパーリンク区分すべてに用意されている。これより上の区画にあるコントロールは、ダイアログの左側の区分のどれが選択されているかによって異なる。</p>
<p>以下は Calc で使用される最も一般的な選択肢の要約だ：</p>
<dl>
<dt><span class="guilabel"><span class="accelerator">I</span>nternet</span></dt><dd><dl class="simple">
<dt><span class="guilabel"><span class="accelerator">U</span>RL</span></dt><dd><p>必要な Web アドレスを入力する。</p>
</dd>
<dt><span class="guilabel">Te<span class="accelerator">x</span>t</span></dt><dd><p>使用者に表示されるテキストを指定する。ここに何も入力しない場合、リンクテキストは完全 URL またはパスになる。リンクが相対リンクでファイルを移動した場合、対象は変更されるがこのテキストは変更されないことに気をつけろ。</p>
</dd>
</dl>
</dd>
<dt><span class="guilabel"><span class="accelerator">M</span>ail</span></dt><dd><p>メールクライアントがインストールされている場合にのみ機能。</p>
<dl class="simple">
<dt><span class="guilabel">Re<span class="accelerator">c</span>ipient</span></dt><dd><p>受信者のメールアドレスを入力するか、ボタンを押してアクセスされる既存データベースからアドレスを選択する。</p>
</dd>
<dt><span class="guilabel"><span class="accelerator">S</span>ubject</span></dt><dd><p>メッセージの件名として使用するテキストを入力する。</p>
</dd>
</dl>
<p><span class="guilabel">Te<span class="accelerator">x</span>t</span> 欄は <span class="guilabel">Further Settings</span> 区画内に設けられている。これらのハイパーリンクの機能は、上記の Internet ハイパーリンクと同じだ。</p>
</dd>
<dt><span class="guilabel"><span class="accelerator">D</span>ocument</span></dt><dd><dl class="simple">
<dt><span class="guilabel"><span class="accelerator">P</span>ath</span></dt><dd><p>開くファイルのパスを指定する。同じスプレッドシート内の対象にリンクする場合は空白のままにする。フォルダー図像をクリックすると <span class="guilabel">開く</span> ダイアログボックス が開き、開く文書を指定可能。</p>
</dd>
<dt><span class="guilabel">Targ<span class="accelerator">e</span>t</span></dt><dd><p>オプションで、文書内の対象（特定のシートなど）を指定する。クロスヘア図像をクリックすると Navigator が開き、対象を選択することが可能。</p>
</dd>
</dl>
</dd>
<dt><span class="guilabel"><span class="accelerator">N</span>ew Document</span></dt><dd><dl class="simple">
<dt><span class="guilabel">Edit <span class="accelerator">n</span>ow</span> / <span class="guilabel">Edit <span class="accelerator">l</span>ater</span></dt><dd><p>新しく作成した文書をすぐに編集するか、作成だけにするかを指定する。</p>
</dd>
<dt><span class="guilabel"><span class="accelerator">F</span>ile</span></dt><dd><p>作成するファイル名を入力する。パス選択図像をクリックすると、ディレクトリーピッカーダイアログが開く。</p>
</dd>
<dt><span class="guilabel">File <span class="accelerator">t</span>ype</span></dt><dd><p>作成する文書の種類を選択する（テキスト文書、スプレッドシート、図面など）。</p>
</dd>
</dl>
</dd>
</dl>
<p><span class="guilabel">Further Settings</span> 区画はすべてのハイパーリンク区分に共通する。ただし、いくつかの選択肢はリンクの種類によって関連性が高く、Internet ハイパーリンクの場合、この区画では <span class="guilabel">Text</span> オプションは省略される。</p>
<dl class="simple">
<dt><span class="guilabel">F<span class="accelerator">r</span>ame</span></dt><dd><p>ハイパーリンクの開き方を決定する。Web ブラウザーで開く文書に適用される。選択肢は <cite>_top</cite>, <cite>_parent</cite>, <cite>_blank</cite>, <cite>_self</cite> だ。</p>
</dd>
<dt><span class="guilabel">F<span class="accelerator">o</span>rm</span></dt><dd><p>リンクをテキストとして表示するか、ボタンとして表示するかを指定する。</p>
</dd>
<dt><span class="guilabel">Te<span class="accelerator">x</span>t</span></dt><dd><p>使用者に表示されるテキストを指定する。先ほどのものと同様。</p>
</dd>
<dt><span class="guilabel">N<span class="accelerator">a</span>me</span></dt><dd><p><abbr title="HyperText Markup Language">HTML</abbr> 文書に適用される。<abbr title="HyperText Markup Language">HTML</abbr> コードの <cite>NAME</cite> 属性として追加されるテキストを指定する。</p>
</dd>
</dl>
</section>
<section id="editing-hyperlinks">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Editing hyperlinks</a><a class="headerlink" href="#editing-hyperlinks" title="Link to this heading">¶</a></h3>
<p>既存のホットテキストに対するハイパーリンクを編集する方法はいくつかある：</p>
<ul class="simple">
<li><p>ホットテキストを含むセルをクリックし、<span class="menuselection"><span class="accelerator">I</span>nsert <span class="accelerator">H</span>yperlink…</span> を実行するか、同等の操作を行う。</p></li>
<li><p>ホットテキストを選択して右クリックメニュー <span class="menuselection">E<span class="accelerator">d</span>it Hyperlink…</span> を実行する。</p></li>
</ul>
<p>既存のボタンに対するハイパーリンクの場合、参照先を編集するにはスプレッドシートの
Form Design Mode が有効である必要がある。ボタンを選択した状態で：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert <span class="accelerator">H</span>yperlink…</span> を実行するか、同等の操作を行う。</p></li>
<li><p>右クリックメニュー <span class="menuselection">Con<span class="accelerator">t</span>rol Properties…</span> を実行し、
<span class="guilabel"><span class="accelerator">L</span>abel</span> にある参照先を表す文字列を変更する。</p></li>
</ul>
<p>複数のハイパーリンクを編集する場合、すべてを編集するまで <span class="guilabel">Hyperlink</span> ダイアログボックス を開いたままにしておくことが可能。適宜 <span class="guilabel"><span class="accelerator">A</span>pply</span> ボタン を押せ。</p>
<p>ボタンのハイパーリンクを編集するには、Design Mode であるとして、ボタンを選択し、右クリックメニューから <span class="menuselection">Con<span class="accelerator">t</span>rol Properties…</span> を選択する。Calc では <span class="guilabel">Properties</span> ダイアログボックス
が開く。Label 欄を編集してボタンテキストを変更し、URL 欄を編集してリンクアドレスを変更します。<span class="guilabel">Properties</span> ダイアログボックス に <span class="guilabel"><span class="accelerator">O</span>K</span> ボタン はない。</p>
</section>
<section id="removing-hyperlinks">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Removing hyperlinks</a><a class="headerlink" href="#removing-hyperlinks" title="Link to this heading">¶</a></h3>
<p>ホットテキストの場合は文字列を選択して右クリックメニューから <span class="menuselection"><span class="accelerator">R</span>emove Hyperlink</span>
を実行しろ。ボタンの場合は編集時と同じ。</p>
</section>
</section>
<section id="linking-to-external-data">
<h2><a class="toc-backref" href="#id26" role="doc-backlink">Linking to external data</a><a class="headerlink" href="#linking-to-external-data" title="Link to this heading">¶</a></h2>
<p>他の文書のデータをリンクとしてスプレッドシートに挿入可能。</p>
<p><span class="guilabel">External Data</span> ダイアログボックス を使用する方法と Navigator を使用する方法がある。ファイルに名前付き範囲、データベース範囲、または名前付き表があり、リンクしたい範囲や表の名前がわかっている場合は、<span class="guilabel">External Data</span> ダイアログボックス を使用するとすばやく簡単にできる。しかし、ファイルに複数の範囲や表があり、そのうちの一つしか選択したくない場合、どれがどれなのか簡単に判断できない。</p>
<p>Calc には外部給源からのリンクデータを含めるための他の方法が用意されている。例えば <a class="reference internal" href="#calc11-anchor-linking"><span class="std std-ref">Linking to registered data sources</span></a> と <a class="reference internal" href="#calc11-anchor-dde"><span class="std std-ref">Dynamic Data Exchange (DDE)</span></a> を見ろ。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>リンク先のファイルの保存場所によっては、更新処理が完了するまでに数分かかることがある。</p>
</div>
<section id="using-the-external-data-dialog">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Using the External Data dialog</a><a class="headerlink" href="#using-the-external-data-dialog" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>The <span class="guilabel">External Data</span> dialog inserts data from an <abbr title="HyperText Markup Language">HTML</abbr>, Calc,
<abbr title="Comma-Separated Values">CSV</abbr>, or Microsoft Excel file into the current sheet as a link. Calc
utilizes a Web Page Query import filter, enabling you to insert tables from
<abbr title="HyperText Markup Language">HTML</abbr> documents.</p>
</div></blockquote>
<p>この操作をインポートと便宜上呼ぶことにする。インポートの手順は：</p>
<ol class="arabic simple">
<li><p>外部データインポート先となる ods ファイルを開く</p></li>
<li><p>インポート先セル範囲の左上セルを選択する</p></li>
<li><p>メニューから <span class="menuselection"><span class="accelerator">S</span>heet‣E<span class="accelerator">x</span>ternal Links…</span> を実行</p></li>
</ol>
<p>ここで <span class="guilabel">External Data</span> ダイアログボックス が開く。</p>
<ul class="simple">
<li><p><span class="guilabel">URL of <span class="accelerator">E</span>xternal Data Source</span> に場所を入力するか、</p></li>
<li><p>ドロップダウンリストから項目を選択するか、</p></li>
<li><p><span class="guilabel"><span class="accelerator">B</span>rowse…</span> ボタン からアクセスできるファイル選択ダイアログ</p></li>
</ul>
<p>からインポート元を選択しろ。インポート元のデータ種別により、以降 UI の挙動が異なる。</p>
<ul class="simple">
<li><p><abbr title="HyperText Markup Language">HTML</abbr> ファイルを選択した場合、本書参照。</p></li>
<li><p><abbr title="Comma-Separated Values">CSV</abbr> ファイルを選択した場合、<span class="guilabel">Text Import</span> ダイアログボックスが現れる。<a class="reference internal" href="calc01.html"><span class="doc">Chapter 1, Introduction</span></a> で述べられている手順に合流する。</p></li>
<li><p>Calc または MS Excelファイルを選択した場合、インポート元に定義されている範囲名とデータベース範囲の一覧がダイアログの <span class="guilabel"><span class="accelerator">A</span>vailable Tables/Ranges</span>
に埋まる。挿入したい項目を選択しろ。</p></li>
</ul>
<p>インポートにより、Navigator の <span class="guilabel">Linked areas</span> 欄に新しい項目が追加する。このような項目を</p>
<ul class="simple">
<li><p>ダブルクリックするとシート内のリンクされたデータが強調表示される。</p></li>
<li><p>マウスホバーするとツールチップにリンクされたデータのパスが表示される。</p></li>
</ul>
<p>スプレッドシート内のすべての外部データリンクを一覧表示するには、Menu バー から
<span class="menuselection"><span class="accelerator">E</span>dit‣Lin<span class="accelerator">k</span>s to External Files…</span> を実行する。<span class="guilabel">Edit Links</span> ダイアログボックス が開く。一般には、一覧の一部が外部リンクだ。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="guilabel">Edit Links</span> ダイアログボックス は <span class="guilabel">External Data</span> ダイアログボックス を使用して作成されていない他のリンクに関する情報を表示できる。</p>
</div>
<p><span class="guilabel">External Data</span> ダイアログボックス を使用して作成されたリンクについては、<span class="guilabel">Edit Links</span> ダイアログボックス でリンクを選択して <span class="guilabel"><span class="accelerator">M</span>odify…</span> ボタンを押すか、リンクをダブルクリックすることで、再度ダイアログにアクセスできる。<span class="guilabel"><span class="accelerator">B</span>reak Link</span> ボタンを押し、選択したリンクを解除することを確認すると、以前リンクされていたデータがスプレッドシートに埋め込まれる。<span class="guilabel"><span class="accelerator">U</span>pdate</span> ボタンを押すと対象ファイル内のリンクされたデータが元ファイル内のものと一致するように更新される。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="guilabel">Edit Links</span> ダイアログボックス の <span class="guilabel">Status</span> 列には、<span class="guilabel">External Data</span> ダイアログボックス を使用して作成されたリンクの場合、<cite>Manual</cite> がつねに表示される。この欄に表示される状態は
<span class="guilabel">External Data</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">U</span>pdate every</span> 設定を反映したものではない。</p>
</div>
</section>
<section id="using-the-navigator">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Using the Navigator</a><a class="headerlink" href="#using-the-navigator" title="Link to this heading">¶</a></h3>
<p>Navigator または Sidebar <span class="guilabel">Navigator</span> 甲板 を使用して外部データをリンクすることもできる。Navigator については <a class="reference internal" href="calc01.html"><span class="doc">Chapter 1, Introduction</span></a> を見ろ。</p>
<p>Navigator を使用して外部データへのリンクを作るには：</p>
<ol class="arabic">
<li><p>インポート先スプレッドシートを開く。</p></li>
<li><p>インポート元ファイルを開く（上述のファイル形式が有効）。</p></li>
<li><p>インポート先で Navigator を開く。<kbd class="kbd docutils literal notranslate">F5</kbd> 押しが早い。</p></li>
<li><p>Navigator 下部のドロップダウンリストからインポート元を選択する。</p></li>
<li><p>必要な範囲名またはデータベース範囲項目を選択し、Navigator からインポート先シートにドラッグして、データ範囲の左上の升目に移動する。</p></li>
<li><p>Navigator で、Drag Mode メニューの <span class="menuselection">Insert <span class="accelerator">a</span>s Link</span> を選択する。</p>
<p>範囲名を右クリックし、コンテキストメニューから必要なオプションを選択することで、ドラッグモードを変更することもできる。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Navigator の Drag Mode 図像が変わり、現在選択されているドラッグモードが反映される。</p>
</div>
</li>
<li><p><cite>Range names</cite> または <cite>Database ranges</cite> から必要登録項目を選択し、Navigator から対象文書へ、データ範囲の左上の升目にドラッグする。</p></li>
<li><p>Navigator 下部のドロップダウンメニューで対象文書を再選択。<cite>Range names</cite> 横ではなく、<cite>Linked areas</cite> 横に <span class="guilabel">+</span> 図像が表示される。これをクリックすると、原文書からドラッグされた項目が表示される。</p></li>
</ol>
</section>
<section id="how-to-find-the-required-data-range-or-table">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">How to find the required data range or table</a><a class="headerlink" href="#how-to-find-the-required-data-range-or-table" title="Link to this heading">¶</a></h3>
<p>Calc の Web Page Query インポートフィルターは Web ページから給源順にデータ範囲（表）を表示する。さらに範囲名を二つ作成する：</p>
<ul class="simple">
<li><p><cite>HTML_all</cite>: HTML ファイル全体を指定</p></li>
<li><p><cite>HTML_tables</cite>: HTML ファイル内の表すべてを指定</p></li>
</ul>
<p><cite>TABLE</cite> 要素に <cite>ID</cite> 属性がある場合、連番を付けた範囲と共に、それらの属性値が範囲名一覧に表示される。</p>
<p>そういう属性値がないインポート元については強調表示機能頼みになる。</p>
<p>Calc で開いた原文書に移動する。Navigator で範囲名をダブルクリックするとその範囲がシート上で強調表示される。Figure 34 の例は
&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/List_of_best-selling_albums">https://en.wikipedia.org/wiki/List_of_best-selling_albums</a>&gt; から抽出した、レコード音楽のベストセラーアルバムの世界年別表だ。</p>
<p>Formula バー が表示されている場合、範囲名は左端の <span class="guilabel">Name</span> にも表示される。範囲名はドロップダウンリストで選択し、ページ上で強調表示することができる。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>本書の例を真似ても掲載されている画像のようには現在、ならない。</p>
</div>
</section>
</section>
<section id="linking-to-registered-data-sources">
<span id="calc11-anchor-linking"></span><h2><a class="toc-backref" href="#id30" role="doc-backlink">Linking to registered data sources</a><a class="headerlink" href="#linking-to-registered-data-sources" title="Link to this heading">¶</a></h2>
<p>さまざまなデータベースと Calc 文書をリンク可能だ。それにはまず、LibreOffice にデータ給源を登録する必要がある。登録とは LibreOffice にデータ給源の型とファイルがとこに位置するかを知らせることだ。これを行う方法はデータ給源が .odb 形式のデータベースであるかどうかによって異なる。</p>
<p>ODB ファイルを登録する手順は <span class="guilabel">Options</span> ダイアログボックス を用いる：</p>
<ol class="arabic simple">
<li><p><span class="menuselection">LibreOffice Base‣Databases</span> ページを見る。
<span class="guilabel">Registered databases</span> 一覧を確認する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">N</span>ew…</span> ボタンを押す。<span class="guilabel">Create Database Link</span> ダイアログボックス を開く。してパスと名前の対応を登録する。</p></li>
<li><p>データベースファイルの場所を入力するか、ドロップダウンリストからデータベースファイルを選択するか、<span class="guilabel"><span class="accelerator">B</span>rowse…</span> ボタン を押して <span class="guilabel">開く</span> ダイアログボックス を開き、データベースファイルを選択する。</p></li>
<li><p>データベースの登録名として使用する名前を入力し、<span class="guilabel"><span class="accelerator">O</span>K</span> ボタン 押す。データベースが登録済みデータベース目録に追加され、LibreOffice は登録名を使用してデータベースにアクセスする。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="guilabel">Create Database Link</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">O</span>K</span> ボタン は <span class="guilabel"><span class="accelerator">D</span>atabase file</span> 欄と
<span class="guilabel">Registered <span class="accelerator">n</span>ame</span> 欄の両方が入力されている場合に有効になる。</p>
</div>
<p>ODB ファイル以外のデータ元の登録手順：</p>
<ol class="arabic simple">
<li><p><span class="menuselection"><span class="accelerator">F</span>ile‣<span class="accelerator">N</span>ew‣Data<span class="accelerator">b</span>ase…</span> を実行</p></li>
<li><p><span class="guilabel">Connect to an <span class="accelerator">e</span>xisting database</span> を選択</p></li>
<li><p>ドロップダウンリストから所望の項目を選択、<span class="guilabel"><span class="accelerator">N</span>ext &gt;</span> ボタン を押す。</p></li>
</ol>
<p>この後はデータベースの種別により異なるが、最後に <span class="guilabel"><span class="accelerator">F</span>inish</span> ボタン を押す。</p>
<p>データ給源が登録されると、Calc を含むどの LibreOffice アプリケーションでも使用可能になる。</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>データベース利用ノートと関連するので、試す価値はある。</p>
</div>
<section id="viewing-data-sources">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">Viewing data sources</a><a class="headerlink" href="#viewing-data-sources" title="Link to this heading">¶</a></h3>
<p>現在スプレッドシートで利用可能なデータ元を閲覧する方法：</p>
<p><span class="menuselection"><span class="accelerator">V</span>iew‣<span class="accelerator">D</span>ata Sources…</span> (<kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">F4</kbd>) を実行する</p>
<p>これにより Data Sources 窓がスプレッドシート上部に現れる。この窓は次の四つの部分からなる。</p>
<dl>
<dt><span class="guilabel">Table Data</span> ツールバー</dt><dd><p><span class="guilabel">Table Data</span> ツールバー は既定で Data Sources ウィンドウの上部に配置されている。</p>
</dd>
<dt>Data Source Explorer 窓</dt><dd><p>Data Source Explorer は既定では Data Sources 窓の左側、<span class="guilabel">Table Data</span> ツールバー の下にある。</p>
<p>Data Source Explorer には登録されているデータベースの目録が表示される。</p>
<p>各データベースを表示するには、データベース名の左にある展開アイコンをクリックする。同様に、<cite>Queries</cite> の左側にある展開アイコンをクリックすると、選択したデータベース内の個々の質問を表示できる。表名をクリックすると、その表に保持されているすべての登録項目が表示される。</p>
</dd>
<dt>選択表の登録項目（表の各行）</dt><dd><p>選択表のデータ登録項目は Data Sources 窓の右側、<span class="guilabel">Table Data</span> ツールバー の下の領域に表示される。</p>
<p>この領域により多くの列を表示するには、<span class="guilabel">Table Data</span> ツールバー の
<span class="guilabel">Explorer On/Off</span> 図像をクリックしてData Sources Explorer を隠す。再度クリックすると現れる。</p>
<p>データ項目の下には案内棒があり、選択中の登録項目が何であるかと登録項目の総数が表示される。これには次のボタン群がある：</p>
<ul class="simple">
<li><p>First record</p></li>
<li><p>Previous record</p></li>
<li><p>Next record</p></li>
<li><p>Last record</p></li>
<li><p>Add new record</p></li>
<li><p>利用可能な列すべてが可視領域に収まらない場合は横スクロールバー、利用可能な登録項目すべてが可視領域に収まらない場合は、縦スクロールバーがそれぞれ現れる。</p></li>
</ul>
</dd>
<dt>表示切り替えハンドル（最下部の細い矩形）</dt><dd><p>Data Sources 窓の中央下部には、窓全体を隠したり見せたりするコントロールがある。</p>
</dd>
</dl>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>手許のデータベースファイルが全部破損していて機能を試していない。</p>
</div>
</section>
<section id="editing-data-sources">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Editing data sources</a><a class="headerlink" href="#editing-data-sources" title="Link to this heading">¶</a></h3>
<p>Data Sources 窓で編集できるのは、登録済みのデータ給源のみ。</p>
<p>編集可能なデータ給源では登録項目の編集、追加、削除が可能だ。編集内容を保存できない場合は LibreOffice Base でデータベースを開き、そこで編集する必要がある。また、列を隠したり、表示に変更を加えたりすることも可能だ。</p>
</section>
<section id="launching-base-to-work-on-data-sources">
<h3><a class="toc-backref" href="#id33" role="doc-backlink">Launching Base to work on data sources</a><a class="headerlink" href="#launching-base-to-work-on-data-sources" title="Link to this heading">¶</a></h3>
<p>右クリックメニューから <span class="menuselection">Edit <span class="accelerator">D</span>atabase File…</span> を実行すると LibreOffice Base が起動する。データベース、<cite>Tables</cite>, 表名、<cite>Queries</cite>, 質問名を右クリックする。Base に入ると、表、質問、フォーム、報告書を編集、追加、削除することが可能だ。</p>
<p>Base の使い方については <em>Getting Started Guide</em> または <em>Base Guide</em> を見ろ。</p>
</section>
<section id="using-data-sources-in-calc-spreadsheets">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Using data sources in Calc spreadsheets</a><a class="headerlink" href="#using-data-sources-in-calc-spreadsheets" title="Link to this heading">¶</a></h3>
<p>Data Sources 窓の右側に表示されている表のデータは Calc 文書に配置可能だ。</p>
<p>Data Sources 窓で単一升目、単一行、複数行のどれかを選択し、データをシートにドラッグ＆ドロップすることが可能だ。マウスボタンを放した位置にデータが入る。行の場合、Calc は追加データの上に列見出しも含める。シートに追加するデータの行を選択するには：</p>
<ol class="arabic simple">
<li><p>選択したい最初の行の左にある灰色箱をクリックする。その行が強調表示される。</p></li>
<li><p>隣接する複数の行を選択するには <kbd class="kbd docutils literal notranslate">Shift</kbd> を押しながら、所望の行最後の灰色箱をクリックする。</p></li>
<li><p>複数の別々の行を選択するには <kbd class="kbd docutils literal notranslate">Ctrl</kbd> を押しながら各行を選択する。</p></li>
<li><p>すべての行を選択するには、左上隅の灰色箱をクリックする。</p></li>
</ol>
<p>別の方法として、<span class="guilabel">Table Data</span> ツールバー の <span class="guilabel">Data to Text</span> 図像を使用すると、入れたデータの上に列見出しも入る：</p>
<ol class="arabic simple">
<li><p>データの左上に表示したいシートの升目を列名も含めてクリックする。</p></li>
<li><p>前の段落で説明したようにして、シートに追加したいデータの行を選択する。</p></li>
<li><p><span class="guilabel">Table Data</span> ツールバー の <span class="guilabel">Data to Text</span> 図像をクリックしてデータをシートの升目に入れる。</p></li>
</ol>
<p>データ給源の列見出し（フィールド名）をシートにドラッグして、個々の登録項目を一度に表示、編集するフォームを作成することも可能だ。手順は次のとおり：</p>
<ol class="arabic simple">
<li><p>使用したいフィールド名を含む列の上部にある灰色箱を、シートで登録項目を表示したい場所にドラッグ＆ドロップする。</p></li>
<li><p>必要なフィールドをすべて必要な場所に移動するまで繰り返す。</p></li>
<li><p>Data Sources 窓を閉じる。</p></li>
<li><p>スプレッドシートを保存し、Menu バー の <span class="menuselection"><span class="accelerator">E</span>dit‣E<span class="accelerator">d</span>it Mode</span> を選択するか、<kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">M</kbd> を押して読み取り専用にする。</p></li>
<li><p>Menu バー の <span class="menuselection"><span class="accelerator">F</span>ile‣Re<span class="accelerator">l</span>oad</span> を選択する。すべてのフィールドに選択したデータ給源の最初の登録項目のデータの値が表示される。</p></li>
<li><p><span class="menuselection"><span class="accelerator">V</span>iew‣<span class="accelerator">T</span>oolbars‣Form <span class="accelerator">N</span>avigation</span> を選択して
<span class="guilabel">Form Navigation</span> ツールバー を表示する。既定ではこのツールバーは Status バー のすぐ上に開く。</p></li>
<li><p><span class="guilabel">Form Navigation</span> ツールバー の矢印をクリックすると、表のさまざまな登録項目が表示される。ツールバーには、現在表示されている登録項目と、利用可能な登録項目の総数が表示される。登録項目を移動するにつれて現在の登録項目番号が変わり、シートのフィールドデータは特定の登録項目番号のデータに対応するように更新される。</p></li>
</ol>
</section>
</section>
<section id="embedding-spreadsheets">
<h2><a class="toc-backref" href="#id35" role="doc-backlink">Embedding spreadsheets</a><a class="headerlink" href="#embedding-spreadsheets" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>スプレッドシートを他の LibreOffice ファイルに埋め込むことが可能だ。</p></li>
<li><p>スプレッドシートは <abbr title="Object Linking and Embedding">OLE</abbr> 物または <abbr title="Dynamic Data Exchange">DDE</abbr> 物として埋め込み可能。</p></li>
</ul>
<p>例えば、Calc スプレッドシートが <abbr title="Dynamic Data Exchange">DDE</abbr> 物として Writer 文書に貼り付けられている場合、Writer 文書からスプレッドシートを編集することは不可能だ。ただし、元スプレッドシートが更新されると Writer 文書で自動的に更新される。</p>
<p>例：スプレッドシートがリンクされた <abbr title="Object Linking and Embedding">OLE</abbr> 物として Writer 文書に埋め込まれた場合、Writer でもスプレッドシートを編集でき、両者が互いに同期する。</p>
<section id="object-linking-and-embedding-ole">
<h3><a class="toc-backref" href="#id36" role="doc-backlink">Object Linking and Embedding (OLE)</a><a class="headerlink" href="#object-linking-and-embedding-ole" title="Link to this heading">¶</a></h3>
<p><abbr title="Object Linking and Embedding">OLE</abbr> 物の主な利点は：</p>
<ul class="simple">
<li><p>ダブルクリックするだけでその内容を素早く編集できる。</p></li>
<li><p>物のリンクを挿入することもでき、その場合は図像として表示される。</p></li>
</ul>
<p>リンクと埋め込みの差異は、元ファイルのその後の変更に追従するか否かだと思ってよい。後者はデータの静的コピーでしかない。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><abbr title="Object Linking and Embedding">OLE</abbr> 物が空かつ活動停止中で、図像として表示されていない場合、それは透明になる。</p>
</div>
<p>スプレッドシートを <abbr title="Object Linking and Embedding">OLE</abbr> 物として紙芝居に埋め込む手順：</p>
<ol class="arabic simple">
<li><p>文書内の <abbr title="Object Linking and Embedding">OLE</abbr> 物を配置したい位置にキャレットを置く。</p></li>
<li><p>Menu バー の <span class="menuselection"><span class="accelerator">I</span>nsert‣<span class="accelerator">O</span>LE Object‣<span class="accelerator">O</span>LE Object…</span> を選択。<span class="guilabel">Insert OLE Object</span> ダイアログボックス が開き、既定で新規作成オプションが選択されている。</p></li>
<li><p><abbr title="Object Linking and Embedding">OLE</abbr> 物を新規作成するか、既存ファイルから作成する。</p></li>
</ol>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>これは Calc 以外のアプリケーションのメニューから Calc 文書を埋め込むことを想定した説明になっている？</p>
</div>
<p>新しいオブジェクトを作成する手順：</p>
<ol class="arabic simple">
<li><p><span class="guilabel">Create <span class="accelerator">n</span>ew</span> を選択し、<span class="guilabel">Object <span class="accelerator">T</span>ype</span> 一覧から必要なものを選択する。この例では <cite>LibreOffice 7.2 Spreadsheet</cite> を選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。</p></li>
<li><p>LibreOffice はスライドに空の器を配置し、情報を入力できるようにする。既定では
Menu バー は Calc Menu バー に変化する。スプレッドシートの領域以外のスライドをクリックすると、Menu バー は元のアプリケーションのそれに戻る。</p></li>
</ol>
<p>スプレッドシート領域外をクリックした後、<abbr title="Object Linking and Embedding">OLE</abbr> 物をダブルクリックして、物の編集モードに再度入る。その型のファイルを扱うアプリケーション (Calc) が物を開く。</p>
<p>はめ込んだスプレッドシートを保存する手順：</p>
<ol class="arabic simple">
<li><p>スプレッドシートの外側のどこかをクリックして、編集モードから出る。</p></li>
<li><p>スプレッドシート上で右クリックし、コンテキストメニューから
<span class="menuselection">Save Copy <span class="accelerator">a</span>s…</span> を選択するか、Menu バー から
<span class="menuselection"><span class="accelerator">E</span>dit‣OLE Ob<span class="accelerator">j</span>ect‣Save Copy <span class="accelerator">a</span>s…</span> を選択する。</p></li>
<li><p>新しいファイルの名前と保存先のフォルダーを選択する。</p></li>
<li><p><span class="guilabel">保存 (<span class="accelerator">S</span>)</span> ボタン を押す。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>挿入物が LibreOffice で処理される場合は、物を操作するプログラムへの移行が継ぎ目なく行われる。その他の場合は、物が新しい窓に開き、その挿入物を更新するためのオプションが <span class="menuselection"><span class="accelerator">F</span>ile‣</span> メニュー に表示される。</p>
</div>
<p>既存物をはめ込む手順：</p>
<ol class="arabic">
<li><p>既存のファイルから <abbr title="Object Linking and Embedding">OLE</abbr> 物を作成するために <span class="guilabel">Create <span class="accelerator">f</span>rom file</span> を選択する。 <span class="guilabel">Insert OLE Object</span> ダイアログボックス が変化する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">S</span>earch…</span> を押し、<span class="guilabel">開く</span> ダイアログボックス で必要なファイルを選択し <span class="guilabel">開く (<span class="accelerator">O</span>)</span> ボタン
を押す。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>この機能は LibreOffice ファイルに限定されない。他の多くのアプリケーションの既存ファイルを使用して <abbr title="Object Linking and Embedding">OLE</abbr> 物を作成可能だ。</p>
</div>
</li>
<li><p>物を原ファイルへのリンクとしてはめ込むには <span class="guilabel"><span class="accelerator">L</span>ink to file</span> をオンにする。そうしないと物が埋め込まれる。</p></li>
<li><p>物をファイルの一部ではなく、選択可能な図像として見せたい場合は、
<span class="guilabel"><span class="accelerator">D</span>isplay as icon</span> をオンにする。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。はめ込んだファイルの部分が文書に示される。原スプレッドシートにシートが複数ある場合は、編集モードでシート間を渡れる。</p></li>
</ol>
<section id="other-ole-objects">
<h4><a class="toc-backref" href="#id37" role="doc-backlink">Other OLE objects</a><a class="headerlink" href="#other-ole-objects" title="Link to this heading">¶</a></h4>
<p>Windows では <span class="guilabel">Insert OLE Object</span> ダイアログボックス で <span class="guilabel">Create <span class="accelerator">n</span>ew</span> オプションを選択すると
<span class="guilabel">Object <span class="accelerator">T</span>ype</span> 一覧に <cite>Further objects</cite> という項目が追加される。</p>
<ol class="arabic">
<li><p><cite>Further objects</cite> の項目をダブルクリックして <span class="guilabel">オブジェクトの挿入</span>
ダイアログボックスを開く。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>LibreOffice ではなく、Windows が備えているダイアログボックスが開く。</p>
</div>
</li>
<li><p><span class="guilabel">オブジェクトの種類 (<span class="accelerator">T</span>)</span> 一覧で選択した型の新しい物をはめ込むため
<span class="guilabel">新規作成 (<span class="accelerator">N</span>)</span> を、既存ファイルから物を新規に作成するには
<span class="guilabel">ファイルから作成 (<span class="accelerator">F</span>)</span> を選択する。</p></li>
<li><p>後者を選択した後 <span class="guilabel">参照 (<span class="accelerator">B</span>)…</span> を押し、はめ込むファイルを選択する。挿入物はそれを作成した Windows プログラムで編集可能だ。</p>
<p>物に代わりにリンクを挿入したい場合は、<span class="guilabel">アイコンで表示 (<span class="accelerator">D</span>)</span> をオンにする。</p>
</li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。</p></li>
</ol>
</section>
<section id="non-linked-ole-object">
<h4><a class="toc-backref" href="#id38" role="doc-backlink">Non-linked OLE object</a><a class="headerlink" href="#non-linked-ole-object" title="Link to this heading">¶</a></h4>
<p><abbr title="Object Linking and Embedding">OLE</abbr> 物がリンクされていない場合、新規文書で編集することが可能だ。例えば、スプレッドシートを Writer 文書に挿入した場合、基本的に Writer の表組と同じように扱うことが可能だ。ダブルクリックで編集開始。</p>
</section>
<section id="linked-ole-object">
<h4><a class="toc-backref" href="#id39" role="doc-backlink">Linked OLE object</a><a class="headerlink" href="#linked-ole-object" title="Link to this heading">¶</a></h4>
<p>スプレッドシート <abbr title="Object Linking and Embedding">OLE</abbr> 物リンクされていて、Writer で変更すると Calc でも変更され、Calc で変更すると Writer でも変更される。Writer 窓だけを開いていればいいということになる。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ただし、一度に編集できるスプレッドシートのコピーは一つに限られる。複数の文書からリンクされている場合、残りの文書からは参照先が読み取り専用扱いとなる。</p>
</div>
</section>
</section>
<section id="dynamic-data-exchange-dde">
<span id="calc11-anchor-dde"></span><h3><a class="toc-backref" href="#id40" role="doc-backlink">Dynamic Data Exchange (DDE)</a><a class="headerlink" href="#dynamic-data-exchange-dde" title="Link to this heading">¶</a></h3>
<p>文書 A で選択したデータを、リンクされたオリジナルの生コピーとして文書 B に貼り付けることができる仕組みが <abbr title="Dynamic Data Exchange">DDE</abbr> だ。例えば、Calc スプレッドシートから取得した販売実績のような、時系列で変化するデータを含む Writer で書かれた報告書があり得る。
<abbr title="Dynamic Data Exchange">DDE</abbr> リンクにより、参照先が更新されると参照元も更新されるため、エラーの可能性が低くなり、参照元文書を最新の状態に保つ作業が軽減される。</p>
<p><abbr title="Dynamic Data Exchange">DDE</abbr> は <abbr title="Object Linking and Embedding">OLE</abbr> の前身に当たる。<abbr title="Dynamic Data Exchange">DDE</abbr> では、物はファイル参照を通じてリンクされるが埋め込まれない。<abbr title="Dynamic Data Exchange">DDE</abbr> リンクは Calc シートの Calc 升目内、または Writer などの別の LibreOffice 文書の Calc 升目内に作成できる。</p>
<section id="dde-link-in-calc">
<h4><a class="toc-backref" href="#id41" role="doc-backlink">DDE link in Calc</a><a class="headerlink" href="#dde-link-in-calc" title="Link to this heading">¶</a></h4>
<p><span class="guilabel">Paste Special</span> ダイアログボックス の <span class="guilabel">As <span class="accelerator">L</span>ink</span> をオンにするのが本質的だ。参照先セルを含むファイルを開いていないとこの操作ができない。</p>
<p>Calc スプレッドシートから別のスプレッドシートへ <abbr title="Dynamic Data Exchange">DDE</abbr> リンクを作成する手順：</p>
<ol class="arabic simple">
<li><p>リンクしたい元のデータを含むスプレッドシートを Calc で開く。</p></li>
<li><p><abbr title="Dynamic Data Exchange">DDE</abbr> リンクさせたいセルを選択する。</p></li>
<li><p>Menu バー の <span class="menuselection"><span class="accelerator">E</span>dit‣Cop<span class="accelerator">y</span></span> を選択するか、<span class="guilabel">Standard</span> ツールバー の <span class="guilabel">Copy</span>
図像をクリックするか、選択領域を右クリックしてコンテキストメニューから
<span class="menuselection">Cop<span class="accelerator">y</span>…</span> を選択するか、<kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">C</kbd> を押して升目をクリップボードにコピーする。</p></li>
<li><p>リンクデータを含む第二のスプレッドシートを開く。</p></li>
<li><p>第二スプレッドシートで、リンクデータを表示したい領域の左上升目をクリックする。</p></li>
<li><p>第二スプレッドシートで、Menu バー の <span class="menuselection"><span class="accelerator">E</span>dit‣Paste <span class="accelerator">S</span>pecial‣Paste <span class="accelerator">S</span>pecial…</span> を選択するか、その領域の左上セルを右クリックしてコンテキストメニューから <span class="menuselection">Paste <span class="accelerator">S</span>pecial‣Paste <span class="accelerator">S</span>pecial…</span> を選択するか、<kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">V</kbd> を押す。</p></li>
<li><p><span class="guilabel">Paste Special</span> ダイアログボックス が開く。</p></li>
<li><p><span class="guilabel">Paste Special</span> ダイアログボックス で <span class="guilabel">As <span class="accelerator">L</span>ink</span> を選択し <span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。</p></li>
<li><p>リンクされた升目をクリックすると、Formula バー に <code class="docutils literal notranslate"><span class="pre">{='</span></code> で始まる参照が表示される。</p></li>
<li><p>両方のスプレッドシートを保存して閉じる。</p></li>
</ol>
<p>その後、そのスプレッドシートの元のセルを編集して変更を保存すると、次にリンク先のセルを含むスプレッドシートを開いたときにリンク先の升目の値が更新され、元のセルの最新値が反映される。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>リンクされたデータを含むスプレッドシートを開くと、 外部リンクの自動更新が無効になっていることを示す警告メッセージが表示されることがある。リンクされた升目の更新を許可するには、関連するボタンを押す必要がある。元のデータを含むスプレッドシートが信頼できるファイルの場所にあり、開くときに信頼できる場所からのリンクを常に更新するオプションが選択されていることを確認することで、このメッセージを回避できる。これらの設定は <span class="guilabel">Options</span> ダイアログボックス の</p>
<ul class="simple">
<li><p><span class="menuselection">LibreOffice‣Security</span> ページ <span class="guilabel">Macro Securit<span class="accelerator">y</span>…</span> ボタンからの
<span class="guilabel">Trusted Sources</span> タブと、</p></li>
<li><p><span class="menuselection">LibreOffice Calc‣General</span> ページ <span class="guilabel">Update links when opening section</span></p></li>
</ul>
<p>でそれぞれ確認可能。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>二つ目の項目が見当たらない。</p>
</div>
</div>
</section>
<section id="dde-link-in-writer">
<h4><a class="toc-backref" href="#id42" role="doc-backlink">DDE link in Writer</a><a class="headerlink" href="#dde-link-in-writer" title="Link to this heading">¶</a></h4>
<p>Calc から Writer への <abbr title="Dynamic Data Exchange">DDE</abbr> リンクの作成手順は、Calc 内でのそれと同様だ。この機能の詳細については <em>Writer Guide</em> を見ろ。</p>
<ol class="arabic simple">
<li><p>Calc で <abbr title="Dynamic Data Exchange">DDE</abbr> リンクを作成するセルを選択、コピー。</p></li>
<li><p>Writer 文書の <abbr title="Dynamic Data Exchange">DDE</abbr> リンクを作成する場所に移動。<span class="menuselection"><span class="accelerator">E</span>dit‣Paste <span class="accelerator">S</span>pecial‣Paste <span class="accelerator">S</span>pecial…</span> を選択。</p></li>
<li><p>Writer に <span class="guilabel">Paste Special</span> ダイアログボックス が開く。</p></li>
<li><p><span class="guilabel"><span class="accelerator">S</span>election</span> 一覧で <cite>Dynamic Data Exchange (DDE link)</cite> を選択。</p></li>
<li><p><span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。</p></li>
<li><p>これで Writer にリンクが作成された。Calc スプレッドシートが更新されると
Writer の表も自動的に更新される。</p></li>
</ol>
</section>
</section>
</section>
<section id="xml-source">
<h2><a class="toc-backref" href="#id43" role="doc-backlink">XML Source</a><a class="headerlink" href="#xml-source" title="Link to this heading">¶</a></h2>
<p>XML Source 機能を使用すると、既存の表計算文書の升目に、任意に構造化された <abbr title="Extensible Markup Language">XML</abbr>
中身からデータをインポートすることができる。この機能では <abbr title="Extensible Markup Language">XML</abbr> 中身の構造や使用者が定義する写像定義に応じて、中身を部分的または全体的にインポートすることができる。使用者は同じ文書内の異なる升目位置に写される複数の重複しない部分構造を指定することができ、要素中身、属性値、またはその両方のインポートを選択することができる。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>XML Source 機能では、現在、<abbr title="Extensible Markup Language">XML</abbr> データを一度限りのイベントとしてインポートすることができる。すなわち、データがインポートされると、データ給源に関する情報は保存されない。</p>
</div>
<p>次のような <abbr title="Extensible Markup Language">XML</abbr> ファイルに売上データがあるとする：</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;sales&gt;</span>
<span class="w">  </span><span class="nt">&lt;sale&gt;</span>
<span class="w">    </span><span class="nt">&lt;date&gt;</span>01/19/08<span class="nt">&lt;/date&gt;</span>
<span class="w">    </span><span class="nt">&lt;value&gt;</span>$2,032<span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;category&gt;</span>Golf<span class="nt">&lt;/category&gt;</span>
<span class="w">    </span><span class="nt">&lt;region&gt;</span>West<span class="nt">&lt;/region&gt;</span>
<span class="w">    </span><span class="nt">&lt;employee&gt;</span>Brigitte<span class="nt">&lt;/employee&gt;</span>
<span class="w">  </span><span class="nt">&lt;/sale&gt;</span>
<span class="w">  </span><span class="nt">&lt;sale&gt;</span>
<span class="w">    </span><span class="nt">&lt;date&gt;</span>01/25/08<span class="nt">&lt;/date&gt;</span>
<span class="w">    </span><span class="nt">&lt;value&gt;</span>$3,116<span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;category&gt;</span>Sailing<span class="nt">&lt;/category&gt;</span>
<span class="w">    </span><span class="nt">&lt;region&gt;</span>East<span class="nt">&lt;/region&gt;</span>
<span class="w">    </span><span class="nt">&lt;employee&gt;</span>Hans<span class="nt">&lt;/employee&gt;</span>
<span class="w">  </span><span class="nt">&lt;/sale&gt;</span>
<span class="w">  </span><span class="nt">&lt;sale&gt;</span>
<span class="w">    </span><span class="nt">&lt;date&gt;</span>01/26/08<span class="nt">&lt;/date&gt;</span>
<span class="w">    </span><span class="nt">&lt;value&gt;</span>$2,811<span class="nt">&lt;/value&gt;</span>
<span class="w">    </span><span class="nt">&lt;category&gt;</span>Tennis<span class="nt">&lt;/category&gt;</span>
<span class="w">    </span><span class="nt">&lt;region&gt;</span>South<span class="nt">&lt;/region&gt;</span>
<span class="w">    </span><span class="nt">&lt;employee&gt;</span>Fritz<span class="nt">&lt;/employee&gt;</span>
<span class="w">  </span><span class="nt">&lt;/sale&gt;</span>
<span class="w"> </span><span class="nt">&lt;/sales&gt;</span>
</pre></div>
</div>
<p>このデータを Calc にインポートするには：</p>
<ol class="arabic simple">
<li><p><span class="menuselection"><span class="accelerator">D</span>ata‣<span class="accelerator">X</span>ML Source…</span> を選択する。<span class="guilabel">XML Source</span> ダイアログボックス が開く。</p></li>
<li><p><span class="guilabel">Source File</span> 領域の図像を押す。文書にインポートする <abbr title="Extensible Markup Language">XML</abbr> ファイルのパスを指定する。</p></li>
<li><p>適切なフォルダーに移動し、必要なファイルを選択して <span class="guilabel">開く (<span class="accelerator">O</span>)</span> ボタン を押す。</p></li>
<li><p>Calc は指定されたファイルの内容を読み取り、<span class="guilabel">XML Source</span> ダイアログボックス の <span class="guilabel">Map
to Document</span> 領域に <abbr title="Extensible Markup Language">XML</abbr> の構造を表示する。</p></li>
<li><p>この例のデータの場合、<span class="guilabel">Map to Document</span> 領域で <cite>sale</cite> を選択する。これにより、<abbr title="Extensible Markup Language">XML</abbr> 中身の <cite>&lt;sale&gt;</cite> 項目すべてがスプレッドシートにインポートされる。</p></li>
<li><p>スプレッドシートでデータを表示する領域の左上の升目をクリックする。この例の場合、A1 をクリックする。<span class="guilabel"><span class="accelerator">M</span>apped cell</span> 欄にクリックした升目のテルバックが表示される。</p></li>
<li><p><span class="guilabel"><span class="accelerator">I</span>mport</span> ボタンを押す。この動作は、使用者が与えたリンク定義に基づいてインポート処理を開始する。インポートが終了するとダイアログボックスが閉じる。</p></li>
</ol>
<p><abbr title="Extensible Markup Language">XML</abbr> 中身がスプレッドシート内の指定した位置に配置する。</p>
<p><span class="guilabel">XML Source</span> ダイアログボックス の <span class="guilabel">Map to Document</span> 領域には ソース <abbr title="Extensible Markup Language">XML</abbr> 中身の構造が木として表示される。最初は空で、ソースファイルを指定すると入力される。</p>
<p>木内の各要素は次の三種類のいずれかだ：</p>
<ul class="simple">
<li><p>記号 <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> で表される属性。</p></li>
<li><p>記号 <code class="docutils literal notranslate"><span class="pre">&lt;/&gt;</span></code> で表される単一の単発要素。同じ親の下で一度だけ出現する要素だ。文書内の単一セルに写される。</p></li>
<li><p>記号 <code class="docutils literal notranslate"><span class="pre">&lt;//&gt;</span></code> で表される反復要素。反復要素とは同じ親の下に複数回出現する要素だ。複数の登録項目の単一登録項目を囲む親として機能する。これらの項目は、項目の数にヘッダー行を一行追加した高さに等しい範囲にインポートされる。</p></li>
</ul>
<p><span class="guilabel"><span class="accelerator">M</span>apped cell</span> 欄は要素や属性がリンクされている文書内の升目の位置を指定する。単発要素や属性の場合はリンクされた要素や属性の値がインポートされる升目を指す。反復要素であれば登録項目全体とヘッダーがインポートされる範囲の左上の升目を指す。</p>
</section>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="calc10.html" title="Previous">Calc Guide Chapter 10, Data Analysis ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Calc Guide 読書ノート</a>
        </li>
        <li>
          <a href="calc12.html" title="Next">Calc Guide Chapter 12, Sharing and Reviewing Spreadsheets ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="../../index.html" title="読書ノート Home"><img src="../../_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>