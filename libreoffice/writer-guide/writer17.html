<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Writer Guide Chapter 17, Fields ノート &#8212; 読書ノート 1.6dev</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=c9b0a06a" />
    <script src="../../_static/documentation_options.js?v=4354bf25"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Writer Guide Chapter 18, Forms ノート" href="writer18.html" />
    <link rel="prev" title="Writer Guide Chapter 16, Master Documents ノート" href="writer16.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="writer16.html" title="Previous">Writer Guide Chapter 16, Master Documents ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Writer Guide 読書ノート</a>
        </li>
        <li>
          <a href="writer18.html" title="Next">Writer Guide Chapter 18, Forms ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="writer-guide-chapter-17-fields">
<h1>Writer Guide Chapter 17, Fields ノート<a class="headerlink" href="#writer-guide-chapter-17-fields" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="id1">
<p class="topic-title">章見出し</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id5">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#keyboard-shortcuts-for-fields" id="id6">Keyboard shortcuts for fields</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#quick-and-easy-field-entry" id="id7">Quick and easy field entry</a></p></li>
<li><p><a class="reference internal" href="#using-document-properties-to-hold-metadata-and-information-that-changes" id="id8">Using document properties to hold metadata and information that changes</a></p></li>
<li><p><a class="reference internal" href="#using-other-fields-to-hold-information-that-changes" id="id9">Using other fields to hold information that changes</a></p></li>
<li><p><a class="reference internal" href="#using-autotext-to-insert-often-used-fields" id="id10">Using AutoText to insert often-used fields</a></p></li>
<li><p><a class="reference internal" href="#defining-your-own-numbering-sequences" id="id11">Defining your own numbering sequences</a></p></li>
<li><p><a class="reference internal" href="#using-automatic-cross-references" id="id12">Using automatic cross-references</a></p>
<ul>
<li><p><a class="reference internal" href="#inserting-cross-references" id="id13">Inserting cross-references</a></p></li>
<li><p><a class="reference internal" href="#formats-for-cross-references" id="id14">Formats for cross-references</a></p>
<ul>
<li><p><a class="reference internal" href="#example-of-cross-referencing-to-numbered-headings" id="id15">Example of cross-referencing to numbered headings</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#preparing-items-as-targets-for-cross-referencing" id="id16">Preparing items as targets for cross-referencing</a></p>
<ul>
<li><p><a class="reference internal" href="#using-bookmarks" id="id17">Using bookmarks</a></p></li>
<li><p><a class="reference internal" href="#setting-references" id="id18">Setting references</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#cross-referencing-between-subdocuments" id="id19">Cross-referencing between subdocuments</a></p>
<ul>
<li><p><a class="reference internal" href="#preparing-the-references" id="id20">Preparing the references</a></p></li>
<li><p><a class="reference internal" href="#inserting-the-cross-references" id="id21">Inserting the cross-references</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-fields-in-headers-and-footers" id="id22">Using fields in headers and footers</a></p></li>
<li><p><a class="reference internal" href="#managing-bookmarks" id="id23">Managing bookmarks</a></p></li>
<li><p><a class="reference internal" href="#developing-conditional-content" id="id24">Developing conditional content</a></p>
<ul>
<li><p><a class="reference internal" href="#choose-the-types-of-conditional-content-to-use" id="id25">Choose the types of conditional content to use</a></p></li>
<li><p><a class="reference internal" href="#plan-your-conditional-content" id="id26">Plan your conditional content</a></p>
<ul>
<li><p><a class="reference internal" href="#choose-or-define-a-variable" id="id27">Choose or define a variable</a></p></li>
<li><p><a class="reference internal" href="#define-a-logical-expression-condition-involving-the-variable" id="id28">Define a logical expression (condition) involving the variable</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#create-the-variable" id="id29">Create the variable</a></p>
<ul>
<li><p><a class="reference internal" href="#docinformation-fields" id="id30">DocInformation fields</a></p></li>
<li><p><a class="reference internal" href="#user-defined-variable-field" id="id31">User-defined variable field</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#apply-the-condition-to-the-content" id="id32">Apply the condition to the content</a></p>
<ul>
<li><p><a class="reference internal" href="#conditional-text" id="id33">Conditional text</a></p></li>
<li><p><a class="reference internal" href="#hidden-text" id="id34">Hidden text</a></p></li>
<li><p><a class="reference internal" href="#hidden-paragraphs" id="id35">Hidden paragraphs</a></p></li>
<li><p><a class="reference internal" href="#hidden-sections" id="id36">Hidden sections</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#change-the-value-of-the-variable" id="id37">Change the value of the variable</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-placeholder-fields" id="id38">Using placeholder fields</a></p></li>
<li><p><a class="reference internal" href="#using-other-fields" id="id39">Using other fields</a></p></li>
<li><p><a class="reference internal" href="#classifying-document-contents" id="id40">Classifying document contents</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>フィールドは様々な目的で使用される：</p>
<ul class="simple">
<li><p>変化するデータ：現在の日付や総ページ数など</p></li>
<li><p>変更するおそれがあるデータ：開発中の製品や書籍の名前など</p></li>
<li><p>使用者定義の番号順、自動相互参照、条件式中身（ある条件では表示または印刷されるが、他の条件では表示または印刷されない単語や段落）など</p></li>
<li><p>索引項目</p></li>
</ul>
<p>この章ではフィールドの一般的な使い方を説明する。フィールドとその使用法についての完全な議論は本書の範囲を超えている。上級者であればアプリケーションの Help にある詳細を見つけられる。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Menu バー <span class="menuselection"><span class="accelerator">V</span>iew‣Fie<span class="accelerator">l</span>d Shadings…</span> をオフにするか、<span class="guilabel">Options</span> ダイアログボックス
<span class="menuselection">LibreOffice‣Application Colors</span> ページ で陰影色を変更していない限り、フィールド背景は画面表示時に灰色になる。この灰色はファイルを印刷したり <abbr title="Portable Document Format">PDF</abbr> ファイルにエクスポートしたりするときには表示されない。</p>
</div>
<section id="keyboard-shortcuts-for-fields">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Keyboard shortcuts for fields</a><a class="headerlink" href="#keyboard-shortcuts-for-fields" title="Link to this heading">¶</a></h3>
<p>フィールドを操作するときに便利なキーバインド：</p>
<table class="docutils align-left" id="id4">
<caption><span class="caption-text">title</span><a class="headerlink" href="#id4" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>キーバインド</p></th>
<th class="head"><p>動作</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F2</kbd></p></td>
<td><p><span class="guilabel">Fields</span> ダイアログボックス を開く</p></td>
</tr>
<tr class="row-odd"><td><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F8</kbd></p></td>
<td><p>フィールド陰影表示を切り替える</p></td>
</tr>
<tr class="row-even"><td><p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F9</kbd></p></td>
<td><p>フィールド名表示を切り替える</p></td>
</tr>
<tr class="row-odd"><td><p><kbd class="kbd docutils literal notranslate">F9</kbd></p></td>
<td><p>フィールドを更新する</p></td>
</tr>
</tbody>
</table>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p><kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F9</kbd> は日常的に使う DeepL の「読みながら翻訳」コマンドのキーバインドと衝突しているので要注意。</p>
</div>
</section>
</section>
<section id="quick-and-easy-field-entry">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Quick and easy field entry</a><a class="headerlink" href="#quick-and-easy-field-entry" title="Link to this heading">¶</a></h2>
<p>一般的なフィールドを文書にすばやく入れるには Menu バー で次のいずれかを行う：</p>
<ul class="simple">
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣<span class="accelerator">P</span>age Number…</span> を選択</p></li>
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣Fiel<span class="accelerator">d</span>‣</span> サブメニューで必要なフィールドを選択</p></li>
</ul>
</section>
<section id="using-document-properties-to-hold-metadata-and-information-that-changes">
<span id="writer17-anchor-hold"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink">Using document properties to hold metadata and information that changes</a><a class="headerlink" href="#using-document-properties-to-hold-metadata-and-information-that-changes" title="Link to this heading">¶</a></h2>
<p>文書の <span class="guilabel">Properties</span> ダイアログボックス にはタブが六つある。<span class="guilabel">General</span> タブ と <span class="guilabel">Statistics</span>
タブの情報はプログラムが生成する。一部の情報[#writer17-footnote1]_ は
<span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice‣User Data</span> ページ から取得される。<span class="guilabel">Font</span> タブ と <span class="guilabel">Security</span> タブ の選択肢については本書の他の箇所に説明がある。</p>
<p><span class="guilabel">Description</span> タブ と <span class="guilabel">Custom Properties</span> タブ は次の目的のために使う：</p>
<ul class="simple">
<li><p>文書の分類、並べ替え、保存、検索を支援するメタデータ。このメタデータの一部は
<abbr title="HyperText Markup Language">HTML</abbr> や <abbr title="Portable Document Format">PDF</abbr> で最も近い等価物にエクスポートされる。一部のフィールドには同等のものがなく、エクスポートされない。</p></li>
<li><p>変更される情報。たとえば、文書の表題、プロジェクト参加者の連絡先、製品名などは、プロジェクトの過程で変更される可能性がある。</p></li>
</ul>
<p>このダイアログボックスは雛形で使用することができ、フィールド名は書き手に含めるべき情報を思い出させる役割を果たす。</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>プレースホルダーはテキスト内でも同様の役割を果たすことができる。
<a class="reference internal" href="#writer17-anchor-placeholder"><span class="std std-ref">Using placeholder fields</span></a> 参照。</p>
</div>
<p>このダイアログボックスに戻り、入力した情報を変更することがいつでもできる。そうすると、その情報への参照すべてが文書内のどこに表示されていても変更される。例えば、
<span class="guilabel">Description</span> タブ で <span class="guilabel"><span class="accelerator">T</span>itle</span> 欄の内容を草稿表題から製品表題に変更する必要が出るかもしれない。</p>
<p><span class="guilabel">Custom Properties</span> タブ は、このダイアログボックスの他のタブが設けるフィールドに収まらない情報を保存するために使用する。</p>
<p>新しい文書で <span class="guilabel">Custom Properties</span> タブ を最初に開いたとき、空白の場合がある。新しい文書が雛形に基づいている場合、このタブにはフィールドが含まれることがある。</p>
<p>タブの右下にある <span class="guilabel">Add <span class="accelerator">P</span>roperty</span> ボタンを押すと、独自性質入力欄の列がはめ込まれる。</p>
<ul class="simple">
<li><p><span class="guilabel">Name</span> には、典型的な選択肢のドロップダウンリストがある。スクロールダウンすると、すべての選択肢を見ることができる。</p></li>
<li><p><span class="guilabel">Type</span> では <cite>Text</cite>, <cite>DateTime</cite>, <cite>Date</cite>, <cite>Duration</cite>, <cite>Number</cite>, <cite>Yes</cite>,
<cite>No</cite> から選択できる。新しい型を定義することはできない。</p></li>
<li><p><span class="guilabel">Value</span> ではこのフィールドが使用される文書に表示させたい内容を指定する。例えば、<span class="guilabel">Type</span> の選択が <cite>Date</cite> の場合、その性質の
<span class="guilabel">Value</span> は日付に限定される。</p></li>
</ul>
<p>独自性質を削除するには行の右端にあるバツボタンを押す。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>日付の値の形式を変更するには、<span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">Language Settings‣Languages</span> ページ <span class="guilabel">Locale
setting</span> を変更する。</p>
</div>
</section>
<section id="using-other-fields-to-hold-information-that-changes">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Using other fields to hold information that changes</a><a class="headerlink" href="#using-other-fields-to-hold-information-that-changes" title="Link to this heading">¶</a></h2>
<p>フィールドの用途の一つとしては、プロジェクトの過程で変更される可能性のある情報を保持することがある。例えば、責任者、製品、会社全体の名前が変更される可能性がある。変更可能な情報をフィールドとして文書内に入れておけば、ある場所で情報を変更すれば、そのフィールドが出現するすべての場所で自動的に変更される。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>フィールドはプログラミングにおける変数の役割を果たすものだと考えてよさそうだ。</p>
</div>
<p>Writer にはフィールドが参照する情報を格納できる場所がいくつか用意されている。</p>
<p>次の文書特性は <span class="menuselection"><span class="accelerator">I</span>nsert‣Fiel<span class="accelerator">d</span>‣</span> にある。これらのフィールドを入れるには、対応するメニュー項目をクリックする：</p>
<ul class="simple">
<li><p><cite>Page Number</cite></p></li>
<li><p><cite>Page Count</cite></p></li>
<li><p><cite>Date</cite></p></li>
<li><p><cite>Time</cite></p></li>
<li><p><cite>Title</cite></p></li>
<li><p><cite>First Author</cite></p></li>
<li><p><cite>Subject</cite></p></li>
</ul>
<p>これらのフィールドのいくつかは <span class="guilabel">Document Properties</span> ダイアログボックス から情報を取得する。</p>
<p>その他の文書性質は <span class="guilabel">Fields</span> ダイアログボックス の <span class="guilabel">DocInformation</span> タブ と <span class="guilabel">Document</span> タブ にあり、次のいずれかで届く：</p>
<ul class="simple">
<li><p>Menu バー <span class="menuselection"><span class="accelerator">I</span>nsert‣Fiel<span class="accelerator">d</span>‣<span class="accelerator">M</span>ore Fields…</span></p></li>
<li><p>キーバインド <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F2</kbd></p></li>
</ul>
<p><span class="guilabel">DocInformation</span> タブ の <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 にある <cite>Custom</cite> 項目は <span class="guilabel">Document Properties</span> ダイアログボックス
<span class="guilabel">Custom Properties</span> タブ から派生したものだ。独自性質が定義されていない場合は一覧に現れない。</p>
<p>フィールド値には <span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice‣User Data</span> ページ から拾われるものがある。そのページの情報が正しいことを確認しろ。</p>
<p>これらのフィールドをはめ込むには <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 でフィールドを選択し、物が現れれば
<span class="guilabel">Select</span> および <span class="guilabel">Format</span> 一覧で値を選択する。最後に <span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン
を押す。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>内容を固定するには、フィールドをはめ込むときに <span class="guilabel">Fi<span class="accelerator">x</span>ed content</span> をオンにする。必要であれば、後でこのダイアログボックスに戻って、フィールドを再び可変にするためにこのオプションの選択をオフにしろ。例えば、文書の作成日を入れるフィールドを使用する場合、その日付を変更させたくないとする。</p>
</div>
</section>
<section id="using-autotext-to-insert-often-used-fields">
<span id="writer17-anchor-autotext"></span><h2><a class="toc-backref" href="#id10" role="doc-backlink">Using AutoText to insert often-used fields</a><a class="headerlink" href="#using-autotext-to-insert-often-used-fields" title="Link to this heading">¶</a></h2>
<p>同じフィールドを頻繁に使用する場合は、AutoText を使用するとすばやく簡単にフィールドをはめ込める。</p>
<p>フィールドに AutoText 項目を定義するには：</p>
<ol class="arabic simple">
<li><p>フィールドを文書に普通に入れる。</p></li>
<li><p>入れたフィールドを選択し、<span class="menuselection"><span class="accelerator">T</span>ools‣AutoText</span> を選択するか、キーバインド <kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F3</kbd> を使う。</p></li>
<li><p><span class="guilabel">AutoText</span> ダイアログボックス でこの新しい項目を登録するグループ (e.g. <cite>My AutoText</cite>) を選択し、<span class="guilabel">Na<span class="accelerator">m</span>e</span> に登録項目の名前を打ち込み、必要に応じて <span class="guilabel"><span class="accelerator">S</span>hortcut</span>
を変更する。</p></li>
<li><p><span class="menuselection">AutoTe<span class="accelerator">x</span>t‣<span class="accelerator">N</span>ew</span> を選択して項目をフィールドとして入れる。
AutoText の項目がプレーンテキストになるので <span class="menuselection">New (text only)</span>
は選択するな。</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>lose</span> ボタン を押して <span class="guilabel">AutoText</span> ダイアログボックス を閉じる。</p></li>
</ol>
<p>このフィールドをキャレット位置に入れるには、ショートカットを入力し、<kbd class="kbd docutils literal notranslate">F3</kbd> を押す。</p>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>ここで言うショートカットとは、Visual Studio Code の user snippets 機能における prefix に対応する。</p>
</div>
</section>
<section id="defining-your-own-numbering-sequences">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Defining your own numbering sequences</a><a class="headerlink" href="#defining-your-own-numbering-sequences" title="Link to this heading">¶</a></h2>
<p>段落の先頭に番号を常に付けたいわけではない場合や、組み込みの番号付けの選択肢よりも制御したい場合、一覧スタイルでは思いどおりにならない場合などに、独自の連番を定義して使用したい場合がある。</p>
<p>番号範囲変数フィールドを使用して、連番を作成する方法を見ていく。</p>
<p>アラビア数字を使って数値範囲変数を作成するには：</p>
<ol class="arabic simple">
<li><p>キャレットを文書内の空白の段落に置く。</p></li>
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣Fiel<span class="accelerator">d</span>‣<span class="accelerator">M</span>ore Fields…</span> を選択するか、<kbd class="kbd docutils literal notranslate">Ctrl</kbd> + <kbd class="kbd docutils literal notranslate">F2</kbd> を押して <span class="guilabel">Variables</span> タブ を選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 で <cite>Number range</cite> を選択する。<span class="guilabel"><span class="accelerator">F</span>ormat</span> 一覧 で <cite>Arabic (1 2 3)</cite> を選択する。<span class="guilabel">Na<span class="accelerator">m</span>e</span> に <cite>Step</cite> などの名前を入力する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押す。変数名 <cite>Step</cite> が <span class="guilabel"><span class="accelerator">S</span>elect</span> 一覧 に表示され、数値フィールドが文書の挿入点に表示される。<span class="guilabel">Fields</span> ダイアログボックス は開いたままだ。</p></li>
<li><p><span class="guilabel">Fields</span> ダイアログボックス の <span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン をさらに何回か押すと、2, 3, 4, … と数字が文書に表示される。</p></li>
<li><p>挿入したフィールドは削除することができる。<span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel"><span class="accelerator">S</span>elect</span> 一覧 には
<cite>Step</cite> 連番が（この文書のみ）残る。このフィールドは文書内の任意の場所に入れることが可能。</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><cite>Step</cite> 番号を入力するたびにこのような作業をするのを避ける方法がある。<cite>Step</cite>
AutoText 登録項目を作成するのだ。そうすれば、他の AutoText を入力するのと同じ方法でフィールドを入れられる。<a class="reference internal" href="#writer17-anchor-autotext"><span class="std std-ref">Using AutoText to insert often-used fields</span></a> を見ろ。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>使用者定義変数が文書で使用されていない場合、<span class="guilabel"><span class="accelerator">V</span>alue</span> 欄 の隣にあるバツボタンが活動開始する。これを押すと変数を削除することができる。使用されている変数を削除するには、まずその変数を使用しているフィールドをすべて文書から削除し、それから一覧から変数を削除する。</p>
</div>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>この節で述べられた連番の番号は、挿入順序ではなく、文書内の出現順序によって決まるようだ。</p>
</div>
</section>
<section id="using-automatic-cross-references">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Using automatic cross-references</a><a class="headerlink" href="#using-automatic-cross-references" title="Link to this heading">¶</a></h2>
<p>文書の他の部分への相互参照を入力した場合、見出しの文言を変更したり、図版を追加または削除したり、トピックを再編成したりすると、それらの参照は簡単に古くなってしまいる。入力した相互参照を自動参照に置き換えると、すべての参照は自動的に更新され、現在の文言またはページ・図表・表組番号が表示される。</p>
<p><span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Cross-references</span> タブ には、見出し、段落番号、しおりなど、項目がいくつか表示される。図版の説明、表組の説明、使用者定義の数値範囲変数、その他いくつかの項目が文書で定義されている場合、その型も一覧に表示される。</p>
<p>必要な項目に表示される単語や語句を知っている場合、<span class="guilabel"><span class="accelerator">S</span>elect</span> 一覧 に表示される項目の一覧を短くすることができる。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>相互参照に Writer のハイパーリンク機能を使う人がいるが、リンク先項目のテキストを変更してもハイパーリンクの表示テキストは変更されない。ほとんどの場面で相互参照を使用するのが望ましい。相互参照は <abbr title="HyperText Markup Language">HTML</abbr> 文書ではハイパーリンクにならないので、Writer 文書ではハイパーリンクを使用する必要がある。</p>
</div>
<section id="inserting-cross-references">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Inserting cross-references</a><a class="headerlink" href="#inserting-cross-references" title="Link to this heading">¶</a></h3>
<p><span class="guilabel">Cross-references</span> タブ に表示されている見出し、図版、その他の項目に相互参照を入れる方法：</p>
<ol class="arabic simple">
<li><p>キャレットを文書内の相互参照を表示したい場所に置く。</p></li>
<li><p><span class="guilabel">Fields</span> ダイアログボックス が開いていない場合は <span class="menuselection"><span class="accelerator">I</span>nsert‣Cross-<span class="accelerator">r</span>eference…</span> を選択するか、<kbd class="kbd docutils literal notranslate">Ctrl</kbd> +
<kbd class="kbd docutils literal notranslate">F2</kbd> を押す。<span class="guilabel">Cross-references</span> タブ の <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 で参照する項目の型 (e.g.
<cite>Headings</cite>, <cite>Figures</cite>) をクリックする。</p></li>
<li><p><span class="guilabel"><span class="accelerator">S</span>elect</span> 一覧 で必要な項目をクリックする。この一覧には、自動的に作成された項目と使用者定義の参照の両方が表示される。</p></li>
<li><p><span class="guilabel"><span class="accelerator">R</span>efer using</span> 一覧 で、必要な参照の型を選択する。選択肢は参照する項目によって異なる（すぐ次の節を参照しろ）。</p></li>
<li><p><span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押す。</p></li>
</ol>
</section>
<section id="formats-for-cross-references">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">Formats for cross-references</a><a class="headerlink" href="#formats-for-cross-references" title="Link to this heading">¶</a></h3>
<p>相互参照はその型によらず、次の形式から選択することができる：</p>
<dl class="simple">
<dt><cite>Page number (unstyled)</cite></dt><dd><p>対象のページ番号。ページスタイルで指定された書式を使用しない。</p>
</dd>
<dt><cite>Chapter</cite></dt><dd><p>参照された対象がある章の番号。</p>
</dd>
<dt><cite>Referenced Text</cite></dt><dd><p>参照またはしおりとして設定された全文集合。</p>
</dd>
<dt><cite>“Above”/”Below”</cite></dt><dd><p>参照される対象に対するフィールドの相対的な位置に応じて、上または下の単語。</p>
</dd>
<dt><cite>Page number (styled)</cite></dt><dd><p>対象のページ番号。ページスタイルで指定された書式を使用。ローマ数字が使用される front matter でページへの参照を置くときにたいへん便利だ。</p>
</dd>
</dl>
<p>見出しや段落番号にはさらに三つある：</p>
<dl class="simple">
<dt><cite>Number</cite></dt><dd><p>見出しまたは番号付き段落の番号を、文脈に応じて上位レベルも含めて入れる。</p>
</dd>
<dt><cite>Number (no context)</cite></dt><dd><p>見出しまたは番号付き段落の番号のみを入れる。例えば項目 2.4 を参照する場合、単に <code class="docutils literal notranslate"><span class="pre">4</span></code> が入る。</p>
</dd>
<dt><cite>Number (full context)</cite></dt><dd><p>上位の階層水準を含む完全な番号を入れる。例えば項目 2.4 を参照する場合、完全な番号である <code class="docutils literal notranslate"><span class="pre">2.4</span></code> が入る。</p>
</dd>
</dl>
<p>図表や図版など、説明とともにはめ込まれるものに対しては、次のように選択することもできる：</p>
<dl class="simple">
<dt><cite>Category and Number</cite></dt><dd><p>参照される物の区分と番号の両方 (e.g. <code class="docutils literal notranslate"><span class="pre">Figure</span> <span class="pre">6</span></code>) を入れる。図版や図表で最も使用される形式だ。</p>
</dd>
<dt><cite>Caption Text</cite></dt><dd><p>参照物の説明全文 (e.g. <code class="docutils literal notranslate"><span class="pre">Figure</span> <span class="pre">6:</span> <span class="pre">This</span> <span class="pre">is</span> <span class="pre">an</span> <span class="pre">example</span> <span class="pre">figure</span></code>) を入れる。</p>
</dd>
<dt><cite>Numbering</cite></dt><dd><p>参照される物の連番を区分を除いて入れる。例えば、<code class="docutils literal notranslate"><span class="pre">Table</span> <span class="pre">2</span></code> を参照する場合、フィールドには番号 <code class="docutils literal notranslate"><span class="pre">2</span></code> のみが含まれる。</p>
</dd>
</dl>
<section id="example-of-cross-referencing-to-numbered-headings">
<h4><a class="toc-backref" href="#id15" role="doc-backlink">Example of cross-referencing to numbered headings</a><a class="headerlink" href="#example-of-cross-referencing-to-numbered-headings" title="Link to this heading">¶</a></h4>
<p>第一章第二節第五項では見出しに 1.2.5 と番号を付けることができる。直前の 1.2.4 のテキストに含まれる参照は <cite>Number</cite> 形式を使うと <code class="docutils literal notranslate"><span class="pre">4</span></code> と表示される。もし番号がより多くの下位階を表示するように設定されていれば、同じ参照は設定により <code class="docutils literal notranslate"><span class="pre">2.4</span></code> または <code class="docutils literal notranslate"><span class="pre">1.2.4</span></code> と表示される。<cite>Number (full context)</cite> 形式を使用すると、番号がどのように形式化されていても、つねに <code class="docutils literal notranslate"><span class="pre">1.2.4</span></code> と表示される。</p>
</section>
</section>
<section id="preparing-items-as-targets-for-cross-referencing">
<span id="writer17-anchor-preparing"></span><h3><a class="toc-backref" href="#id16" role="doc-backlink">Preparing items as targets for cross-referencing</a><a class="headerlink" href="#preparing-items-as-targets-for-cross-referencing" title="Link to this heading">¶</a></h3>
<p><span class="guilabel">Cross-references</span> タブ に自動的に表示されないもの、例えば説明のない図版や箇条書き一覧の項目などに相互参照を挿入したい場合は、まず参照先となる項目を用意する必要がある。これを行うには、しおりを使用するか、参照を設定する。対象が定義されたら、
<a class="reference internal" href="#writer17-anchor-inserting"><span class="std std-ref">Inserting the cross-references</span></a> の説明に従って相互参照することができる。</p>
<section id="using-bookmarks">
<h4><a class="toc-backref" href="#id17" role="doc-backlink">Using bookmarks</a><a class="headerlink" href="#using-bookmarks" title="Link to this heading">¶</a></h4>
<p>しおりは Navigator に一覧表示され、そこから直接アクセスできる。<abbr title="HyperText Markup Language">HTML</abbr> 文書ではしおりはハイパーリンクを使って飛ぶことができる錨に変換される。</p>
<p>しおりの詳細については <a class="reference internal" href="#writer17-anchor-bookmarks"><span class="std std-ref">Managing bookmarks</span></a> を見ろ。</p>
<ol class="arabic simple">
<li><p>しおりにしたいテキストを選択するか、テキスト内の必要な場所をクリックする。メニューから <span class="menuselection"><span class="accelerator">I</span>nsert‣Bookmar<span class="accelerator">k</span>…</span> を選択する。</p></li>
<li><p><span class="guilabel">Bookmark</span> ダイアログボックスで以前に定義したしおりが一覧表示される。<span class="guilabel"><span class="accelerator">N</span>ame</span> 欄に新しいしおりの名前を入力するか、既定の名前を受け入れ、<span class="guilabel">In<span class="accelerator">s</span>ert</span> ボタンを押す。</p></li>
<li><p>さらにしおりを入れる間、ダイアログボックスを開いたままにしておくことができる。終わったら <span class="guilabel"><span class="accelerator">C</span>lose</span> ボタン を押す。</p></li>
</ol>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>「しおりにしたいテキスト」と記したが、文書中の選択自体としおりが対応すると考えろ。</p>
</div>
</section>
<section id="setting-references">
<h4><a class="toc-backref" href="#id18" role="doc-backlink">Setting references</a><a class="headerlink" href="#setting-references" title="Link to this heading">¶</a></h4>
<p>集合参照は <span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Cross-references</span> タブ で登録、管理する。</p>
<ol class="arabic simple">
<li><p>しおりのテキストを選択するか、テキスト内の必要な場所をクリックする。</p></li>
<li><p>Menu バー で <span class="menuselection"><span class="accelerator">I</span>nsert‣Cross-<span class="accelerator">r</span>eference…</span> を選択する。</p></li>
<li><p><span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Cross-references</span> タブ で <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 から <span class="guilabel">Set Reference</span> を選択する。<span class="guilabel"><span class="accelerator">S</span>elect</span> 一覧 には定義済みの参照が表示される。複数の項目を参照に設定する間、このダイアログボックスは開いたままにできる。</p></li>
<li><p>右下の <span class="guilabel"><span class="accelerator">V</span>alue</span> 欄 に項目のテキストが表示される。この項目を識別できるテキストを <span class="guilabel">Na<span class="accelerator">m</span>e</span> に入力する。フィールド名は大文字と小文字を区別する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押す。<span class="guilabel">Na<span class="accelerator">m</span>e</span> に入力したテキストが <span class="guilabel"><span class="accelerator">S</span>elect</span> 一覧 に表示される。</p></li>
<li><p>以上を必要なだけ繰り返す。</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>lose</span> ボタン を押す。</p></li>
</ol>
</section>
</section>
</section>
<section id="cross-referencing-between-subdocuments">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Cross-referencing between subdocuments</a><a class="headerlink" href="#cross-referencing-between-subdocuments" title="Link to this heading">¶</a></h2>
<p>宗主文書の従属文書間の相互参照を自動的に更新したい場合がある。この題目では集合参照を使用する方法について説明する。しおりを使用する場合も手順は同様だ。</p>
<section id="preparing-the-references">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Preparing the references</a><a class="headerlink" href="#preparing-the-references" title="Link to this heading">¶</a></h3>
<p>相互参照の対象となる項目すべてについて <a class="reference internal" href="#writer17-anchor-preparing"><span class="std std-ref">Preparing items as targets for cross-referencing</span></a> で説明した手順をとれ。この場合、見出し、図版の説明、その他の項目を含める必要がある。一つの文書内の項目のように自動的に一覧されないからだ。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>参照フィールドの名前を一覧し、一つの文書内だけでなく、関連する文書すべてでそれぞれの名前が一意であることを確認しろ。この情報を管理する方法の一つは、別のファイルやスプレッドシートに保存することだ。</p>
<p>フィールド名は大文字と小文字を区別する。参照する項目にマウスポインターを合わせるとフィールド名を確認できる。</p>
</div>
</section>
<section id="inserting-the-cross-references">
<span id="writer17-anchor-inserting"></span><h3><a class="toc-backref" href="#id21" role="doc-backlink">Inserting the cross-references</a><a class="headerlink" href="#inserting-the-cross-references" title="Link to this heading">¶</a></h3>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>手順をまだ試していない。</p>
</div>
<ol class="arabic simple">
<li><p>相互参照を表示したい文書内のどこかにキャレットを置く。</p></li>
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣Cross-<span class="accelerator">r</span>eference…</span> を選択。</p></li>
<li><p><span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Cross-references</span> タブ で <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 から <cite>Insert Reference</cite> を選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">R</span>efer using</span> 一覧 で <cite>Referenced text</cite> を選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">S</span>elect</span> 一覧 には使用している従属文書の参照フィールド名（もしあれば）しか表示されていないので、その一覧は無視して、前節で手動作成した一覧を確認しろ。</p></li>
<li><p><span class="guilabel">Na<span class="accelerator">m</span>e</span> に参照する従属文書に設定した参照の名前を入力する。この例では、参照名は <cite>word count</cite> だ。</p></li>
<li><p><span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押し、参照とページ番号の間に表示したいテキスト (e.g. <cite>on page</cite>) を入力し、<span class="guilabel"><span class="accelerator">R</span>efer using</span> 一覧 にある <cite>Page number (unstyled)</cite> を使って別の参照を入れる。相互参照はエラーを表示する。これらのフィールドの上にマウスポインターを置くとフィールド名が表示される。<a class="footnote-reference brackets" href="#writer17-footnote2" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p></li>
<li><p>従属文書に必要な相互参照をすべて挿入したら <span class="guilabel"><span class="accelerator">C</span>lose</span> ボタン を押して保存し、宗主文書のウィンドウに戻る。</p></li>
<li><p>Menu バー の <span class="menuselection"><span class="accelerator">T</span>ools‣<span class="accelerator">U</span>pdate‣<span class="accelerator">L</span>inks</span> を選択するか、Navigator の <span class="menuselection"><span class="accelerator">U</span>pdate‣<span class="accelerator">L</span>inks</span> を選択する。宗主文書の編集内容がすべて表示される。宗主文書内で、相互参照フィールドを挿入した従属文書のページに移動する。</p></li>
</ol>
<p>これで、挿入した場所に相互参照のテキストが表示されるはずだ。うまくいかない場合は、宗主文書を保存して閉じ、リンクを更新しながらもう一度開いてください。編集のために従属文書を開くと、エラーメッセージが表示される。</p>
<p>この技法は手順中で従属文書を直接開いて（宗主文書内からではなく）相互参照フィールドを入れる場合にも有効だ。</p>
</section>
</section>
<section id="using-fields-in-headers-and-footers">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Using fields in headers and footers</a><a class="headerlink" href="#using-fields-in-headers-and-footers" title="Link to this heading">¶</a></h2>
<p>ヘッダーやフッターにフィールドを挿入することができる：</p>
<ul class="simple">
<li><p>ページ番号、文書表題、作成者、作成日時、現在日時、または総ページ数フィールドを入れるには、<span class="guilabel">Document Properties</span> ダイアログボックス を使用するか、Menu バー で
<span class="menuselection"><span class="accelerator">I</span>nsert‣Fiel<span class="accelerator">d</span>‣</span> から対応項目を選択する。</p></li>
<li><p>しおり、見出し、その他の項目への相互参照を入れるには、次のいずれかを行う：</p>
<ul>
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣Cross-<span class="accelerator">r</span>eference…</span> を選択</p></li>
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣Fiel<span class="accelerator">d</span>‣<span class="accelerator">M</span>ore Fields…</span> で <span class="guilabel">Fields</span> ダイアログボックス を開いて <span class="guilabel">Cross-references</span> タブ を使う</p></li>
</ul>
</li>
<li><p><cite>Heading 1</cite> が章表題に使われている場合、<cite>Document</cite> フィールドを使って現在の章表題を挿入し、ヘッダーやフッターの内容が章ごとに変わるようにする。
<span class="menuselection"><span class="accelerator">I</span>nsert‣Fiel<span class="accelerator">d</span>‣<span class="accelerator">M</span>ore Fields…</span> で <span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Document</span> タブ をクリックする。</p></li>
<li><p>他の見出しレベルとの相互参照を入れるには、<span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Document</span> タブ 右下の
<span class="guilabel"><span class="accelerator">U</span>p to level</span> で値を指定する。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ページのヘッダー内の相互参照フィールドは、そのページのそのレベルの最初の見出しを拾い上げる。フッターのフィールドは、そのページのそのレベルの最後の見出しを拾う。</p>
</div>
<p>フッターに <cite>Page 9 of 12</cite> のような表記を追加できる。</p>
<ol class="arabic simple">
<li><p><cite>Page</cite> フィールドの前に単語 Page と空白を入力する。</p></li>
<li><p><cite>Page</cite> フィールドの後に空白、単語 of, 空白を入力する。</p></li>
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣Fiel<span class="accelerator">d</span>‣Page <span class="accelerator">C</span>ount</span> を選択する。</p></li>
</ol>
<p>章番号をページ番号に含めるには：</p>
<ol class="arabic simple">
<li><p>挿入した <cite>Page</cite> フィールドの直前にキャレットを置く。</p></li>
<li><p><span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Document</span> タブ で <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 で <cite>Chapter</cite> を選択し、<span class="guilabel"><span class="accelerator">F</span>ormat</span> 一覧
で <cite>Chapter number without separator</cite> を選択する。<span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押す。</p></li>
<li><p>このフィールドを挿入したヘッダーまたはフッターに移動し、章番号とページ番号の間に表示したい文字を入力する。</p></li>
<li><p>目次はこれらの章番号を自動的に拾い出さないので、<a class="reference internal" href="writer15.html"><span class="doc">Chapter 15, Tables of Contents, Indexes, Bibliographies</span></a> で説明するように
<span class="guilabel">Table of Contents, Index or Bibliography</span> ダイアログボックス <span class="guilabel">Entries</span> タブ で変更する必要がある。</p></li>
</ol>
</section>
<section id="managing-bookmarks">
<span id="writer17-anchor-bookmarks"></span><h2><a class="toc-backref" href="#id23" role="doc-backlink">Managing bookmarks</a><a class="headerlink" href="#managing-bookmarks" title="Link to this heading">¶</a></h2>
<p>しおりは位置参照にもテキスト参照にも使える。</p>
<p>しおりで囲まれたテキストは、文書自体だけでなく <span class="guilabel">Bookmark</span> ダイアログボックス でも編集できる。ダイアログボックスでテキストを編集すると、文書でも編集される。変更追跡をオンにしている場合、しおりの変更は文書内で追跡される。</p>
<p><span class="guilabel">Bookmark</span> ダイアログボックス を使ったしおりのテキストを編集する手順：</p>
<ol class="arabic simple">
<li><p>Navigator の Bookmarks 一覧を開き、しおり名を右クリックし、コンテキストメニューから <span class="menuselection"><span class="accelerator">E</span>dit…</span> を選択する。<span class="guilabel">Bookmark</span> ダイアログボックス がそのしおりを選択した状態で開く。ダイアログボックスが開いている間は、一覧内のどのしおりでも選択できる。</p></li>
<li><p>必要なしおりを選択した状態で <span class="guilabel"><span class="accelerator">E</span>dit Text</span> ボタンを押す。選択したしおりのテキストがテキスト欄で強調表示される。</p></li>
<li><p>ダイアログボックスで強調表示されたテキストをクリックして編集する。終わったら <span class="guilabel"><span class="accelerator">C</span>lose</span> ボタン を押す。</p></li>
</ol>
<p>しおりの名前を編集するには、 Navigator でしおりを右クリックし、コンテキストメニューから <span class="menuselection"><span class="accelerator">R</span>ename…</span> を選択するか、<span class="guilabel">Bookmark</span> ダイアログボックス でしおりを選択し、<span class="guilabel"><span class="accelerator">R</span>ename</span> ボタンを押す。小さなダイアログボックスが開く。新しい名前を入力するか、既存の名前を編集し、<span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押して保存する。</p>
<p>文書内のしおりを探すには、Navigator でしおりを右クリックし、コンテキストメニューから <span class="menuselection"><span class="accelerator">G</span>o to</span> を選択するか、<span class="guilabel">Bookmark</span> ダイアログボックス でしおりを選択し、
<span class="guilabel"><span class="accelerator">G</span>o to</span> ボタンを押す。キャレットがしおりの場所に飛び、しおりが強調表示される。</p>
</section>
<section id="developing-conditional-content">
<h2><a class="toc-backref" href="#id24" role="doc-backlink">Developing conditional content</a><a class="headerlink" href="#developing-conditional-content" title="Link to this heading">¶</a></h2>
<p>条件式中身とは、指定した条件によって文書に含まれたり含まれなかったりするテキストや画像のことだ。</p>
<p>簡単な例としては、延滞した口座の督促状がある。最初と二度目の督促状には Reminder
Notice という件名かもしれないが、三度目には Final Notice という件名になり、さらに最終段落が異なるかもしれない。</p>
<p>もっと複雑な例としては、Pro 版と Lite 版の二種類がある製品のソフトウェア手順書がある。両者には多くの共通点があるが、Pro 版には Lite 版にはない機能がある。条件式中身を使用すれば、両方の版の情報を含む一つのファイルを管理し、それぞれのためにカスタマイズした印刷（またはオンラインヘルプの作成）を行うことができる。同じ情報を二つ管理する必要がないので、何か変更があったときにどちらかを更新し忘れることがなくなる。</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>場合によっては、段落や文字のスタイルを隠すことで同じ効果を得ることができる。
<a class="reference internal" href="writer09.html"><span class="doc">Chapter 9, Working with Styles</span></a> を見ろ。</p>
</div>
<section id="choose-the-types-of-conditional-content-to-use">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Choose the types of conditional content to use</a><a class="headerlink" href="#choose-the-types-of-conditional-content-to-use" title="Link to this heading">¶</a></h3>
<p>条件式中身の設計と維持に役立つ Writer 機能について。文書一つで一つでも任意の組み合わせでも使用できる。</p>
<dl>
<dt>Conditional text</dt><dd><p>条件式テキストでは代替テキスト（単語、句、文）を二つ指定できる。一方のテキストは指定条件を満たした場合に表示・印刷され、もう一方は満たさなかった場合に表示・印刷される。<span class="guilabel">Fields</span> ダイアログボックス 以外では画像を入れたり、テキストを編集したりすることはできない（文書本文ではできない）。また、テキストの一部を書式設定することはできないが（例えば、ある単語を太字にし、他の単語を太字にしないなど）、フィールドの内容すべてに影響を与える書式設定をすることはできる（例えば、すべての単語を太字や斜体にするなど）。テキストに相互参照や他のフィールドを含めることはできない。</p>
</dd>
<dt>Hidden text</dt><dd><p>隠しテキスト（単語、句、文）では、見せるか隠すかの二択しかない。指定条件を満たせばテキストが隠れ、満たさなければ現れる。欠点は条件式テキストと同じで、画像を含められないこと、本文のテキストを編集できないこと、テキストの一部を書式整形できないこと、フィールドを含められないことだ。</p>
</dd>
<dt>Hidden paragraphs</dt><dd><p>どのような条件で段落を表示または印刷しないかを指定できる段落だ。画像を含めたり、本文のテキストを編集したり、テキストの任意の部分を整形したり、フィールドを含めたりすることが可能だ。</p>
<p>例えば、データベースフィールドに現在の登録項目の内容がない場合、空白の段落を隠すこともできる。これは、住所を手紙に差し込むときに便利だ。住所に二行を許可していて、データベースレコードが一行しか使用していない場合、空白行が文書に表示されるのを防ぐことができる。</p>
</dd>
<dt>Hidden sections</dt><dd><p>隠し区画は隠し段落のようなものだが、見出しと一つ以上の段落など、複数の段落を含むことができる。ただし、区画に段落未満の内容を含めることはできないので、単語や句にこの方法を使用することはできない。隠れ区画の内容は文書の他の部分の内容と同じように動作するが、区画を表示または印刷しない条件を指定することができる。さらに、区画をパスワードで保護することもできる。</p>
</dd>
</dl>
</section>
<section id="plan-your-conditional-content">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Plan your conditional content</a><a class="headerlink" href="#plan-your-conditional-content" title="Link to this heading">¶</a></h3>
<p>条件とは、プログラマーが論理式と呼ぶものだ。条件は常に真か偽のどちらかであるため、条件ごとに論理式を作成する必要がある。文書内のさまざまな場所で、さまざまな型の条件式中身に同じ条件を使用することができる。</p>
<p>条件式中身を動作させるには、変数を選択または定義し、選択した変数に関係する論理式（条件）を定義する必要がある。</p>
<section id="choose-or-define-a-variable">
<span id="writer17-anchor-var"></span><h4><a class="toc-backref" href="#id27" role="doc-backlink">Choose or define a variable</a><a class="headerlink" href="#choose-or-define-a-variable" title="Link to this heading">¶</a></h4>
<p>条件では次の変数を使用できる：</p>
<ul class="simple">
<li><p>使用者定義変数</p></li>
<li><p>文書性質の統計値を使用する定義済みの LibreOffice 変数</p></li>
<li><p>使用者データ</p></li>
<li><p>データベースフィールドの内容（住所録など）</p></li>
</ul>
<p>条件中では内部変数（ページ番号や章名など）を使用できない。</p>
</section>
<section id="define-a-logical-expression-condition-involving-the-variable">
<h4><a class="toc-backref" href="#id28" role="doc-backlink">Define a logical expression (condition) involving the variable</a><a class="headerlink" href="#define-a-logical-expression-condition-involving-the-variable" title="Link to this heading">¶</a></h4>
<p>条件は、指定された固定値と変数またはデータベースフィールドの中身を比較する。</p>
<p>条件を作成するには、数式を作成するのと同じ要素を使用する。演算子、数学関数、統計関数、数値書式、変数、定数などだ。使用可能な演算子や多くの使用例は Help に記載されている。複雑な式を定義することもできるが、ほとんどの場合は単純な条件で十分だ。</p>
</section>
</section>
<section id="create-the-variable">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Create the variable</a><a class="headerlink" href="#create-the-variable" title="Link to this heading">¶</a></h3>
<p>変数を作成するには、<span class="guilabel">Fields</span> ダイアログボックス の <span class="guilabel">DocInformation</span> タブ、<span class="guilabel">Variables</span> タブ、
<span class="guilabel">Database</span> タブ にある選択肢を使用する。</p>
<section id="docinformation-fields">
<h4><a class="toc-backref" href="#id30" role="doc-backlink">DocInformation fields</a><a class="headerlink" href="#docinformation-fields" title="Link to this heading">¶</a></h4>
<p><a class="reference internal" href="#writer17-anchor-hold"><span class="std std-ref">Using document properties to hold metadata and information that changes</span></a> では、文書独自性質を設定する方法を説明した。その文書性質を条件文の変数として使用することができる。</p>
</section>
<section id="user-defined-variable-field">
<h4><a class="toc-backref" href="#id31" role="doc-backlink">User-defined variable field</a><a class="headerlink" href="#user-defined-variable-field" title="Link to this heading">¶</a></h4>
<p>変数または使用者フィールドを設定するには：</p>
<ol class="arabic">
<li><p>フィールドを挿入したい場所にキャレットを置く。</p></li>
<li><p><span class="guilabel">Fields</span> ダイアログボックス で <span class="guilabel">Variables</span> タブ を選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 で <cite>Set variable</cite> を選択し、<span class="guilabel"><span class="accelerator">F</span>ormat</span> 一覧 で <cite>Text</cite> を選択する。<span class="guilabel">Na<span class="accelerator">m</span>e</span> に変数の名前を、<span class="guilabel"><span class="accelerator">V</span>alue</span> 欄 に値をそれぞれ入力する。</p>
<p>この例では（この変数が二つの製品版に関連していることを思い出させるため）、名前に <cite>ProLite</cite> が選ばれ、値には「Lite 版であれば、このテキストは隠す」ことを忘れないために <cite>Lite</cite> が設定されている。</p>
</li>
<li><p>文書にフィールドが表示されないように <span class="guilabel">Invisi<span class="accelerator">b</span>le</span> をオンにする。 <span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン
を押し、<span class="guilabel"><span class="accelerator">C</span>lose</span> ボタン を押す。フィールドを入れた場所に小さな灰色の目印が表示される。</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>灰色の目印はとても小さいので、特に文書内に他のフィールドがある場合、再度見つけるのに苦労することがある。作業中は変数フィールドを表示したままにしておき、最終的なコピーを作成する直前に隠すように変更するといい。</p>
<p>挿入点をフィールドの直前に置き、<span class="menuselection">Edit F<span class="accelerator">i</span>elds…</span> を選択するか、フィールドを右クリックしてコンテキストメニューから <span class="menuselection">Edit F<span class="accelerator">i</span>elds…</span> を選択することがいつでもできる。<span class="guilabel">Edit Fields</span> ダイアログボックス で <span class="guilabel">Invisi<span class="accelerator">b</span>le</span> を切り替えろ。</p>
</div>
</section>
</section>
<section id="apply-the-condition-to-the-content">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Apply the condition to the content</a><a class="headerlink" href="#apply-the-condition-to-the-content" title="Link to this heading">¶</a></h3>
<p>変数を定義したら、それを条件文の中で使うことができる。</p>
<section id="conditional-text">
<h4><a class="toc-backref" href="#id33" role="doc-backlink">Conditional text</a><a class="headerlink" href="#conditional-text" title="Link to this heading">¶</a></h4>
<p>まず、手引書の Lite 版には <cite>Great Product Lite</cite> を、Pro 版には <cite>Great Product
Pro</cite> という言葉を入れる条件テキストを設定しよう。製品名を記載したいときにいつでもこのフィールドを使用する。</p>
<ol class="arabic">
<li><p>キャレットをこれらの語句のいずれかを表示させたい場所に置く（キャレットは後で移動または削除することができる）。</p></li>
<li><p><span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Functions</span> タブ で <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 から <cite>Conditional text</cite> を選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>ondition</span> 欄、<span class="guilabel">The<span class="accelerator">n</span></span>, <span class="guilabel">Else</span> 各欄に次をそれぞれ入力する：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ProLite</span> <span class="pre">EQ</span> <span class="pre">&quot;Lite&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Great</span> <span class="pre">Product</span> <span class="pre">Lite</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Great</span> <span class="pre">Product</span> <span class="pre">Pro</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>これらのフィールドでは大文字と小文字が区別され、<cite>Lite</cite> のようなテキスト値の周りには引用符が必要だ。</p>
</div>
</li>
<li><p><span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押してフィールドを入れ、<span class="guilabel"><span class="accelerator">C</span>lose</span> ボタン を押す。テキストに <cite>Great Product
Lite</cite> が表示されるはずだ。</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>このフィールドをテキストに入れる場所が多い場合、<a class="reference internal" href="#writer17-anchor-autotext"><span class="std std-ref">AutoText</span></a> 項目を作成しろ。</p>
</div>
</section>
<section id="hidden-text">
<h4><a class="toc-backref" href="#id34" role="doc-backlink">Hidden text</a><a class="headerlink" href="#hidden-text" title="Link to this heading">¶</a></h4>
<p>隠しテキストは、Lite 版にはない Great Product Pro の機能を説明する単語や短い句に使用できる。コピーして貼り付けるなどして、文書内の複数の場所で同じフィールドを再利用できる。隠しテキストフィールドを作成するには：</p>
<ol class="arabic simple">
<li><p><span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Functions</span> タブ で <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 から <cite>Hidden text</cite> を選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">C</span>ondition</span> 欄 に <code class="docutils literal notranslate"><span class="pre">ProLite</span> <span class="pre">EQ</span> <span class="pre">&quot;Lite&quot;</span></code> と入力し、<span class="guilabel">Hidden t<span class="accelerator">e</span>xt</span> 欄に必要なテキストを入力する。これは条件が真の場合に隠れるテキストだ。</p></li>
<li><p><span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押してフィールドを作成し、文書中に入れる。</p></li>
</ol>
<p>隠しテキストをすべて見せて編集できるようにするには、次のいずれかを実行する：</p>
<ul class="simple">
<li><p><span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Writer‣View</span> ページ で <span class="guilabel">Hidden te<span class="accelerator">x</span>t</span> をオンにする。</p></li>
<li><p>テキストを隠す条件を定義するために使用した変数の前をダブルクリックし、変数に別の値を入力する。</p></li>
</ul>
</section>
<section id="hidden-paragraphs">
<h4><a class="toc-backref" href="#id35" role="doc-backlink">Hidden paragraphs</a><a class="headerlink" href="#hidden-paragraphs" title="Link to this heading">¶</a></h4>
<p>条件式段落は、その条件が真の場合に隠れる。段落を隠すには：</p>
<ol class="arabic simple">
<li><p>隠す段落をクリック</p></li>
<li><p><span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Functions</span> タブ <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 で <cite>Hidden Paragraph</cite> を選択</p></li>
<li><p>この例では、<span class="guilabel"><span class="accelerator">C</span>ondition</span> 欄 に <code class="docutils literal notranslate"><span class="pre">ProLite</span> <span class="pre">EQ</span> <span class="pre">&quot;Lite&quot;</span></code> と入力する</p></li>
<li><p><span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押してフィールドを作成</p></li>
</ol>
<p>隠し段落をすべて表示して編集できるようにするには、次のいずれかを実行する：</p>
<ul class="simple">
<li><p>Menu バー <span class="menuselection"><span class="accelerator">V</span>iew‣Field <span class="accelerator">H</span>idden Paragraphs</span> を選択</p></li>
<li><p><span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Writer‣View</span> ページ で <span class="guilabel">Hidden p<span class="accelerator">a</span>ragraphs</span> をオン</p></li>
<li><p>段落を非表示にする条件を定義するために使用した変数の前をダブルクリックし、変数に別の値を入力する。</p></li>
</ul>
</section>
<section id="hidden-sections">
<h4><a class="toc-backref" href="#id36" role="doc-backlink">Hidden sections</a><a class="headerlink" href="#hidden-sections" title="Link to this heading">¶</a></h4>
<p>条件式区画条件が真の場合に隠れる。条件式区画を作成するには：</p>
<ol class="arabic simple">
<li><p>条件式区画に含めたいテキストを選択する（他のテキストと同じように後で編集できる)。</p></li>
<li><p><span class="menuselection"><span class="accelerator">I</span>nsert‣Se<span class="accelerator">c</span>tion…</span> を選択する。<span class="guilabel">Insert Section</span> ダイアログボックス で
<span class="guilabel">Section</span> タブを開き、<span class="guilabel">H<span class="accelerator">i</span>de</span> をオンにして、 <span class="guilabel"><span class="accelerator">W</span>idth
Condition</span> に条件を入力する。区画に名前を付けることもできる。文書に区画が複数ある場合に、簡単に見つけることができるようになる。</p></li>
<li><p><span class="guilabel"><span class="accelerator">I</span>nsert</span> ボタン を押して区画を文書に入れる。</p></li>
</ol>
<p>隠し区画を見せて編集できるようにするには</p>
<ol class="arabic simple">
<li><p>Menu バー から <span class="menuselection">F<span class="accelerator">o</span>rmat‣<span class="accelerator">S</span>ections…</span> を選択する。</p></li>
<li><p><span class="guilabel">Edit Sections</span> ダイアログボックス で一覧から区画を選択する。</p></li>
<li><p><span class="guilabel">H<span class="accelerator">i</span>de</span> をオフにし、<span class="guilabel"><span class="accelerator">O</span>K</span> ボタン を押す。これで区画内容を編集できるようになる。その後、<span class="menuselection">F<span class="accelerator">o</span>rmat‣<span class="accelerator">S</span>ections…</span> を選択し、<span class="guilabel">H<span class="accelerator">i</span>de</span> をオンにすると、区画を再び隠すことができる。</p></li>
</ol>
<p>隠し区画を文書の通常の一部にする（つまり、区画目印は削除するが、内容は削除しない）手順：</p>
<ol class="arabic simple">
<li><p>上記のようにして隠し区画を見せる。</p></li>
<li><p><span class="guilabel">Edit Sections</span> ダイアログボックス で一覧から区画を選択する。</p></li>
<li><p><span class="guilabel"><span class="accelerator">R</span>emove</span> ボタン を押す。区画内容は文書の通常の部分となる。</p></li>
</ol>
</section>
</section>
<section id="change-the-value-of-the-variable">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">Change the value of the variable</a><a class="headerlink" href="#change-the-value-of-the-variable" title="Link to this heading">¶</a></h3>
<p><cite>Lite</cite> と <cite>Pro</cite> の間で変数の値を変更するには：</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#writer17-anchor-var"><span class="std std-ref">Choose or define a variable</span></a> で作成した変数フィールドを見つける。</p></li>
<li><p>このフィールドのすぐ前を一度クリックし、右クリックしてコンテキストメニューの
<span class="menuselection">Edit F<span class="accelerator">i</span>elds…</span> を選択。</p></li>
<li><p><span class="guilabel">Edit Fields</span> ダイアログボックス で変数の値を <cite>Pro</cite> に変更する。</p></li>
<li><p>フィールドを自動的に更新するように設定している場合は、この変数を条件として使用している条件式テキストと隠しテキストがすべて変更される。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>条件式テキストと隠しテキストは <span class="guilabel">Edit Fields</span> ダイアログボックス でのみ編集可能。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>フィールドの自動更新を有効にするには、<span class="guilabel">Options</span> ダイアログボックス <span class="menuselection">LibreOffice Writer‣General</span> ページ で
<span class="guilabel"><span class="accelerator">F</span>ields</span> をオンにする。</p>
</div>
</section>
</section>
<section id="using-placeholder-fields">
<span id="writer17-anchor-placeholder"></span><h2><a class="toc-backref" href="#id38" role="doc-backlink">Using placeholder fields</a><a class="headerlink" href="#using-placeholder-fields" title="Link to this heading">¶</a></h2>
<p>仮入力欄とは、テキスト、表組、枠、画像、物などの何かの入力を促すものだ。</p>
<p>仮入力欄を文書に入れるには：</p>
<ol class="arabic simple">
<li><p><span class="guilabel">Fields</span> ダイアログボックス <span class="guilabel">Functions</span> タブ <span class="guilabel"><span class="accelerator">T</span>ype</span> 一覧 で <cite>Placeholder</cite> を選択し、<span class="guilabel"><span class="accelerator">F</span>ormat</span> 一覧
で用途を選択する。</p></li>
<li><p>フィールドに表示したいテキストを <span class="guilabel">Placeholder</span> 欄 に入力する。</p></li>
<li><p>マウスポインターをフィールド上に置いたときにツールチップとして表示させたいテキストを <span class="guilabel">Reference</span> 欄に入力する。</p></li>
</ol>
<p><cite>Image</cite> 仮入力欄をクリックすると、<span class="guilabel">Insert Image</span> ダイアログボックス が開き、画像を選択するよう促される。画像を選択して <span class="guilabel">開く (<span class="accelerator">O</span>)</span> ボタン を押すと、その画像が文書内のフィールドに置き換わる。</p>
<p>同様に、<cite>Table</cite> 仮入力欄をクリックすると <span class="guilabel">Insert Table</span> ダイアログボックス が開き、<cite>Frame</cite> 仮入力欄をクリックすると <span class="guilabel">Frame</span> ダイアログボックス が開き、<cite>Object`仮入力欄をクリックすると
|InsertOLEDlg| が開く。`Text</cite> 仮入力欄は、単にそれをクリックし、<span class="guilabel">Placeholder</span> 欄
にテキストを入力するだけで、フィールドが置き換わる。</p>
</section>
<section id="using-other-fields">
<h2><a class="toc-backref" href="#id39" role="doc-backlink">Using other fields</a><a class="headerlink" href="#using-other-fields" title="Link to this heading">¶</a></h2>
<p>データベースフィールド、フォームフィールド、中身コントロールなど、フィールドのその他の使用方法については、この文書のさまざまな章で説明する。</p>
<p>LibreOffice には他にも便利なフィールドが多数用意されているが、専門的であり過ぎて紹介し切れない。詳細、説明、例については Help を参照しろ。</p>
</section>
<section id="classifying-document-contents">
<h2><a class="toc-backref" href="#id40" role="doc-backlink">Classifying document contents</a><a class="headerlink" href="#classifying-document-contents" title="Link to this heading">¶</a></h2>
<div class="admonition- admonition">
<p class="admonition-title">読者ノート</p>
<p>読み飛ばしていい。</p>
</div>
<p>文書の分類と機密保全は企業や政府にとって重要だ。使用者や組織の間で機密情報が交換される場合、そのような情報がどのように識別され、取り扱われるかについて、当事者間で合意する必要がある。LibreOffice は機密情報を保持するための一連の標準フィールドを使用して、機密情報を識別および保護するための標準化手段を備えている。</p>
<p>LibreOffice には <abbr title="Transglobal Secure Collaboration Participation">TSCP</abbr>
が作成したオープン標準が実装されている。これには三つの <abbr title="Business Authentication Framework">BAF</abbr> 区分が含まれている：</p>
<ul class="simple">
<li><p>知的財産</p></li>
<li><p>国家安全機密保全</p></li>
<li><p>輸出管理</p></li>
</ul>
<p>だ。各区分には <abbr title="Business Authorization Identification and Labeling Scheme">BAILS</abbr> 水準が四段階ある：</p>
<ul class="simple">
<li><p>非業務</p></li>
<li><p>一般業務</p></li>
<li><p>機密</p></li>
<li><p>内部のみ</p></li>
</ul>
<p>文書の分類を有効にするには、<span class="guilabel">TSCP</span> バーを開く。このツールバーには、文書の機密保全の選択に役立つリストボックスが含まれている。次に、LibreOffice は文書性質に独自フィールドを追加し、分類方策を文書のメタデータとして保存する。</p>
<p>機密保全策の侵害を防ぐため、高分類水準の内容を低水準の文書に貼り付けることは不可能だ。</p>
<hr class="docutils" />
<p class="rubric">章末注</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="writer17-footnote1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p><span class="guilabel">General</span> タブ の <span class="guilabel"><span class="accelerator">C</span>reated</span> と
<span class="guilabel"><span class="accelerator">M</span>odified</span> の行の人名。</p>
</aside>
<aside class="footnote brackets" id="writer17-footnote2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p><span class="menuselection"><span class="accelerator">V</span>iew‣<span class="accelerator">F</span>ield Names</span> を選択して、フィールドコードの表示をオンにすることができる。</p>
</aside>
</aside>
</section>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="writer16.html" title="Previous">Writer Guide Chapter 16, Master Documents ノート</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">LibreOffice Writer Guide 読書ノート</a>
        </li>
        <li>
          <a href="writer18.html" title="Next">Writer Guide Chapter 18, Forms ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="../../index.html" title="読書ノート Home"><img src="../../_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>