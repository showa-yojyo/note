<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Text Extractor &#8212; 読書ノート 1.6dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=1a9a5cd9" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=5a6f99c4"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="Video Conference Mute" href="video-conference-mute.html" />
    <link rel="prev" title="Shortcut Guide" href="shortcut-guide.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="shortcut-guide.html" title="Previous">Shortcut Guide</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">Microsoft PowerToys 利用ノート</a>
        </li>
        <li>
          <a href="video-conference-mute.html" title="Next">Video Conference Mute</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="text-extractor">
<h1><a class="toc-backref" href="#id6" role="doc-backlink">Text Extractor</a><a class="headerlink" href="#text-extractor" title="Permalink to this heading">¶</a></h1>
<p>Text Extractor は画面上の選択範囲からテキストを抽出する機能だ。</p>
<div class="admonition- admonition">
<p class="admonition-title">利用者ノート</p>
<p>携帯電話でオンライン麻雀ゲームのスコア画面を撮影することがよくあるのだが、その数字を転写するのがたいへん面倒だ。画像を PC にインポートして画面に表示させてこの機能でテキストを抽出したい。</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p><a class="reference internal" href="index.html"><span class="doc">Microsoft PowerToys 利用ノート</span></a> 冒頭の前提条件に留意すること。</p>
</div>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#text-extractor" id="id6">Text Extractor</a></p>
<ul>
<li><p><a class="reference internal" href="#id1" id="id7">稼働および停止方法</a></p></li>
<li><p><a class="reference internal" href="#id2" id="id8">調整</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id9">対応言語</a></p>
<ul>
<li><p><a class="reference internal" href="#ocr" id="id10">OCR 言語パック構成</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id4" id="id11">トラブルシューティング</a></p>
<ul>
<li><p><a class="reference internal" href="#powershell-invalidoperation" id="id12">公式文書の PowerShell コードで InvalidOperation 例外が生じる</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id13">日本語をスキャンすると空白文字がインターリーブする</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="id1">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">稼働および停止方法</a><a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<p>起動には <kbd class="kbd docutils literal notranslate">Win</kbd> + <kbd class="kbd docutils literal notranslate">Shift</kbd> + <kbd class="kbd docutils literal notranslate">T</kbd> を押す。画面が薄暗くなる。このとき、マウスドラッグで矩形選択して中に含まれている文字列をクリップボードにコピーする。選択領域のテキストが認識され、クリップボードにコピーされると、キャプチャーモードが解除される。あるいは <kbd class="kbd docutils literal notranslate">Esc</kbd> キーを押して終了することができる。</p>
</section>
<section id="id2">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">調整</a><a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h2>
<p>矩形選択中に <kbd class="kbd docutils literal notranslate">Shift</kbd> を押し始めると、操作モードが矩形移動に切り替わる。
<kbd class="kbd docutils literal notranslate">Shift</kbd> を離すと矩形指定モードに再び戻る。</p>
<ul class="simple">
<li><p>出力されたテキストが完璧でない場合もあるので、簡単な校正をする必要がある。</p></li>
<li><p>このツールは OCR を応用したものだ。</p></li>
<li><p>既定の言語は <span class="menuselection">Windows のシステム言語 ‣ キーボード設定</span> に基づく。OCR 言語パックをインストール可能。</p></li>
</ul>
</section>
<section id="id3">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">対応言語</a><a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<p>Text Extractor は OCR 言語パックがインストールされている言語しか認識できない。その一覧を得るには、PowerShell で次のコマンドを実行する：</p>
<div class="highlight-pwsh notranslate"><div class="highlight"><pre><span></span><span class="nb">PS </span><span class="p">&gt;</span> <span class="p">[</span><span class="n">Windows</span><span class="p">.</span><span class="n">Media</span><span class="p">.</span><span class="n">Ocr</span><span class="p">.</span><span class="n">OcrEngine</span><span class="p">,</span> <span class="n">Windows</span><span class="p">.</span><span class="n">Foundation</span><span class="p">,</span> <span class="n">ContentType</span> <span class="p">=</span> <span class="n">WindowsRuntime</span><span class="p">]</span>

<span class="n">IsPublic</span> <span class="n">IsSerial</span> <span class="n">Name</span>      <span class="n">BaseType</span>
<span class="p">--------</span> <span class="p">--------</span> <span class="p">----</span>      <span class="p">--------</span>
<span class="n">True</span>     <span class="n">False</span>    <span class="n">OcrEngine</span> <span class="n">System</span><span class="p">.</span><span class="n">Runtime</span><span class="p">.</span><span class="n">InteropServices</span><span class="p">.</span><span class="n">WindowsRuntime</span><span class="p">.</span><span class="n">RuntimeClass</span>

<span class="nb">PS </span><span class="p">&gt;</span> <span class="no">[Windows.Media.Ocr.OcrEngine]</span><span class="p">::</span><span class="n">AvailableRecognizerLanguages</span>

<span class="n">DisplayName</span>     <span class="p">:</span> <span class="n">日本語</span>
<span class="n">LanguageTag</span>     <span class="p">:</span> <span class="n">ja</span>
<span class="n">NativeName</span>      <span class="p">:</span> <span class="n">日本語</span>
<span class="n">Script</span>          <span class="p">:</span> <span class="n">Jpan</span>
<span class="n">LayoutDirection</span> <span class="p">:</span> <span class="n">Ltr</span>
<span class="n">AbbreviatedName</span> <span class="p">:</span> <span class="n">日本</span>
</pre></div>
</div>
<p>対応言語パックの一覧を返すには、<strong class="program">PowerShell</strong> を管理者として開き、次のコマンドを実行する：</p>
<div class="highlight-pwsh notranslate"><div class="highlight"><pre><span></span><span class="p">&gt;</span> <span class="nb">Get-WindowsCapability</span> <span class="n">-Online</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-Like</span> <span class="s1">&#39;Language.OCR*&#39;</span> <span class="p">}</span>
</pre></div>
</div>
<p>かなり長い出力となる。言語と場所は省略されるので、出力に使用できない言語がある場合、その言語は OCR が対応しないことを意味する。</p>
<section id="ocr">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">OCR 言語パック構成</a><a class="headerlink" href="#ocr" title="Permalink to this heading">¶</a></h3>
<p>OCR 言語パックをインストールするコマンド例 (en-US) を以下に示す：</p>
<div class="highlight-pwsh notranslate"><div class="highlight"><pre><span></span><span class="p">&gt;</span> <span class="nv">$Capability</span> <span class="p">=</span> <span class="nb">Get-WindowsCapability</span> <span class="n">-Online</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-Like</span> <span class="s1">&#39;Language.OCR*en-US*&#39;</span> <span class="p">}</span>
<span class="p">&gt;</span> <span class="nv">$Capability</span> <span class="p">|</span> <span class="nb">Add-WindowsCapability</span> <span class="n">-Online</span>
</pre></div>
</div>
<p>アンインストールは次のように実行する：</p>
<div class="highlight-pwsh notranslate"><div class="highlight"><pre><span></span><span class="p">&gt;</span> <span class="nv">$Capability</span> <span class="p">=</span> <span class="nb">Get-WindowsCapability</span> <span class="n">-Online</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-Like</span> <span class="s1">&#39;Language.OCR*en-US*&#39;</span> <span class="p">}</span>
<span class="p">&gt;</span> <span class="nv">$Capability</span> <span class="p">|</span> <span class="nb">Remove-WindowsCapability</span> <span class="n">-Online</span>
</pre></div>
</div>
</section>
</section>
<section id="id4">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">トラブルシューティング</a><a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<p>本家のトラブルシューティングは常識的であり過ぎる。当ノートでは独自の厄介事を記す。</p>
<section id="powershell-invalidoperation">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">公式文書の PowerShell コードで InvalidOperation 例外が生じる</a><a class="headerlink" href="#powershell-invalidoperation" title="Permalink to this heading">¶</a></h3>
<p>上記の Windows.Media.Ocr.OcrEngine を含むコードについては、PowerShell 7 で実行すると例外が送出する。これについては 古い PowerShell を利用することで解決する。</p>
</section>
<section id="id5">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">日本語をスキャンすると空白文字がインターリーブする</a><a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<p>このような感じになる。校正が必要になるとは断られているものの、これでは厳しい：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ト ラ づ ル シ ュ ー テ ィ ン ゲ
日本語 を ス キ ャ ン す る と 空白文字 が イ ン タ ー リ ー づ す る
</pre></div>
</div>
<p>こうなるとクリップボードからテキストを抽出して空白文字を削除するコマンドにパイプするしかない。</p>
</section>
</section>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="shortcut-guide.html" title="Previous">Shortcut Guide</a>
        </li>
      
        <li>
          &uarr;
          <a href="index.html" title="Parent">Microsoft PowerToys 利用ノート</a>
        </li>
        <li>
          <a href="video-conference-mute.html" title="Next">Video Conference Mute</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="../index.html" title="読書ノート Home"><img src="../_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>