<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>What’s New In Python 3.8 ノート &#8212; 読書ノート 1.6dev</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=c9b0a06a" />
    <script src="_static/documentation_options.js?v=4354bf25"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="_static/mathjax-v3.js?v=bf1ec211"></script>
    <script src="_static/mermaid.js?v=578dbed1"></script>
    <link rel="next" title="What’s New In Python 3.9 ノート" href="python-3.9.html" />
    <link rel="prev" title="What’s New In Python 3.7 ノート" href="python-3.7.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
    <div class="related top">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="python-3.7.html" title="Previous">What’s New In Python 3.7 ノート</a>
        </li>
      
        <li>
          <a href="python-3.9.html" title="Next">What’s New In Python 3.9 ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>


          <div class="body" role="main">
            
  <section id="what-s-new-in-python-3-8">
<h1><a class="toc-backref" href="#id2" role="doc-backlink">What’s New In Python 3.8 ノート</a><a class="headerlink" href="#what-s-new-in-python-3-8" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="https://docs.python.org/3/whatsnew/3.8.html">What’s New In Python 3.8</a> をたどりながら調査。興味のあるものしか読まない。</p>
<nav class="contents" id="id1">
<p class="topic-title">ノート目次</p>
<ul class="simple">
<li><p><a class="reference internal" href="#what-s-new-in-python-3-8" id="id2">What’s New In Python 3.8 ノート</a></p>
<ul>
<li><p><a class="reference internal" href="#new-features" id="id3">New Features</a></p></li>
<li><p><a class="reference internal" href="#other-language-changes" id="id4">Other Language Changes</a></p></li>
<li><p><a class="reference internal" href="#new-modules" id="id5">New Modules</a></p></li>
<li><p><a class="reference internal" href="#improved-modules" id="id6">Improved Modules</a></p>
<ul>
<li><p><a class="reference internal" href="#asyncio" id="id7"><code class="docutils literal notranslate"><span class="pre">asyncio</span></code></a></p></li>
<li><p><a class="reference internal" href="#collections" id="id8"><code class="docutils literal notranslate"><span class="pre">collections</span></code></a></p></li>
<li><p><a class="reference internal" href="#cprofile" id="id9"><code class="docutils literal notranslate"><span class="pre">cProfile</span></code></a></p></li>
<li><p><a class="reference internal" href="#csv" id="id10"><code class="docutils literal notranslate"><span class="pre">csv</span></code></a></p></li>
<li><p><a class="reference internal" href="#datetime" id="id11"><code class="docutils literal notranslate"><span class="pre">datetime</span></code></a></p></li>
<li><p><a class="reference internal" href="#functools" id="id12"><code class="docutils literal notranslate"><span class="pre">functools</span></code></a></p></li>
<li><p><a class="reference internal" href="#itertools" id="id13"><code class="docutils literal notranslate"><span class="pre">itertools</span></code></a></p></li>
<li><p><a class="reference internal" href="#math" id="id14"><code class="docutils literal notranslate"><span class="pre">math</span></code></a></p></li>
<li><p><a class="reference internal" href="#os-path" id="id15"><code class="docutils literal notranslate"><span class="pre">os.path</span></code></a></p></li>
<li><p><a class="reference internal" href="#pathlib" id="id16"><code class="docutils literal notranslate"><span class="pre">pathlib</span></code></a></p></li>
<li><p><a class="reference internal" href="#pprint" id="id17"><code class="docutils literal notranslate"><span class="pre">pprint</span></code></a></p></li>
<li><p><a class="reference internal" href="#statistics" id="id18"><code class="docutils literal notranslate"><span class="pre">statistics</span></code></a></p></li>
<li><p><a class="reference internal" href="#unicodedata" id="id19"><code class="docutils literal notranslate"><span class="pre">unicodedata</span></code></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="new-features">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">New Features</a><a class="headerlink" href="#new-features" title="Link to this heading">¶</a></h2>
<ul>
<li><p>代入文 <code class="docutils literal notranslate"><span class="pre">:=</span></code></p>
<ul class="simple">
<li><p>ふつうの <code class="docutils literal notranslate"><span class="pre">=</span></code> と微妙に異なる。</p></li>
<li><p>この演算子は内包記法と相性が良いようだ。</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">y</span> <span class="o">:=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">[2, 6, 12, 20, 30, 42, 56, 72]</span>
</pre></div>
</div>
</li>
<li><p>位置専用引数</p>
<ul class="simple">
<li><p>引数リストのスラッシュまでが位置専用引数を意味し、キーワード引数のような形では値渡しできない。</p></li>
<li><p>この構文は私は使わないだろうが、既存関数のヘルプを参照するときにこの知識が要るわけだ。</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<span class="go">Help on built-in function len in module builtins:</span>

<span class="go">len(obj, /)</span>
<span class="go">    Return the number of items in a container.</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">TypeError: len() takes no keyword arguments</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">3</span>
</pre></div>
</div>
</li>
<li><p>f-string での <code class="docutils literal notranslate"><span class="pre">=</span></code> を用いたオブジェクトの表現</p>
<ul class="simple">
<li><p>中括弧の中に評価したい Python 式に加えて等号を置くと、式を表す文字列がそのまま保たれる機能だ。</p></li>
<li><p>次は公式文書からそっくり拝借した利用例だ。</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">radians</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta</span> <span class="o">=</span> <span class="mi">30</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">theta</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span><span class="si">=:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="go">&#39;theta=30 cos(radians(theta))=0.866&#39;</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="other-language-changes">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Other Language Changes</a><a class="headerlink" href="#other-language-changes" title="Link to this heading">¶</a></h2>
<ul>
<li><p>メソッド <code class="docutils literal notranslate"><span class="pre">.as_integer_ratio()</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code> や <code class="docutils literal notranslate"><span class="pre">decimal.Decimal</span></code> のメソッドだったが、さらに <code class="docutils literal notranslate"><span class="pre">bool</span></code>,
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">fractions.Fraction</span></code> もこれをサポートするようになった。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Fraction</span></code> にこれまでサポートされていなかったというのは驚きだ。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kc">True</span><span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(1, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kc">False</span><span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(10, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(-10, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Fraction</span><span class="p">(</span><span class="o">-</span><span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">)</span><span class="o">.</span><span class="n">as_integer_ratio</span><span class="p">()</span>
<span class="go">(-41, 152)</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>正規表現で Unicode の文字名を <code class="regexp docutils literal notranslate"><span class="pre">\N{name}</span></code> の形で書けるようになった。例えば「🀀」にマッチする正規表現は次でもよい：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;ドラは🀀になりました&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\N{MAHJONG TILE EAST WIND}&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="go">&lt;re.Match object; span=(3, 4), match=&#39;🀀&#39;&gt;</span>
</pre></div>
</div>
</li>
<li><p>逆順サポートが <code class="docutils literal notranslate"><span class="pre">dict</span></code>, <code class="docutils literal notranslate"><span class="pre">dictview</span></code> に追加された。使う気がしない。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">pow(base,</span> <span class="pre">exp,</span> <span class="pre">mod)</span></code> で整数のべき乗の剰余を計算する際に、<code class="docutils literal notranslate"><span class="pre">base</span></code> が
<code class="docutils literal notranslate"><span class="pre">mod</span></code> と互いに素ならば <code class="docutils literal notranslate"><span class="pre">exp</span></code> に負の数を許容するようになった。次のコードは公式文書からとってきたものだ：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">pow</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">137</span><span class="p">)</span>
<span class="go">119</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">38</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">137</span><span class="p">)</span> <span class="o">%</span> <span class="mi">137</span>
<span class="go">1</span>
</pre></div>
</div>
<ul>
<li><p>これは Diophantus 方程式を解くのに利用できる。これも公式からとってきた例だが、方程式</p>
<div class="math notranslate nohighlight">
\[4258x + 147y = 369\]</div>
<p>の解を一つ見つけよう。これを次のように書き換えれば：</p>
<div class="math notranslate nohighlight">
\[4258x \equiv 369 \pmod{147}\]</div>
<p>Python で次のコードで <span class="math notranslate nohighlight">\(x\)</span> および <span class="math notranslate nohighlight">\(y\)</span> を求められることに気づく：</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">369</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">4258</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">147</span><span class="p">)</span> <span class="o">%</span> <span class="mi">147</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4258</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">369</span><span class="p">)</span> <span class="o">//</span> <span class="o">-</span><span class="mi">147</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">4258</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">147</span> <span class="o">*</span> <span class="n">y</span>
<span class="go">369</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> の内包表現はキー、値の順に評価される。</p></li>
</ul>
</section>
<section id="new-modules">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">New Modules</a><a class="headerlink" href="#new-modules" title="Link to this heading">¶</a></h2>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">importlib.metadata</span></code></p>
<ul>
<li><p>このモジュールはサードパーティー製パッケージからバージョン、エントリーポイントなどの諸データを得る機能を提供する。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">importlib.metadata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">version</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">&#39;1.5.1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy_metadata</span>
<span class="go">&lt;email.message.Message at 0x2237c4d4820&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[&#39;Metadata-Version&#39;,</span>
<span class="go"> &#39;Name&#39;,</span>
<span class="go"> &#39;Version&#39;,</span>
<span class="go"> &#39;Summary&#39;,</span>
<span class="go"> &#39;Home-page&#39;,</span>
<span class="go"> &#39;Author&#39;,</span>
<span class="go"> &#39;Author-email&#39;,</span>
<span class="go"> &#39;License&#39;,</span>
<span class="go"> &#39;Keywords&#39;,</span>
<span class="go"> &#39;Platform&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Classifier&#39;,</span>
<span class="go"> &#39;Requires-Python&#39;,</span>
<span class="go"> &#39;Requires-Dist&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy_metadata</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">metadata</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy_metadata</span><span class="p">[</span><span class="s1">&#39;Author&#39;</span><span class="p">]</span>
<span class="go">&#39;SymPy development team&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy_metadata</span><span class="p">[</span><span class="s1">&#39;Summary&#39;</span><span class="p">]</span>
<span class="go">&#39;Computer algebra system (CAS) in Python&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sympy_metadata</span><span class="p">[</span><span class="s1">&#39;Keywords&#39;</span><span class="p">]</span>
<span class="go">&#39;Math CAS&#39;</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</section>
<section id="improved-modules">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Improved Modules</a><a class="headerlink" href="#improved-modules" title="Link to this heading">¶</a></h2>
<section id="asyncio">
<h3><a class="toc-backref" href="#id7" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">asyncio</span></code></a><a class="headerlink" href="#asyncio" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Python 3.7 で新設された <code class="docutils literal notranslate"><span class="pre">run()</span></code> が安定 API に昇格した。</p></li>
<li><p>シェルで <strong class="command">python -m asyncio</strong> を実行すると、専用対話型インタプリタが起動する。</p></li>
<li><p>Windows では、イベントループのデフォルトが <code class="docutils literal notranslate"><span class="pre">ProactorEventLoop</span></code> になった。併せて、<code class="docutils literal notranslate"><span class="pre">ProactorEventLoop</span></code> が <code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code> によって中断できるようになった。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Task</span></code> オブジェクトに名前をつけることができる。生成時に <code class="docutils literal notranslate"><span class="pre">name</span></code> を指定するか、メソッド <code class="docutils literal notranslate"><span class="pre">set_name()</span></code> を呼べばできる。名前は <code class="docutils literal notranslate"><span class="pre">repr()</span></code> 出力やメソッド
<code class="docutils literal notranslate"><span class="pre">get_name()</span></code> の返り値でわかる。</p></li>
</ul>
</section>
<section id="collections">
<h3><a class="toc-backref" href="#id8" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">collections</span></code></a><a class="headerlink" href="#collections" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">namedtuple</span></code> のメソッド <code class="docutils literal notranslate"><span class="pre">_asdict()</span></code> の返り値の型が単なる <code class="docutils literal notranslate"><span class="pre">dict</span></code> に変更された。</p></li>
</ul>
</section>
<section id="cprofile">
<h3><a class="toc-backref" href="#id9" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">cProfile</span></code></a><a class="headerlink" href="#cprofile" title="Link to this heading">¶</a></h3>
<ul>
<li><p>クラス <code class="docutils literal notranslate"><span class="pre">Profile</span></code> がコンテキストマネジャーをサポートした。つまり <code class="docutils literal notranslate"><span class="pre">with</span></code> 文でプロファイルがとれる。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">0</span>
<span class="gp">... </span>    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cProfile</span> <span class="kn">import</span> <span class="n">Profile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">Profile</span><span class="p">()</span> <span class="k">as</span> <span class="n">profiler</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">fib</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">0</span>
<span class="go">1</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">5</span>
<span class="go">8</span>
<span class="go">13</span>
<span class="go">21</span>
<span class="go">34</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">profiler</span><span class="o">.</span><span class="n">print_stats</span><span class="p">()</span>
<span class="go">         488 function calls (222 primitive calls) in 0.028 seconds</span>

<span class="go">   Ordered by: standard name</span>

<span class="go">   ncalls  tottime  percall  cumtime  percall filename:lineno(function)</span>
<span class="go">   276/10    0.000    0.000    0.000    0.000 &lt;ipython-input-107-8190ac52035f&gt;:1(fib)</span>
<span class="go">       20    0.000    0.000    0.028    0.001 ansitowin32.py:160(write)</span>
<span class="go">       20    0.000    0.000    0.028    0.001 ansitowin32.py:177(write_and_convert)</span>
<span class="go">       20    0.000    0.000    0.027    0.001 ansitowin32.py:193(write_plain_text)</span>
<span class="go">       20    0.000    0.000    0.000    0.000 ansitowin32.py:245(convert_osc)</span>
<span class="go">       20    0.000    0.000    0.028    0.001 ansitowin32.py:40(write)</span>
<span class="go">        1    0.000    0.000    0.000    0.000 cProfile.py:133(__exit__)</span>
<span class="go">       20    0.000    0.000    0.000    0.000 {built-in method builtins.len}</span>
<span class="go">       10    0.000    0.000    0.028    0.003 {built-in method builtins.print}</span>
<span class="go">        1    0.000    0.000    0.000    0.000 {method &#39;disable&#39; of &#39;_lsprof.Profiler&#39; objects}</span>
<span class="go">       40    0.000    0.000    0.000    0.000 {method &#39;finditer&#39; of &#39;re.Pattern&#39; objects}</span>
<span class="go">       20    0.004    0.000    0.004    0.000 {method &#39;flush&#39; of &#39;_io.TextIOWrapper&#39; objects}</span>
<span class="go">       20    0.023    0.001    0.023    0.001 {method &#39;write&#39; of &#39;_io.TextIOWrapper&#39; objects}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="csv">
<h3><a class="toc-backref" href="#id10" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">csv</span></code></a><a class="headerlink" href="#csv" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">csv.DictReader</span></code> が返す iterable が単なる <code class="docutils literal notranslate"><span class="pre">dict</span></code> になった。</p></li>
</ul>
</section>
<section id="datetime">
<h3><a class="toc-backref" href="#id11" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">datetime</span></code></a><a class="headerlink" href="#datetime" title="Link to this heading">¶</a></h3>
<ul>
<li><p>クラスメソッドが二点追加された。これらの逆メソッドはすでにサポート済みだ。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">date.fromisocalendar(year,</span> <span class="pre">week,</span> <span class="pre">day)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datetime.fromisocalendar(year,</span> <span class="pre">week,</span> <span class="pre">day)</span></code></p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">date</span><span class="o">.</span><span class="n">fromisocalendar</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">datetime.date(2020, 5, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisocalendar</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">datetime.datetime(2020, 5, 3, 0, 0)</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="functools">
<h3><a class="toc-backref" href="#id12" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">functools</span></code></a><a class="headerlink" href="#functools" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">lru_cache()</span></code> が従来の用法に加えて decorator そのものとしても使えるようになった。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">lru_cache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@lru_cache</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">0</span>
<span class="gp">... </span>    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fib</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">...</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">cached_property()</span></code> が追加された。一度計算すれば二度と変わらないような値を返すメソッドに適用すると効率が良い。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">singledispatchmethod()</span></code> が追加された。名前からわかるように
<code class="docutils literal notranslate"><span class="pre">singledispatch()</span></code> のメソッド版だ。</p></li>
</ul>
</section>
<section id="itertools">
<h3><a class="toc-backref" href="#id13" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">itertools</span></code></a><a class="headerlink" href="#itertools" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">accumulate()</span></code> にオプション引数 <code class="docutils literal notranslate"><span class="pre">initial</span></code> が追加された。</p></li>
</ul>
</section>
<section id="math">
<h3><a class="toc-backref" href="#id14" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">math</span></code></a><a class="headerlink" href="#math" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">dist()</span></code> が追加された。</p>
<ul>
<li><p>Pythagoras の定理に基づく二点間に距離を計算する。</p></li>
<li><p>点は iterable で与えることができる。二点の次元は同じであるものとする。</p></li>
</ul>
</li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">hypot()</span></code> の二次元制限が廃止された。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">prod()</span></code> が追加された。組み込み関数 <code class="docutils literal notranslate"><span class="pre">sum()</span></code> の乗算版だ。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">perm()</span></code> が追加された。順列の数を計算する。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">comb()</span></code> が追加された。二項係数を計算する。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">isqrt()</span></code> が追加された。非負整数を取り非負整数を返す。</p></li>
</ul>
</section>
<section id="os-path">
<h3><a class="toc-backref" href="#id15" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">os.path</span></code></a><a class="headerlink" href="#os-path" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>関数のうち、パス文字列を判定して真偽値を返す <code class="docutils literal notranslate"><span class="pre">exists()</span></code> などが
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code> またはそのサブクラスの例外を送出していたような状況において、単に <code class="docutils literal notranslate"><span class="pre">False</span></code> を返すように変更された。パス文字列が OS レベルで表現できないような文字なりバイトなりを含むときにそうなる。</p></li>
<li><p>Windows では 関数 <code class="docutils literal notranslate"><span class="pre">expanduser()</span></code> が環境変数 <code class="docutils literal notranslate"><span class="pre">USERPROFILE</span></code> を <code class="docutils literal notranslate"><span class="pre">HOME</span></code> よりも優先するようになった。</p></li>
<li><p>その他の Windows 対応。</p></li>
</ul>
</section>
<section id="pathlib">
<h3><a class="toc-backref" href="#id16" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">pathlib</span></code></a><a class="headerlink" href="#pathlib" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Path のメソッドのうち、パス文字列を判定して真偽値を返す <code class="docutils literal notranslate"><span class="pre">exists()</span></code> などについても <code class="docutils literal notranslate"><span class="pre">os.path</span></code> での変更と同じものがなされた。</p></li>
</ul>
</section>
<section id="pprint">
<h3><a class="toc-backref" href="#id17" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">pprint</span></code></a><a class="headerlink" href="#pprint" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>関数に引数 <code class="docutils literal notranslate"><span class="pre">sort_dicts</span></code> が追加された。</p>
<ul>
<li><p>既定値は True であるが、True と False のどちらも用途があるので考えて使う。</p></li>
<li><p>それに伴い関数 <code class="docutils literal notranslate"><span class="pre">pp()</span></code> が追加された。<code class="code docutils literal notranslate"><span class="pre">sort_dicts=False</span></code> として関数 <code class="docutils literal notranslate"><span class="pre">pprint()</span></code> を呼び出すようなものだ。</p></li>
</ul>
</li>
</ul>
</section>
<section id="statistics">
<h3><a class="toc-backref" href="#id18" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">statistics</span></code></a><a class="headerlink" href="#statistics" title="Link to this heading">¶</a></h3>
<p>使えるものが相当数追加されている。</p>
<ul class="simple">
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">fmean()</span></code> が追加された。関数 <code class="docutils literal notranslate"><span class="pre">mean()</span></code> の浮動小数点特化版。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">geometric_mean()</span></code> が追加された。こちらはデータを浮動小数点に変換してから演算する。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">multimode()</span></code> が追加された。最頻値が複数あればそれをすべて返す。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">quantiles()</span></code> が追加された。分割点のほうを返す。</p>
<ul>
<li><p>キーワード引数 <code class="docutils literal notranslate"><span class="pre">n</span></code> で分割数を指定する。既定値は 4 だ。</p></li>
<li><p>キーワード引数 <code class="docutils literal notranslate"><span class="pre">method</span></code> でアルゴリズムを指定する。 <code class="docutils literal notranslate"><span class="pre">'inclusive'</span></code> か
<code class="docutils literal notranslate"><span class="pre">'exclusive'</span></code> を指定する。既定値は後者だ。</p></li>
</ul>
</li>
<li><p>クラス <code class="docutils literal notranslate"><span class="pre">NormalDist</span></code> が追加された。もちろん正規分布を意味する。</p>
<ul>
<li><p>コンストラクターから生成するときは期待値と標準偏差を与える。</p></li>
<li><p>クラスメソッド <code class="docutils literal notranslate"><span class="pre">.from_samples()</span></code> でデータから生成することもできる。</p></li>
<li><p>Library Reference の記述がひじょうに丁寧なので読んでおく。</p></li>
</ul>
</li>
</ul>
</section>
<section id="unicodedata">
<h3><a class="toc-backref" href="#id19" role="doc-backlink"><code class="docutils literal notranslate"><span class="pre">unicodedata</span></code></a><a class="headerlink" href="#unicodedata" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Unicode 12.1.0 に対応。</p></li>
<li><p>関数 <code class="docutils literal notranslate"><span class="pre">is_normalized()</span></code> が追加された。与えられた文字列が NFC, NFKC, NFD, NFKD
正規形なのかどうかを返す。</p></li>
</ul>
<p>以上</p>
</section>
</section>
</section>


          </div>
    <div class="related bottom">
      &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="python-3.7.html" title="Previous">What’s New In Python 3.7 ノート</a>
        </li>
      
        <li>
          <a href="python-3.9.html" title="Next">What’s New In Python 3.9 ノート</a>
          &rarr;
        </li>
    </ul>
  </nav>
    </div>

      </div>
      <div class="clearer"></div>
    </div>
<div class="footer">
  <ul>
    <li id="footer_logo">
      <a class="image-reference" href="index.html" title="読書ノート Home"><img src="_images/logo.svg"/></a>
    </li>
    <li id="footer_copyright">
      Copyright &copy; 1999-2024, プレハブ小屋 All rights reserved.
    </li>
  </ul>
</div>
  </body>
</html>